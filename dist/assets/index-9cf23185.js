function vC(i,o){for(var d=0;d<o.length;d++){const y=o[d];if(typeof y!="string"&&!Array.isArray(y)){for(const x in y)if(x!=="default"&&!(x in i)){const S=Object.getOwnPropertyDescriptor(y,x);S&&Object.defineProperty(i,x,S.get?S:{enumerable:!0,get:()=>y[x]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const x of document.querySelectorAll('link[rel="modulepreload"]'))y(x);new MutationObserver(x=>{for(const S of x)if(S.type==="childList")for(const b of S.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&y(b)}).observe(document,{childList:!0,subtree:!0});function d(x){const S={};return x.integrity&&(S.integrity=x.integrity),x.referrerPolicy&&(S.referrerPolicy=x.referrerPolicy),x.crossOrigin==="use-credentials"?S.credentials="include":x.crossOrigin==="anonymous"?S.credentials="omit":S.credentials="same-origin",S}function y(x){if(x.ep)return;x.ep=!0;const S=d(x);fetch(x.href,S)}})();var xC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function S0(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Bx={exports:{}},_m={},jx={exports:{}},Nt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wh=Symbol.for("react.element"),bC=Symbol.for("react.portal"),wC=Symbol.for("react.fragment"),CC=Symbol.for("react.strict_mode"),IC=Symbol.for("react.profiler"),AC=Symbol.for("react.provider"),SC=Symbol.for("react.context"),TC=Symbol.for("react.forward_ref"),PC=Symbol.for("react.suspense"),kC=Symbol.for("react.memo"),MC=Symbol.for("react.lazy"),cv=Symbol.iterator;function EC(i){return i===null||typeof i!="object"?null:(i=cv&&i[cv]||i["@@iterator"],typeof i=="function"?i:null)}var Ox={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Vx=Object.assign,Ux={};function Vc(i,o,d){this.props=i,this.context=o,this.refs=Ux,this.updater=d||Ox}Vc.prototype.isReactComponent={};Vc.prototype.setState=function(i,o){if(typeof i!="object"&&typeof i!="function"&&i!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,i,o,"setState")};Vc.prototype.forceUpdate=function(i){this.updater.enqueueForceUpdate(this,i,"forceUpdate")};function $x(){}$x.prototype=Vc.prototype;function T0(i,o,d){this.props=i,this.context=o,this.refs=Ux,this.updater=d||Ox}var P0=T0.prototype=new $x;P0.constructor=T0;Vx(P0,Vc.prototype);P0.isPureReactComponent=!0;var uv=Array.isArray,Zx=Object.prototype.hasOwnProperty,k0={current:null},Gx={key:!0,ref:!0,__self:!0,__source:!0};function Wx(i,o,d){var y,x={},S=null,b=null;if(o!=null)for(y in o.ref!==void 0&&(b=o.ref),o.key!==void 0&&(S=""+o.key),o)Zx.call(o,y)&&!Gx.hasOwnProperty(y)&&(x[y]=o[y]);var c=arguments.length-2;if(c===1)x.children=d;else if(1<c){for(var F=Array(c),W=0;W<c;W++)F[W]=arguments[W+2];x.children=F}if(i&&i.defaultProps)for(y in c=i.defaultProps,c)x[y]===void 0&&(x[y]=c[y]);return{$$typeof:Wh,type:i,key:S,ref:b,props:x,_owner:k0.current}}function zC(i,o){return{$$typeof:Wh,type:i.type,key:o,ref:i.ref,props:i.props,_owner:i._owner}}function M0(i){return typeof i=="object"&&i!==null&&i.$$typeof===Wh}function NC(i){var o={"=":"=0",":":"=2"};return"$"+i.replace(/[=:]/g,function(d){return o[d]})}var hv=/\/+/g;function Kf(i,o){return typeof i=="object"&&i!==null&&i.key!=null?NC(""+i.key):o.toString(36)}function Mp(i,o,d,y,x){var S=typeof i;(S==="undefined"||S==="boolean")&&(i=null);var b=!1;if(i===null)b=!0;else switch(S){case"string":case"number":b=!0;break;case"object":switch(i.$$typeof){case Wh:case bC:b=!0}}if(b)return b=i,x=x(b),i=y===""?"."+Kf(b,0):y,uv(x)?(d="",i!=null&&(d=i.replace(hv,"$&/")+"/"),Mp(x,o,d,"",function(W){return W})):x!=null&&(M0(x)&&(x=zC(x,d+(!x.key||b&&b.key===x.key?"":(""+x.key).replace(hv,"$&/")+"/")+i)),o.push(x)),1;if(b=0,y=y===""?".":y+":",uv(i))for(var c=0;c<i.length;c++){S=i[c];var F=y+Kf(S,c);b+=Mp(S,o,d,F,x)}else if(F=EC(i),typeof F=="function")for(i=F.call(i),c=0;!(S=i.next()).done;)S=S.value,F=y+Kf(S,c++),b+=Mp(S,o,d,F,x);else if(S==="object")throw o=String(i),Error("Objects are not valid as a React child (found: "+(o==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":o)+"). If you meant to render a collection of children, use an array instead.");return b}function hp(i,o,d){if(i==null)return i;var y=[],x=0;return Mp(i,y,"","",function(S){return o.call(d,S,x++)}),y}function DC(i){if(i._status===-1){var o=i._result;o=o(),o.then(function(d){(i._status===0||i._status===-1)&&(i._status=1,i._result=d)},function(d){(i._status===0||i._status===-1)&&(i._status=2,i._result=d)}),i._status===-1&&(i._status=0,i._result=o)}if(i._status===1)return i._result.default;throw i._result}var rr={current:null},Ep={transition:null},LC={ReactCurrentDispatcher:rr,ReactCurrentBatchConfig:Ep,ReactCurrentOwner:k0};function qx(){throw Error("act(...) is not supported in production builds of React.")}Nt.Children={map:hp,forEach:function(i,o,d){hp(i,function(){o.apply(this,arguments)},d)},count:function(i){var o=0;return hp(i,function(){o++}),o},toArray:function(i){return hp(i,function(o){return o})||[]},only:function(i){if(!M0(i))throw Error("React.Children.only expected to receive a single React element child.");return i}};Nt.Component=Vc;Nt.Fragment=wC;Nt.Profiler=IC;Nt.PureComponent=T0;Nt.StrictMode=CC;Nt.Suspense=PC;Nt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=LC;Nt.act=qx;Nt.cloneElement=function(i,o,d){if(i==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+i+".");var y=Vx({},i.props),x=i.key,S=i.ref,b=i._owner;if(o!=null){if(o.ref!==void 0&&(S=o.ref,b=k0.current),o.key!==void 0&&(x=""+o.key),i.type&&i.type.defaultProps)var c=i.type.defaultProps;for(F in o)Zx.call(o,F)&&!Gx.hasOwnProperty(F)&&(y[F]=o[F]===void 0&&c!==void 0?c[F]:o[F])}var F=arguments.length-2;if(F===1)y.children=d;else if(1<F){c=Array(F);for(var W=0;W<F;W++)c[W]=arguments[W+2];y.children=c}return{$$typeof:Wh,type:i.type,key:x,ref:S,props:y,_owner:b}};Nt.createContext=function(i){return i={$$typeof:SC,_currentValue:i,_currentValue2:i,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},i.Provider={$$typeof:AC,_context:i},i.Consumer=i};Nt.createElement=Wx;Nt.createFactory=function(i){var o=Wx.bind(null,i);return o.type=i,o};Nt.createRef=function(){return{current:null}};Nt.forwardRef=function(i){return{$$typeof:TC,render:i}};Nt.isValidElement=M0;Nt.lazy=function(i){return{$$typeof:MC,_payload:{_status:-1,_result:i},_init:DC}};Nt.memo=function(i,o){return{$$typeof:kC,type:i,compare:o===void 0?null:o}};Nt.startTransition=function(i){var o=Ep.transition;Ep.transition={};try{i()}finally{Ep.transition=o}};Nt.unstable_act=qx;Nt.useCallback=function(i,o){return rr.current.useCallback(i,o)};Nt.useContext=function(i){return rr.current.useContext(i)};Nt.useDebugValue=function(){};Nt.useDeferredValue=function(i){return rr.current.useDeferredValue(i)};Nt.useEffect=function(i,o){return rr.current.useEffect(i,o)};Nt.useId=function(){return rr.current.useId()};Nt.useImperativeHandle=function(i,o,d){return rr.current.useImperativeHandle(i,o,d)};Nt.useInsertionEffect=function(i,o){return rr.current.useInsertionEffect(i,o)};Nt.useLayoutEffect=function(i,o){return rr.current.useLayoutEffect(i,o)};Nt.useMemo=function(i,o){return rr.current.useMemo(i,o)};Nt.useReducer=function(i,o,d){return rr.current.useReducer(i,o,d)};Nt.useRef=function(i){return rr.current.useRef(i)};Nt.useState=function(i){return rr.current.useState(i)};Nt.useSyncExternalStore=function(i,o,d){return rr.current.useSyncExternalStore(i,o,d)};Nt.useTransition=function(){return rr.current.useTransition()};Nt.version="18.3.1";jx.exports=Nt;var Me=jx.exports;const vm=S0(Me),RC=vC({__proto__:null,default:vm},[Me]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FC=Me,BC=Symbol.for("react.element"),jC=Symbol.for("react.fragment"),OC=Object.prototype.hasOwnProperty,VC=FC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,UC={key:!0,ref:!0,__self:!0,__source:!0};function Hx(i,o,d){var y,x={},S=null,b=null;d!==void 0&&(S=""+d),o.key!==void 0&&(S=""+o.key),o.ref!==void 0&&(b=o.ref);for(y in o)OC.call(o,y)&&!UC.hasOwnProperty(y)&&(x[y]=o[y]);if(i&&i.defaultProps)for(y in o=i.defaultProps,o)x[y]===void 0&&(x[y]=o[y]);return{$$typeof:BC,type:i,key:S,ref:b,props:x,_owner:VC.current}}_m.Fragment=jC;_m.jsx=Hx;_m.jsxs=Hx;Bx.exports=_m;var E0=Bx.exports;const zp=E0.Fragment,A=E0.jsx,$=E0.jsxs;var Ag={},Xx={exports:{}},zr={},Kx={exports:{}},Yx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(i){function o(Qe,He){var yt=Qe.length;Qe.push(He);e:for(;0<yt;){var At=yt-1>>>1,Rt=Qe[At];if(0<x(Rt,He))Qe[At]=He,Qe[yt]=Rt,yt=At;else break e}}function d(Qe){return Qe.length===0?null:Qe[0]}function y(Qe){if(Qe.length===0)return null;var He=Qe[0],yt=Qe.pop();if(yt!==He){Qe[0]=yt;e:for(var At=0,Rt=Qe.length,qi=Rt>>>1;At<qi;){var pi=2*(At+1)-1,En=Qe[pi],jt=pi+1,zn=Qe[jt];if(0>x(En,yt))jt<Rt&&0>x(zn,En)?(Qe[At]=zn,Qe[jt]=yt,At=jt):(Qe[At]=En,Qe[pi]=yt,At=pi);else if(jt<Rt&&0>x(zn,yt))Qe[At]=zn,Qe[jt]=yt,At=jt;else break e}}return He}function x(Qe,He){var yt=Qe.sortIndex-He.sortIndex;return yt!==0?yt:Qe.id-He.id}if(typeof performance=="object"&&typeof performance.now=="function"){var S=performance;i.unstable_now=function(){return S.now()}}else{var b=Date,c=b.now();i.unstable_now=function(){return b.now()-c}}var F=[],W=[],se=1,re=null,ce=3,K=!1,Ie=!1,Te=!1,We=typeof setTimeout=="function"?setTimeout:null,he=typeof clearTimeout=="function"?clearTimeout:null,oe=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function fe(Qe){for(var He=d(W);He!==null;){if(He.callback===null)y(W);else if(He.startTime<=Qe)y(W),He.sortIndex=He.expirationTime,o(F,He);else break;He=d(W)}}function De(Qe){if(Te=!1,fe(Qe),!Ie)if(d(F)!==null)Ie=!0,Gn(Xe);else{var He=d(W);He!==null&&Mn(De,He.startTime-Qe)}}function Xe(Qe,He){Ie=!1,Te&&(Te=!1,he(lt),lt=-1),K=!0;var yt=ce;try{for(fe(He),re=d(F);re!==null&&(!(re.expirationTime>He)||Qe&&!di());){var At=re.callback;if(typeof At=="function"){re.callback=null,ce=re.priorityLevel;var Rt=At(re.expirationTime<=He);He=i.unstable_now(),typeof Rt=="function"?re.callback=Rt:re===d(F)&&y(F),fe(He)}else y(F);re=d(F)}if(re!==null)var qi=!0;else{var pi=d(W);pi!==null&&Mn(De,pi.startTime-He),qi=!1}return qi}finally{re=null,ce=yt,K=!1}}var tt=!1,et=null,lt=-1,Lt=5,mt=-1;function di(){return!(i.unstable_now()-mt<Lt)}function Mi(){if(et!==null){var Qe=i.unstable_now();mt=Qe;var He=!0;try{He=et(!0,Qe)}finally{He?Bi():(tt=!1,et=null)}}else tt=!1}var Bi;if(typeof oe=="function")Bi=function(){oe(Mi)};else if(typeof MessageChannel<"u"){var si=new MessageChannel,_i=si.port2;si.port1.onmessage=Mi,Bi=function(){_i.postMessage(null)}}else Bi=function(){We(Mi,0)};function Gn(Qe){et=Qe,tt||(tt=!0,Bi())}function Mn(Qe,He){lt=We(function(){Qe(i.unstable_now())},He)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(Qe){Qe.callback=null},i.unstable_continueExecution=function(){Ie||K||(Ie=!0,Gn(Xe))},i.unstable_forceFrameRate=function(Qe){0>Qe||125<Qe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Lt=0<Qe?Math.floor(1e3/Qe):5},i.unstable_getCurrentPriorityLevel=function(){return ce},i.unstable_getFirstCallbackNode=function(){return d(F)},i.unstable_next=function(Qe){switch(ce){case 1:case 2:case 3:var He=3;break;default:He=ce}var yt=ce;ce=He;try{return Qe()}finally{ce=yt}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(Qe,He){switch(Qe){case 1:case 2:case 3:case 4:case 5:break;default:Qe=3}var yt=ce;ce=Qe;try{return He()}finally{ce=yt}},i.unstable_scheduleCallback=function(Qe,He,yt){var At=i.unstable_now();switch(typeof yt=="object"&&yt!==null?(yt=yt.delay,yt=typeof yt=="number"&&0<yt?At+yt:At):yt=At,Qe){case 1:var Rt=-1;break;case 2:Rt=250;break;case 5:Rt=1073741823;break;case 4:Rt=1e4;break;default:Rt=5e3}return Rt=yt+Rt,Qe={id:se++,callback:He,priorityLevel:Qe,startTime:yt,expirationTime:Rt,sortIndex:-1},yt>At?(Qe.sortIndex=yt,o(W,Qe),d(F)===null&&Qe===d(W)&&(Te?(he(lt),lt=-1):Te=!0,Mn(De,yt-At))):(Qe.sortIndex=Rt,o(F,Qe),Ie||K||(Ie=!0,Gn(Xe))),Qe},i.unstable_shouldYield=di,i.unstable_wrapCallback=function(Qe){var He=ce;return function(){var yt=ce;ce=He;try{return Qe.apply(this,arguments)}finally{ce=yt}}}})(Yx);Kx.exports=Yx;var $C=Kx.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ZC=Me,Er=$C;function Ge(i){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+i,d=1;d<arguments.length;d++)o+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Jx=new Set,Sh={};function al(i,o){Nc(i,o),Nc(i+"Capture",o)}function Nc(i,o){for(Sh[i]=o,i=0;i<o.length;i++)Jx.add(o[i])}var po=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Sg=Object.prototype.hasOwnProperty,GC=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,dv={},pv={};function WC(i){return Sg.call(pv,i)?!0:Sg.call(dv,i)?!1:GC.test(i)?pv[i]=!0:(dv[i]=!0,!1)}function qC(i,o,d,y){if(d!==null&&d.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return y?!1:d!==null?!d.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function HC(i,o,d,y){if(o===null||typeof o>"u"||qC(i,o,d,y))return!0;if(y)return!1;if(d!==null)switch(d.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function ar(i,o,d,y,x,S,b){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=y,this.attributeNamespace=x,this.mustUseProperty=d,this.propertyName=i,this.type=o,this.sanitizeURL=S,this.removeEmptyString=b}var kn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){kn[i]=new ar(i,0,!1,i,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var o=i[0];kn[o]=new ar(o,1,!1,i[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(i){kn[i]=new ar(i,2,!1,i.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){kn[i]=new ar(i,2,!1,i,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){kn[i]=new ar(i,3,!1,i.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(i){kn[i]=new ar(i,3,!0,i,null,!1,!1)});["capture","download"].forEach(function(i){kn[i]=new ar(i,4,!1,i,null,!1,!1)});["cols","rows","size","span"].forEach(function(i){kn[i]=new ar(i,6,!1,i,null,!1,!1)});["rowSpan","start"].forEach(function(i){kn[i]=new ar(i,5,!1,i.toLowerCase(),null,!1,!1)});var z0=/[\-:]([a-z])/g;function N0(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var o=i.replace(z0,N0);kn[o]=new ar(o,1,!1,i,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var o=i.replace(z0,N0);kn[o]=new ar(o,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(i){var o=i.replace(z0,N0);kn[o]=new ar(o,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(i){kn[i]=new ar(i,1,!1,i.toLowerCase(),null,!1,!1)});kn.xlinkHref=new ar("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(i){kn[i]=new ar(i,1,!1,i.toLowerCase(),null,!0,!0)});function D0(i,o,d,y){var x=kn.hasOwnProperty(o)?kn[o]:null;(x!==null?x.type!==0:y||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(HC(o,d,x,y)&&(d=null),y||x===null?WC(o)&&(d===null?i.removeAttribute(o):i.setAttribute(o,""+d)):x.mustUseProperty?i[x.propertyName]=d===null?x.type===3?!1:"":d:(o=x.attributeName,y=x.attributeNamespace,d===null?i.removeAttribute(o):(x=x.type,d=x===3||x===4&&d===!0?"":""+d,y?i.setAttributeNS(y,o,d):i.setAttribute(o,d))))}var yo=ZC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,dp=Symbol.for("react.element"),fc=Symbol.for("react.portal"),gc=Symbol.for("react.fragment"),L0=Symbol.for("react.strict_mode"),Tg=Symbol.for("react.profiler"),Qx=Symbol.for("react.provider"),e1=Symbol.for("react.context"),R0=Symbol.for("react.forward_ref"),Pg=Symbol.for("react.suspense"),kg=Symbol.for("react.suspense_list"),F0=Symbol.for("react.memo"),Oo=Symbol.for("react.lazy"),t1=Symbol.for("react.offscreen"),mv=Symbol.iterator;function ah(i){return i===null||typeof i!="object"?null:(i=mv&&i[mv]||i["@@iterator"],typeof i=="function"?i:null)}var ki=Object.assign,Yf;function ph(i){if(Yf===void 0)try{throw Error()}catch(d){var o=d.stack.trim().match(/\n( *(at )?)/);Yf=o&&o[1]||""}return`
`+Yf+i}var Jf=!1;function Qf(i,o){if(!i||Jf)return"";Jf=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(W){var y=W}Reflect.construct(i,[],o)}else{try{o.call()}catch(W){y=W}i.call(o.prototype)}else{try{throw Error()}catch(W){y=W}i()}}catch(W){if(W&&y&&typeof W.stack=="string"){for(var x=W.stack.split(`
`),S=y.stack.split(`
`),b=x.length-1,c=S.length-1;1<=b&&0<=c&&x[b]!==S[c];)c--;for(;1<=b&&0<=c;b--,c--)if(x[b]!==S[c]){if(b!==1||c!==1)do if(b--,c--,0>c||x[b]!==S[c]){var F=`
`+x[b].replace(" at new "," at ");return i.displayName&&F.includes("<anonymous>")&&(F=F.replace("<anonymous>",i.displayName)),F}while(1<=b&&0<=c);break}}}finally{Jf=!1,Error.prepareStackTrace=d}return(i=i?i.displayName||i.name:"")?ph(i):""}function XC(i){switch(i.tag){case 5:return ph(i.type);case 16:return ph("Lazy");case 13:return ph("Suspense");case 19:return ph("SuspenseList");case 0:case 2:case 15:return i=Qf(i.type,!1),i;case 11:return i=Qf(i.type.render,!1),i;case 1:return i=Qf(i.type,!0),i;default:return""}}function Mg(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case gc:return"Fragment";case fc:return"Portal";case Tg:return"Profiler";case L0:return"StrictMode";case Pg:return"Suspense";case kg:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case e1:return(i.displayName||"Context")+".Consumer";case Qx:return(i._context.displayName||"Context")+".Provider";case R0:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case F0:return o=i.displayName||null,o!==null?o:Mg(i.type)||"Memo";case Oo:o=i._payload,i=i._init;try{return Mg(i(o))}catch{}}return null}function KC(i){var o=i.type;switch(i.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=o.render,i=i.displayName||i.name||"",o.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Mg(o);case 8:return o===L0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function is(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function i1(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function YC(i){var o=i1(i)?"checked":"value",d=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),y=""+i[o];if(!i.hasOwnProperty(o)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var x=d.get,S=d.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return x.call(this)},set:function(b){y=""+b,S.call(this,b)}}),Object.defineProperty(i,o,{enumerable:d.enumerable}),{getValue:function(){return y},setValue:function(b){y=""+b},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function pp(i){i._valueTracker||(i._valueTracker=YC(i))}function n1(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var d=o.getValue(),y="";return i&&(y=i1(i)?i.checked?"true":"false":i.value),i=y,i!==d?(o.setValue(i),!0):!1}function $p(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function Eg(i,o){var d=o.checked;return ki({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??i._wrapperState.initialChecked})}function fv(i,o){var d=o.defaultValue==null?"":o.defaultValue,y=o.checked!=null?o.checked:o.defaultChecked;d=is(o.value!=null?o.value:d),i._wrapperState={initialChecked:y,initialValue:d,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function r1(i,o){o=o.checked,o!=null&&D0(i,"checked",o,!1)}function zg(i,o){r1(i,o);var d=is(o.value),y=o.type;if(d!=null)y==="number"?(d===0&&i.value===""||i.value!=d)&&(i.value=""+d):i.value!==""+d&&(i.value=""+d);else if(y==="submit"||y==="reset"){i.removeAttribute("value");return}o.hasOwnProperty("value")?Ng(i,o.type,d):o.hasOwnProperty("defaultValue")&&Ng(i,o.type,is(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(i.defaultChecked=!!o.defaultChecked)}function gv(i,o,d){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var y=o.type;if(!(y!=="submit"&&y!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+i._wrapperState.initialValue,d||o===i.value||(i.value=o),i.defaultValue=o}d=i.name,d!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,d!==""&&(i.name=d)}function Ng(i,o,d){(o!=="number"||$p(i.ownerDocument)!==i)&&(d==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+d&&(i.defaultValue=""+d))}var mh=Array.isArray;function Tc(i,o,d,y){if(i=i.options,o){o={};for(var x=0;x<d.length;x++)o["$"+d[x]]=!0;for(d=0;d<i.length;d++)x=o.hasOwnProperty("$"+i[d].value),i[d].selected!==x&&(i[d].selected=x),x&&y&&(i[d].defaultSelected=!0)}else{for(d=""+is(d),o=null,x=0;x<i.length;x++){if(i[x].value===d){i[x].selected=!0,y&&(i[x].defaultSelected=!0);return}o!==null||i[x].disabled||(o=i[x])}o!==null&&(o.selected=!0)}}function Dg(i,o){if(o.dangerouslySetInnerHTML!=null)throw Error(Ge(91));return ki({},o,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function yv(i,o){var d=o.value;if(d==null){if(d=o.children,o=o.defaultValue,d!=null){if(o!=null)throw Error(Ge(92));if(mh(d)){if(1<d.length)throw Error(Ge(93));d=d[0]}o=d}o==null&&(o=""),d=o}i._wrapperState={initialValue:is(d)}}function a1(i,o){var d=is(o.value),y=is(o.defaultValue);d!=null&&(d=""+d,d!==i.value&&(i.value=d),o.defaultValue==null&&i.defaultValue!==d&&(i.defaultValue=d)),y!=null&&(i.defaultValue=""+y)}function _v(i){var o=i.textContent;o===i._wrapperState.initialValue&&o!==""&&o!==null&&(i.value=o)}function o1(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Lg(i,o){return i==null||i==="http://www.w3.org/1999/xhtml"?o1(o):i==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var mp,s1=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,d,y,x){MSApp.execUnsafeLocalFunction(function(){return i(o,d,y,x)})}:i}(function(i,o){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=o;else{for(mp=mp||document.createElement("div"),mp.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=mp.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;o.firstChild;)i.appendChild(o.firstChild)}});function Th(i,o){if(o){var d=i.firstChild;if(d&&d===i.lastChild&&d.nodeType===3){d.nodeValue=o;return}}i.textContent=o}var yh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},JC=["Webkit","ms","Moz","O"];Object.keys(yh).forEach(function(i){JC.forEach(function(o){o=o+i.charAt(0).toUpperCase()+i.substring(1),yh[o]=yh[i]})});function l1(i,o,d){return o==null||typeof o=="boolean"||o===""?"":d||typeof o!="number"||o===0||yh.hasOwnProperty(i)&&yh[i]?(""+o).trim():o+"px"}function c1(i,o){i=i.style;for(var d in o)if(o.hasOwnProperty(d)){var y=d.indexOf("--")===0,x=l1(d,o[d],y);d==="float"&&(d="cssFloat"),y?i.setProperty(d,x):i[d]=x}}var QC=ki({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Rg(i,o){if(o){if(QC[i]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(Ge(137,i));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(Ge(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(Ge(61))}if(o.style!=null&&typeof o.style!="object")throw Error(Ge(62))}}function Fg(i,o){if(i.indexOf("-")===-1)return typeof o.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bg=null;function B0(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var jg=null,Pc=null,kc=null;function vv(i){if(i=Xh(i)){if(typeof jg!="function")throw Error(Ge(280));var o=i.stateNode;o&&(o=Im(o),jg(i.stateNode,i.type,o))}}function u1(i){Pc?kc?kc.push(i):kc=[i]:Pc=i}function h1(){if(Pc){var i=Pc,o=kc;if(kc=Pc=null,vv(i),o)for(i=0;i<o.length;i++)vv(o[i])}}function d1(i,o){return i(o)}function p1(){}var eg=!1;function m1(i,o,d){if(eg)return i(o,d);eg=!0;try{return d1(i,o,d)}finally{eg=!1,(Pc!==null||kc!==null)&&(p1(),h1())}}function Ph(i,o){var d=i.stateNode;if(d===null)return null;var y=Im(d);if(y===null)return null;d=y[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(i=i.type,y=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!y;break e;default:i=!1}if(i)return null;if(d&&typeof d!="function")throw Error(Ge(231,o,typeof d));return d}var Og=!1;if(po)try{var oh={};Object.defineProperty(oh,"passive",{get:function(){Og=!0}}),window.addEventListener("test",oh,oh),window.removeEventListener("test",oh,oh)}catch{Og=!1}function eI(i,o,d,y,x,S,b,c,F){var W=Array.prototype.slice.call(arguments,3);try{o.apply(d,W)}catch(se){this.onError(se)}}var _h=!1,Zp=null,Gp=!1,Vg=null,tI={onError:function(i){_h=!0,Zp=i}};function iI(i,o,d,y,x,S,b,c,F){_h=!1,Zp=null,eI.apply(tI,arguments)}function nI(i,o,d,y,x,S,b,c,F){if(iI.apply(this,arguments),_h){if(_h){var W=Zp;_h=!1,Zp=null}else throw Error(Ge(198));Gp||(Gp=!0,Vg=W)}}function ol(i){var o=i,d=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,o.flags&4098&&(d=o.return),i=o.return;while(i)}return o.tag===3?d:null}function f1(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function xv(i){if(ol(i)!==i)throw Error(Ge(188))}function rI(i){var o=i.alternate;if(!o){if(o=ol(i),o===null)throw Error(Ge(188));return o!==i?null:i}for(var d=i,y=o;;){var x=d.return;if(x===null)break;var S=x.alternate;if(S===null){if(y=x.return,y!==null){d=y;continue}break}if(x.child===S.child){for(S=x.child;S;){if(S===d)return xv(x),i;if(S===y)return xv(x),o;S=S.sibling}throw Error(Ge(188))}if(d.return!==y.return)d=x,y=S;else{for(var b=!1,c=x.child;c;){if(c===d){b=!0,d=x,y=S;break}if(c===y){b=!0,y=x,d=S;break}c=c.sibling}if(!b){for(c=S.child;c;){if(c===d){b=!0,d=S,y=x;break}if(c===y){b=!0,y=S,d=x;break}c=c.sibling}if(!b)throw Error(Ge(189))}}if(d.alternate!==y)throw Error(Ge(190))}if(d.tag!==3)throw Error(Ge(188));return d.stateNode.current===d?i:o}function g1(i){return i=rI(i),i!==null?y1(i):null}function y1(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var o=y1(i);if(o!==null)return o;i=i.sibling}return null}var _1=Er.unstable_scheduleCallback,bv=Er.unstable_cancelCallback,aI=Er.unstable_shouldYield,oI=Er.unstable_requestPaint,Gi=Er.unstable_now,sI=Er.unstable_getCurrentPriorityLevel,j0=Er.unstable_ImmediatePriority,v1=Er.unstable_UserBlockingPriority,Wp=Er.unstable_NormalPriority,lI=Er.unstable_LowPriority,x1=Er.unstable_IdlePriority,xm=null,Ea=null;function cI(i){if(Ea&&typeof Ea.onCommitFiberRoot=="function")try{Ea.onCommitFiberRoot(xm,i,void 0,(i.current.flags&128)===128)}catch{}}var ua=Math.clz32?Math.clz32:dI,uI=Math.log,hI=Math.LN2;function dI(i){return i>>>=0,i===0?32:31-(uI(i)/hI|0)|0}var fp=64,gp=4194304;function fh(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function qp(i,o){var d=i.pendingLanes;if(d===0)return 0;var y=0,x=i.suspendedLanes,S=i.pingedLanes,b=d&268435455;if(b!==0){var c=b&~x;c!==0?y=fh(c):(S&=b,S!==0&&(y=fh(S)))}else b=d&~x,b!==0?y=fh(b):S!==0&&(y=fh(S));if(y===0)return 0;if(o!==0&&o!==y&&!(o&x)&&(x=y&-y,S=o&-o,x>=S||x===16&&(S&4194240)!==0))return o;if(y&4&&(y|=d&16),o=i.entangledLanes,o!==0)for(i=i.entanglements,o&=y;0<o;)d=31-ua(o),x=1<<d,y|=i[d],o&=~x;return y}function pI(i,o){switch(i){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function mI(i,o){for(var d=i.suspendedLanes,y=i.pingedLanes,x=i.expirationTimes,S=i.pendingLanes;0<S;){var b=31-ua(S),c=1<<b,F=x[b];F===-1?(!(c&d)||c&y)&&(x[b]=pI(c,o)):F<=o&&(i.expiredLanes|=c),S&=~c}}function Ug(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function b1(){var i=fp;return fp<<=1,!(fp&4194240)&&(fp=64),i}function tg(i){for(var o=[],d=0;31>d;d++)o.push(i);return o}function qh(i,o,d){i.pendingLanes|=o,o!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,o=31-ua(o),i[o]=d}function fI(i,o){var d=i.pendingLanes&~o;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=o,i.mutableReadLanes&=o,i.entangledLanes&=o,o=i.entanglements;var y=i.eventTimes;for(i=i.expirationTimes;0<d;){var x=31-ua(d),S=1<<x;o[x]=0,y[x]=-1,i[x]=-1,d&=~S}}function O0(i,o){var d=i.entangledLanes|=o;for(i=i.entanglements;d;){var y=31-ua(d),x=1<<y;x&o|i[y]&o&&(i[y]|=o),d&=~x}}var qt=0;function w1(i){return i&=-i,1<i?4<i?i&268435455?16:536870912:4:1}var C1,V0,I1,A1,S1,$g=!1,yp=[],qo=null,Ho=null,Xo=null,kh=new Map,Mh=new Map,Uo=[],gI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function wv(i,o){switch(i){case"focusin":case"focusout":qo=null;break;case"dragenter":case"dragleave":Ho=null;break;case"mouseover":case"mouseout":Xo=null;break;case"pointerover":case"pointerout":kh.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Mh.delete(o.pointerId)}}function sh(i,o,d,y,x,S){return i===null||i.nativeEvent!==S?(i={blockedOn:o,domEventName:d,eventSystemFlags:y,nativeEvent:S,targetContainers:[x]},o!==null&&(o=Xh(o),o!==null&&V0(o)),i):(i.eventSystemFlags|=y,o=i.targetContainers,x!==null&&o.indexOf(x)===-1&&o.push(x),i)}function yI(i,o,d,y,x){switch(o){case"focusin":return qo=sh(qo,i,o,d,y,x),!0;case"dragenter":return Ho=sh(Ho,i,o,d,y,x),!0;case"mouseover":return Xo=sh(Xo,i,o,d,y,x),!0;case"pointerover":var S=x.pointerId;return kh.set(S,sh(kh.get(S)||null,i,o,d,y,x)),!0;case"gotpointercapture":return S=x.pointerId,Mh.set(S,sh(Mh.get(S)||null,i,o,d,y,x)),!0}return!1}function T1(i){var o=Xs(i.target);if(o!==null){var d=ol(o);if(d!==null){if(o=d.tag,o===13){if(o=f1(d),o!==null){i.blockedOn=o,S1(i.priority,function(){I1(d)});return}}else if(o===3&&d.stateNode.current.memoizedState.isDehydrated){i.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Np(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var d=Zg(i.domEventName,i.eventSystemFlags,o[0],i.nativeEvent);if(d===null){d=i.nativeEvent;var y=new d.constructor(d.type,d);Bg=y,d.target.dispatchEvent(y),Bg=null}else return o=Xh(d),o!==null&&V0(o),i.blockedOn=d,!1;o.shift()}return!0}function Cv(i,o,d){Np(i)&&d.delete(o)}function _I(){$g=!1,qo!==null&&Np(qo)&&(qo=null),Ho!==null&&Np(Ho)&&(Ho=null),Xo!==null&&Np(Xo)&&(Xo=null),kh.forEach(Cv),Mh.forEach(Cv)}function lh(i,o){i.blockedOn===o&&(i.blockedOn=null,$g||($g=!0,Er.unstable_scheduleCallback(Er.unstable_NormalPriority,_I)))}function Eh(i){function o(x){return lh(x,i)}if(0<yp.length){lh(yp[0],i);for(var d=1;d<yp.length;d++){var y=yp[d];y.blockedOn===i&&(y.blockedOn=null)}}for(qo!==null&&lh(qo,i),Ho!==null&&lh(Ho,i),Xo!==null&&lh(Xo,i),kh.forEach(o),Mh.forEach(o),d=0;d<Uo.length;d++)y=Uo[d],y.blockedOn===i&&(y.blockedOn=null);for(;0<Uo.length&&(d=Uo[0],d.blockedOn===null);)T1(d),d.blockedOn===null&&Uo.shift()}var Mc=yo.ReactCurrentBatchConfig,Hp=!0;function vI(i,o,d,y){var x=qt,S=Mc.transition;Mc.transition=null;try{qt=1,U0(i,o,d,y)}finally{qt=x,Mc.transition=S}}function xI(i,o,d,y){var x=qt,S=Mc.transition;Mc.transition=null;try{qt=4,U0(i,o,d,y)}finally{qt=x,Mc.transition=S}}function U0(i,o,d,y){if(Hp){var x=Zg(i,o,d,y);if(x===null)hg(i,o,y,Xp,d),wv(i,y);else if(yI(x,i,o,d,y))y.stopPropagation();else if(wv(i,y),o&4&&-1<gI.indexOf(i)){for(;x!==null;){var S=Xh(x);if(S!==null&&C1(S),S=Zg(i,o,d,y),S===null&&hg(i,o,y,Xp,d),S===x)break;x=S}x!==null&&y.stopPropagation()}else hg(i,o,y,null,d)}}var Xp=null;function Zg(i,o,d,y){if(Xp=null,i=B0(y),i=Xs(i),i!==null)if(o=ol(i),o===null)i=null;else if(d=o.tag,d===13){if(i=f1(o),i!==null)return i;i=null}else if(d===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null);return Xp=i,null}function P1(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(sI()){case j0:return 1;case v1:return 4;case Wp:case lI:return 16;case x1:return 536870912;default:return 16}default:return 16}}var Zo=null,$0=null,Dp=null;function k1(){if(Dp)return Dp;var i,o=$0,d=o.length,y,x="value"in Zo?Zo.value:Zo.textContent,S=x.length;for(i=0;i<d&&o[i]===x[i];i++);var b=d-i;for(y=1;y<=b&&o[d-y]===x[S-y];y++);return Dp=x.slice(i,1<y?1-y:void 0)}function Lp(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function _p(){return!0}function Iv(){return!1}function Nr(i){function o(d,y,x,S,b){this._reactName=d,this._targetInst=x,this.type=y,this.nativeEvent=S,this.target=b,this.currentTarget=null;for(var c in i)i.hasOwnProperty(c)&&(d=i[c],this[c]=d?d(S):S[c]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?_p:Iv,this.isPropagationStopped=Iv,this}return ki(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=_p)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=_p)},persist:function(){},isPersistent:_p}),o}var Uc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Z0=Nr(Uc),Hh=ki({},Uc,{view:0,detail:0}),bI=Nr(Hh),ig,ng,ch,bm=ki({},Hh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:G0,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==ch&&(ch&&i.type==="mousemove"?(ig=i.screenX-ch.screenX,ng=i.screenY-ch.screenY):ng=ig=0,ch=i),ig)},movementY:function(i){return"movementY"in i?i.movementY:ng}}),Av=Nr(bm),wI=ki({},bm,{dataTransfer:0}),CI=Nr(wI),II=ki({},Hh,{relatedTarget:0}),rg=Nr(II),AI=ki({},Uc,{animationName:0,elapsedTime:0,pseudoElement:0}),SI=Nr(AI),TI=ki({},Uc,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),PI=Nr(TI),kI=ki({},Uc,{data:0}),Sv=Nr(kI),MI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},EI={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function NI(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=zI[i])?!!o[i]:!1}function G0(){return NI}var DI=ki({},Hh,{key:function(i){if(i.key){var o=MI[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=Lp(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?EI[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:G0,charCode:function(i){return i.type==="keypress"?Lp(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Lp(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),LI=Nr(DI),RI=ki({},bm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Tv=Nr(RI),FI=ki({},Hh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:G0}),BI=Nr(FI),jI=ki({},Uc,{propertyName:0,elapsedTime:0,pseudoElement:0}),OI=Nr(jI),VI=ki({},bm,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),UI=Nr(VI),$I=[9,13,27,32],W0=po&&"CompositionEvent"in window,vh=null;po&&"documentMode"in document&&(vh=document.documentMode);var ZI=po&&"TextEvent"in window&&!vh,M1=po&&(!W0||vh&&8<vh&&11>=vh),Pv=String.fromCharCode(32),kv=!1;function E1(i,o){switch(i){case"keyup":return $I.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function z1(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var yc=!1;function GI(i,o){switch(i){case"compositionend":return z1(o);case"keypress":return o.which!==32?null:(kv=!0,Pv);case"textInput":return i=o.data,i===Pv&&kv?null:i;default:return null}}function WI(i,o){if(yc)return i==="compositionend"||!W0&&E1(i,o)?(i=k1(),Dp=$0=Zo=null,yc=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return M1&&o.locale!=="ko"?null:o.data;default:return null}}var qI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mv(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!qI[i.type]:o==="textarea"}function N1(i,o,d,y){u1(y),o=Kp(o,"onChange"),0<o.length&&(d=new Z0("onChange","change",null,d,y),i.push({event:d,listeners:o}))}var xh=null,zh=null;function HI(i){Z1(i,0)}function wm(i){var o=xc(i);if(n1(o))return i}function XI(i,o){if(i==="change")return o}var D1=!1;if(po){var ag;if(po){var og="oninput"in document;if(!og){var Ev=document.createElement("div");Ev.setAttribute("oninput","return;"),og=typeof Ev.oninput=="function"}ag=og}else ag=!1;D1=ag&&(!document.documentMode||9<document.documentMode)}function zv(){xh&&(xh.detachEvent("onpropertychange",L1),zh=xh=null)}function L1(i){if(i.propertyName==="value"&&wm(zh)){var o=[];N1(o,zh,i,B0(i)),m1(HI,o)}}function KI(i,o,d){i==="focusin"?(zv(),xh=o,zh=d,xh.attachEvent("onpropertychange",L1)):i==="focusout"&&zv()}function YI(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return wm(zh)}function JI(i,o){if(i==="click")return wm(o)}function QI(i,o){if(i==="input"||i==="change")return wm(o)}function eA(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var da=typeof Object.is=="function"?Object.is:eA;function Nh(i,o){if(da(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var d=Object.keys(i),y=Object.keys(o);if(d.length!==y.length)return!1;for(y=0;y<d.length;y++){var x=d[y];if(!Sg.call(o,x)||!da(i[x],o[x]))return!1}return!0}function Nv(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Dv(i,o){var d=Nv(i);i=0;for(var y;d;){if(d.nodeType===3){if(y=i+d.textContent.length,i<=o&&y>=o)return{node:d,offset:o-i};i=y}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=Nv(d)}}function R1(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?R1(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function F1(){for(var i=window,o=$p();o instanceof i.HTMLIFrameElement;){try{var d=typeof o.contentWindow.location.href=="string"}catch{d=!1}if(d)i=o.contentWindow;else break;o=$p(i.document)}return o}function q0(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}function tA(i){var o=F1(),d=i.focusedElem,y=i.selectionRange;if(o!==d&&d&&d.ownerDocument&&R1(d.ownerDocument.documentElement,d)){if(y!==null&&q0(d)){if(o=y.start,i=y.end,i===void 0&&(i=o),"selectionStart"in d)d.selectionStart=o,d.selectionEnd=Math.min(i,d.value.length);else if(i=(o=d.ownerDocument||document)&&o.defaultView||window,i.getSelection){i=i.getSelection();var x=d.textContent.length,S=Math.min(y.start,x);y=y.end===void 0?S:Math.min(y.end,x),!i.extend&&S>y&&(x=y,y=S,S=x),x=Dv(d,S);var b=Dv(d,y);x&&b&&(i.rangeCount!==1||i.anchorNode!==x.node||i.anchorOffset!==x.offset||i.focusNode!==b.node||i.focusOffset!==b.offset)&&(o=o.createRange(),o.setStart(x.node,x.offset),i.removeAllRanges(),S>y?(i.addRange(o),i.extend(b.node,b.offset)):(o.setEnd(b.node,b.offset),i.addRange(o)))}}for(o=[],i=d;i=i.parentNode;)i.nodeType===1&&o.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<o.length;d++)i=o[d],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var iA=po&&"documentMode"in document&&11>=document.documentMode,_c=null,Gg=null,bh=null,Wg=!1;function Lv(i,o,d){var y=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Wg||_c==null||_c!==$p(y)||(y=_c,"selectionStart"in y&&q0(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),bh&&Nh(bh,y)||(bh=y,y=Kp(Gg,"onSelect"),0<y.length&&(o=new Z0("onSelect","select",null,o,d),i.push({event:o,listeners:y}),o.target=_c)))}function vp(i,o){var d={};return d[i.toLowerCase()]=o.toLowerCase(),d["Webkit"+i]="webkit"+o,d["Moz"+i]="moz"+o,d}var vc={animationend:vp("Animation","AnimationEnd"),animationiteration:vp("Animation","AnimationIteration"),animationstart:vp("Animation","AnimationStart"),transitionend:vp("Transition","TransitionEnd")},sg={},B1={};po&&(B1=document.createElement("div").style,"AnimationEvent"in window||(delete vc.animationend.animation,delete vc.animationiteration.animation,delete vc.animationstart.animation),"TransitionEvent"in window||delete vc.transitionend.transition);function Cm(i){if(sg[i])return sg[i];if(!vc[i])return i;var o=vc[i],d;for(d in o)if(o.hasOwnProperty(d)&&d in B1)return sg[i]=o[d];return i}var j1=Cm("animationend"),O1=Cm("animationiteration"),V1=Cm("animationstart"),U1=Cm("transitionend"),$1=new Map,Rv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function rs(i,o){$1.set(i,o),al(o,[i])}for(var lg=0;lg<Rv.length;lg++){var cg=Rv[lg],nA=cg.toLowerCase(),rA=cg[0].toUpperCase()+cg.slice(1);rs(nA,"on"+rA)}rs(j1,"onAnimationEnd");rs(O1,"onAnimationIteration");rs(V1,"onAnimationStart");rs("dblclick","onDoubleClick");rs("focusin","onFocus");rs("focusout","onBlur");rs(U1,"onTransitionEnd");Nc("onMouseEnter",["mouseout","mouseover"]);Nc("onMouseLeave",["mouseout","mouseover"]);Nc("onPointerEnter",["pointerout","pointerover"]);Nc("onPointerLeave",["pointerout","pointerover"]);al("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));al("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));al("onBeforeInput",["compositionend","keypress","textInput","paste"]);al("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));al("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));al("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var gh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),aA=new Set("cancel close invalid load scroll toggle".split(" ").concat(gh));function Fv(i,o,d){var y=i.type||"unknown-event";i.currentTarget=d,nI(y,o,void 0,i),i.currentTarget=null}function Z1(i,o){o=(o&4)!==0;for(var d=0;d<i.length;d++){var y=i[d],x=y.event;y=y.listeners;e:{var S=void 0;if(o)for(var b=y.length-1;0<=b;b--){var c=y[b],F=c.instance,W=c.currentTarget;if(c=c.listener,F!==S&&x.isPropagationStopped())break e;Fv(x,c,W),S=F}else for(b=0;b<y.length;b++){if(c=y[b],F=c.instance,W=c.currentTarget,c=c.listener,F!==S&&x.isPropagationStopped())break e;Fv(x,c,W),S=F}}}if(Gp)throw i=Vg,Gp=!1,Vg=null,i}function gi(i,o){var d=o[Yg];d===void 0&&(d=o[Yg]=new Set);var y=i+"__bubble";d.has(y)||(G1(o,i,2,!1),d.add(y))}function ug(i,o,d){var y=0;o&&(y|=4),G1(d,i,y,o)}var xp="_reactListening"+Math.random().toString(36).slice(2);function Dh(i){if(!i[xp]){i[xp]=!0,Jx.forEach(function(d){d!=="selectionchange"&&(aA.has(d)||ug(d,!1,i),ug(d,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[xp]||(o[xp]=!0,ug("selectionchange",!1,o))}}function G1(i,o,d,y){switch(P1(o)){case 1:var x=vI;break;case 4:x=xI;break;default:x=U0}d=x.bind(null,o,d,i),x=void 0,!Og||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(x=!0),y?x!==void 0?i.addEventListener(o,d,{capture:!0,passive:x}):i.addEventListener(o,d,!0):x!==void 0?i.addEventListener(o,d,{passive:x}):i.addEventListener(o,d,!1)}function hg(i,o,d,y,x){var S=y;if(!(o&1)&&!(o&2)&&y!==null)e:for(;;){if(y===null)return;var b=y.tag;if(b===3||b===4){var c=y.stateNode.containerInfo;if(c===x||c.nodeType===8&&c.parentNode===x)break;if(b===4)for(b=y.return;b!==null;){var F=b.tag;if((F===3||F===4)&&(F=b.stateNode.containerInfo,F===x||F.nodeType===8&&F.parentNode===x))return;b=b.return}for(;c!==null;){if(b=Xs(c),b===null)return;if(F=b.tag,F===5||F===6){y=S=b;continue e}c=c.parentNode}}y=y.return}m1(function(){var W=S,se=B0(d),re=[];e:{var ce=$1.get(i);if(ce!==void 0){var K=Z0,Ie=i;switch(i){case"keypress":if(Lp(d)===0)break e;case"keydown":case"keyup":K=LI;break;case"focusin":Ie="focus",K=rg;break;case"focusout":Ie="blur",K=rg;break;case"beforeblur":case"afterblur":K=rg;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":K=Av;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":K=CI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":K=BI;break;case j1:case O1:case V1:K=SI;break;case U1:K=OI;break;case"scroll":K=bI;break;case"wheel":K=UI;break;case"copy":case"cut":case"paste":K=PI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":K=Tv}var Te=(o&4)!==0,We=!Te&&i==="scroll",he=Te?ce!==null?ce+"Capture":null:ce;Te=[];for(var oe=W,fe;oe!==null;){fe=oe;var De=fe.stateNode;if(fe.tag===5&&De!==null&&(fe=De,he!==null&&(De=Ph(oe,he),De!=null&&Te.push(Lh(oe,De,fe)))),We)break;oe=oe.return}0<Te.length&&(ce=new K(ce,Ie,null,d,se),re.push({event:ce,listeners:Te}))}}if(!(o&7)){e:{if(ce=i==="mouseover"||i==="pointerover",K=i==="mouseout"||i==="pointerout",ce&&d!==Bg&&(Ie=d.relatedTarget||d.fromElement)&&(Xs(Ie)||Ie[mo]))break e;if((K||ce)&&(ce=se.window===se?se:(ce=se.ownerDocument)?ce.defaultView||ce.parentWindow:window,K?(Ie=d.relatedTarget||d.toElement,K=W,Ie=Ie?Xs(Ie):null,Ie!==null&&(We=ol(Ie),Ie!==We||Ie.tag!==5&&Ie.tag!==6)&&(Ie=null)):(K=null,Ie=W),K!==Ie)){if(Te=Av,De="onMouseLeave",he="onMouseEnter",oe="mouse",(i==="pointerout"||i==="pointerover")&&(Te=Tv,De="onPointerLeave",he="onPointerEnter",oe="pointer"),We=K==null?ce:xc(K),fe=Ie==null?ce:xc(Ie),ce=new Te(De,oe+"leave",K,d,se),ce.target=We,ce.relatedTarget=fe,De=null,Xs(se)===W&&(Te=new Te(he,oe+"enter",Ie,d,se),Te.target=fe,Te.relatedTarget=We,De=Te),We=De,K&&Ie)t:{for(Te=K,he=Ie,oe=0,fe=Te;fe;fe=mc(fe))oe++;for(fe=0,De=he;De;De=mc(De))fe++;for(;0<oe-fe;)Te=mc(Te),oe--;for(;0<fe-oe;)he=mc(he),fe--;for(;oe--;){if(Te===he||he!==null&&Te===he.alternate)break t;Te=mc(Te),he=mc(he)}Te=null}else Te=null;K!==null&&Bv(re,ce,K,Te,!1),Ie!==null&&We!==null&&Bv(re,We,Ie,Te,!0)}}e:{if(ce=W?xc(W):window,K=ce.nodeName&&ce.nodeName.toLowerCase(),K==="select"||K==="input"&&ce.type==="file")var Xe=XI;else if(Mv(ce))if(D1)Xe=QI;else{Xe=YI;var tt=KI}else(K=ce.nodeName)&&K.toLowerCase()==="input"&&(ce.type==="checkbox"||ce.type==="radio")&&(Xe=JI);if(Xe&&(Xe=Xe(i,W))){N1(re,Xe,d,se);break e}tt&&tt(i,ce,W),i==="focusout"&&(tt=ce._wrapperState)&&tt.controlled&&ce.type==="number"&&Ng(ce,"number",ce.value)}switch(tt=W?xc(W):window,i){case"focusin":(Mv(tt)||tt.contentEditable==="true")&&(_c=tt,Gg=W,bh=null);break;case"focusout":bh=Gg=_c=null;break;case"mousedown":Wg=!0;break;case"contextmenu":case"mouseup":case"dragend":Wg=!1,Lv(re,d,se);break;case"selectionchange":if(iA)break;case"keydown":case"keyup":Lv(re,d,se)}var et;if(W0)e:{switch(i){case"compositionstart":var lt="onCompositionStart";break e;case"compositionend":lt="onCompositionEnd";break e;case"compositionupdate":lt="onCompositionUpdate";break e}lt=void 0}else yc?E1(i,d)&&(lt="onCompositionEnd"):i==="keydown"&&d.keyCode===229&&(lt="onCompositionStart");lt&&(M1&&d.locale!=="ko"&&(yc||lt!=="onCompositionStart"?lt==="onCompositionEnd"&&yc&&(et=k1()):(Zo=se,$0="value"in Zo?Zo.value:Zo.textContent,yc=!0)),tt=Kp(W,lt),0<tt.length&&(lt=new Sv(lt,i,null,d,se),re.push({event:lt,listeners:tt}),et?lt.data=et:(et=z1(d),et!==null&&(lt.data=et)))),(et=ZI?GI(i,d):WI(i,d))&&(W=Kp(W,"onBeforeInput"),0<W.length&&(se=new Sv("onBeforeInput","beforeinput",null,d,se),re.push({event:se,listeners:W}),se.data=et))}Z1(re,o)})}function Lh(i,o,d){return{instance:i,listener:o,currentTarget:d}}function Kp(i,o){for(var d=o+"Capture",y=[];i!==null;){var x=i,S=x.stateNode;x.tag===5&&S!==null&&(x=S,S=Ph(i,d),S!=null&&y.unshift(Lh(i,S,x)),S=Ph(i,o),S!=null&&y.push(Lh(i,S,x))),i=i.return}return y}function mc(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function Bv(i,o,d,y,x){for(var S=o._reactName,b=[];d!==null&&d!==y;){var c=d,F=c.alternate,W=c.stateNode;if(F!==null&&F===y)break;c.tag===5&&W!==null&&(c=W,x?(F=Ph(d,S),F!=null&&b.unshift(Lh(d,F,c))):x||(F=Ph(d,S),F!=null&&b.push(Lh(d,F,c)))),d=d.return}b.length!==0&&i.push({event:o,listeners:b})}var oA=/\r\n?/g,sA=/\u0000|\uFFFD/g;function jv(i){return(typeof i=="string"?i:""+i).replace(oA,`
`).replace(sA,"")}function bp(i,o,d){if(o=jv(o),jv(i)!==o&&d)throw Error(Ge(425))}function Yp(){}var qg=null,Hg=null;function Xg(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Kg=typeof setTimeout=="function"?setTimeout:void 0,lA=typeof clearTimeout=="function"?clearTimeout:void 0,Ov=typeof Promise=="function"?Promise:void 0,cA=typeof queueMicrotask=="function"?queueMicrotask:typeof Ov<"u"?function(i){return Ov.resolve(null).then(i).catch(uA)}:Kg;function uA(i){setTimeout(function(){throw i})}function dg(i,o){var d=o,y=0;do{var x=d.nextSibling;if(i.removeChild(d),x&&x.nodeType===8)if(d=x.data,d==="/$"){if(y===0){i.removeChild(x),Eh(o);return}y--}else d!=="$"&&d!=="$?"&&d!=="$!"||y++;d=x}while(d);Eh(o)}function Ko(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return i}function Vv(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var d=i.data;if(d==="$"||d==="$!"||d==="$?"){if(o===0)return i;o--}else d==="/$"&&o++}i=i.previousSibling}return null}var $c=Math.random().toString(36).slice(2),Ma="__reactFiber$"+$c,Rh="__reactProps$"+$c,mo="__reactContainer$"+$c,Yg="__reactEvents$"+$c,hA="__reactListeners$"+$c,dA="__reactHandles$"+$c;function Xs(i){var o=i[Ma];if(o)return o;for(var d=i.parentNode;d;){if(o=d[mo]||d[Ma]){if(d=o.alternate,o.child!==null||d!==null&&d.child!==null)for(i=Vv(i);i!==null;){if(d=i[Ma])return d;i=Vv(i)}return o}i=d,d=i.parentNode}return null}function Xh(i){return i=i[Ma]||i[mo],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function xc(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(Ge(33))}function Im(i){return i[Rh]||null}var Jg=[],bc=-1;function as(i){return{current:i}}function yi(i){0>bc||(i.current=Jg[bc],Jg[bc]=null,bc--)}function hi(i,o){bc++,Jg[bc]=i.current,i.current=o}var ns={},Zn=as(ns),dr=as(!1),el=ns;function Dc(i,o){var d=i.type.contextTypes;if(!d)return ns;var y=i.stateNode;if(y&&y.__reactInternalMemoizedUnmaskedChildContext===o)return y.__reactInternalMemoizedMaskedChildContext;var x={},S;for(S in d)x[S]=o[S];return y&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=o,i.__reactInternalMemoizedMaskedChildContext=x),x}function pr(i){return i=i.childContextTypes,i!=null}function Jp(){yi(dr),yi(Zn)}function Uv(i,o,d){if(Zn.current!==ns)throw Error(Ge(168));hi(Zn,o),hi(dr,d)}function W1(i,o,d){var y=i.stateNode;if(o=o.childContextTypes,typeof y.getChildContext!="function")return d;y=y.getChildContext();for(var x in y)if(!(x in o))throw Error(Ge(108,KC(i)||"Unknown",x));return ki({},d,y)}function Qp(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||ns,el=Zn.current,hi(Zn,i),hi(dr,dr.current),!0}function $v(i,o,d){var y=i.stateNode;if(!y)throw Error(Ge(169));d?(i=W1(i,o,el),y.__reactInternalMemoizedMergedChildContext=i,yi(dr),yi(Zn),hi(Zn,i)):yi(dr),hi(dr,d)}var lo=null,Am=!1,pg=!1;function q1(i){lo===null?lo=[i]:lo.push(i)}function pA(i){Am=!0,q1(i)}function os(){if(!pg&&lo!==null){pg=!0;var i=0,o=qt;try{var d=lo;for(qt=1;i<d.length;i++){var y=d[i];do y=y(!0);while(y!==null)}lo=null,Am=!1}catch(x){throw lo!==null&&(lo=lo.slice(i+1)),_1(j0,os),x}finally{qt=o,pg=!1}}return null}var wc=[],Cc=0,em=null,tm=0,$r=[],Zr=0,tl=null,co=1,uo="";function Ws(i,o){wc[Cc++]=tm,wc[Cc++]=em,em=i,tm=o}function H1(i,o,d){$r[Zr++]=co,$r[Zr++]=uo,$r[Zr++]=tl,tl=i;var y=co;i=uo;var x=32-ua(y)-1;y&=~(1<<x),d+=1;var S=32-ua(o)+x;if(30<S){var b=x-x%5;S=(y&(1<<b)-1).toString(32),y>>=b,x-=b,co=1<<32-ua(o)+x|d<<x|y,uo=S+i}else co=1<<S|d<<x|y,uo=i}function H0(i){i.return!==null&&(Ws(i,1),H1(i,1,0))}function X0(i){for(;i===em;)em=wc[--Cc],wc[Cc]=null,tm=wc[--Cc],wc[Cc]=null;for(;i===tl;)tl=$r[--Zr],$r[Zr]=null,uo=$r[--Zr],$r[Zr]=null,co=$r[--Zr],$r[Zr]=null}var Mr=null,kr=null,bi=!1,ca=null;function X1(i,o){var d=Gr(5,null,null,0);d.elementType="DELETED",d.stateNode=o,d.return=i,o=i.deletions,o===null?(i.deletions=[d],i.flags|=16):o.push(d)}function Zv(i,o){switch(i.tag){case 5:var d=i.type;return o=o.nodeType!==1||d.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(i.stateNode=o,Mr=i,kr=Ko(o.firstChild),!0):!1;case 6:return o=i.pendingProps===""||o.nodeType!==3?null:o,o!==null?(i.stateNode=o,Mr=i,kr=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(d=tl!==null?{id:co,overflow:uo}:null,i.memoizedState={dehydrated:o,treeContext:d,retryLane:1073741824},d=Gr(18,null,null,0),d.stateNode=o,d.return=i,i.child=d,Mr=i,kr=null,!0):!1;default:return!1}}function Qg(i){return(i.mode&1)!==0&&(i.flags&128)===0}function e0(i){if(bi){var o=kr;if(o){var d=o;if(!Zv(i,o)){if(Qg(i))throw Error(Ge(418));o=Ko(d.nextSibling);var y=Mr;o&&Zv(i,o)?X1(y,d):(i.flags=i.flags&-4097|2,bi=!1,Mr=i)}}else{if(Qg(i))throw Error(Ge(418));i.flags=i.flags&-4097|2,bi=!1,Mr=i}}}function Gv(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;Mr=i}function wp(i){if(i!==Mr)return!1;if(!bi)return Gv(i),bi=!0,!1;var o;if((o=i.tag!==3)&&!(o=i.tag!==5)&&(o=i.type,o=o!=="head"&&o!=="body"&&!Xg(i.type,i.memoizedProps)),o&&(o=kr)){if(Qg(i))throw K1(),Error(Ge(418));for(;o;)X1(i,o),o=Ko(o.nextSibling)}if(Gv(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Ge(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8){var d=i.data;if(d==="/$"){if(o===0){kr=Ko(i.nextSibling);break e}o--}else d!=="$"&&d!=="$!"&&d!=="$?"||o++}i=i.nextSibling}kr=null}}else kr=Mr?Ko(i.stateNode.nextSibling):null;return!0}function K1(){for(var i=kr;i;)i=Ko(i.nextSibling)}function Lc(){kr=Mr=null,bi=!1}function K0(i){ca===null?ca=[i]:ca.push(i)}var mA=yo.ReactCurrentBatchConfig;function uh(i,o,d){if(i=d.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(Ge(309));var y=d.stateNode}if(!y)throw Error(Ge(147,i));var x=y,S=""+i;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===S?o.ref:(o=function(b){var c=x.refs;b===null?delete c[S]:c[S]=b},o._stringRef=S,o)}if(typeof i!="string")throw Error(Ge(284));if(!d._owner)throw Error(Ge(290,i))}return i}function Cp(i,o){throw i=Object.prototype.toString.call(o),Error(Ge(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i))}function Wv(i){var o=i._init;return o(i._payload)}function Y1(i){function o(he,oe){if(i){var fe=he.deletions;fe===null?(he.deletions=[oe],he.flags|=16):fe.push(oe)}}function d(he,oe){if(!i)return null;for(;oe!==null;)o(he,oe),oe=oe.sibling;return null}function y(he,oe){for(he=new Map;oe!==null;)oe.key!==null?he.set(oe.key,oe):he.set(oe.index,oe),oe=oe.sibling;return he}function x(he,oe){return he=es(he,oe),he.index=0,he.sibling=null,he}function S(he,oe,fe){return he.index=fe,i?(fe=he.alternate,fe!==null?(fe=fe.index,fe<oe?(he.flags|=2,oe):fe):(he.flags|=2,oe)):(he.flags|=1048576,oe)}function b(he){return i&&he.alternate===null&&(he.flags|=2),he}function c(he,oe,fe,De){return oe===null||oe.tag!==6?(oe=xg(fe,he.mode,De),oe.return=he,oe):(oe=x(oe,fe),oe.return=he,oe)}function F(he,oe,fe,De){var Xe=fe.type;return Xe===gc?se(he,oe,fe.props.children,De,fe.key):oe!==null&&(oe.elementType===Xe||typeof Xe=="object"&&Xe!==null&&Xe.$$typeof===Oo&&Wv(Xe)===oe.type)?(De=x(oe,fe.props),De.ref=uh(he,oe,fe),De.return=he,De):(De=Up(fe.type,fe.key,fe.props,null,he.mode,De),De.ref=uh(he,oe,fe),De.return=he,De)}function W(he,oe,fe,De){return oe===null||oe.tag!==4||oe.stateNode.containerInfo!==fe.containerInfo||oe.stateNode.implementation!==fe.implementation?(oe=bg(fe,he.mode,De),oe.return=he,oe):(oe=x(oe,fe.children||[]),oe.return=he,oe)}function se(he,oe,fe,De,Xe){return oe===null||oe.tag!==7?(oe=Qs(fe,he.mode,De,Xe),oe.return=he,oe):(oe=x(oe,fe),oe.return=he,oe)}function re(he,oe,fe){if(typeof oe=="string"&&oe!==""||typeof oe=="number")return oe=xg(""+oe,he.mode,fe),oe.return=he,oe;if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case dp:return fe=Up(oe.type,oe.key,oe.props,null,he.mode,fe),fe.ref=uh(he,null,oe),fe.return=he,fe;case fc:return oe=bg(oe,he.mode,fe),oe.return=he,oe;case Oo:var De=oe._init;return re(he,De(oe._payload),fe)}if(mh(oe)||ah(oe))return oe=Qs(oe,he.mode,fe,null),oe.return=he,oe;Cp(he,oe)}return null}function ce(he,oe,fe,De){var Xe=oe!==null?oe.key:null;if(typeof fe=="string"&&fe!==""||typeof fe=="number")return Xe!==null?null:c(he,oe,""+fe,De);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case dp:return fe.key===Xe?F(he,oe,fe,De):null;case fc:return fe.key===Xe?W(he,oe,fe,De):null;case Oo:return Xe=fe._init,ce(he,oe,Xe(fe._payload),De)}if(mh(fe)||ah(fe))return Xe!==null?null:se(he,oe,fe,De,null);Cp(he,fe)}return null}function K(he,oe,fe,De,Xe){if(typeof De=="string"&&De!==""||typeof De=="number")return he=he.get(fe)||null,c(oe,he,""+De,Xe);if(typeof De=="object"&&De!==null){switch(De.$$typeof){case dp:return he=he.get(De.key===null?fe:De.key)||null,F(oe,he,De,Xe);case fc:return he=he.get(De.key===null?fe:De.key)||null,W(oe,he,De,Xe);case Oo:var tt=De._init;return K(he,oe,fe,tt(De._payload),Xe)}if(mh(De)||ah(De))return he=he.get(fe)||null,se(oe,he,De,Xe,null);Cp(oe,De)}return null}function Ie(he,oe,fe,De){for(var Xe=null,tt=null,et=oe,lt=oe=0,Lt=null;et!==null&&lt<fe.length;lt++){et.index>lt?(Lt=et,et=null):Lt=et.sibling;var mt=ce(he,et,fe[lt],De);if(mt===null){et===null&&(et=Lt);break}i&&et&&mt.alternate===null&&o(he,et),oe=S(mt,oe,lt),tt===null?Xe=mt:tt.sibling=mt,tt=mt,et=Lt}if(lt===fe.length)return d(he,et),bi&&Ws(he,lt),Xe;if(et===null){for(;lt<fe.length;lt++)et=re(he,fe[lt],De),et!==null&&(oe=S(et,oe,lt),tt===null?Xe=et:tt.sibling=et,tt=et);return bi&&Ws(he,lt),Xe}for(et=y(he,et);lt<fe.length;lt++)Lt=K(et,he,lt,fe[lt],De),Lt!==null&&(i&&Lt.alternate!==null&&et.delete(Lt.key===null?lt:Lt.key),oe=S(Lt,oe,lt),tt===null?Xe=Lt:tt.sibling=Lt,tt=Lt);return i&&et.forEach(function(di){return o(he,di)}),bi&&Ws(he,lt),Xe}function Te(he,oe,fe,De){var Xe=ah(fe);if(typeof Xe!="function")throw Error(Ge(150));if(fe=Xe.call(fe),fe==null)throw Error(Ge(151));for(var tt=Xe=null,et=oe,lt=oe=0,Lt=null,mt=fe.next();et!==null&&!mt.done;lt++,mt=fe.next()){et.index>lt?(Lt=et,et=null):Lt=et.sibling;var di=ce(he,et,mt.value,De);if(di===null){et===null&&(et=Lt);break}i&&et&&di.alternate===null&&o(he,et),oe=S(di,oe,lt),tt===null?Xe=di:tt.sibling=di,tt=di,et=Lt}if(mt.done)return d(he,et),bi&&Ws(he,lt),Xe;if(et===null){for(;!mt.done;lt++,mt=fe.next())mt=re(he,mt.value,De),mt!==null&&(oe=S(mt,oe,lt),tt===null?Xe=mt:tt.sibling=mt,tt=mt);return bi&&Ws(he,lt),Xe}for(et=y(he,et);!mt.done;lt++,mt=fe.next())mt=K(et,he,lt,mt.value,De),mt!==null&&(i&&mt.alternate!==null&&et.delete(mt.key===null?lt:mt.key),oe=S(mt,oe,lt),tt===null?Xe=mt:tt.sibling=mt,tt=mt);return i&&et.forEach(function(Mi){return o(he,Mi)}),bi&&Ws(he,lt),Xe}function We(he,oe,fe,De){if(typeof fe=="object"&&fe!==null&&fe.type===gc&&fe.key===null&&(fe=fe.props.children),typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case dp:e:{for(var Xe=fe.key,tt=oe;tt!==null;){if(tt.key===Xe){if(Xe=fe.type,Xe===gc){if(tt.tag===7){d(he,tt.sibling),oe=x(tt,fe.props.children),oe.return=he,he=oe;break e}}else if(tt.elementType===Xe||typeof Xe=="object"&&Xe!==null&&Xe.$$typeof===Oo&&Wv(Xe)===tt.type){d(he,tt.sibling),oe=x(tt,fe.props),oe.ref=uh(he,tt,fe),oe.return=he,he=oe;break e}d(he,tt);break}else o(he,tt);tt=tt.sibling}fe.type===gc?(oe=Qs(fe.props.children,he.mode,De,fe.key),oe.return=he,he=oe):(De=Up(fe.type,fe.key,fe.props,null,he.mode,De),De.ref=uh(he,oe,fe),De.return=he,he=De)}return b(he);case fc:e:{for(tt=fe.key;oe!==null;){if(oe.key===tt)if(oe.tag===4&&oe.stateNode.containerInfo===fe.containerInfo&&oe.stateNode.implementation===fe.implementation){d(he,oe.sibling),oe=x(oe,fe.children||[]),oe.return=he,he=oe;break e}else{d(he,oe);break}else o(he,oe);oe=oe.sibling}oe=bg(fe,he.mode,De),oe.return=he,he=oe}return b(he);case Oo:return tt=fe._init,We(he,oe,tt(fe._payload),De)}if(mh(fe))return Ie(he,oe,fe,De);if(ah(fe))return Te(he,oe,fe,De);Cp(he,fe)}return typeof fe=="string"&&fe!==""||typeof fe=="number"?(fe=""+fe,oe!==null&&oe.tag===6?(d(he,oe.sibling),oe=x(oe,fe),oe.return=he,he=oe):(d(he,oe),oe=xg(fe,he.mode,De),oe.return=he,he=oe),b(he)):d(he,oe)}return We}var Rc=Y1(!0),J1=Y1(!1),im=as(null),nm=null,Ic=null,Y0=null;function J0(){Y0=Ic=nm=null}function Q0(i){var o=im.current;yi(im),i._currentValue=o}function t0(i,o,d){for(;i!==null;){var y=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,y!==null&&(y.childLanes|=o)):y!==null&&(y.childLanes&o)!==o&&(y.childLanes|=o),i===d)break;i=i.return}}function Ec(i,o){nm=i,Y0=Ic=null,i=i.dependencies,i!==null&&i.firstContext!==null&&(i.lanes&o&&(hr=!0),i.firstContext=null)}function qr(i){var o=i._currentValue;if(Y0!==i)if(i={context:i,memoizedValue:o,next:null},Ic===null){if(nm===null)throw Error(Ge(308));Ic=i,nm.dependencies={lanes:0,firstContext:i}}else Ic=Ic.next=i;return o}var Ks=null;function ey(i){Ks===null?Ks=[i]:Ks.push(i)}function Q1(i,o,d,y){var x=o.interleaved;return x===null?(d.next=d,ey(o)):(d.next=x.next,x.next=d),o.interleaved=d,fo(i,y)}function fo(i,o){i.lanes|=o;var d=i.alternate;for(d!==null&&(d.lanes|=o),d=i,i=i.return;i!==null;)i.childLanes|=o,d=i.alternate,d!==null&&(d.childLanes|=o),d=i,i=i.return;return d.tag===3?d.stateNode:null}var Vo=!1;function ty(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function eb(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function ho(i,o){return{eventTime:i,lane:o,tag:0,payload:null,callback:null,next:null}}function Yo(i,o,d){var y=i.updateQueue;if(y===null)return null;if(y=y.shared,Bt&2){var x=y.pending;return x===null?o.next=o:(o.next=x.next,x.next=o),y.pending=o,fo(i,d)}return x=y.interleaved,x===null?(o.next=o,ey(y)):(o.next=x.next,x.next=o),y.interleaved=o,fo(i,d)}function Rp(i,o,d){if(o=o.updateQueue,o!==null&&(o=o.shared,(d&4194240)!==0)){var y=o.lanes;y&=i.pendingLanes,d|=y,o.lanes=d,O0(i,d)}}function qv(i,o){var d=i.updateQueue,y=i.alternate;if(y!==null&&(y=y.updateQueue,d===y)){var x=null,S=null;if(d=d.firstBaseUpdate,d!==null){do{var b={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};S===null?x=S=b:S=S.next=b,d=d.next}while(d!==null);S===null?x=S=o:S=S.next=o}else x=S=o;d={baseState:y.baseState,firstBaseUpdate:x,lastBaseUpdate:S,shared:y.shared,effects:y.effects},i.updateQueue=d;return}i=d.lastBaseUpdate,i===null?d.firstBaseUpdate=o:i.next=o,d.lastBaseUpdate=o}function rm(i,o,d,y){var x=i.updateQueue;Vo=!1;var S=x.firstBaseUpdate,b=x.lastBaseUpdate,c=x.shared.pending;if(c!==null){x.shared.pending=null;var F=c,W=F.next;F.next=null,b===null?S=W:b.next=W,b=F;var se=i.alternate;se!==null&&(se=se.updateQueue,c=se.lastBaseUpdate,c!==b&&(c===null?se.firstBaseUpdate=W:c.next=W,se.lastBaseUpdate=F))}if(S!==null){var re=x.baseState;b=0,se=W=F=null,c=S;do{var ce=c.lane,K=c.eventTime;if((y&ce)===ce){se!==null&&(se=se.next={eventTime:K,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var Ie=i,Te=c;switch(ce=o,K=d,Te.tag){case 1:if(Ie=Te.payload,typeof Ie=="function"){re=Ie.call(K,re,ce);break e}re=Ie;break e;case 3:Ie.flags=Ie.flags&-65537|128;case 0:if(Ie=Te.payload,ce=typeof Ie=="function"?Ie.call(K,re,ce):Ie,ce==null)break e;re=ki({},re,ce);break e;case 2:Vo=!0}}c.callback!==null&&c.lane!==0&&(i.flags|=64,ce=x.effects,ce===null?x.effects=[c]:ce.push(c))}else K={eventTime:K,lane:ce,tag:c.tag,payload:c.payload,callback:c.callback,next:null},se===null?(W=se=K,F=re):se=se.next=K,b|=ce;if(c=c.next,c===null){if(c=x.shared.pending,c===null)break;ce=c,c=ce.next,ce.next=null,x.lastBaseUpdate=ce,x.shared.pending=null}}while(1);if(se===null&&(F=re),x.baseState=F,x.firstBaseUpdate=W,x.lastBaseUpdate=se,o=x.shared.interleaved,o!==null){x=o;do b|=x.lane,x=x.next;while(x!==o)}else S===null&&(x.shared.lanes=0);nl|=b,i.lanes=b,i.memoizedState=re}}function Hv(i,o,d){if(i=o.effects,o.effects=null,i!==null)for(o=0;o<i.length;o++){var y=i[o],x=y.callback;if(x!==null){if(y.callback=null,y=d,typeof x!="function")throw Error(Ge(191,x));x.call(y)}}}var Kh={},za=as(Kh),Fh=as(Kh),Bh=as(Kh);function Ys(i){if(i===Kh)throw Error(Ge(174));return i}function iy(i,o){switch(hi(Bh,o),hi(Fh,i),hi(za,Kh),i=o.nodeType,i){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:Lg(null,"");break;default:i=i===8?o.parentNode:o,o=i.namespaceURI||null,i=i.tagName,o=Lg(o,i)}yi(za),hi(za,o)}function Fc(){yi(za),yi(Fh),yi(Bh)}function tb(i){Ys(Bh.current);var o=Ys(za.current),d=Lg(o,i.type);o!==d&&(hi(Fh,i),hi(za,d))}function ny(i){Fh.current===i&&(yi(za),yi(Fh))}var Ti=as(0);function am(i){for(var o=i;o!==null;){if(o.tag===13){var d=o.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(o.flags&128)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var mg=[];function ry(){for(var i=0;i<mg.length;i++)mg[i]._workInProgressVersionPrimary=null;mg.length=0}var Fp=yo.ReactCurrentDispatcher,fg=yo.ReactCurrentBatchConfig,il=0,Pi=null,cn=null,yn=null,om=!1,wh=!1,jh=0,fA=0;function On(){throw Error(Ge(321))}function ay(i,o){if(o===null)return!1;for(var d=0;d<o.length&&d<i.length;d++)if(!da(i[d],o[d]))return!1;return!0}function oy(i,o,d,y,x,S){if(il=S,Pi=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Fp.current=i===null||i.memoizedState===null?vA:xA,i=d(y,x),wh){S=0;do{if(wh=!1,jh=0,25<=S)throw Error(Ge(301));S+=1,yn=cn=null,o.updateQueue=null,Fp.current=bA,i=d(y,x)}while(wh)}if(Fp.current=sm,o=cn!==null&&cn.next!==null,il=0,yn=cn=Pi=null,om=!1,o)throw Error(Ge(300));return i}function sy(){var i=jh!==0;return jh=0,i}function ka(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yn===null?Pi.memoizedState=yn=i:yn=yn.next=i,yn}function Hr(){if(cn===null){var i=Pi.alternate;i=i!==null?i.memoizedState:null}else i=cn.next;var o=yn===null?Pi.memoizedState:yn.next;if(o!==null)yn=o,cn=i;else{if(i===null)throw Error(Ge(310));cn=i,i={memoizedState:cn.memoizedState,baseState:cn.baseState,baseQueue:cn.baseQueue,queue:cn.queue,next:null},yn===null?Pi.memoizedState=yn=i:yn=yn.next=i}return yn}function Oh(i,o){return typeof o=="function"?o(i):o}function gg(i){var o=Hr(),d=o.queue;if(d===null)throw Error(Ge(311));d.lastRenderedReducer=i;var y=cn,x=y.baseQueue,S=d.pending;if(S!==null){if(x!==null){var b=x.next;x.next=S.next,S.next=b}y.baseQueue=x=S,d.pending=null}if(x!==null){S=x.next,y=y.baseState;var c=b=null,F=null,W=S;do{var se=W.lane;if((il&se)===se)F!==null&&(F=F.next={lane:0,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null}),y=W.hasEagerState?W.eagerState:i(y,W.action);else{var re={lane:se,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null};F===null?(c=F=re,b=y):F=F.next=re,Pi.lanes|=se,nl|=se}W=W.next}while(W!==null&&W!==S);F===null?b=y:F.next=c,da(y,o.memoizedState)||(hr=!0),o.memoizedState=y,o.baseState=b,o.baseQueue=F,d.lastRenderedState=y}if(i=d.interleaved,i!==null){x=i;do S=x.lane,Pi.lanes|=S,nl|=S,x=x.next;while(x!==i)}else x===null&&(d.lanes=0);return[o.memoizedState,d.dispatch]}function yg(i){var o=Hr(),d=o.queue;if(d===null)throw Error(Ge(311));d.lastRenderedReducer=i;var y=d.dispatch,x=d.pending,S=o.memoizedState;if(x!==null){d.pending=null;var b=x=x.next;do S=i(S,b.action),b=b.next;while(b!==x);da(S,o.memoizedState)||(hr=!0),o.memoizedState=S,o.baseQueue===null&&(o.baseState=S),d.lastRenderedState=S}return[S,y]}function ib(){}function nb(i,o){var d=Pi,y=Hr(),x=o(),S=!da(y.memoizedState,x);if(S&&(y.memoizedState=x,hr=!0),y=y.queue,ly(ob.bind(null,d,y,i),[i]),y.getSnapshot!==o||S||yn!==null&&yn.memoizedState.tag&1){if(d.flags|=2048,Vh(9,ab.bind(null,d,y,x,o),void 0,null),_n===null)throw Error(Ge(349));il&30||rb(d,o,x)}return x}function rb(i,o,d){i.flags|=16384,i={getSnapshot:o,value:d},o=Pi.updateQueue,o===null?(o={lastEffect:null,stores:null},Pi.updateQueue=o,o.stores=[i]):(d=o.stores,d===null?o.stores=[i]:d.push(i))}function ab(i,o,d,y){o.value=d,o.getSnapshot=y,sb(o)&&lb(i)}function ob(i,o,d){return d(function(){sb(o)&&lb(i)})}function sb(i){var o=i.getSnapshot;i=i.value;try{var d=o();return!da(i,d)}catch{return!0}}function lb(i){var o=fo(i,1);o!==null&&ha(o,i,1,-1)}function Xv(i){var o=ka();return typeof i=="function"&&(i=i()),o.memoizedState=o.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Oh,lastRenderedState:i},o.queue=i,i=i.dispatch=_A.bind(null,Pi,i),[o.memoizedState,i]}function Vh(i,o,d,y){return i={tag:i,create:o,destroy:d,deps:y,next:null},o=Pi.updateQueue,o===null?(o={lastEffect:null,stores:null},Pi.updateQueue=o,o.lastEffect=i.next=i):(d=o.lastEffect,d===null?o.lastEffect=i.next=i:(y=d.next,d.next=i,i.next=y,o.lastEffect=i)),i}function cb(){return Hr().memoizedState}function Bp(i,o,d,y){var x=ka();Pi.flags|=i,x.memoizedState=Vh(1|o,d,void 0,y===void 0?null:y)}function Sm(i,o,d,y){var x=Hr();y=y===void 0?null:y;var S=void 0;if(cn!==null){var b=cn.memoizedState;if(S=b.destroy,y!==null&&ay(y,b.deps)){x.memoizedState=Vh(o,d,S,y);return}}Pi.flags|=i,x.memoizedState=Vh(1|o,d,S,y)}function Kv(i,o){return Bp(8390656,8,i,o)}function ly(i,o){return Sm(2048,8,i,o)}function ub(i,o){return Sm(4,2,i,o)}function hb(i,o){return Sm(4,4,i,o)}function db(i,o){if(typeof o=="function")return i=i(),o(i),function(){o(null)};if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function pb(i,o,d){return d=d!=null?d.concat([i]):null,Sm(4,4,db.bind(null,o,i),d)}function cy(){}function mb(i,o){var d=Hr();o=o===void 0?null:o;var y=d.memoizedState;return y!==null&&o!==null&&ay(o,y[1])?y[0]:(d.memoizedState=[i,o],i)}function fb(i,o){var d=Hr();o=o===void 0?null:o;var y=d.memoizedState;return y!==null&&o!==null&&ay(o,y[1])?y[0]:(i=i(),d.memoizedState=[i,o],i)}function gb(i,o,d){return il&21?(da(d,o)||(d=b1(),Pi.lanes|=d,nl|=d,i.baseState=!0),o):(i.baseState&&(i.baseState=!1,hr=!0),i.memoizedState=d)}function gA(i,o){var d=qt;qt=d!==0&&4>d?d:4,i(!0);var y=fg.transition;fg.transition={};try{i(!1),o()}finally{qt=d,fg.transition=y}}function yb(){return Hr().memoizedState}function yA(i,o,d){var y=Qo(i);if(d={lane:y,action:d,hasEagerState:!1,eagerState:null,next:null},_b(i))vb(o,d);else if(d=Q1(i,o,d,y),d!==null){var x=nr();ha(d,i,y,x),xb(d,o,y)}}function _A(i,o,d){var y=Qo(i),x={lane:y,action:d,hasEagerState:!1,eagerState:null,next:null};if(_b(i))vb(o,x);else{var S=i.alternate;if(i.lanes===0&&(S===null||S.lanes===0)&&(S=o.lastRenderedReducer,S!==null))try{var b=o.lastRenderedState,c=S(b,d);if(x.hasEagerState=!0,x.eagerState=c,da(c,b)){var F=o.interleaved;F===null?(x.next=x,ey(o)):(x.next=F.next,F.next=x),o.interleaved=x;return}}catch{}finally{}d=Q1(i,o,x,y),d!==null&&(x=nr(),ha(d,i,y,x),xb(d,o,y))}}function _b(i){var o=i.alternate;return i===Pi||o!==null&&o===Pi}function vb(i,o){wh=om=!0;var d=i.pending;d===null?o.next=o:(o.next=d.next,d.next=o),i.pending=o}function xb(i,o,d){if(d&4194240){var y=o.lanes;y&=i.pendingLanes,d|=y,o.lanes=d,O0(i,d)}}var sm={readContext:qr,useCallback:On,useContext:On,useEffect:On,useImperativeHandle:On,useInsertionEffect:On,useLayoutEffect:On,useMemo:On,useReducer:On,useRef:On,useState:On,useDebugValue:On,useDeferredValue:On,useTransition:On,useMutableSource:On,useSyncExternalStore:On,useId:On,unstable_isNewReconciler:!1},vA={readContext:qr,useCallback:function(i,o){return ka().memoizedState=[i,o===void 0?null:o],i},useContext:qr,useEffect:Kv,useImperativeHandle:function(i,o,d){return d=d!=null?d.concat([i]):null,Bp(4194308,4,db.bind(null,o,i),d)},useLayoutEffect:function(i,o){return Bp(4194308,4,i,o)},useInsertionEffect:function(i,o){return Bp(4,2,i,o)},useMemo:function(i,o){var d=ka();return o=o===void 0?null:o,i=i(),d.memoizedState=[i,o],i},useReducer:function(i,o,d){var y=ka();return o=d!==void 0?d(o):o,y.memoizedState=y.baseState=o,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:o},y.queue=i,i=i.dispatch=yA.bind(null,Pi,i),[y.memoizedState,i]},useRef:function(i){var o=ka();return i={current:i},o.memoizedState=i},useState:Xv,useDebugValue:cy,useDeferredValue:function(i){return ka().memoizedState=i},useTransition:function(){var i=Xv(!1),o=i[0];return i=gA.bind(null,i[1]),ka().memoizedState=i,[o,i]},useMutableSource:function(){},useSyncExternalStore:function(i,o,d){var y=Pi,x=ka();if(bi){if(d===void 0)throw Error(Ge(407));d=d()}else{if(d=o(),_n===null)throw Error(Ge(349));il&30||rb(y,o,d)}x.memoizedState=d;var S={value:d,getSnapshot:o};return x.queue=S,Kv(ob.bind(null,y,S,i),[i]),y.flags|=2048,Vh(9,ab.bind(null,y,S,d,o),void 0,null),d},useId:function(){var i=ka(),o=_n.identifierPrefix;if(bi){var d=uo,y=co;d=(y&~(1<<32-ua(y)-1)).toString(32)+d,o=":"+o+"R"+d,d=jh++,0<d&&(o+="H"+d.toString(32)),o+=":"}else d=fA++,o=":"+o+"r"+d.toString(32)+":";return i.memoizedState=o},unstable_isNewReconciler:!1},xA={readContext:qr,useCallback:mb,useContext:qr,useEffect:ly,useImperativeHandle:pb,useInsertionEffect:ub,useLayoutEffect:hb,useMemo:fb,useReducer:gg,useRef:cb,useState:function(){return gg(Oh)},useDebugValue:cy,useDeferredValue:function(i){var o=Hr();return gb(o,cn.memoizedState,i)},useTransition:function(){var i=gg(Oh)[0],o=Hr().memoizedState;return[i,o]},useMutableSource:ib,useSyncExternalStore:nb,useId:yb,unstable_isNewReconciler:!1},bA={readContext:qr,useCallback:mb,useContext:qr,useEffect:ly,useImperativeHandle:pb,useInsertionEffect:ub,useLayoutEffect:hb,useMemo:fb,useReducer:yg,useRef:cb,useState:function(){return yg(Oh)},useDebugValue:cy,useDeferredValue:function(i){var o=Hr();return cn===null?o.memoizedState=i:gb(o,cn.memoizedState,i)},useTransition:function(){var i=yg(Oh)[0],o=Hr().memoizedState;return[i,o]},useMutableSource:ib,useSyncExternalStore:nb,useId:yb,unstable_isNewReconciler:!1};function sa(i,o){if(i&&i.defaultProps){o=ki({},o),i=i.defaultProps;for(var d in i)o[d]===void 0&&(o[d]=i[d]);return o}return o}function i0(i,o,d,y){o=i.memoizedState,d=d(y,o),d=d==null?o:ki({},o,d),i.memoizedState=d,i.lanes===0&&(i.updateQueue.baseState=d)}var Tm={isMounted:function(i){return(i=i._reactInternals)?ol(i)===i:!1},enqueueSetState:function(i,o,d){i=i._reactInternals;var y=nr(),x=Qo(i),S=ho(y,x);S.payload=o,d!=null&&(S.callback=d),o=Yo(i,S,x),o!==null&&(ha(o,i,x,y),Rp(o,i,x))},enqueueReplaceState:function(i,o,d){i=i._reactInternals;var y=nr(),x=Qo(i),S=ho(y,x);S.tag=1,S.payload=o,d!=null&&(S.callback=d),o=Yo(i,S,x),o!==null&&(ha(o,i,x,y),Rp(o,i,x))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var d=nr(),y=Qo(i),x=ho(d,y);x.tag=2,o!=null&&(x.callback=o),o=Yo(i,x,y),o!==null&&(ha(o,i,y,d),Rp(o,i,y))}};function Yv(i,o,d,y,x,S,b){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(y,S,b):o.prototype&&o.prototype.isPureReactComponent?!Nh(d,y)||!Nh(x,S):!0}function bb(i,o,d){var y=!1,x=ns,S=o.contextType;return typeof S=="object"&&S!==null?S=qr(S):(x=pr(o)?el:Zn.current,y=o.contextTypes,S=(y=y!=null)?Dc(i,x):ns),o=new o(d,S),i.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=Tm,i.stateNode=o,o._reactInternals=i,y&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=x,i.__reactInternalMemoizedMaskedChildContext=S),o}function Jv(i,o,d,y){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(d,y),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(d,y),o.state!==i&&Tm.enqueueReplaceState(o,o.state,null)}function n0(i,o,d,y){var x=i.stateNode;x.props=d,x.state=i.memoizedState,x.refs={},ty(i);var S=o.contextType;typeof S=="object"&&S!==null?x.context=qr(S):(S=pr(o)?el:Zn.current,x.context=Dc(i,S)),x.state=i.memoizedState,S=o.getDerivedStateFromProps,typeof S=="function"&&(i0(i,o,S,d),x.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(o=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),o!==x.state&&Tm.enqueueReplaceState(x,x.state,null),rm(i,d,x,y),x.state=i.memoizedState),typeof x.componentDidMount=="function"&&(i.flags|=4194308)}function Bc(i,o){try{var d="",y=o;do d+=XC(y),y=y.return;while(y);var x=d}catch(S){x=`
Error generating stack: `+S.message+`
`+S.stack}return{value:i,source:o,stack:x,digest:null}}function _g(i,o,d){return{value:i,source:null,stack:d??null,digest:o??null}}function r0(i,o){try{console.error(o.value)}catch(d){setTimeout(function(){throw d})}}var wA=typeof WeakMap=="function"?WeakMap:Map;function wb(i,o,d){d=ho(-1,d),d.tag=3,d.payload={element:null};var y=o.value;return d.callback=function(){cm||(cm=!0,m0=y),r0(i,o)},d}function Cb(i,o,d){d=ho(-1,d),d.tag=3;var y=i.type.getDerivedStateFromError;if(typeof y=="function"){var x=o.value;d.payload=function(){return y(x)},d.callback=function(){r0(i,o)}}var S=i.stateNode;return S!==null&&typeof S.componentDidCatch=="function"&&(d.callback=function(){r0(i,o),typeof y!="function"&&(Jo===null?Jo=new Set([this]):Jo.add(this));var b=o.stack;this.componentDidCatch(o.value,{componentStack:b!==null?b:""})}),d}function Qv(i,o,d){var y=i.pingCache;if(y===null){y=i.pingCache=new wA;var x=new Set;y.set(o,x)}else x=y.get(o),x===void 0&&(x=new Set,y.set(o,x));x.has(d)||(x.add(d),i=RA.bind(null,i,o,d),o.then(i,i))}function ex(i){do{var o;if((o=i.tag===13)&&(o=i.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return i;i=i.return}while(i!==null);return null}function tx(i,o,d,y,x){return i.mode&1?(i.flags|=65536,i.lanes=x,i):(i===o?i.flags|=65536:(i.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(o=ho(-1,1),o.tag=2,Yo(d,o,1))),d.lanes|=1),i)}var CA=yo.ReactCurrentOwner,hr=!1;function ir(i,o,d,y){o.child=i===null?J1(o,null,d,y):Rc(o,i.child,d,y)}function ix(i,o,d,y,x){d=d.render;var S=o.ref;return Ec(o,x),y=oy(i,o,d,y,S,x),d=sy(),i!==null&&!hr?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~x,go(i,o,x)):(bi&&d&&H0(o),o.flags|=1,ir(i,o,y,x),o.child)}function nx(i,o,d,y,x){if(i===null){var S=d.type;return typeof S=="function"&&!yy(S)&&S.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(o.tag=15,o.type=S,Ib(i,o,S,y,x)):(i=Up(d.type,null,y,o,o.mode,x),i.ref=o.ref,i.return=o,o.child=i)}if(S=i.child,!(i.lanes&x)){var b=S.memoizedProps;if(d=d.compare,d=d!==null?d:Nh,d(b,y)&&i.ref===o.ref)return go(i,o,x)}return o.flags|=1,i=es(S,y),i.ref=o.ref,i.return=o,o.child=i}function Ib(i,o,d,y,x){if(i!==null){var S=i.memoizedProps;if(Nh(S,y)&&i.ref===o.ref)if(hr=!1,o.pendingProps=y=S,(i.lanes&x)!==0)i.flags&131072&&(hr=!0);else return o.lanes=i.lanes,go(i,o,x)}return a0(i,o,d,y,x)}function Ab(i,o,d){var y=o.pendingProps,x=y.children,S=i!==null?i.memoizedState:null;if(y.mode==="hidden")if(!(o.mode&1))o.memoizedState={baseLanes:0,cachePool:null,transitions:null},hi(Sc,Pr),Pr|=d;else{if(!(d&1073741824))return i=S!==null?S.baseLanes|d:d,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:i,cachePool:null,transitions:null},o.updateQueue=null,hi(Sc,Pr),Pr|=i,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},y=S!==null?S.baseLanes:d,hi(Sc,Pr),Pr|=y}else S!==null?(y=S.baseLanes|d,o.memoizedState=null):y=d,hi(Sc,Pr),Pr|=y;return ir(i,o,x,d),o.child}function Sb(i,o){var d=o.ref;(i===null&&d!==null||i!==null&&i.ref!==d)&&(o.flags|=512,o.flags|=2097152)}function a0(i,o,d,y,x){var S=pr(d)?el:Zn.current;return S=Dc(o,S),Ec(o,x),d=oy(i,o,d,y,S,x),y=sy(),i!==null&&!hr?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~x,go(i,o,x)):(bi&&y&&H0(o),o.flags|=1,ir(i,o,d,x),o.child)}function rx(i,o,d,y,x){if(pr(d)){var S=!0;Qp(o)}else S=!1;if(Ec(o,x),o.stateNode===null)jp(i,o),bb(o,d,y),n0(o,d,y,x),y=!0;else if(i===null){var b=o.stateNode,c=o.memoizedProps;b.props=c;var F=b.context,W=d.contextType;typeof W=="object"&&W!==null?W=qr(W):(W=pr(d)?el:Zn.current,W=Dc(o,W));var se=d.getDerivedStateFromProps,re=typeof se=="function"||typeof b.getSnapshotBeforeUpdate=="function";re||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(c!==y||F!==W)&&Jv(o,b,y,W),Vo=!1;var ce=o.memoizedState;b.state=ce,rm(o,y,b,x),F=o.memoizedState,c!==y||ce!==F||dr.current||Vo?(typeof se=="function"&&(i0(o,d,se,y),F=o.memoizedState),(c=Vo||Yv(o,d,c,y,ce,F,W))?(re||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(o.flags|=4194308)):(typeof b.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=y,o.memoizedState=F),b.props=y,b.state=F,b.context=W,y=c):(typeof b.componentDidMount=="function"&&(o.flags|=4194308),y=!1)}else{b=o.stateNode,eb(i,o),c=o.memoizedProps,W=o.type===o.elementType?c:sa(o.type,c),b.props=W,re=o.pendingProps,ce=b.context,F=d.contextType,typeof F=="object"&&F!==null?F=qr(F):(F=pr(d)?el:Zn.current,F=Dc(o,F));var K=d.getDerivedStateFromProps;(se=typeof K=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(c!==re||ce!==F)&&Jv(o,b,y,F),Vo=!1,ce=o.memoizedState,b.state=ce,rm(o,y,b,x);var Ie=o.memoizedState;c!==re||ce!==Ie||dr.current||Vo?(typeof K=="function"&&(i0(o,d,K,y),Ie=o.memoizedState),(W=Vo||Yv(o,d,W,y,ce,Ie,F)||!1)?(se||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(y,Ie,F),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(y,Ie,F)),typeof b.componentDidUpdate=="function"&&(o.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof b.componentDidUpdate!="function"||c===i.memoizedProps&&ce===i.memoizedState||(o.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||c===i.memoizedProps&&ce===i.memoizedState||(o.flags|=1024),o.memoizedProps=y,o.memoizedState=Ie),b.props=y,b.state=Ie,b.context=F,y=W):(typeof b.componentDidUpdate!="function"||c===i.memoizedProps&&ce===i.memoizedState||(o.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||c===i.memoizedProps&&ce===i.memoizedState||(o.flags|=1024),y=!1)}return o0(i,o,d,y,S,x)}function o0(i,o,d,y,x,S){Sb(i,o);var b=(o.flags&128)!==0;if(!y&&!b)return x&&$v(o,d,!1),go(i,o,S);y=o.stateNode,CA.current=o;var c=b&&typeof d.getDerivedStateFromError!="function"?null:y.render();return o.flags|=1,i!==null&&b?(o.child=Rc(o,i.child,null,S),o.child=Rc(o,null,c,S)):ir(i,o,c,S),o.memoizedState=y.state,x&&$v(o,d,!0),o.child}function Tb(i){var o=i.stateNode;o.pendingContext?Uv(i,o.pendingContext,o.pendingContext!==o.context):o.context&&Uv(i,o.context,!1),iy(i,o.containerInfo)}function ax(i,o,d,y,x){return Lc(),K0(x),o.flags|=256,ir(i,o,d,y),o.child}var s0={dehydrated:null,treeContext:null,retryLane:0};function l0(i){return{baseLanes:i,cachePool:null,transitions:null}}function Pb(i,o,d){var y=o.pendingProps,x=Ti.current,S=!1,b=(o.flags&128)!==0,c;if((c=b)||(c=i!==null&&i.memoizedState===null?!1:(x&2)!==0),c?(S=!0,o.flags&=-129):(i===null||i.memoizedState!==null)&&(x|=1),hi(Ti,x&1),i===null)return e0(o),i=o.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?(o.mode&1?i.data==="$!"?o.lanes=8:o.lanes=1073741824:o.lanes=1,null):(b=y.children,i=y.fallback,S?(y=o.mode,S=o.child,b={mode:"hidden",children:b},!(y&1)&&S!==null?(S.childLanes=0,S.pendingProps=b):S=Mm(b,y,0,null),i=Qs(i,y,d,null),S.return=o,i.return=o,S.sibling=i,o.child=S,o.child.memoizedState=l0(d),o.memoizedState=s0,i):uy(o,b));if(x=i.memoizedState,x!==null&&(c=x.dehydrated,c!==null))return IA(i,o,b,y,c,x,d);if(S){S=y.fallback,b=o.mode,x=i.child,c=x.sibling;var F={mode:"hidden",children:y.children};return!(b&1)&&o.child!==x?(y=o.child,y.childLanes=0,y.pendingProps=F,o.deletions=null):(y=es(x,F),y.subtreeFlags=x.subtreeFlags&14680064),c!==null?S=es(c,S):(S=Qs(S,b,d,null),S.flags|=2),S.return=o,y.return=o,y.sibling=S,o.child=y,y=S,S=o.child,b=i.child.memoizedState,b=b===null?l0(d):{baseLanes:b.baseLanes|d,cachePool:null,transitions:b.transitions},S.memoizedState=b,S.childLanes=i.childLanes&~d,o.memoizedState=s0,y}return S=i.child,i=S.sibling,y=es(S,{mode:"visible",children:y.children}),!(o.mode&1)&&(y.lanes=d),y.return=o,y.sibling=null,i!==null&&(d=o.deletions,d===null?(o.deletions=[i],o.flags|=16):d.push(i)),o.child=y,o.memoizedState=null,y}function uy(i,o){return o=Mm({mode:"visible",children:o},i.mode,0,null),o.return=i,i.child=o}function Ip(i,o,d,y){return y!==null&&K0(y),Rc(o,i.child,null,d),i=uy(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function IA(i,o,d,y,x,S,b){if(d)return o.flags&256?(o.flags&=-257,y=_g(Error(Ge(422))),Ip(i,o,b,y)):o.memoizedState!==null?(o.child=i.child,o.flags|=128,null):(S=y.fallback,x=o.mode,y=Mm({mode:"visible",children:y.children},x,0,null),S=Qs(S,x,b,null),S.flags|=2,y.return=o,S.return=o,y.sibling=S,o.child=y,o.mode&1&&Rc(o,i.child,null,b),o.child.memoizedState=l0(b),o.memoizedState=s0,S);if(!(o.mode&1))return Ip(i,o,b,null);if(x.data==="$!"){if(y=x.nextSibling&&x.nextSibling.dataset,y)var c=y.dgst;return y=c,S=Error(Ge(419)),y=_g(S,y,void 0),Ip(i,o,b,y)}if(c=(b&i.childLanes)!==0,hr||c){if(y=_n,y!==null){switch(b&-b){case 4:x=2;break;case 16:x=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:x=32;break;case 536870912:x=268435456;break;default:x=0}x=x&(y.suspendedLanes|b)?0:x,x!==0&&x!==S.retryLane&&(S.retryLane=x,fo(i,x),ha(y,i,x,-1))}return gy(),y=_g(Error(Ge(421))),Ip(i,o,b,y)}return x.data==="$?"?(o.flags|=128,o.child=i.child,o=FA.bind(null,i),x._reactRetry=o,null):(i=S.treeContext,kr=Ko(x.nextSibling),Mr=o,bi=!0,ca=null,i!==null&&($r[Zr++]=co,$r[Zr++]=uo,$r[Zr++]=tl,co=i.id,uo=i.overflow,tl=o),o=uy(o,y.children),o.flags|=4096,o)}function ox(i,o,d){i.lanes|=o;var y=i.alternate;y!==null&&(y.lanes|=o),t0(i.return,o,d)}function vg(i,o,d,y,x){var S=i.memoizedState;S===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:y,tail:d,tailMode:x}:(S.isBackwards=o,S.rendering=null,S.renderingStartTime=0,S.last=y,S.tail=d,S.tailMode=x)}function kb(i,o,d){var y=o.pendingProps,x=y.revealOrder,S=y.tail;if(ir(i,o,y.children,d),y=Ti.current,y&2)y=y&1|2,o.flags|=128;else{if(i!==null&&i.flags&128)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&ox(i,d,o);else if(i.tag===19)ox(i,d,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}y&=1}if(hi(Ti,y),!(o.mode&1))o.memoizedState=null;else switch(x){case"forwards":for(d=o.child,x=null;d!==null;)i=d.alternate,i!==null&&am(i)===null&&(x=d),d=d.sibling;d=x,d===null?(x=o.child,o.child=null):(x=d.sibling,d.sibling=null),vg(o,!1,x,d,S);break;case"backwards":for(d=null,x=o.child,o.child=null;x!==null;){if(i=x.alternate,i!==null&&am(i)===null){o.child=x;break}i=x.sibling,x.sibling=d,d=x,x=i}vg(o,!0,d,null,S);break;case"together":vg(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function jp(i,o){!(o.mode&1)&&i!==null&&(i.alternate=null,o.alternate=null,o.flags|=2)}function go(i,o,d){if(i!==null&&(o.dependencies=i.dependencies),nl|=o.lanes,!(d&o.childLanes))return null;if(i!==null&&o.child!==i.child)throw Error(Ge(153));if(o.child!==null){for(i=o.child,d=es(i,i.pendingProps),o.child=d,d.return=o;i.sibling!==null;)i=i.sibling,d=d.sibling=es(i,i.pendingProps),d.return=o;d.sibling=null}return o.child}function AA(i,o,d){switch(o.tag){case 3:Tb(o),Lc();break;case 5:tb(o);break;case 1:pr(o.type)&&Qp(o);break;case 4:iy(o,o.stateNode.containerInfo);break;case 10:var y=o.type._context,x=o.memoizedProps.value;hi(im,y._currentValue),y._currentValue=x;break;case 13:if(y=o.memoizedState,y!==null)return y.dehydrated!==null?(hi(Ti,Ti.current&1),o.flags|=128,null):d&o.child.childLanes?Pb(i,o,d):(hi(Ti,Ti.current&1),i=go(i,o,d),i!==null?i.sibling:null);hi(Ti,Ti.current&1);break;case 19:if(y=(d&o.childLanes)!==0,i.flags&128){if(y)return kb(i,o,d);o.flags|=128}if(x=o.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),hi(Ti,Ti.current),y)break;return null;case 22:case 23:return o.lanes=0,Ab(i,o,d)}return go(i,o,d)}var Mb,c0,Eb,zb;Mb=function(i,o){for(var d=o.child;d!==null;){if(d.tag===5||d.tag===6)i.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===o)break;for(;d.sibling===null;){if(d.return===null||d.return===o)return;d=d.return}d.sibling.return=d.return,d=d.sibling}};c0=function(){};Eb=function(i,o,d,y){var x=i.memoizedProps;if(x!==y){i=o.stateNode,Ys(za.current);var S=null;switch(d){case"input":x=Eg(i,x),y=Eg(i,y),S=[];break;case"select":x=ki({},x,{value:void 0}),y=ki({},y,{value:void 0}),S=[];break;case"textarea":x=Dg(i,x),y=Dg(i,y),S=[];break;default:typeof x.onClick!="function"&&typeof y.onClick=="function"&&(i.onclick=Yp)}Rg(d,y);var b;d=null;for(W in x)if(!y.hasOwnProperty(W)&&x.hasOwnProperty(W)&&x[W]!=null)if(W==="style"){var c=x[W];for(b in c)c.hasOwnProperty(b)&&(d||(d={}),d[b]="")}else W!=="dangerouslySetInnerHTML"&&W!=="children"&&W!=="suppressContentEditableWarning"&&W!=="suppressHydrationWarning"&&W!=="autoFocus"&&(Sh.hasOwnProperty(W)?S||(S=[]):(S=S||[]).push(W,null));for(W in y){var F=y[W];if(c=x!=null?x[W]:void 0,y.hasOwnProperty(W)&&F!==c&&(F!=null||c!=null))if(W==="style")if(c){for(b in c)!c.hasOwnProperty(b)||F&&F.hasOwnProperty(b)||(d||(d={}),d[b]="");for(b in F)F.hasOwnProperty(b)&&c[b]!==F[b]&&(d||(d={}),d[b]=F[b])}else d||(S||(S=[]),S.push(W,d)),d=F;else W==="dangerouslySetInnerHTML"?(F=F?F.__html:void 0,c=c?c.__html:void 0,F!=null&&c!==F&&(S=S||[]).push(W,F)):W==="children"?typeof F!="string"&&typeof F!="number"||(S=S||[]).push(W,""+F):W!=="suppressContentEditableWarning"&&W!=="suppressHydrationWarning"&&(Sh.hasOwnProperty(W)?(F!=null&&W==="onScroll"&&gi("scroll",i),S||c===F||(S=[])):(S=S||[]).push(W,F))}d&&(S=S||[]).push("style",d);var W=S;(o.updateQueue=W)&&(o.flags|=4)}};zb=function(i,o,d,y){d!==y&&(o.flags|=4)};function hh(i,o){if(!bi)switch(i.tailMode){case"hidden":o=i.tail;for(var d=null;o!==null;)o.alternate!==null&&(d=o),o=o.sibling;d===null?i.tail=null:d.sibling=null;break;case"collapsed":d=i.tail;for(var y=null;d!==null;)d.alternate!==null&&(y=d),d=d.sibling;y===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:y.sibling=null}}function Vn(i){var o=i.alternate!==null&&i.alternate.child===i.child,d=0,y=0;if(o)for(var x=i.child;x!==null;)d|=x.lanes|x.childLanes,y|=x.subtreeFlags&14680064,y|=x.flags&14680064,x.return=i,x=x.sibling;else for(x=i.child;x!==null;)d|=x.lanes|x.childLanes,y|=x.subtreeFlags,y|=x.flags,x.return=i,x=x.sibling;return i.subtreeFlags|=y,i.childLanes=d,o}function SA(i,o,d){var y=o.pendingProps;switch(X0(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vn(o),null;case 1:return pr(o.type)&&Jp(),Vn(o),null;case 3:return y=o.stateNode,Fc(),yi(dr),yi(Zn),ry(),y.pendingContext&&(y.context=y.pendingContext,y.pendingContext=null),(i===null||i.child===null)&&(wp(o)?o.flags|=4:i===null||i.memoizedState.isDehydrated&&!(o.flags&256)||(o.flags|=1024,ca!==null&&(y0(ca),ca=null))),c0(i,o),Vn(o),null;case 5:ny(o);var x=Ys(Bh.current);if(d=o.type,i!==null&&o.stateNode!=null)Eb(i,o,d,y,x),i.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!y){if(o.stateNode===null)throw Error(Ge(166));return Vn(o),null}if(i=Ys(za.current),wp(o)){y=o.stateNode,d=o.type;var S=o.memoizedProps;switch(y[Ma]=o,y[Rh]=S,i=(o.mode&1)!==0,d){case"dialog":gi("cancel",y),gi("close",y);break;case"iframe":case"object":case"embed":gi("load",y);break;case"video":case"audio":for(x=0;x<gh.length;x++)gi(gh[x],y);break;case"source":gi("error",y);break;case"img":case"image":case"link":gi("error",y),gi("load",y);break;case"details":gi("toggle",y);break;case"input":fv(y,S),gi("invalid",y);break;case"select":y._wrapperState={wasMultiple:!!S.multiple},gi("invalid",y);break;case"textarea":yv(y,S),gi("invalid",y)}Rg(d,S),x=null;for(var b in S)if(S.hasOwnProperty(b)){var c=S[b];b==="children"?typeof c=="string"?y.textContent!==c&&(S.suppressHydrationWarning!==!0&&bp(y.textContent,c,i),x=["children",c]):typeof c=="number"&&y.textContent!==""+c&&(S.suppressHydrationWarning!==!0&&bp(y.textContent,c,i),x=["children",""+c]):Sh.hasOwnProperty(b)&&c!=null&&b==="onScroll"&&gi("scroll",y)}switch(d){case"input":pp(y),gv(y,S,!0);break;case"textarea":pp(y),_v(y);break;case"select":case"option":break;default:typeof S.onClick=="function"&&(y.onclick=Yp)}y=x,o.updateQueue=y,y!==null&&(o.flags|=4)}else{b=x.nodeType===9?x:x.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=o1(d)),i==="http://www.w3.org/1999/xhtml"?d==="script"?(i=b.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof y.is=="string"?i=b.createElement(d,{is:y.is}):(i=b.createElement(d),d==="select"&&(b=i,y.multiple?b.multiple=!0:y.size&&(b.size=y.size))):i=b.createElementNS(i,d),i[Ma]=o,i[Rh]=y,Mb(i,o,!1,!1),o.stateNode=i;e:{switch(b=Fg(d,y),d){case"dialog":gi("cancel",i),gi("close",i),x=y;break;case"iframe":case"object":case"embed":gi("load",i),x=y;break;case"video":case"audio":for(x=0;x<gh.length;x++)gi(gh[x],i);x=y;break;case"source":gi("error",i),x=y;break;case"img":case"image":case"link":gi("error",i),gi("load",i),x=y;break;case"details":gi("toggle",i),x=y;break;case"input":fv(i,y),x=Eg(i,y),gi("invalid",i);break;case"option":x=y;break;case"select":i._wrapperState={wasMultiple:!!y.multiple},x=ki({},y,{value:void 0}),gi("invalid",i);break;case"textarea":yv(i,y),x=Dg(i,y),gi("invalid",i);break;default:x=y}Rg(d,x),c=x;for(S in c)if(c.hasOwnProperty(S)){var F=c[S];S==="style"?c1(i,F):S==="dangerouslySetInnerHTML"?(F=F?F.__html:void 0,F!=null&&s1(i,F)):S==="children"?typeof F=="string"?(d!=="textarea"||F!=="")&&Th(i,F):typeof F=="number"&&Th(i,""+F):S!=="suppressContentEditableWarning"&&S!=="suppressHydrationWarning"&&S!=="autoFocus"&&(Sh.hasOwnProperty(S)?F!=null&&S==="onScroll"&&gi("scroll",i):F!=null&&D0(i,S,F,b))}switch(d){case"input":pp(i),gv(i,y,!1);break;case"textarea":pp(i),_v(i);break;case"option":y.value!=null&&i.setAttribute("value",""+is(y.value));break;case"select":i.multiple=!!y.multiple,S=y.value,S!=null?Tc(i,!!y.multiple,S,!1):y.defaultValue!=null&&Tc(i,!!y.multiple,y.defaultValue,!0);break;default:typeof x.onClick=="function"&&(i.onclick=Yp)}switch(d){case"button":case"input":case"select":case"textarea":y=!!y.autoFocus;break e;case"img":y=!0;break e;default:y=!1}}y&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return Vn(o),null;case 6:if(i&&o.stateNode!=null)zb(i,o,i.memoizedProps,y);else{if(typeof y!="string"&&o.stateNode===null)throw Error(Ge(166));if(d=Ys(Bh.current),Ys(za.current),wp(o)){if(y=o.stateNode,d=o.memoizedProps,y[Ma]=o,(S=y.nodeValue!==d)&&(i=Mr,i!==null))switch(i.tag){case 3:bp(y.nodeValue,d,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&bp(y.nodeValue,d,(i.mode&1)!==0)}S&&(o.flags|=4)}else y=(d.nodeType===9?d:d.ownerDocument).createTextNode(y),y[Ma]=o,o.stateNode=y}return Vn(o),null;case 13:if(yi(Ti),y=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(bi&&kr!==null&&o.mode&1&&!(o.flags&128))K1(),Lc(),o.flags|=98560,S=!1;else if(S=wp(o),y!==null&&y.dehydrated!==null){if(i===null){if(!S)throw Error(Ge(318));if(S=o.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(Ge(317));S[Ma]=o}else Lc(),!(o.flags&128)&&(o.memoizedState=null),o.flags|=4;Vn(o),S=!1}else ca!==null&&(y0(ca),ca=null),S=!0;if(!S)return o.flags&65536?o:null}return o.flags&128?(o.lanes=d,o):(y=y!==null,y!==(i!==null&&i.memoizedState!==null)&&y&&(o.child.flags|=8192,o.mode&1&&(i===null||Ti.current&1?un===0&&(un=3):gy())),o.updateQueue!==null&&(o.flags|=4),Vn(o),null);case 4:return Fc(),c0(i,o),i===null&&Dh(o.stateNode.containerInfo),Vn(o),null;case 10:return Q0(o.type._context),Vn(o),null;case 17:return pr(o.type)&&Jp(),Vn(o),null;case 19:if(yi(Ti),S=o.memoizedState,S===null)return Vn(o),null;if(y=(o.flags&128)!==0,b=S.rendering,b===null)if(y)hh(S,!1);else{if(un!==0||i!==null&&i.flags&128)for(i=o.child;i!==null;){if(b=am(i),b!==null){for(o.flags|=128,hh(S,!1),y=b.updateQueue,y!==null&&(o.updateQueue=y,o.flags|=4),o.subtreeFlags=0,y=d,d=o.child;d!==null;)S=d,i=y,S.flags&=14680066,b=S.alternate,b===null?(S.childLanes=0,S.lanes=i,S.child=null,S.subtreeFlags=0,S.memoizedProps=null,S.memoizedState=null,S.updateQueue=null,S.dependencies=null,S.stateNode=null):(S.childLanes=b.childLanes,S.lanes=b.lanes,S.child=b.child,S.subtreeFlags=0,S.deletions=null,S.memoizedProps=b.memoizedProps,S.memoizedState=b.memoizedState,S.updateQueue=b.updateQueue,S.type=b.type,i=b.dependencies,S.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),d=d.sibling;return hi(Ti,Ti.current&1|2),o.child}i=i.sibling}S.tail!==null&&Gi()>jc&&(o.flags|=128,y=!0,hh(S,!1),o.lanes=4194304)}else{if(!y)if(i=am(b),i!==null){if(o.flags|=128,y=!0,d=i.updateQueue,d!==null&&(o.updateQueue=d,o.flags|=4),hh(S,!0),S.tail===null&&S.tailMode==="hidden"&&!b.alternate&&!bi)return Vn(o),null}else 2*Gi()-S.renderingStartTime>jc&&d!==1073741824&&(o.flags|=128,y=!0,hh(S,!1),o.lanes=4194304);S.isBackwards?(b.sibling=o.child,o.child=b):(d=S.last,d!==null?d.sibling=b:o.child=b,S.last=b)}return S.tail!==null?(o=S.tail,S.rendering=o,S.tail=o.sibling,S.renderingStartTime=Gi(),o.sibling=null,d=Ti.current,hi(Ti,y?d&1|2:d&1),o):(Vn(o),null);case 22:case 23:return fy(),y=o.memoizedState!==null,i!==null&&i.memoizedState!==null!==y&&(o.flags|=8192),y&&o.mode&1?Pr&1073741824&&(Vn(o),o.subtreeFlags&6&&(o.flags|=8192)):Vn(o),null;case 24:return null;case 25:return null}throw Error(Ge(156,o.tag))}function TA(i,o){switch(X0(o),o.tag){case 1:return pr(o.type)&&Jp(),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return Fc(),yi(dr),yi(Zn),ry(),i=o.flags,i&65536&&!(i&128)?(o.flags=i&-65537|128,o):null;case 5:return ny(o),null;case 13:if(yi(Ti),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(Ge(340));Lc()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return yi(Ti),null;case 4:return Fc(),null;case 10:return Q0(o.type._context),null;case 22:case 23:return fy(),null;case 24:return null;default:return null}}var Ap=!1,$n=!1,PA=typeof WeakSet=="function"?WeakSet:Set,ot=null;function Ac(i,o){var d=i.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(y){Fi(i,o,y)}else d.current=null}function u0(i,o,d){try{d()}catch(y){Fi(i,o,y)}}var sx=!1;function kA(i,o){if(qg=Hp,i=F1(),q0(i)){if("selectionStart"in i)var d={start:i.selectionStart,end:i.selectionEnd};else e:{d=(d=i.ownerDocument)&&d.defaultView||window;var y=d.getSelection&&d.getSelection();if(y&&y.rangeCount!==0){d=y.anchorNode;var x=y.anchorOffset,S=y.focusNode;y=y.focusOffset;try{d.nodeType,S.nodeType}catch{d=null;break e}var b=0,c=-1,F=-1,W=0,se=0,re=i,ce=null;t:for(;;){for(var K;re!==d||x!==0&&re.nodeType!==3||(c=b+x),re!==S||y!==0&&re.nodeType!==3||(F=b+y),re.nodeType===3&&(b+=re.nodeValue.length),(K=re.firstChild)!==null;)ce=re,re=K;for(;;){if(re===i)break t;if(ce===d&&++W===x&&(c=b),ce===S&&++se===y&&(F=b),(K=re.nextSibling)!==null)break;re=ce,ce=re.parentNode}re=K}d=c===-1||F===-1?null:{start:c,end:F}}else d=null}d=d||{start:0,end:0}}else d=null;for(Hg={focusedElem:i,selectionRange:d},Hp=!1,ot=o;ot!==null;)if(o=ot,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,ot=i;else for(;ot!==null;){o=ot;try{var Ie=o.alternate;if(o.flags&1024)switch(o.tag){case 0:case 11:case 15:break;case 1:if(Ie!==null){var Te=Ie.memoizedProps,We=Ie.memoizedState,he=o.stateNode,oe=he.getSnapshotBeforeUpdate(o.elementType===o.type?Te:sa(o.type,Te),We);he.__reactInternalSnapshotBeforeUpdate=oe}break;case 3:var fe=o.stateNode.containerInfo;fe.nodeType===1?fe.textContent="":fe.nodeType===9&&fe.documentElement&&fe.removeChild(fe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ge(163))}}catch(De){Fi(o,o.return,De)}if(i=o.sibling,i!==null){i.return=o.return,ot=i;break}ot=o.return}return Ie=sx,sx=!1,Ie}function Ch(i,o,d){var y=o.updateQueue;if(y=y!==null?y.lastEffect:null,y!==null){var x=y=y.next;do{if((x.tag&i)===i){var S=x.destroy;x.destroy=void 0,S!==void 0&&u0(o,d,S)}x=x.next}while(x!==y)}}function Pm(i,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var d=o=o.next;do{if((d.tag&i)===i){var y=d.create;d.destroy=y()}d=d.next}while(d!==o)}}function h0(i){var o=i.ref;if(o!==null){var d=i.stateNode;switch(i.tag){case 5:i=d;break;default:i=d}typeof o=="function"?o(i):o.current=i}}function Nb(i){var o=i.alternate;o!==null&&(i.alternate=null,Nb(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&(delete o[Ma],delete o[Rh],delete o[Yg],delete o[hA],delete o[dA])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function Db(i){return i.tag===5||i.tag===3||i.tag===4}function lx(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Db(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function d0(i,o,d){var y=i.tag;if(y===5||y===6)i=i.stateNode,o?d.nodeType===8?d.parentNode.insertBefore(i,o):d.insertBefore(i,o):(d.nodeType===8?(o=d.parentNode,o.insertBefore(i,d)):(o=d,o.appendChild(i)),d=d._reactRootContainer,d!=null||o.onclick!==null||(o.onclick=Yp));else if(y!==4&&(i=i.child,i!==null))for(d0(i,o,d),i=i.sibling;i!==null;)d0(i,o,d),i=i.sibling}function p0(i,o,d){var y=i.tag;if(y===5||y===6)i=i.stateNode,o?d.insertBefore(i,o):d.appendChild(i);else if(y!==4&&(i=i.child,i!==null))for(p0(i,o,d),i=i.sibling;i!==null;)p0(i,o,d),i=i.sibling}var Tn=null,la=!1;function jo(i,o,d){for(d=d.child;d!==null;)Lb(i,o,d),d=d.sibling}function Lb(i,o,d){if(Ea&&typeof Ea.onCommitFiberUnmount=="function")try{Ea.onCommitFiberUnmount(xm,d)}catch{}switch(d.tag){case 5:$n||Ac(d,o);case 6:var y=Tn,x=la;Tn=null,jo(i,o,d),Tn=y,la=x,Tn!==null&&(la?(i=Tn,d=d.stateNode,i.nodeType===8?i.parentNode.removeChild(d):i.removeChild(d)):Tn.removeChild(d.stateNode));break;case 18:Tn!==null&&(la?(i=Tn,d=d.stateNode,i.nodeType===8?dg(i.parentNode,d):i.nodeType===1&&dg(i,d),Eh(i)):dg(Tn,d.stateNode));break;case 4:y=Tn,x=la,Tn=d.stateNode.containerInfo,la=!0,jo(i,o,d),Tn=y,la=x;break;case 0:case 11:case 14:case 15:if(!$n&&(y=d.updateQueue,y!==null&&(y=y.lastEffect,y!==null))){x=y=y.next;do{var S=x,b=S.destroy;S=S.tag,b!==void 0&&(S&2||S&4)&&u0(d,o,b),x=x.next}while(x!==y)}jo(i,o,d);break;case 1:if(!$n&&(Ac(d,o),y=d.stateNode,typeof y.componentWillUnmount=="function"))try{y.props=d.memoizedProps,y.state=d.memoizedState,y.componentWillUnmount()}catch(c){Fi(d,o,c)}jo(i,o,d);break;case 21:jo(i,o,d);break;case 22:d.mode&1?($n=(y=$n)||d.memoizedState!==null,jo(i,o,d),$n=y):jo(i,o,d);break;default:jo(i,o,d)}}function cx(i){var o=i.updateQueue;if(o!==null){i.updateQueue=null;var d=i.stateNode;d===null&&(d=i.stateNode=new PA),o.forEach(function(y){var x=BA.bind(null,i,y);d.has(y)||(d.add(y),y.then(x,x))})}}function oa(i,o){var d=o.deletions;if(d!==null)for(var y=0;y<d.length;y++){var x=d[y];try{var S=i,b=o,c=b;e:for(;c!==null;){switch(c.tag){case 5:Tn=c.stateNode,la=!1;break e;case 3:Tn=c.stateNode.containerInfo,la=!0;break e;case 4:Tn=c.stateNode.containerInfo,la=!0;break e}c=c.return}if(Tn===null)throw Error(Ge(160));Lb(S,b,x),Tn=null,la=!1;var F=x.alternate;F!==null&&(F.return=null),x.return=null}catch(W){Fi(x,o,W)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)Rb(o,i),o=o.sibling}function Rb(i,o){var d=i.alternate,y=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(oa(o,i),Ta(i),y&4){try{Ch(3,i,i.return),Pm(3,i)}catch(Te){Fi(i,i.return,Te)}try{Ch(5,i,i.return)}catch(Te){Fi(i,i.return,Te)}}break;case 1:oa(o,i),Ta(i),y&512&&d!==null&&Ac(d,d.return);break;case 5:if(oa(o,i),Ta(i),y&512&&d!==null&&Ac(d,d.return),i.flags&32){var x=i.stateNode;try{Th(x,"")}catch(Te){Fi(i,i.return,Te)}}if(y&4&&(x=i.stateNode,x!=null)){var S=i.memoizedProps,b=d!==null?d.memoizedProps:S,c=i.type,F=i.updateQueue;if(i.updateQueue=null,F!==null)try{c==="input"&&S.type==="radio"&&S.name!=null&&r1(x,S),Fg(c,b);var W=Fg(c,S);for(b=0;b<F.length;b+=2){var se=F[b],re=F[b+1];se==="style"?c1(x,re):se==="dangerouslySetInnerHTML"?s1(x,re):se==="children"?Th(x,re):D0(x,se,re,W)}switch(c){case"input":zg(x,S);break;case"textarea":a1(x,S);break;case"select":var ce=x._wrapperState.wasMultiple;x._wrapperState.wasMultiple=!!S.multiple;var K=S.value;K!=null?Tc(x,!!S.multiple,K,!1):ce!==!!S.multiple&&(S.defaultValue!=null?Tc(x,!!S.multiple,S.defaultValue,!0):Tc(x,!!S.multiple,S.multiple?[]:"",!1))}x[Rh]=S}catch(Te){Fi(i,i.return,Te)}}break;case 6:if(oa(o,i),Ta(i),y&4){if(i.stateNode===null)throw Error(Ge(162));x=i.stateNode,S=i.memoizedProps;try{x.nodeValue=S}catch(Te){Fi(i,i.return,Te)}}break;case 3:if(oa(o,i),Ta(i),y&4&&d!==null&&d.memoizedState.isDehydrated)try{Eh(o.containerInfo)}catch(Te){Fi(i,i.return,Te)}break;case 4:oa(o,i),Ta(i);break;case 13:oa(o,i),Ta(i),x=i.child,x.flags&8192&&(S=x.memoizedState!==null,x.stateNode.isHidden=S,!S||x.alternate!==null&&x.alternate.memoizedState!==null||(py=Gi())),y&4&&cx(i);break;case 22:if(se=d!==null&&d.memoizedState!==null,i.mode&1?($n=(W=$n)||se,oa(o,i),$n=W):oa(o,i),Ta(i),y&8192){if(W=i.memoizedState!==null,(i.stateNode.isHidden=W)&&!se&&i.mode&1)for(ot=i,se=i.child;se!==null;){for(re=ot=se;ot!==null;){switch(ce=ot,K=ce.child,ce.tag){case 0:case 11:case 14:case 15:Ch(4,ce,ce.return);break;case 1:Ac(ce,ce.return);var Ie=ce.stateNode;if(typeof Ie.componentWillUnmount=="function"){y=ce,d=ce.return;try{o=y,Ie.props=o.memoizedProps,Ie.state=o.memoizedState,Ie.componentWillUnmount()}catch(Te){Fi(y,d,Te)}}break;case 5:Ac(ce,ce.return);break;case 22:if(ce.memoizedState!==null){hx(re);continue}}K!==null?(K.return=ce,ot=K):hx(re)}se=se.sibling}e:for(se=null,re=i;;){if(re.tag===5){if(se===null){se=re;try{x=re.stateNode,W?(S=x.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none"):(c=re.stateNode,F=re.memoizedProps.style,b=F!=null&&F.hasOwnProperty("display")?F.display:null,c.style.display=l1("display",b))}catch(Te){Fi(i,i.return,Te)}}}else if(re.tag===6){if(se===null)try{re.stateNode.nodeValue=W?"":re.memoizedProps}catch(Te){Fi(i,i.return,Te)}}else if((re.tag!==22&&re.tag!==23||re.memoizedState===null||re===i)&&re.child!==null){re.child.return=re,re=re.child;continue}if(re===i)break e;for(;re.sibling===null;){if(re.return===null||re.return===i)break e;se===re&&(se=null),re=re.return}se===re&&(se=null),re.sibling.return=re.return,re=re.sibling}}break;case 19:oa(o,i),Ta(i),y&4&&cx(i);break;case 21:break;default:oa(o,i),Ta(i)}}function Ta(i){var o=i.flags;if(o&2){try{e:{for(var d=i.return;d!==null;){if(Db(d)){var y=d;break e}d=d.return}throw Error(Ge(160))}switch(y.tag){case 5:var x=y.stateNode;y.flags&32&&(Th(x,""),y.flags&=-33);var S=lx(i);p0(i,S,x);break;case 3:case 4:var b=y.stateNode.containerInfo,c=lx(i);d0(i,c,b);break;default:throw Error(Ge(161))}}catch(F){Fi(i,i.return,F)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function MA(i,o,d){ot=i,Fb(i)}function Fb(i,o,d){for(var y=(i.mode&1)!==0;ot!==null;){var x=ot,S=x.child;if(x.tag===22&&y){var b=x.memoizedState!==null||Ap;if(!b){var c=x.alternate,F=c!==null&&c.memoizedState!==null||$n;c=Ap;var W=$n;if(Ap=b,($n=F)&&!W)for(ot=x;ot!==null;)b=ot,F=b.child,b.tag===22&&b.memoizedState!==null?dx(x):F!==null?(F.return=b,ot=F):dx(x);for(;S!==null;)ot=S,Fb(S),S=S.sibling;ot=x,Ap=c,$n=W}ux(i)}else x.subtreeFlags&8772&&S!==null?(S.return=x,ot=S):ux(i)}}function ux(i){for(;ot!==null;){var o=ot;if(o.flags&8772){var d=o.alternate;try{if(o.flags&8772)switch(o.tag){case 0:case 11:case 15:$n||Pm(5,o);break;case 1:var y=o.stateNode;if(o.flags&4&&!$n)if(d===null)y.componentDidMount();else{var x=o.elementType===o.type?d.memoizedProps:sa(o.type,d.memoizedProps);y.componentDidUpdate(x,d.memoizedState,y.__reactInternalSnapshotBeforeUpdate)}var S=o.updateQueue;S!==null&&Hv(o,S,y);break;case 3:var b=o.updateQueue;if(b!==null){if(d=null,o.child!==null)switch(o.child.tag){case 5:d=o.child.stateNode;break;case 1:d=o.child.stateNode}Hv(o,b,d)}break;case 5:var c=o.stateNode;if(d===null&&o.flags&4){d=c;var F=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":F.autoFocus&&d.focus();break;case"img":F.src&&(d.src=F.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var W=o.alternate;if(W!==null){var se=W.memoizedState;if(se!==null){var re=se.dehydrated;re!==null&&Eh(re)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ge(163))}$n||o.flags&512&&h0(o)}catch(ce){Fi(o,o.return,ce)}}if(o===i){ot=null;break}if(d=o.sibling,d!==null){d.return=o.return,ot=d;break}ot=o.return}}function hx(i){for(;ot!==null;){var o=ot;if(o===i){ot=null;break}var d=o.sibling;if(d!==null){d.return=o.return,ot=d;break}ot=o.return}}function dx(i){for(;ot!==null;){var o=ot;try{switch(o.tag){case 0:case 11:case 15:var d=o.return;try{Pm(4,o)}catch(F){Fi(o,d,F)}break;case 1:var y=o.stateNode;if(typeof y.componentDidMount=="function"){var x=o.return;try{y.componentDidMount()}catch(F){Fi(o,x,F)}}var S=o.return;try{h0(o)}catch(F){Fi(o,S,F)}break;case 5:var b=o.return;try{h0(o)}catch(F){Fi(o,b,F)}}}catch(F){Fi(o,o.return,F)}if(o===i){ot=null;break}var c=o.sibling;if(c!==null){c.return=o.return,ot=c;break}ot=o.return}}var EA=Math.ceil,lm=yo.ReactCurrentDispatcher,hy=yo.ReactCurrentOwner,Wr=yo.ReactCurrentBatchConfig,Bt=0,_n=null,tn=null,Pn=0,Pr=0,Sc=as(0),un=0,Uh=null,nl=0,km=0,dy=0,Ih=null,ur=null,py=0,jc=1/0,so=null,cm=!1,m0=null,Jo=null,Sp=!1,Go=null,um=0,Ah=0,f0=null,Op=-1,Vp=0;function nr(){return Bt&6?Gi():Op!==-1?Op:Op=Gi()}function Qo(i){return i.mode&1?Bt&2&&Pn!==0?Pn&-Pn:mA.transition!==null?(Vp===0&&(Vp=b1()),Vp):(i=qt,i!==0||(i=window.event,i=i===void 0?16:P1(i.type)),i):1}function ha(i,o,d,y){if(50<Ah)throw Ah=0,f0=null,Error(Ge(185));qh(i,d,y),(!(Bt&2)||i!==_n)&&(i===_n&&(!(Bt&2)&&(km|=d),un===4&&$o(i,Pn)),mr(i,y),d===1&&Bt===0&&!(o.mode&1)&&(jc=Gi()+500,Am&&os()))}function mr(i,o){var d=i.callbackNode;mI(i,o);var y=qp(i,i===_n?Pn:0);if(y===0)d!==null&&bv(d),i.callbackNode=null,i.callbackPriority=0;else if(o=y&-y,i.callbackPriority!==o){if(d!=null&&bv(d),o===1)i.tag===0?pA(px.bind(null,i)):q1(px.bind(null,i)),cA(function(){!(Bt&6)&&os()}),d=null;else{switch(w1(y)){case 1:d=j0;break;case 4:d=v1;break;case 16:d=Wp;break;case 536870912:d=x1;break;default:d=Wp}d=Gb(d,Bb.bind(null,i))}i.callbackPriority=o,i.callbackNode=d}}function Bb(i,o){if(Op=-1,Vp=0,Bt&6)throw Error(Ge(327));var d=i.callbackNode;if(zc()&&i.callbackNode!==d)return null;var y=qp(i,i===_n?Pn:0);if(y===0)return null;if(y&30||y&i.expiredLanes||o)o=hm(i,y);else{o=y;var x=Bt;Bt|=2;var S=Ob();(_n!==i||Pn!==o)&&(so=null,jc=Gi()+500,Js(i,o));do try{DA();break}catch(c){jb(i,c)}while(1);J0(),lm.current=S,Bt=x,tn!==null?o=0:(_n=null,Pn=0,o=un)}if(o!==0){if(o===2&&(x=Ug(i),x!==0&&(y=x,o=g0(i,x))),o===1)throw d=Uh,Js(i,0),$o(i,y),mr(i,Gi()),d;if(o===6)$o(i,y);else{if(x=i.current.alternate,!(y&30)&&!zA(x)&&(o=hm(i,y),o===2&&(S=Ug(i),S!==0&&(y=S,o=g0(i,S))),o===1))throw d=Uh,Js(i,0),$o(i,y),mr(i,Gi()),d;switch(i.finishedWork=x,i.finishedLanes=y,o){case 0:case 1:throw Error(Ge(345));case 2:qs(i,ur,so);break;case 3:if($o(i,y),(y&130023424)===y&&(o=py+500-Gi(),10<o)){if(qp(i,0)!==0)break;if(x=i.suspendedLanes,(x&y)!==y){nr(),i.pingedLanes|=i.suspendedLanes&x;break}i.timeoutHandle=Kg(qs.bind(null,i,ur,so),o);break}qs(i,ur,so);break;case 4:if($o(i,y),(y&4194240)===y)break;for(o=i.eventTimes,x=-1;0<y;){var b=31-ua(y);S=1<<b,b=o[b],b>x&&(x=b),y&=~S}if(y=x,y=Gi()-y,y=(120>y?120:480>y?480:1080>y?1080:1920>y?1920:3e3>y?3e3:4320>y?4320:1960*EA(y/1960))-y,10<y){i.timeoutHandle=Kg(qs.bind(null,i,ur,so),y);break}qs(i,ur,so);break;case 5:qs(i,ur,so);break;default:throw Error(Ge(329))}}}return mr(i,Gi()),i.callbackNode===d?Bb.bind(null,i):null}function g0(i,o){var d=Ih;return i.current.memoizedState.isDehydrated&&(Js(i,o).flags|=256),i=hm(i,o),i!==2&&(o=ur,ur=d,o!==null&&y0(o)),i}function y0(i){ur===null?ur=i:ur.push.apply(ur,i)}function zA(i){for(var o=i;;){if(o.flags&16384){var d=o.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var y=0;y<d.length;y++){var x=d[y],S=x.getSnapshot;x=x.value;try{if(!da(S(),x))return!1}catch{return!1}}}if(d=o.child,o.subtreeFlags&16384&&d!==null)d.return=o,o=d;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function $o(i,o){for(o&=~dy,o&=~km,i.suspendedLanes|=o,i.pingedLanes&=~o,i=i.expirationTimes;0<o;){var d=31-ua(o),y=1<<d;i[d]=-1,o&=~y}}function px(i){if(Bt&6)throw Error(Ge(327));zc();var o=qp(i,0);if(!(o&1))return mr(i,Gi()),null;var d=hm(i,o);if(i.tag!==0&&d===2){var y=Ug(i);y!==0&&(o=y,d=g0(i,y))}if(d===1)throw d=Uh,Js(i,0),$o(i,o),mr(i,Gi()),d;if(d===6)throw Error(Ge(345));return i.finishedWork=i.current.alternate,i.finishedLanes=o,qs(i,ur,so),mr(i,Gi()),null}function my(i,o){var d=Bt;Bt|=1;try{return i(o)}finally{Bt=d,Bt===0&&(jc=Gi()+500,Am&&os())}}function rl(i){Go!==null&&Go.tag===0&&!(Bt&6)&&zc();var o=Bt;Bt|=1;var d=Wr.transition,y=qt;try{if(Wr.transition=null,qt=1,i)return i()}finally{qt=y,Wr.transition=d,Bt=o,!(Bt&6)&&os()}}function fy(){Pr=Sc.current,yi(Sc)}function Js(i,o){i.finishedWork=null,i.finishedLanes=0;var d=i.timeoutHandle;if(d!==-1&&(i.timeoutHandle=-1,lA(d)),tn!==null)for(d=tn.return;d!==null;){var y=d;switch(X0(y),y.tag){case 1:y=y.type.childContextTypes,y!=null&&Jp();break;case 3:Fc(),yi(dr),yi(Zn),ry();break;case 5:ny(y);break;case 4:Fc();break;case 13:yi(Ti);break;case 19:yi(Ti);break;case 10:Q0(y.type._context);break;case 22:case 23:fy()}d=d.return}if(_n=i,tn=i=es(i.current,null),Pn=Pr=o,un=0,Uh=null,dy=km=nl=0,ur=Ih=null,Ks!==null){for(o=0;o<Ks.length;o++)if(d=Ks[o],y=d.interleaved,y!==null){d.interleaved=null;var x=y.next,S=d.pending;if(S!==null){var b=S.next;S.next=x,y.next=b}d.pending=y}Ks=null}return i}function jb(i,o){do{var d=tn;try{if(J0(),Fp.current=sm,om){for(var y=Pi.memoizedState;y!==null;){var x=y.queue;x!==null&&(x.pending=null),y=y.next}om=!1}if(il=0,yn=cn=Pi=null,wh=!1,jh=0,hy.current=null,d===null||d.return===null){un=1,Uh=o,tn=null;break}e:{var S=i,b=d.return,c=d,F=o;if(o=Pn,c.flags|=32768,F!==null&&typeof F=="object"&&typeof F.then=="function"){var W=F,se=c,re=se.tag;if(!(se.mode&1)&&(re===0||re===11||re===15)){var ce=se.alternate;ce?(se.updateQueue=ce.updateQueue,se.memoizedState=ce.memoizedState,se.lanes=ce.lanes):(se.updateQueue=null,se.memoizedState=null)}var K=ex(b);if(K!==null){K.flags&=-257,tx(K,b,c,S,o),K.mode&1&&Qv(S,W,o),o=K,F=W;var Ie=o.updateQueue;if(Ie===null){var Te=new Set;Te.add(F),o.updateQueue=Te}else Ie.add(F);break e}else{if(!(o&1)){Qv(S,W,o),gy();break e}F=Error(Ge(426))}}else if(bi&&c.mode&1){var We=ex(b);if(We!==null){!(We.flags&65536)&&(We.flags|=256),tx(We,b,c,S,o),K0(Bc(F,c));break e}}S=F=Bc(F,c),un!==4&&(un=2),Ih===null?Ih=[S]:Ih.push(S),S=b;do{switch(S.tag){case 3:S.flags|=65536,o&=-o,S.lanes|=o;var he=wb(S,F,o);qv(S,he);break e;case 1:c=F;var oe=S.type,fe=S.stateNode;if(!(S.flags&128)&&(typeof oe.getDerivedStateFromError=="function"||fe!==null&&typeof fe.componentDidCatch=="function"&&(Jo===null||!Jo.has(fe)))){S.flags|=65536,o&=-o,S.lanes|=o;var De=Cb(S,c,o);qv(S,De);break e}}S=S.return}while(S!==null)}Ub(d)}catch(Xe){o=Xe,tn===d&&d!==null&&(tn=d=d.return);continue}break}while(1)}function Ob(){var i=lm.current;return lm.current=sm,i===null?sm:i}function gy(){(un===0||un===3||un===2)&&(un=4),_n===null||!(nl&268435455)&&!(km&268435455)||$o(_n,Pn)}function hm(i,o){var d=Bt;Bt|=2;var y=Ob();(_n!==i||Pn!==o)&&(so=null,Js(i,o));do try{NA();break}catch(x){jb(i,x)}while(1);if(J0(),Bt=d,lm.current=y,tn!==null)throw Error(Ge(261));return _n=null,Pn=0,un}function NA(){for(;tn!==null;)Vb(tn)}function DA(){for(;tn!==null&&!aI();)Vb(tn)}function Vb(i){var o=Zb(i.alternate,i,Pr);i.memoizedProps=i.pendingProps,o===null?Ub(i):tn=o,hy.current=null}function Ub(i){var o=i;do{var d=o.alternate;if(i=o.return,o.flags&32768){if(d=TA(d,o),d!==null){d.flags&=32767,tn=d;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{un=6,tn=null;return}}else if(d=SA(d,o,Pr),d!==null){tn=d;return}if(o=o.sibling,o!==null){tn=o;return}tn=o=i}while(o!==null);un===0&&(un=5)}function qs(i,o,d){var y=qt,x=Wr.transition;try{Wr.transition=null,qt=1,LA(i,o,d,y)}finally{Wr.transition=x,qt=y}return null}function LA(i,o,d,y){do zc();while(Go!==null);if(Bt&6)throw Error(Ge(327));d=i.finishedWork;var x=i.finishedLanes;if(d===null)return null;if(i.finishedWork=null,i.finishedLanes=0,d===i.current)throw Error(Ge(177));i.callbackNode=null,i.callbackPriority=0;var S=d.lanes|d.childLanes;if(fI(i,S),i===_n&&(tn=_n=null,Pn=0),!(d.subtreeFlags&2064)&&!(d.flags&2064)||Sp||(Sp=!0,Gb(Wp,function(){return zc(),null})),S=(d.flags&15990)!==0,d.subtreeFlags&15990||S){S=Wr.transition,Wr.transition=null;var b=qt;qt=1;var c=Bt;Bt|=4,hy.current=null,kA(i,d),Rb(d,i),tA(Hg),Hp=!!qg,Hg=qg=null,i.current=d,MA(d),oI(),Bt=c,qt=b,Wr.transition=S}else i.current=d;if(Sp&&(Sp=!1,Go=i,um=x),S=i.pendingLanes,S===0&&(Jo=null),cI(d.stateNode),mr(i,Gi()),o!==null)for(y=i.onRecoverableError,d=0;d<o.length;d++)x=o[d],y(x.value,{componentStack:x.stack,digest:x.digest});if(cm)throw cm=!1,i=m0,m0=null,i;return um&1&&i.tag!==0&&zc(),S=i.pendingLanes,S&1?i===f0?Ah++:(Ah=0,f0=i):Ah=0,os(),null}function zc(){if(Go!==null){var i=w1(um),o=Wr.transition,d=qt;try{if(Wr.transition=null,qt=16>i?16:i,Go===null)var y=!1;else{if(i=Go,Go=null,um=0,Bt&6)throw Error(Ge(331));var x=Bt;for(Bt|=4,ot=i.current;ot!==null;){var S=ot,b=S.child;if(ot.flags&16){var c=S.deletions;if(c!==null){for(var F=0;F<c.length;F++){var W=c[F];for(ot=W;ot!==null;){var se=ot;switch(se.tag){case 0:case 11:case 15:Ch(8,se,S)}var re=se.child;if(re!==null)re.return=se,ot=re;else for(;ot!==null;){se=ot;var ce=se.sibling,K=se.return;if(Nb(se),se===W){ot=null;break}if(ce!==null){ce.return=K,ot=ce;break}ot=K}}}var Ie=S.alternate;if(Ie!==null){var Te=Ie.child;if(Te!==null){Ie.child=null;do{var We=Te.sibling;Te.sibling=null,Te=We}while(Te!==null)}}ot=S}}if(S.subtreeFlags&2064&&b!==null)b.return=S,ot=b;else e:for(;ot!==null;){if(S=ot,S.flags&2048)switch(S.tag){case 0:case 11:case 15:Ch(9,S,S.return)}var he=S.sibling;if(he!==null){he.return=S.return,ot=he;break e}ot=S.return}}var oe=i.current;for(ot=oe;ot!==null;){b=ot;var fe=b.child;if(b.subtreeFlags&2064&&fe!==null)fe.return=b,ot=fe;else e:for(b=oe;ot!==null;){if(c=ot,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Pm(9,c)}}catch(Xe){Fi(c,c.return,Xe)}if(c===b){ot=null;break e}var De=c.sibling;if(De!==null){De.return=c.return,ot=De;break e}ot=c.return}}if(Bt=x,os(),Ea&&typeof Ea.onPostCommitFiberRoot=="function")try{Ea.onPostCommitFiberRoot(xm,i)}catch{}y=!0}return y}finally{qt=d,Wr.transition=o}}return!1}function mx(i,o,d){o=Bc(d,o),o=wb(i,o,1),i=Yo(i,o,1),o=nr(),i!==null&&(qh(i,1,o),mr(i,o))}function Fi(i,o,d){if(i.tag===3)mx(i,i,d);else for(;o!==null;){if(o.tag===3){mx(o,i,d);break}else if(o.tag===1){var y=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(Jo===null||!Jo.has(y))){i=Bc(d,i),i=Cb(o,i,1),o=Yo(o,i,1),i=nr(),o!==null&&(qh(o,1,i),mr(o,i));break}}o=o.return}}function RA(i,o,d){var y=i.pingCache;y!==null&&y.delete(o),o=nr(),i.pingedLanes|=i.suspendedLanes&d,_n===i&&(Pn&d)===d&&(un===4||un===3&&(Pn&130023424)===Pn&&500>Gi()-py?Js(i,0):dy|=d),mr(i,o)}function $b(i,o){o===0&&(i.mode&1?(o=gp,gp<<=1,!(gp&130023424)&&(gp=4194304)):o=1);var d=nr();i=fo(i,o),i!==null&&(qh(i,o,d),mr(i,d))}function FA(i){var o=i.memoizedState,d=0;o!==null&&(d=o.retryLane),$b(i,d)}function BA(i,o){var d=0;switch(i.tag){case 13:var y=i.stateNode,x=i.memoizedState;x!==null&&(d=x.retryLane);break;case 19:y=i.stateNode;break;default:throw Error(Ge(314))}y!==null&&y.delete(o),$b(i,d)}var Zb;Zb=function(i,o,d){if(i!==null)if(i.memoizedProps!==o.pendingProps||dr.current)hr=!0;else{if(!(i.lanes&d)&&!(o.flags&128))return hr=!1,AA(i,o,d);hr=!!(i.flags&131072)}else hr=!1,bi&&o.flags&1048576&&H1(o,tm,o.index);switch(o.lanes=0,o.tag){case 2:var y=o.type;jp(i,o),i=o.pendingProps;var x=Dc(o,Zn.current);Ec(o,d),x=oy(null,o,y,i,x,d);var S=sy();return o.flags|=1,typeof x=="object"&&x!==null&&typeof x.render=="function"&&x.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,pr(y)?(S=!0,Qp(o)):S=!1,o.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,ty(o),x.updater=Tm,o.stateNode=x,x._reactInternals=o,n0(o,y,i,d),o=o0(null,o,y,!0,S,d)):(o.tag=0,bi&&S&&H0(o),ir(null,o,x,d),o=o.child),o;case 16:y=o.elementType;e:{switch(jp(i,o),i=o.pendingProps,x=y._init,y=x(y._payload),o.type=y,x=o.tag=OA(y),i=sa(y,i),x){case 0:o=a0(null,o,y,i,d);break e;case 1:o=rx(null,o,y,i,d);break e;case 11:o=ix(null,o,y,i,d);break e;case 14:o=nx(null,o,y,sa(y.type,i),d);break e}throw Error(Ge(306,y,""))}return o;case 0:return y=o.type,x=o.pendingProps,x=o.elementType===y?x:sa(y,x),a0(i,o,y,x,d);case 1:return y=o.type,x=o.pendingProps,x=o.elementType===y?x:sa(y,x),rx(i,o,y,x,d);case 3:e:{if(Tb(o),i===null)throw Error(Ge(387));y=o.pendingProps,S=o.memoizedState,x=S.element,eb(i,o),rm(o,y,null,d);var b=o.memoizedState;if(y=b.element,S.isDehydrated)if(S={element:y,isDehydrated:!1,cache:b.cache,pendingSuspenseBoundaries:b.pendingSuspenseBoundaries,transitions:b.transitions},o.updateQueue.baseState=S,o.memoizedState=S,o.flags&256){x=Bc(Error(Ge(423)),o),o=ax(i,o,y,d,x);break e}else if(y!==x){x=Bc(Error(Ge(424)),o),o=ax(i,o,y,d,x);break e}else for(kr=Ko(o.stateNode.containerInfo.firstChild),Mr=o,bi=!0,ca=null,d=J1(o,null,y,d),o.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(Lc(),y===x){o=go(i,o,d);break e}ir(i,o,y,d)}o=o.child}return o;case 5:return tb(o),i===null&&e0(o),y=o.type,x=o.pendingProps,S=i!==null?i.memoizedProps:null,b=x.children,Xg(y,x)?b=null:S!==null&&Xg(y,S)&&(o.flags|=32),Sb(i,o),ir(i,o,b,d),o.child;case 6:return i===null&&e0(o),null;case 13:return Pb(i,o,d);case 4:return iy(o,o.stateNode.containerInfo),y=o.pendingProps,i===null?o.child=Rc(o,null,y,d):ir(i,o,y,d),o.child;case 11:return y=o.type,x=o.pendingProps,x=o.elementType===y?x:sa(y,x),ix(i,o,y,x,d);case 7:return ir(i,o,o.pendingProps,d),o.child;case 8:return ir(i,o,o.pendingProps.children,d),o.child;case 12:return ir(i,o,o.pendingProps.children,d),o.child;case 10:e:{if(y=o.type._context,x=o.pendingProps,S=o.memoizedProps,b=x.value,hi(im,y._currentValue),y._currentValue=b,S!==null)if(da(S.value,b)){if(S.children===x.children&&!dr.current){o=go(i,o,d);break e}}else for(S=o.child,S!==null&&(S.return=o);S!==null;){var c=S.dependencies;if(c!==null){b=S.child;for(var F=c.firstContext;F!==null;){if(F.context===y){if(S.tag===1){F=ho(-1,d&-d),F.tag=2;var W=S.updateQueue;if(W!==null){W=W.shared;var se=W.pending;se===null?F.next=F:(F.next=se.next,se.next=F),W.pending=F}}S.lanes|=d,F=S.alternate,F!==null&&(F.lanes|=d),t0(S.return,d,o),c.lanes|=d;break}F=F.next}}else if(S.tag===10)b=S.type===o.type?null:S.child;else if(S.tag===18){if(b=S.return,b===null)throw Error(Ge(341));b.lanes|=d,c=b.alternate,c!==null&&(c.lanes|=d),t0(b,d,o),b=S.sibling}else b=S.child;if(b!==null)b.return=S;else for(b=S;b!==null;){if(b===o){b=null;break}if(S=b.sibling,S!==null){S.return=b.return,b=S;break}b=b.return}S=b}ir(i,o,x.children,d),o=o.child}return o;case 9:return x=o.type,y=o.pendingProps.children,Ec(o,d),x=qr(x),y=y(x),o.flags|=1,ir(i,o,y,d),o.child;case 14:return y=o.type,x=sa(y,o.pendingProps),x=sa(y.type,x),nx(i,o,y,x,d);case 15:return Ib(i,o,o.type,o.pendingProps,d);case 17:return y=o.type,x=o.pendingProps,x=o.elementType===y?x:sa(y,x),jp(i,o),o.tag=1,pr(y)?(i=!0,Qp(o)):i=!1,Ec(o,d),bb(o,y,x),n0(o,y,x,d),o0(null,o,y,!0,i,d);case 19:return kb(i,o,d);case 22:return Ab(i,o,d)}throw Error(Ge(156,o.tag))};function Gb(i,o){return _1(i,o)}function jA(i,o,d,y){this.tag=i,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Gr(i,o,d,y){return new jA(i,o,d,y)}function yy(i){return i=i.prototype,!(!i||!i.isReactComponent)}function OA(i){if(typeof i=="function")return yy(i)?1:0;if(i!=null){if(i=i.$$typeof,i===R0)return 11;if(i===F0)return 14}return 2}function es(i,o){var d=i.alternate;return d===null?(d=Gr(i.tag,o,i.key,i.mode),d.elementType=i.elementType,d.type=i.type,d.stateNode=i.stateNode,d.alternate=i,i.alternate=d):(d.pendingProps=o,d.type=i.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=i.flags&14680064,d.childLanes=i.childLanes,d.lanes=i.lanes,d.child=i.child,d.memoizedProps=i.memoizedProps,d.memoizedState=i.memoizedState,d.updateQueue=i.updateQueue,o=i.dependencies,d.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},d.sibling=i.sibling,d.index=i.index,d.ref=i.ref,d}function Up(i,o,d,y,x,S){var b=2;if(y=i,typeof i=="function")yy(i)&&(b=1);else if(typeof i=="string")b=5;else e:switch(i){case gc:return Qs(d.children,x,S,o);case L0:b=8,x|=8;break;case Tg:return i=Gr(12,d,o,x|2),i.elementType=Tg,i.lanes=S,i;case Pg:return i=Gr(13,d,o,x),i.elementType=Pg,i.lanes=S,i;case kg:return i=Gr(19,d,o,x),i.elementType=kg,i.lanes=S,i;case t1:return Mm(d,x,S,o);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case Qx:b=10;break e;case e1:b=9;break e;case R0:b=11;break e;case F0:b=14;break e;case Oo:b=16,y=null;break e}throw Error(Ge(130,i==null?i:typeof i,""))}return o=Gr(b,d,o,x),o.elementType=i,o.type=y,o.lanes=S,o}function Qs(i,o,d,y){return i=Gr(7,i,y,o),i.lanes=d,i}function Mm(i,o,d,y){return i=Gr(22,i,y,o),i.elementType=t1,i.lanes=d,i.stateNode={isHidden:!1},i}function xg(i,o,d){return i=Gr(6,i,null,o),i.lanes=d,i}function bg(i,o,d){return o=Gr(4,i.children!==null?i.children:[],i.key,o),o.lanes=d,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}function VA(i,o,d,y,x){this.tag=o,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=tg(0),this.expirationTimes=tg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tg(0),this.identifierPrefix=y,this.onRecoverableError=x,this.mutableSourceEagerHydrationData=null}function _y(i,o,d,y,x,S,b,c,F){return i=new VA(i,o,d,c,F),o===1?(o=1,S===!0&&(o|=8)):o=0,S=Gr(3,null,null,o),i.current=S,S.stateNode=i,S.memoizedState={element:y,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},ty(S),i}function UA(i,o,d){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:fc,key:y==null?null:""+y,children:i,containerInfo:o,implementation:d}}function Wb(i){if(!i)return ns;i=i._reactInternals;e:{if(ol(i)!==i||i.tag!==1)throw Error(Ge(170));var o=i;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(pr(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(Ge(171))}if(i.tag===1){var d=i.type;if(pr(d))return W1(i,d,o)}return o}function qb(i,o,d,y,x,S,b,c,F){return i=_y(d,y,!0,i,x,S,b,c,F),i.context=Wb(null),d=i.current,y=nr(),x=Qo(d),S=ho(y,x),S.callback=o??null,Yo(d,S,x),i.current.lanes=x,qh(i,x,y),mr(i,y),i}function Em(i,o,d,y){var x=o.current,S=nr(),b=Qo(x);return d=Wb(d),o.context===null?o.context=d:o.pendingContext=d,o=ho(S,b),o.payload={element:i},y=y===void 0?null:y,y!==null&&(o.callback=y),i=Yo(x,o,b),i!==null&&(ha(i,x,b,S),Rp(i,x,b)),b}function dm(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function fx(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var d=i.retryLane;i.retryLane=d!==0&&d<o?d:o}}function vy(i,o){fx(i,o),(i=i.alternate)&&fx(i,o)}function $A(){return null}var Hb=typeof reportError=="function"?reportError:function(i){console.error(i)};function xy(i){this._internalRoot=i}zm.prototype.render=xy.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(Ge(409));Em(i,o,null,null)};zm.prototype.unmount=xy.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;rl(function(){Em(null,i,null,null)}),o[mo]=null}};function zm(i){this._internalRoot=i}zm.prototype.unstable_scheduleHydration=function(i){if(i){var o=A1();i={blockedOn:null,target:i,priority:o};for(var d=0;d<Uo.length&&o!==0&&o<Uo[d].priority;d++);Uo.splice(d,0,i),d===0&&T1(i)}};function by(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function Nm(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function gx(){}function ZA(i,o,d,y,x){if(x){if(typeof y=="function"){var S=y;y=function(){var W=dm(b);S.call(W)}}var b=qb(o,y,i,0,null,!1,!1,"",gx);return i._reactRootContainer=b,i[mo]=b.current,Dh(i.nodeType===8?i.parentNode:i),rl(),b}for(;x=i.lastChild;)i.removeChild(x);if(typeof y=="function"){var c=y;y=function(){var W=dm(F);c.call(W)}}var F=_y(i,0,!1,null,null,!1,!1,"",gx);return i._reactRootContainer=F,i[mo]=F.current,Dh(i.nodeType===8?i.parentNode:i),rl(function(){Em(o,F,d,y)}),F}function Dm(i,o,d,y,x){var S=d._reactRootContainer;if(S){var b=S;if(typeof x=="function"){var c=x;x=function(){var F=dm(b);c.call(F)}}Em(o,b,i,x)}else b=ZA(d,o,i,x,y);return dm(b)}C1=function(i){switch(i.tag){case 3:var o=i.stateNode;if(o.current.memoizedState.isDehydrated){var d=fh(o.pendingLanes);d!==0&&(O0(o,d|1),mr(o,Gi()),!(Bt&6)&&(jc=Gi()+500,os()))}break;case 13:rl(function(){var y=fo(i,1);if(y!==null){var x=nr();ha(y,i,1,x)}}),vy(i,1)}};V0=function(i){if(i.tag===13){var o=fo(i,134217728);if(o!==null){var d=nr();ha(o,i,134217728,d)}vy(i,134217728)}};I1=function(i){if(i.tag===13){var o=Qo(i),d=fo(i,o);if(d!==null){var y=nr();ha(d,i,o,y)}vy(i,o)}};A1=function(){return qt};S1=function(i,o){var d=qt;try{return qt=i,o()}finally{qt=d}};jg=function(i,o,d){switch(o){case"input":if(zg(i,d),o=d.name,d.type==="radio"&&o!=null){for(d=i;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<d.length;o++){var y=d[o];if(y!==i&&y.form===i.form){var x=Im(y);if(!x)throw Error(Ge(90));n1(y),zg(y,x)}}}break;case"textarea":a1(i,d);break;case"select":o=d.value,o!=null&&Tc(i,!!d.multiple,o,!1)}};d1=my;p1=rl;var GA={usingClientEntryPoint:!1,Events:[Xh,xc,Im,u1,h1,my]},dh={findFiberByHostInstance:Xs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},WA={bundleType:dh.bundleType,version:dh.version,rendererPackageName:dh.rendererPackageName,rendererConfig:dh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:yo.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=g1(i),i===null?null:i.stateNode},findFiberByHostInstance:dh.findFiberByHostInstance||$A,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Tp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Tp.isDisabled&&Tp.supportsFiber)try{xm=Tp.inject(WA),Ea=Tp}catch{}}zr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=GA;zr.createPortal=function(i,o){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!by(o))throw Error(Ge(200));return UA(i,o,null,d)};zr.createRoot=function(i,o){if(!by(i))throw Error(Ge(299));var d=!1,y="",x=Hb;return o!=null&&(o.unstable_strictMode===!0&&(d=!0),o.identifierPrefix!==void 0&&(y=o.identifierPrefix),o.onRecoverableError!==void 0&&(x=o.onRecoverableError)),o=_y(i,1,!1,null,null,d,!1,y,x),i[mo]=o.current,Dh(i.nodeType===8?i.parentNode:i),new xy(o)};zr.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(Ge(188)):(i=Object.keys(i).join(","),Error(Ge(268,i)));return i=g1(o),i=i===null?null:i.stateNode,i};zr.flushSync=function(i){return rl(i)};zr.hydrate=function(i,o,d){if(!Nm(o))throw Error(Ge(200));return Dm(null,i,o,!0,d)};zr.hydrateRoot=function(i,o,d){if(!by(i))throw Error(Ge(405));var y=d!=null&&d.hydratedSources||null,x=!1,S="",b=Hb;if(d!=null&&(d.unstable_strictMode===!0&&(x=!0),d.identifierPrefix!==void 0&&(S=d.identifierPrefix),d.onRecoverableError!==void 0&&(b=d.onRecoverableError)),o=qb(o,null,i,1,d??null,x,!1,S,b),i[mo]=o.current,Dh(i),y)for(i=0;i<y.length;i++)d=y[i],x=d._getVersion,x=x(d._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[d,x]:o.mutableSourceEagerHydrationData.push(d,x);return new zm(o)};zr.render=function(i,o,d){if(!Nm(o))throw Error(Ge(200));return Dm(null,i,o,!1,d)};zr.unmountComponentAtNode=function(i){if(!Nm(i))throw Error(Ge(40));return i._reactRootContainer?(rl(function(){Dm(null,null,i,!1,function(){i._reactRootContainer=null,i[mo]=null})}),!0):!1};zr.unstable_batchedUpdates=my;zr.unstable_renderSubtreeIntoContainer=function(i,o,d,y){if(!Nm(d))throw Error(Ge(200));if(i==null||i._reactInternals===void 0)throw Error(Ge(38));return Dm(i,o,d,!1,y)};zr.version="18.3.1-next-f1338f8080-20240426";function Xb(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Xb)}catch(i){console.error(i)}}Xb(),Xx.exports=zr;var qA=Xx.exports,yx=qA;Ag.createRoot=yx.createRoot,Ag.hydrateRoot=yx.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $h(){return $h=Object.assign?Object.assign.bind():function(i){for(var o=1;o<arguments.length;o++){var d=arguments[o];for(var y in d)Object.prototype.hasOwnProperty.call(d,y)&&(i[y]=d[y])}return i},$h.apply(this,arguments)}var Wo;(function(i){i.Pop="POP",i.Push="PUSH",i.Replace="REPLACE"})(Wo||(Wo={}));const _x="popstate";function HA(i){i===void 0&&(i={});function o(y,x){let{pathname:S,search:b,hash:c}=y.location;return _0("",{pathname:S,search:b,hash:c},x.state&&x.state.usr||null,x.state&&x.state.key||"default")}function d(y,x){return typeof x=="string"?x:pm(x)}return KA(o,d,null,i)}function Wi(i,o){if(i===!1||i===null||typeof i>"u")throw new Error(o)}function Kb(i,o){if(!i){typeof console<"u"&&console.warn(o);try{throw new Error(o)}catch{}}}function XA(){return Math.random().toString(36).substr(2,8)}function vx(i,o){return{usr:i.state,key:i.key,idx:o}}function _0(i,o,d,y){return d===void 0&&(d=null),$h({pathname:typeof i=="string"?i:i.pathname,search:"",hash:""},typeof o=="string"?Zc(o):o,{state:d,key:o&&o.key||y||XA()})}function pm(i){let{pathname:o="/",search:d="",hash:y=""}=i;return d&&d!=="?"&&(o+=d.charAt(0)==="?"?d:"?"+d),y&&y!=="#"&&(o+=y.charAt(0)==="#"?y:"#"+y),o}function Zc(i){let o={};if(i){let d=i.indexOf("#");d>=0&&(o.hash=i.substr(d),i=i.substr(0,d));let y=i.indexOf("?");y>=0&&(o.search=i.substr(y),i=i.substr(0,y)),i&&(o.pathname=i)}return o}function KA(i,o,d,y){y===void 0&&(y={});let{window:x=document.defaultView,v5Compat:S=!1}=y,b=x.history,c=Wo.Pop,F=null,W=se();W==null&&(W=0,b.replaceState($h({},b.state,{idx:W}),""));function se(){return(b.state||{idx:null}).idx}function re(){c=Wo.Pop;let We=se(),he=We==null?null:We-W;W=We,F&&F({action:c,location:Te.location,delta:he})}function ce(We,he){c=Wo.Push;let oe=_0(Te.location,We,he);d&&d(oe,We),W=se()+1;let fe=vx(oe,W),De=Te.createHref(oe);try{b.pushState(fe,"",De)}catch(Xe){if(Xe instanceof DOMException&&Xe.name==="DataCloneError")throw Xe;x.location.assign(De)}S&&F&&F({action:c,location:Te.location,delta:1})}function K(We,he){c=Wo.Replace;let oe=_0(Te.location,We,he);d&&d(oe,We),W=se();let fe=vx(oe,W),De=Te.createHref(oe);b.replaceState(fe,"",De),S&&F&&F({action:c,location:Te.location,delta:0})}function Ie(We){let he=x.location.origin!=="null"?x.location.origin:x.location.href,oe=typeof We=="string"?We:pm(We);return oe=oe.replace(/ $/,"%20"),Wi(he,"No window.location.(origin|href) available to create URL for href: "+oe),new URL(oe,he)}let Te={get action(){return c},get location(){return i(x,b)},listen(We){if(F)throw new Error("A history only accepts one active listener");return x.addEventListener(_x,re),F=We,()=>{x.removeEventListener(_x,re),F=null}},createHref(We){return o(x,We)},createURL:Ie,encodeLocation(We){let he=Ie(We);return{pathname:he.pathname,search:he.search,hash:he.hash}},push:ce,replace:K,go(We){return b.go(We)}};return Te}var xx;(function(i){i.data="data",i.deferred="deferred",i.redirect="redirect",i.error="error"})(xx||(xx={}));function YA(i,o,d){return d===void 0&&(d="/"),JA(i,o,d,!1)}function JA(i,o,d,y){let x=typeof o=="string"?Zc(o):o,S=wy(x.pathname||"/",d);if(S==null)return null;let b=Yb(i);QA(b);let c=null;for(let F=0;c==null&&F<b.length;++F){let W=uS(S);c=lS(b[F],W,y)}return c}function Yb(i,o,d,y){o===void 0&&(o=[]),d===void 0&&(d=[]),y===void 0&&(y="");let x=(S,b,c)=>{let F={relativePath:c===void 0?S.path||"":c,caseSensitive:S.caseSensitive===!0,childrenIndex:b,route:S};F.relativePath.startsWith("/")&&(Wi(F.relativePath.startsWith(y),'Absolute route path "'+F.relativePath+'" nested under path '+('"'+y+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),F.relativePath=F.relativePath.slice(y.length));let W=ts([y,F.relativePath]),se=d.concat(F);S.children&&S.children.length>0&&(Wi(S.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+W+'".')),Yb(S.children,o,se,W)),!(S.path==null&&!S.index)&&o.push({path:W,score:oS(W,S.index),routesMeta:se})};return i.forEach((S,b)=>{var c;if(S.path===""||!((c=S.path)!=null&&c.includes("?")))x(S,b);else for(let F of Jb(S.path))x(S,b,F)}),o}function Jb(i){let o=i.split("/");if(o.length===0)return[];let[d,...y]=o,x=d.endsWith("?"),S=d.replace(/\?$/,"");if(y.length===0)return x?[S,""]:[S];let b=Jb(y.join("/")),c=[];return c.push(...b.map(F=>F===""?S:[S,F].join("/"))),x&&c.push(...b),c.map(F=>i.startsWith("/")&&F===""?"/":F)}function QA(i){i.sort((o,d)=>o.score!==d.score?d.score-o.score:sS(o.routesMeta.map(y=>y.childrenIndex),d.routesMeta.map(y=>y.childrenIndex)))}const eS=/^:[\w-]+$/,tS=3,iS=2,nS=1,rS=10,aS=-2,bx=i=>i==="*";function oS(i,o){let d=i.split("/"),y=d.length;return d.some(bx)&&(y+=aS),o&&(y+=iS),d.filter(x=>!bx(x)).reduce((x,S)=>x+(eS.test(S)?tS:S===""?nS:rS),y)}function sS(i,o){return i.length===o.length&&i.slice(0,-1).every((y,x)=>y===o[x])?i[i.length-1]-o[o.length-1]:0}function lS(i,o,d){d===void 0&&(d=!1);let{routesMeta:y}=i,x={},S="/",b=[];for(let c=0;c<y.length;++c){let F=y[c],W=c===y.length-1,se=S==="/"?o:o.slice(S.length)||"/",re=wx({path:F.relativePath,caseSensitive:F.caseSensitive,end:W},se),ce=F.route;if(!re&&W&&d&&!y[y.length-1].route.index&&(re=wx({path:F.relativePath,caseSensitive:F.caseSensitive,end:!1},se)),!re)return null;Object.assign(x,re.params),b.push({params:x,pathname:ts([S,re.pathname]),pathnameBase:mS(ts([S,re.pathnameBase])),route:ce}),re.pathnameBase!=="/"&&(S=ts([S,re.pathnameBase]))}return b}function wx(i,o){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[d,y]=cS(i.path,i.caseSensitive,i.end),x=o.match(d);if(!x)return null;let S=x[0],b=S.replace(/(.)\/+$/,"$1"),c=x.slice(1);return{params:y.reduce((W,se,re)=>{let{paramName:ce,isOptional:K}=se;if(ce==="*"){let Te=c[re]||"";b=S.slice(0,S.length-Te.length).replace(/(.)\/+$/,"$1")}const Ie=c[re];return K&&!Ie?W[ce]=void 0:W[ce]=(Ie||"").replace(/%2F/g,"/"),W},{}),pathname:S,pathnameBase:b,pattern:i}}function cS(i,o,d){o===void 0&&(o=!1),d===void 0&&(d=!0),Kb(i==="*"||!i.endsWith("*")||i.endsWith("/*"),'Route path "'+i+'" will be treated as if it were '+('"'+i.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+i.replace(/\*$/,"/*")+'".'));let y=[],x="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(b,c,F)=>(y.push({paramName:c,isOptional:F!=null}),F?"/?([^\\/]+)?":"/([^\\/]+)"));return i.endsWith("*")?(y.push({paramName:"*"}),x+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):d?x+="\\/*$":i!==""&&i!=="/"&&(x+="(?:(?=\\/|$))"),[new RegExp(x,o?void 0:"i"),y]}function uS(i){try{return i.split("/").map(o=>decodeURIComponent(o).replace(/\//g,"%2F")).join("/")}catch(o){return Kb(!1,'The URL path "'+i+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+o+").")),i}}function wy(i,o){if(o==="/")return i;if(!i.toLowerCase().startsWith(o.toLowerCase()))return null;let d=o.endsWith("/")?o.length-1:o.length,y=i.charAt(d);return y&&y!=="/"?null:i.slice(d)||"/"}function hS(i,o){o===void 0&&(o="/");let{pathname:d,search:y="",hash:x=""}=typeof i=="string"?Zc(i):i;return{pathname:d?d.startsWith("/")?d:dS(d,o):o,search:fS(y),hash:gS(x)}}function dS(i,o){let d=o.replace(/\/+$/,"").split("/");return i.split("/").forEach(x=>{x===".."?d.length>1&&d.pop():x!=="."&&d.push(x)}),d.length>1?d.join("/"):"/"}function wg(i,o,d,y){return"Cannot include a '"+i+"' character in a manually specified "+("`to."+o+"` field ["+JSON.stringify(y)+"].  Please separate it out to the ")+("`to."+d+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function pS(i){return i.filter((o,d)=>d===0||o.route.path&&o.route.path.length>0)}function Cy(i,o){let d=pS(i);return o?d.map((y,x)=>x===d.length-1?y.pathname:y.pathnameBase):d.map(y=>y.pathnameBase)}function Iy(i,o,d,y){y===void 0&&(y=!1);let x;typeof i=="string"?x=Zc(i):(x=$h({},i),Wi(!x.pathname||!x.pathname.includes("?"),wg("?","pathname","search",x)),Wi(!x.pathname||!x.pathname.includes("#"),wg("#","pathname","hash",x)),Wi(!x.search||!x.search.includes("#"),wg("#","search","hash",x)));let S=i===""||x.pathname==="",b=S?"/":x.pathname,c;if(b==null)c=d;else{let re=o.length-1;if(!y&&b.startsWith("..")){let ce=b.split("/");for(;ce[0]==="..";)ce.shift(),re-=1;x.pathname=ce.join("/")}c=re>=0?o[re]:"/"}let F=hS(x,c),W=b&&b!=="/"&&b.endsWith("/"),se=(S||b===".")&&d.endsWith("/");return!F.pathname.endsWith("/")&&(W||se)&&(F.pathname+="/"),F}const ts=i=>i.join("/").replace(/\/\/+/g,"/"),mS=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),fS=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,gS=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i;function yS(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}const Qb=["post","put","patch","delete"];new Set(Qb);const _S=["get",...Qb];new Set(_S);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Zh(){return Zh=Object.assign?Object.assign.bind():function(i){for(var o=1;o<arguments.length;o++){var d=arguments[o];for(var y in d)Object.prototype.hasOwnProperty.call(d,y)&&(i[y]=d[y])}return i},Zh.apply(this,arguments)}const Ay=Me.createContext(null),vS=Me.createContext(null),ss=Me.createContext(null),Lm=Me.createContext(null),_o=Me.createContext({outlet:null,matches:[],isDataRoute:!1}),ew=Me.createContext(null);function xS(i,o){let{relative:d}=o===void 0?{}:o;Gc()||Wi(!1);let{basename:y,navigator:x}=Me.useContext(ss),{hash:S,pathname:b,search:c}=iw(i,{relative:d}),F=b;return y!=="/"&&(F=b==="/"?y:ts([y,b])),x.createHref({pathname:F,search:c,hash:S})}function Gc(){return Me.useContext(Lm)!=null}function Yh(){return Gc()||Wi(!1),Me.useContext(Lm).location}function tw(i){Me.useContext(ss).static||Me.useLayoutEffect(i)}function sl(){let{isDataRoute:i}=Me.useContext(_o);return i?DS():bS()}function bS(){Gc()||Wi(!1);let i=Me.useContext(Ay),{basename:o,future:d,navigator:y}=Me.useContext(ss),{matches:x}=Me.useContext(_o),{pathname:S}=Yh(),b=JSON.stringify(Cy(x,d.v7_relativeSplatPath)),c=Me.useRef(!1);return tw(()=>{c.current=!0}),Me.useCallback(function(W,se){if(se===void 0&&(se={}),!c.current)return;if(typeof W=="number"){y.go(W);return}let re=Iy(W,JSON.parse(b),S,se.relative==="path");i==null&&o!=="/"&&(re.pathname=re.pathname==="/"?o:ts([o,re.pathname])),(se.replace?y.replace:y.push)(re,se.state,se)},[o,y,b,S,i])}function wS(){let{matches:i}=Me.useContext(_o),o=i[i.length-1];return o?o.params:{}}function iw(i,o){let{relative:d}=o===void 0?{}:o,{future:y}=Me.useContext(ss),{matches:x}=Me.useContext(_o),{pathname:S}=Yh(),b=JSON.stringify(Cy(x,y.v7_relativeSplatPath));return Me.useMemo(()=>Iy(i,JSON.parse(b),S,d==="path"),[i,b,S,d])}function CS(i,o){return IS(i,o)}function IS(i,o,d,y){Gc()||Wi(!1);let{navigator:x}=Me.useContext(ss),{matches:S}=Me.useContext(_o),b=S[S.length-1],c=b?b.params:{};b&&b.pathname;let F=b?b.pathnameBase:"/";b&&b.route;let W=Yh(),se;if(o){var re;let We=typeof o=="string"?Zc(o):o;F==="/"||(re=We.pathname)!=null&&re.startsWith(F)||Wi(!1),se=We}else se=W;let ce=se.pathname||"/",K=ce;if(F!=="/"){let We=F.replace(/^\//,"").split("/");K="/"+ce.replace(/^\//,"").split("/").slice(We.length).join("/")}let Ie=YA(i,{pathname:K}),Te=kS(Ie&&Ie.map(We=>Object.assign({},We,{params:Object.assign({},c,We.params),pathname:ts([F,x.encodeLocation?x.encodeLocation(We.pathname).pathname:We.pathname]),pathnameBase:We.pathnameBase==="/"?F:ts([F,x.encodeLocation?x.encodeLocation(We.pathnameBase).pathname:We.pathnameBase])})),S,d,y);return o&&Te?Me.createElement(Lm.Provider,{value:{location:Zh({pathname:"/",search:"",hash:"",state:null,key:"default"},se),navigationType:Wo.Pop}},Te):Te}function AS(){let i=NS(),o=yS(i)?i.status+" "+i.statusText:i instanceof Error?i.message:JSON.stringify(i),d=i instanceof Error?i.stack:null,x={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},S=null;return Me.createElement(Me.Fragment,null,Me.createElement("h2",null,"Unexpected Application Error!"),Me.createElement("h3",{style:{fontStyle:"italic"}},o),d?Me.createElement("pre",{style:x},d):null,S)}const SS=Me.createElement(AS,null);class TS extends Me.Component{constructor(o){super(o),this.state={location:o.location,revalidation:o.revalidation,error:o.error}}static getDerivedStateFromError(o){return{error:o}}static getDerivedStateFromProps(o,d){return d.location!==o.location||d.revalidation!=="idle"&&o.revalidation==="idle"?{error:o.error,location:o.location,revalidation:o.revalidation}:{error:o.error!==void 0?o.error:d.error,location:d.location,revalidation:o.revalidation||d.revalidation}}componentDidCatch(o,d){console.error("React Router caught the following error during render",o,d)}render(){return this.state.error!==void 0?Me.createElement(_o.Provider,{value:this.props.routeContext},Me.createElement(ew.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function PS(i){let{routeContext:o,match:d,children:y}=i,x=Me.useContext(Ay);return x&&x.static&&x.staticContext&&(d.route.errorElement||d.route.ErrorBoundary)&&(x.staticContext._deepestRenderedBoundaryId=d.route.id),Me.createElement(_o.Provider,{value:o},y)}function kS(i,o,d,y){var x;if(o===void 0&&(o=[]),d===void 0&&(d=null),y===void 0&&(y=null),i==null){var S;if(!d)return null;if(d.errors)i=d.matches;else if((S=y)!=null&&S.v7_partialHydration&&o.length===0&&!d.initialized&&d.matches.length>0)i=d.matches;else return null}let b=i,c=(x=d)==null?void 0:x.errors;if(c!=null){let se=b.findIndex(re=>re.route.id&&(c==null?void 0:c[re.route.id])!==void 0);se>=0||Wi(!1),b=b.slice(0,Math.min(b.length,se+1))}let F=!1,W=-1;if(d&&y&&y.v7_partialHydration)for(let se=0;se<b.length;se++){let re=b[se];if((re.route.HydrateFallback||re.route.hydrateFallbackElement)&&(W=se),re.route.id){let{loaderData:ce,errors:K}=d,Ie=re.route.loader&&ce[re.route.id]===void 0&&(!K||K[re.route.id]===void 0);if(re.route.lazy||Ie){F=!0,W>=0?b=b.slice(0,W+1):b=[b[0]];break}}}return b.reduceRight((se,re,ce)=>{let K,Ie=!1,Te=null,We=null;d&&(K=c&&re.route.id?c[re.route.id]:void 0,Te=re.route.errorElement||SS,F&&(W<0&&ce===0?(LS("route-fallback",!1),Ie=!0,We=null):W===ce&&(Ie=!0,We=re.route.hydrateFallbackElement||null)));let he=o.concat(b.slice(0,ce+1)),oe=()=>{let fe;return K?fe=Te:Ie?fe=We:re.route.Component?fe=Me.createElement(re.route.Component,null):re.route.element?fe=re.route.element:fe=se,Me.createElement(PS,{match:re,routeContext:{outlet:se,matches:he,isDataRoute:d!=null},children:fe})};return d&&(re.route.ErrorBoundary||re.route.errorElement||ce===0)?Me.createElement(TS,{location:d.location,revalidation:d.revalidation,component:Te,error:K,children:oe(),routeContext:{outlet:null,matches:he,isDataRoute:!0}}):oe()},null)}var nw=function(i){return i.UseBlocker="useBlocker",i.UseRevalidator="useRevalidator",i.UseNavigateStable="useNavigate",i}(nw||{}),mm=function(i){return i.UseBlocker="useBlocker",i.UseLoaderData="useLoaderData",i.UseActionData="useActionData",i.UseRouteError="useRouteError",i.UseNavigation="useNavigation",i.UseRouteLoaderData="useRouteLoaderData",i.UseMatches="useMatches",i.UseRevalidator="useRevalidator",i.UseNavigateStable="useNavigate",i.UseRouteId="useRouteId",i}(mm||{});function MS(i){let o=Me.useContext(Ay);return o||Wi(!1),o}function ES(i){let o=Me.useContext(vS);return o||Wi(!1),o}function zS(i){let o=Me.useContext(_o);return o||Wi(!1),o}function rw(i){let o=zS(),d=o.matches[o.matches.length-1];return d.route.id||Wi(!1),d.route.id}function NS(){var i;let o=Me.useContext(ew),d=ES(mm.UseRouteError),y=rw(mm.UseRouteError);return o!==void 0?o:(i=d.errors)==null?void 0:i[y]}function DS(){let{router:i}=MS(nw.UseNavigateStable),o=rw(mm.UseNavigateStable),d=Me.useRef(!1);return tw(()=>{d.current=!0}),Me.useCallback(function(x,S){S===void 0&&(S={}),d.current&&(typeof x=="number"?i.navigate(x):i.navigate(x,Zh({fromRouteId:o},S)))},[i,o])}const Cx={};function LS(i,o,d){!o&&!Cx[i]&&(Cx[i]=!0)}function RS(i,o){i==null||i.v7_startTransition,(i==null?void 0:i.v7_relativeSplatPath)===void 0&&(!o||o.v7_relativeSplatPath),o&&(o.v7_fetcherPersist,o.v7_normalizeFormMethod,o.v7_partialHydration,o.v7_skipActionErrorRevalidation)}function FS(i){let{to:o,replace:d,state:y,relative:x}=i;Gc()||Wi(!1);let{future:S,static:b}=Me.useContext(ss),{matches:c}=Me.useContext(_o),{pathname:F}=Yh(),W=sl(),se=Iy(o,Cy(c,S.v7_relativeSplatPath),F,x==="path"),re=JSON.stringify(se);return Me.useEffect(()=>W(JSON.parse(re),{replace:d,state:y,relative:x}),[W,re,x,d,y]),null}function Un(i){Wi(!1)}function BS(i){let{basename:o="/",children:d=null,location:y,navigationType:x=Wo.Pop,navigator:S,static:b=!1,future:c}=i;Gc()&&Wi(!1);let F=o.replace(/^\/*/,"/"),W=Me.useMemo(()=>({basename:F,navigator:S,static:b,future:Zh({v7_relativeSplatPath:!1},c)}),[F,c,S,b]);typeof y=="string"&&(y=Zc(y));let{pathname:se="/",search:re="",hash:ce="",state:K=null,key:Ie="default"}=y,Te=Me.useMemo(()=>{let We=wy(se,F);return We==null?null:{location:{pathname:We,search:re,hash:ce,state:K,key:Ie},navigationType:x}},[F,se,re,ce,K,Ie,x]);return Te==null?null:Me.createElement(ss.Provider,{value:W},Me.createElement(Lm.Provider,{children:d,value:Te}))}function jS(i){let{children:o,location:d}=i;return CS(v0(o),d)}new Promise(()=>{});function v0(i,o){o===void 0&&(o=[]);let d=[];return Me.Children.forEach(i,(y,x)=>{if(!Me.isValidElement(y))return;let S=[...o,x];if(y.type===Me.Fragment){d.push.apply(d,v0(y.props.children,S));return}y.type!==Un&&Wi(!1),!y.props.index||!y.props.children||Wi(!1);let b={id:y.props.id||S.join("-"),caseSensitive:y.props.caseSensitive,element:y.props.element,Component:y.props.Component,index:y.props.index,path:y.props.path,loader:y.props.loader,action:y.props.action,errorElement:y.props.errorElement,ErrorBoundary:y.props.ErrorBoundary,hasErrorBoundary:y.props.ErrorBoundary!=null||y.props.errorElement!=null,shouldRevalidate:y.props.shouldRevalidate,handle:y.props.handle,lazy:y.props.lazy};y.props.children&&(b.children=v0(y.props.children,S)),d.push(b)}),d}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function x0(){return x0=Object.assign?Object.assign.bind():function(i){for(var o=1;o<arguments.length;o++){var d=arguments[o];for(var y in d)Object.prototype.hasOwnProperty.call(d,y)&&(i[y]=d[y])}return i},x0.apply(this,arguments)}function OS(i,o){if(i==null)return{};var d={},y=Object.keys(i),x,S;for(S=0;S<y.length;S++)x=y[S],!(o.indexOf(x)>=0)&&(d[x]=i[x]);return d}function VS(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function US(i,o){return i.button===0&&(!o||o==="_self")&&!VS(i)}const $S=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],ZS="6";try{window.__reactRouterVersion=ZS}catch{}const GS="startTransition",Ix=RC[GS];function WS(i){let{basename:o,children:d,future:y,window:x}=i,S=Me.useRef();S.current==null&&(S.current=HA({window:x,v5Compat:!0}));let b=S.current,[c,F]=Me.useState({action:b.action,location:b.location}),{v7_startTransition:W}=y||{},se=Me.useCallback(re=>{W&&Ix?Ix(()=>F(re)):F(re)},[F,W]);return Me.useLayoutEffect(()=>b.listen(se),[b,se]),Me.useEffect(()=>RS(y),[y]),Me.createElement(BS,{basename:o,children:d,location:c.location,navigationType:c.action,navigator:b,future:y})}const qS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",HS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,pa=Me.forwardRef(function(o,d){let{onClick:y,relative:x,reloadDocument:S,replace:b,state:c,target:F,to:W,preventScrollReset:se,viewTransition:re}=o,ce=OS(o,$S),{basename:K}=Me.useContext(ss),Ie,Te=!1;if(typeof W=="string"&&HS.test(W)&&(Ie=W,qS))try{let fe=new URL(window.location.href),De=W.startsWith("//")?new URL(fe.protocol+W):new URL(W),Xe=wy(De.pathname,K);De.origin===fe.origin&&Xe!=null?W=Xe+De.search+De.hash:Te=!0}catch{}let We=xS(W,{relative:x}),he=XS(W,{replace:b,state:c,target:F,preventScrollReset:se,relative:x,viewTransition:re});function oe(fe){y&&y(fe),fe.defaultPrevented||he(fe)}return Me.createElement("a",x0({},ce,{href:Ie||We,onClick:Te||S?y:oe,ref:d,target:F}))});var Ax;(function(i){i.UseScrollRestoration="useScrollRestoration",i.UseSubmit="useSubmit",i.UseSubmitFetcher="useSubmitFetcher",i.UseFetcher="useFetcher",i.useViewTransitionState="useViewTransitionState"})(Ax||(Ax={}));var Sx;(function(i){i.UseFetcher="useFetcher",i.UseFetchers="useFetchers",i.UseScrollRestoration="useScrollRestoration"})(Sx||(Sx={}));function XS(i,o){let{target:d,replace:y,state:x,preventScrollReset:S,relative:b,viewTransition:c}=o===void 0?{}:o,F=sl(),W=Yh(),se=iw(i,{relative:b});return Me.useCallback(re=>{if(US(re,d)){re.preventDefault();let ce=y!==void 0?y:pm(W)===pm(se);F(i,{replace:ce,state:x,preventScrollReset:S,relative:b,viewTransition:c})}},[W,F,se,y,x,d,i,S,b,c])}const KS=()=>{const[i,o]=Me.useState(""),[d,y]=Me.useState(""),[x,S]=Me.useState(""),b=sl(),c=W=>{if(W.preventDefault(),!i||!d){S("Please enter both username and password");return}if(i==="admin"&&d==="password"||i==="field-officer"&&d==="password"||i==="user"&&d==="password"){localStorage.setItem("authToken","mock-token");let se="user";i==="admin"?se="admin":i==="field-officer"&&(se="field-officer"),localStorage.setItem("userData",JSON.stringify({username:i,role:se})),b(i==="admin"?"/admin/dashboard":i==="field-officer"?"/field/dashboard":"/user/dashboard")}else S("Invalid username or password")},F=(W,se)=>{o(W),y(se)};return A("div",{style:{fontFamily:"Arial, sans-serif",backgroundColor:"#f3f4f6",display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",margin:0},children:$("div",{style:{background:"white",padding:"2rem",borderRadius:"0.5rem",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",width:"100%",maxWidth:"400px"},children:[A("h2",{style:{textAlign:"center",marginBottom:"1.5rem",color:"#333"},children:"FRA Atlas Login"}),x&&A("div",{style:{backgroundColor:"#fee2e2",color:"#b91c1c",padding:"0.75rem",borderRadius:"0.25rem",marginBottom:"1rem"},children:x}),$("form",{onSubmit:c,children:[$("div",{style:{marginBottom:"1rem"},children:[A("label",{htmlFor:"username",style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold"},children:"Username"}),A("input",{type:"text",id:"username",value:i,onChange:W=>o(W.target.value),required:!0,style:{width:"100%",padding:"0.5rem",border:"1px solid #d1d5db",borderRadius:"0.25rem",boxSizing:"border-box"}})]}),$("div",{style:{marginBottom:"1rem"},children:[A("label",{htmlFor:"password",style:{display:"block",marginBottom:"0.5rem",fontWeight:"bold"},children:"Password"}),A("input",{type:"password",id:"password",value:d,onChange:W=>y(W.target.value),required:!0,style:{width:"100%",padding:"0.5rem",border:"1px solid #d1d5db",borderRadius:"0.25rem",boxSizing:"border-box"}})]}),A("button",{type:"submit",style:{width:"100%",padding:"0.75rem",backgroundColor:"#4f46e5",color:"white",border:"none",borderRadius:"0.25rem",cursor:"pointer",fontWeight:"bold"},children:"Sign In"})]}),$("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginTop:"1rem"},children:[A("button",{onClick:()=>F("admin","password"),style:{padding:"0.5rem",backgroundColor:"#e5e7eb",color:"#374151",border:"none",borderRadius:"0.25rem",cursor:"pointer",fontSize:"0.875rem"},children:"Admin Demo"}),A("button",{onClick:()=>F("field-officer","password"),style:{padding:"0.5rem",backgroundColor:"#e5e7eb",color:"#374151",border:"none",borderRadius:"0.25rem",cursor:"pointer",fontSize:"0.875rem"},children:"Officer Demo"})]}),A("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:"1rem",marginTop:"1rem"},children:A("button",{onClick:()=>F("user","password"),style:{padding:"0.5rem",backgroundColor:"#e5e7eb",color:"#374151",border:"none",borderRadius:"0.25rem",cursor:"pointer",fontSize:"0.875rem"},children:"User Demo"})})]})})},YS=()=>{const i=sl(),o=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("userData"),i("/login")},d=[{name:"View Map",href:"/map",icon:""},{name:"Process Claims",href:"/claims",icon:""},{name:"Digitize Documents",href:"/digitize",icon:""},{name:"Asset Mapping",href:"/asset-mapping",icon:""},{name:"DSS Engine",href:"/dss",icon:""},{name:"Reports",href:"/reports",icon:""}],y=[{id:"CR-2023-001",title:"Forest Land Claim - Village A",status:"Pending",date:"2023-05-15"},{id:"IFR-2023-002",title:"Individual Claim - Village B",status:"Approved",date:"2023-05-10"},{id:"CFR-2023-003",title:"Community Claim - Village C",status:"Under Review",date:"2023-05-05"}];return $("div",{className:"min-h-screen bg-gray-50",children:[A("div",{className:"bg-white shadow",children:A("div",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:$("div",{className:"flex justify-between items-center",children:[A("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard"}),A("button",{onClick:o,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-red-700 bg-red-100 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Logout"})]})})}),$("div",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:[$("div",{className:"px-4 py-6 sm:px-0",children:[A("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Quick Actions"}),A("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:d.map(x=>A(pa,{to:x.href,className:"bg-white overflow-hidden shadow rounded-lg hover:shadow-md transition-shadow duration-300",children:$("div",{className:"p-6 flex flex-col items-center",children:[A("div",{className:"mb-2 text-3xl",children:x.icon}),A("div",{className:"text-sm font-medium text-gray-900 text-center",children:x.name})]})},x.name))})]}),$("div",{className:"px-4 py-6 sm:px-0",children:[A("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Recent Claims"}),A("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:A("ul",{className:"divide-y divide-gray-200",children:y.map(x=>A("li",{children:A(pa,{to:`/claim/${x.id}`,className:"block hover:bg-gray-50",children:$("div",{className:"px-4 py-4 sm:px-6",children:[$("div",{className:"flex items-center justify-between",children:[A("p",{className:"text-sm font-medium text-indigo-600 truncate",children:x.id}),A("div",{className:"ml-2 flex-shrink-0 flex",children:A("p",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:x.status})})]}),$("div",{className:"mt-2 sm:flex sm:justify-between",children:[A("div",{className:"sm:flex",children:A("p",{className:"flex items-center text-sm text-gray-500",children:x.title})}),A("div",{className:"mt-2 flex items-center text-sm text-gray-500 sm:mt-0",children:A("p",{children:x.date})})]})]})})},x.id))})})]}),$("div",{className:"px-4 py-6 sm:px-0",children:[A("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Statistics"}),$("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4",children:[A("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:A("div",{className:"px-4 py-5 sm:p-6",children:$("div",{className:"flex items-center",children:[A("div",{className:"flex-shrink-0 bg-indigo-500 rounded-md p-3",children:A("svg",{className:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),A("div",{className:"ml-5 w-0 flex-1",children:$("dl",{children:[A("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Claims"}),A("dd",{className:"flex items-baseline",children:A("div",{className:"text-2xl font-semibold text-gray-900",children:"142"})})]})})]})})}),A("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:A("div",{className:"px-4 py-5 sm:p-6",children:$("div",{className:"flex items-center",children:[A("div",{className:"flex-shrink-0 bg-green-500 rounded-md p-3",children:A("svg",{className:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),A("div",{className:"ml-5 w-0 flex-1",children:$("dl",{children:[A("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Approved"}),A("dd",{className:"flex items-baseline",children:A("div",{className:"text-2xl font-semibold text-gray-900",children:"89"})})]})})]})})}),A("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:A("div",{className:"px-4 py-5 sm:p-6",children:$("div",{className:"flex items-center",children:[A("div",{className:"flex-shrink-0 bg-yellow-500 rounded-md p-3",children:A("svg",{className:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),A("div",{className:"ml-5 w-0 flex-1",children:$("dl",{children:[A("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Pending"}),A("dd",{className:"flex items-baseline",children:A("div",{className:"text-2xl font-semibold text-gray-900",children:"32"})})]})})]})})}),A("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:A("div",{className:"px-4 py-5 sm:p-6",children:$("div",{className:"flex items-center",children:[A("div",{className:"flex-shrink-0 bg-blue-500 rounded-md p-3",children:A("svg",{className:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),A("div",{className:"ml-5 w-0 flex-1",children:$("dl",{children:[A("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Active Users"}),A("dd",{className:"flex items-baseline",children:A("div",{className:"text-2xl font-semibold text-gray-900",children:"24"})})]})})]})})})]})]})]})]})},JS=()=>{const i=sl(),o=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("userData"),i("/login")},d=[{name:"View Map",href:"/map",icon:""},{name:"Manage Claims",href:"/claims",icon:""},{name:"Process Documents",href:"/digitize",icon:""},{name:"Asset Mapping",href:"/asset-mapping",icon:""},{name:"DSS Engine",href:"/dss",icon:""},{name:"Reports",href:"/reports",icon:""},{name:"User Management",href:"/admin/users",icon:""},{name:"Layer Management",href:"/admin/layers",icon:""}],y=[{id:"CR-2023-001",title:"Forest Land Claim - Village A",status:"Pending",date:"2023-05-15"},{id:"IFR-2023-002",title:"Individual Claim - Village B",status:"Approved",date:"2023-05-10"},{id:"CFR-2023-003",title:"Community Claim - Village C",status:"Under Review",date:"2023-05-05"}];return $("div",{className:"min-h-screen bg-gray-50",children:[A("div",{className:"bg-white shadow",children:A("div",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:$("div",{className:"flex justify-between items-center",children:[A("h1",{className:"text-3xl font-bold text-gray-900",children:"Admin Dashboard"}),$("div",{className:"flex items-center space-x-4",children:[A("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-indigo-100 text-indigo-800",children:"Admin"}),A("button",{onClick:o,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-red-700 bg-red-100 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Logout"})]})]})})}),$("div",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:[$("div",{className:"px-4 py-6 sm:px-0",children:[A("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Admin Quick Actions"}),A("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:d.map(x=>A(pa,{to:x.href,className:"bg-white overflow-hidden shadow rounded-lg hover:shadow-md transition-shadow duration-300",children:$("div",{className:"p-6 flex flex-col items-center",children:[A("div",{className:"mb-2 text-3xl",children:x.icon}),A("div",{className:"text-sm font-medium text-gray-900 text-center",children:x.name})]})},x.name))})]}),$("div",{className:"px-4 py-6 sm:px-0",children:[A("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"System Statistics"}),$("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4",children:[A("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:A("div",{className:"px-4 py-5 sm:p-6",children:$("div",{className:"flex items-center",children:[A("div",{className:"flex-shrink-0 bg-indigo-500 rounded-md p-3",children:A("svg",{className:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),A("div",{className:"ml-5 w-0 flex-1",children:$("dl",{children:[A("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Claims"}),A("dd",{className:"flex items-baseline",children:A("div",{className:"text-2xl font-semibold text-gray-900",children:"142"})})]})})]})})}),A("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:A("div",{className:"px-4 py-5 sm:p-6",children:$("div",{className:"flex items-center",children:[A("div",{className:"flex-shrink-0 bg-green-500 rounded-md p-3",children:A("svg",{className:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),A("div",{className:"ml-5 w-0 flex-1",children:$("dl",{children:[A("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Approved"}),A("dd",{className:"flex items-baseline",children:A("div",{className:"text-2xl font-semibold text-gray-900",children:"89"})})]})})]})})}),A("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:A("div",{className:"px-4 py-5 sm:p-6",children:$("div",{className:"flex items-center",children:[A("div",{className:"flex-shrink-0 bg-blue-500 rounded-md p-3",children:A("svg",{className:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),A("div",{className:"ml-5 w-0 flex-1",children:$("dl",{children:[A("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Active Users"}),A("dd",{className:"flex items-baseline",children:A("div",{className:"text-2xl font-semibold text-gray-900",children:"24"})})]})})]})})}),A("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:A("div",{className:"px-4 py-5 sm:p-6",children:$("div",{className:"flex items-center",children:[A("div",{className:"flex-shrink-0 bg-purple-500 rounded-md p-3",children:A("svg",{className:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),A("div",{className:"ml-5 w-0 flex-1",children:$("dl",{children:[A("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Villages"}),A("dd",{className:"flex items-baseline",children:A("div",{className:"text-2xl font-semibold text-gray-900",children:"12"})})]})})]})})})]})]}),$("div",{className:"px-4 py-6 sm:px-0",children:[A("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Recent Claims"}),A("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:A("ul",{className:"divide-y divide-gray-200",children:y.map(x=>A("li",{children:A(pa,{to:`/claim/${x.id}`,className:"block hover:bg-gray-50",children:$("div",{className:"px-4 py-4 sm:px-6",children:[$("div",{className:"flex items-center justify-between",children:[A("p",{className:"text-sm font-medium text-indigo-600 truncate",children:x.id}),A("div",{className:"ml-2 flex-shrink-0 flex",children:A("p",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:x.status})})]}),$("div",{className:"mt-2 sm:flex sm:justify-between",children:[A("div",{className:"sm:flex",children:A("p",{className:"flex items-center text-sm text-gray-500",children:x.title})}),A("div",{className:"mt-2 flex items-center text-sm text-gray-500 sm:mt-0",children:A("p",{children:x.date})})]})]})})},x.id))})})]})]})]})},QS=()=>{const i=sl(),o=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("userData"),i("/login")},d=[{name:"View Map",href:"/map",icon:""},{name:"Process Claims",href:"/claims",icon:""},{name:"Digitize Documents",href:"/digitize",icon:""},{name:"Asset Mapping",href:"/asset-mapping",icon:""},{name:"DSS Engine",href:"/dss",icon:""},{name:"Reports",href:"/reports",icon:""}],y=[{id:"CR-2023-001",title:"Forest Land Claim - Village A",status:"Pending",date:"2023-05-15"},{id:"IFR-2023-002",title:"Individual Claim - Village B",status:"Approved",date:"2023-05-10"},{id:"CFR-2023-003",title:"Community Claim - Village C",status:"Under Review",date:"2023-05-05"}],x=[{id:"task-1",title:"Review Claim CR-2023-001",priority:"High",due:"Today"},{id:"task-2",title:"Digitize Document DOC-2023-045",priority:"Medium",due:"Today"},{id:"task-3",title:"Visit Village B for Ground Truthing",priority:"High",due:"Tomorrow"}];return $("div",{className:"min-h-screen bg-gray-50",children:[A("div",{className:"bg-white shadow",children:A("div",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:$("div",{className:"flex justify-between items-center",children:[A("h1",{className:"text-3xl font-bold text-gray-900",children:"Field Officer Dashboard"}),$("div",{className:"flex items-center space-x-4",children:[A("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800",children:"Field Officer"}),A("button",{onClick:o,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-red-700 bg-red-100 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Logout"})]})]})})}),$("div",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:[$("div",{className:"px-4 py-6 sm:px-0",children:[A("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Field Operations"}),A("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:d.map(S=>A(pa,{to:S.href,className:"bg-white overflow-hidden shadow rounded-lg hover:shadow-md transition-shadow duration-300",children:$("div",{className:"p-6 flex flex-col items-center",children:[A("div",{className:"mb-2 text-3xl",children:S.icon}),A("div",{className:"text-sm font-medium text-gray-900 text-center",children:S.name})]})},S.name))})]}),$("div",{className:"px-4 py-6 sm:px-0",children:[A("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Your Statistics"}),$("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4",children:[A("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:A("div",{className:"px-4 py-5 sm:p-6",children:$("div",{className:"flex items-center",children:[A("div",{className:"flex-shrink-0 bg-indigo-500 rounded-md p-3",children:A("svg",{className:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),A("div",{className:"ml-5 w-0 flex-1",children:$("dl",{children:[A("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Claims Processed"}),A("dd",{className:"flex items-baseline",children:A("div",{className:"text-2xl font-semibold text-gray-900",children:"24"})})]})})]})})}),A("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:A("div",{className:"px-4 py-5 sm:p-6",children:$("div",{className:"flex items-center",children:[A("div",{className:"flex-shrink-0 bg-green-500 rounded-md p-3",children:A("svg",{className:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),A("div",{className:"ml-5 w-0 flex-1",children:$("dl",{children:[A("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Documents Digitized"}),A("dd",{className:"flex items-baseline",children:A("div",{className:"text-2xl font-semibold text-gray-900",children:"18"})})]})})]})})}),A("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:A("div",{className:"px-4 py-5 sm:p-6",children:$("div",{className:"flex items-center",children:[A("div",{className:"flex-shrink-0 bg-yellow-500 rounded-md p-3",children:A("svg",{className:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),A("div",{className:"ml-5 w-0 flex-1",children:$("dl",{children:[A("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Pending Tasks"}),A("dd",{className:"flex items-baseline",children:A("div",{className:"text-2xl font-semibold text-gray-900",children:"5"})})]})})]})})}),A("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:A("div",{className:"px-4 py-5 sm:p-6",children:$("div",{className:"flex items-center",children:[A("div",{className:"flex-shrink-0 bg-blue-500 rounded-md p-3",children:A("svg",{className:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),A("div",{className:"ml-5 w-0 flex-1",children:$("dl",{children:[A("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Villages Assigned"}),A("dd",{className:"flex items-baseline",children:A("div",{className:"text-2xl font-semibold text-gray-900",children:"3"})})]})})]})})})]})]}),$("div",{className:"px-4 py-6 sm:px-0",children:[A("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Today's Tasks"}),A("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:A("ul",{className:"divide-y divide-gray-200",children:x.map(S=>A("li",{children:$("div",{className:"px-4 py-4 sm:px-6",children:[$("div",{className:"flex items-center justify-between",children:[A("p",{className:"text-sm font-medium text-gray-900 truncate",children:S.title}),A("div",{className:"ml-2 flex-shrink-0 flex",children:A("p",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${S.priority==="High"?"bg-red-100 text-red-800":S.priority==="Medium"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:S.priority})})]}),$("div",{className:"mt-2 sm:flex sm:justify-between",children:[A("div",{className:"sm:flex",children:$("p",{className:"flex items-center text-sm text-gray-500",children:["Due: ",S.due]})}),A("div",{className:"mt-2 flex items-center text-sm text-indigo-600 sm:mt-0",children:A("button",{className:"font-medium hover:text-indigo-900",children:"View Details"})})]})]})},S.id))})})]}),$("div",{className:"px-4 py-6 sm:px-0",children:[A("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Recent Claims"}),A("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:A("ul",{className:"divide-y divide-gray-200",children:y.map(S=>A("li",{children:A(pa,{to:`/claim/${S.id}`,className:"block hover:bg-gray-50",children:$("div",{className:"px-4 py-4 sm:px-6",children:[$("div",{className:"flex items-center justify-between",children:[A("p",{className:"text-sm font-medium text-indigo-600 truncate",children:S.id}),A("div",{className:"ml-2 flex-shrink-0 flex",children:A("p",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:S.status})})]}),$("div",{className:"mt-2 sm:flex sm:justify-between",children:[A("div",{className:"sm:flex",children:A("p",{className:"flex items-center text-sm text-gray-500",children:S.title})}),A("div",{className:"mt-2 flex items-center text-sm text-gray-500 sm:mt-0",children:A("p",{children:S.date})})]})]})})},S.id))})})]})]})]})},eT=()=>{const i=sl(),o=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("userData"),i("/login")},d=[{name:"View Public Map",href:"/map",icon:""},{name:"Browse Claims",href:"/claims",icon:""},{name:"View Reports",href:"/reports",icon:""},{name:"Search Assets",href:"/asset-mapping",icon:""}],y=[{id:"CR-2023-001",title:"Forest Land Claim - Village A",status:"Pending",date:"2023-05-15"},{id:"IFR-2023-002",title:"Individual Claim - Village B",status:"Approved",date:"2023-05-10"},{id:"CFR-2023-003",title:"Community Claim - Village C",status:"Under Review",date:"2023-05-05"}];return $("div",{className:"min-h-screen bg-gray-50",children:[A("div",{className:"bg-white shadow",children:A("div",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:$("div",{className:"flex justify-between items-center",children:[A("h1",{className:"text-3xl font-bold text-gray-900",children:"User Dashboard"}),$("div",{className:"flex items-center space-x-4",children:[A("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-gray-100 text-gray-800",children:"Normal User"}),A("button",{onClick:o,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-red-700 bg-red-100 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Logout"})]})]})})}),$("div",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:[$("div",{className:"px-4 py-6 sm:px-0",children:[A("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Quick Actions"}),A("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:d.map(x=>A(pa,{to:x.href,className:"bg-white overflow-hidden shadow rounded-lg hover:shadow-md transition-shadow duration-300",children:$("div",{className:"p-6 flex flex-col items-center",children:[A("div",{className:"mb-2 text-3xl",children:x.icon}),A("div",{className:"text-sm font-medium text-gray-900 text-center",children:x.name})]})},x.name))})]}),$("div",{className:"px-4 py-6 sm:px-0",children:[A("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Your Overview"}),$("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4",children:[A("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:A("div",{className:"px-4 py-5 sm:p-6",children:$("div",{className:"flex items-center",children:[A("div",{className:"flex-shrink-0 bg-indigo-500 rounded-md p-3",children:A("svg",{className:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),A("div",{className:"ml-5 w-0 flex-1",children:$("dl",{children:[A("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Claims"}),A("dd",{className:"flex items-baseline",children:A("div",{className:"text-2xl font-semibold text-gray-900",children:"142"})})]})})]})})}),A("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:A("div",{className:"px-4 py-5 sm:p-6",children:$("div",{className:"flex items-center",children:[A("div",{className:"flex-shrink-0 bg-green-500 rounded-md p-3",children:A("svg",{className:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),A("div",{className:"ml-5 w-0 flex-1",children:$("dl",{children:[A("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Approved"}),A("dd",{className:"flex items-baseline",children:A("div",{className:"text-2xl font-semibold text-gray-900",children:"89"})})]})})]})})}),A("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:A("div",{className:"px-4 py-5 sm:p-6",children:$("div",{className:"flex items-center",children:[A("div",{className:"flex-shrink-0 bg-yellow-500 rounded-md p-3",children:A("svg",{className:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),A("div",{className:"ml-5 w-0 flex-1",children:$("dl",{children:[A("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Pending"}),A("dd",{className:"flex items-baseline",children:A("div",{className:"text-2xl font-semibold text-gray-900",children:"32"})})]})})]})})}),A("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:A("div",{className:"px-4 py-5 sm:p-6",children:$("div",{className:"flex items-center",children:[A("div",{className:"flex-shrink-0 bg-blue-500 rounded-md p-3",children:A("svg",{className:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),A("div",{className:"ml-5 w-0 flex-1",children:$("dl",{children:[A("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Villages"}),A("dd",{className:"flex items-baseline",children:A("div",{className:"text-2xl font-semibold text-gray-900",children:"12"})})]})})]})})})]})]}),$("div",{className:"px-4 py-6 sm:px-0",children:[A("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Recent Claims"}),A("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:A("ul",{className:"divide-y divide-gray-200",children:y.map(x=>A("li",{children:A(pa,{to:`/claim/${x.id}`,className:"block hover:bg-gray-50",children:$("div",{className:"px-4 py-4 sm:px-6",children:[$("div",{className:"flex items-center justify-between",children:[A("p",{className:"text-sm font-medium text-indigo-600 truncate",children:x.id}),A("div",{className:"ml-2 flex-shrink-0 flex",children:A("p",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:x.status})})]}),$("div",{className:"mt-2 sm:flex sm:justify-between",children:[A("div",{className:"sm:flex",children:A("p",{className:"flex items-center text-sm text-gray-500",children:x.title})}),A("div",{className:"mt-2 flex items-center text-sm text-gray-500 sm:mt-0",children:A("p",{children:x.date})})]})]})})},x.id))})})]}),$("div",{className:"px-4 py-6 sm:px-0",children:[A("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"About FRA Atlas"}),A("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:A("div",{className:"px-4 py-5 sm:p-6",children:$("div",{className:"prose max-w-none",children:[A("p",{className:"text-gray-600",children:"The FRA Atlas & WebGIS DSS is a comprehensive platform for managing and visualizing Forest Rights Act claims. As a normal user, you can browse public information about forest claims, view reports, and explore the map data."}),A("p",{className:"mt-4 text-gray-600",children:"For more information or to submit a claim, please contact your local field officer or visit the nearest forest department office."})]})})})]})]})]})};var aw={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.8.0/LICENSE.txt
 */(function(i,o){(function(d,y){i.exports=y()})(xC,function(){var d={},y={};function x(b,c,F){if(y[b]=F,b==="index"){var W="var sharedModule = {}; ("+y.shared+")(sharedModule); ("+y.worker+")(sharedModule);",se={};return y.shared(se),y.index(d,se),typeof window<"u"&&d.setWorkerUrl(window.URL.createObjectURL(new Blob([W],{type:"text/javascript"}))),d}}x("shared",["exports"],function(b){function c(r,t,n,s){return new(n||(n=Promise))(function(u,p){function g(T){try{w(s.next(T))}catch(P){p(P)}}function v(T){try{w(s.throw(T))}catch(P){p(P)}}function w(T){var P;T.done?u(T.value):(P=T.value,P instanceof n?P:new n(function(E){E(P)})).then(g,v)}w((s=s.apply(r,t||[])).next())})}function F(r,t){this.x=r,this.y=t}function W(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var se,re;typeof SuppressedError=="function"&&SuppressedError,F.prototype={clone(){return new F(this.x,this.y)},add(r){return this.clone()._add(r)},sub(r){return this.clone()._sub(r)},multByPoint(r){return this.clone()._multByPoint(r)},divByPoint(r){return this.clone()._divByPoint(r)},mult(r){return this.clone()._mult(r)},div(r){return this.clone()._div(r)},rotate(r){return this.clone()._rotate(r)},rotateAround(r,t){return this.clone()._rotateAround(r,t)},matMult(r){return this.clone()._matMult(r)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(r){return this.x===r.x&&this.y===r.y},dist(r){return Math.sqrt(this.distSqr(r))},distSqr(r){const t=r.x-this.x,n=r.y-this.y;return t*t+n*n},angle(){return Math.atan2(this.y,this.x)},angleTo(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith(r){return this.angleWithSep(r.x,r.y)},angleWithSep(r,t){return Math.atan2(this.x*t-this.y*r,this.x*r+this.y*t)},_matMult(r){const t=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=t,this},_add(r){return this.x+=r.x,this.y+=r.y,this},_sub(r){return this.x-=r.x,this.y-=r.y,this},_mult(r){return this.x*=r,this.y*=r,this},_div(r){return this.x/=r,this.y/=r,this},_multByPoint(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint(r){return this.x/=r.x,this.y/=r.y,this},_unit(){return this._div(this.mag()),this},_perp(){const r=this.y;return this.y=this.x,this.x=-r,this},_rotate(r){const t=Math.cos(r),n=Math.sin(r),s=n*this.x+t*this.y;return this.x=t*this.x-n*this.y,this.y=s,this},_rotateAround(r,t){const n=Math.cos(r),s=Math.sin(r),u=t.y+s*(this.x-t.x)+n*(this.y-t.y);return this.x=t.x+n*(this.x-t.x)-s*(this.y-t.y),this.y=u,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:F},F.convert=function(r){if(r instanceof F)return r;if(Array.isArray(r))return new F(+r[0],+r[1]);if(r.x!==void 0&&r.y!==void 0)return new F(+r.x,+r.y);throw new Error("Expected [x, y] or {x, y} point format")};var ce=function(){if(re)return se;function r(t,n,s,u){this.cx=3*t,this.bx=3*(s-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(u-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=s,this.p2y=u}return re=1,se=r,r.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,n){if(n===void 0&&(n=1e-6),t<0)return 0;if(t>1)return 1;for(var s=t,u=0;u<8;u++){var p=this.sampleCurveX(s)-t;if(Math.abs(p)<n)return s;var g=this.sampleCurveDerivativeX(s);if(Math.abs(g)<1e-6)break;s-=p/g}var v=0,w=1;for(s=t,u=0;u<20&&(p=this.sampleCurveX(s),!(Math.abs(p-t)<n));u++)t>p?v=s:w=s,s=.5*(w-v)+v;return s},solve:function(t,n){return this.sampleCurveY(this.solveCurveX(t,n))}},se}(),K=W(ce);let Ie,Te;function We(){return Ie==null&&(Ie=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Ie}function he(){if(Te==null&&(Te=!1,We())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let s=0;s<5*5;s++){const u=4*s;t.fillStyle=`rgb(${u},${u+1},${u+2})`,t.fillRect(s%5,Math.floor(s/5),1,1)}const n=t.getImageData(0,0,5,5).data;for(let s=0;s<5*5*4;s++)if(s%4!=3&&n[s]!==s){Te=!0;break}}}return Te||!1}var oe=1e-6,fe=typeof Float32Array<"u"?Float32Array:Array;function De(){var r=new fe(9);return fe!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function Xe(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function tt(){var r=new fe(3);return fe!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function et(r){var t=r[0],n=r[1],s=r[2];return Math.sqrt(t*t+n*n+s*s)}function lt(r,t,n){var s=new fe(3);return s[0]=r,s[1]=t,s[2]=n,s}function Lt(r,t,n){return r[0]=t[0]+n[0],r[1]=t[1]+n[1],r[2]=t[2]+n[2],r}function mt(r,t,n){return r[0]=t[0]*n,r[1]=t[1]*n,r[2]=t[2]*n,r}function di(r,t,n){var s=t[0],u=t[1],p=t[2],g=n[0],v=n[1],w=n[2];return r[0]=u*w-p*v,r[1]=p*g-s*w,r[2]=s*v-u*g,r}var Mi,Bi=et;function si(r,t,n){var s=t[0],u=t[1],p=t[2],g=t[3];return r[0]=n[0]*s+n[4]*u+n[8]*p+n[12]*g,r[1]=n[1]*s+n[5]*u+n[9]*p+n[13]*g,r[2]=n[2]*s+n[6]*u+n[10]*p+n[14]*g,r[3]=n[3]*s+n[7]*u+n[11]*p+n[15]*g,r}function _i(){var r=new fe(4);return fe!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function Gn(r,t,n,s){var u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",p=Math.PI/360;t*=p,s*=p,n*=p;var g=Math.sin(t),v=Math.cos(t),w=Math.sin(n),T=Math.cos(n),P=Math.sin(s),E=Math.cos(s);switch(u){case"xyz":r[0]=g*T*E+v*w*P,r[1]=v*w*E-g*T*P,r[2]=v*T*P+g*w*E,r[3]=v*T*E-g*w*P;break;case"xzy":r[0]=g*T*E-v*w*P,r[1]=v*w*E-g*T*P,r[2]=v*T*P+g*w*E,r[3]=v*T*E+g*w*P;break;case"yxz":r[0]=g*T*E+v*w*P,r[1]=v*w*E-g*T*P,r[2]=v*T*P-g*w*E,r[3]=v*T*E+g*w*P;break;case"yzx":r[0]=g*T*E+v*w*P,r[1]=v*w*E+g*T*P,r[2]=v*T*P-g*w*E,r[3]=v*T*E-g*w*P;break;case"zxy":r[0]=g*T*E-v*w*P,r[1]=v*w*E+g*T*P,r[2]=v*T*P+g*w*E,r[3]=v*T*E-g*w*P;break;case"zyx":r[0]=g*T*E-v*w*P,r[1]=v*w*E+g*T*P,r[2]=v*T*P-g*w*E,r[3]=v*T*E+g*w*P;break;default:throw new Error("Unknown angle order "+u)}return r}function Mn(){var r=new fe(2);return fe!=Float32Array&&(r[0]=0,r[1]=0),r}function Qe(r,t){var n=new fe(2);return n[0]=r,n[1]=t,n}tt(),Mi=new fe(4),fe!=Float32Array&&(Mi[0]=0,Mi[1]=0,Mi[2]=0,Mi[3]=0),tt(),lt(1,0,0),lt(0,1,0),_i(),_i(),De(),Mn();const He=8192;function yt(r,t,n){return t*(He/(r.tileSize*Math.pow(2,n-r.tileID.overscaledZ)))}function At(r,t){return(r%t+t)%t}function Rt(r,t,n){return r*(1-n)+t*n}function qi(r){if(r<=0)return 0;if(r>=1)return 1;const t=r*r,n=t*r;return 4*(r<.5?n:3*(r-t)+n-.75)}function pi(r,t,n,s){const u=new K(r,t,n,s);return p=>u.solve(p)}const En=pi(.25,.1,.25,1);function jt(r,t,n){return Math.min(n,Math.max(t,r))}function zn(r,t,n){const s=n-t,u=((r-t)%s+s)%s+t;return u===t?n:u}function vn(r,...t){for(const n of t)for(const s in n)r[s]=n[s];return r}let Nn=1;function fr(r,t,n){const s={};for(const u in r)s[u]=t.call(this,r[u],u,r);return s}function gr(r,t,n){const s={};for(const u in r)t.call(this,r[u],u,r)&&(s[u]=r[u]);return s}function Ei(r){return Array.isArray(r)?r.map(Ei):typeof r=="object"&&r?fr(r,Ei):r}const ni={};function li(r){ni[r]||(typeof console<"u"&&console.warn(r),ni[r]=!0)}function Dn(r,t,n){return(n.y-r.y)*(t.x-r.x)>(t.y-r.y)*(n.x-r.x)}function Wn(r){return typeof WorkerGlobalScope<"u"&&r!==void 0&&r instanceof WorkerGlobalScope}let Ln=null;function Rn(r){return typeof ImageBitmap<"u"&&r instanceof ImageBitmap}const xn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function yr(r,t,n,s,u){return c(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const p=new VideoFrame(r,{timestamp:0});try{const g=p==null?void 0:p.format;if(!g||!g.startsWith("BGR")&&!g.startsWith("RGB"))throw new Error(`Unrecognized format ${g}`);const v=g.startsWith("BGR"),w=new Uint8ClampedArray(s*u*4);if(yield p.copyTo(w,function(T,P,E,D,R){const B=4*Math.max(-P,0),V=(Math.max(0,E)-E)*D*4+B,G=4*D,Y=Math.max(0,P),_e=Math.max(0,E);return{rect:{x:Y,y:_e,width:Math.min(T.width,P+D)-Y,height:Math.min(T.height,E+R)-_e},layout:[{offset:V,stride:G}]}}(r,t,n,s,u)),v)for(let T=0;T<w.length;T+=4){const P=w[T];w[T]=w[T+2],w[T+2]=P}return w}finally{p.close()}})}let Dr,Lr;function Rr(r,t,n,s){return r.addEventListener(t,n,s),{unsubscribe:()=>{r.removeEventListener(t,n,s)}}}function Ye(r){return r*Math.PI/180}function ht(r){return r/Math.PI*180}const Vt={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Gt={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},zi="AbortError";function me(){return new Error(zi)}const j={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function O(r){return j.REGISTERED_PROTOCOLS[r.substring(0,r.indexOf("://"))]}const Z="global-dispatcher";class ee extends Error{constructor(t,n,s,u){super(`AJAXError: ${n} (${t}): ${s}`),this.status=t,this.statusText=n,this.url=s,this.body=u}}const le=()=>Wn(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,ge=function(r,t){if(/:\/\//.test(r.url)&&!/^https?:|^file:/.test(r.url)){const s=O(r.url);if(s)return s(r,t);if(Wn(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:r,targetMapId:Z},t)}if(!(/^file:/.test(n=r.url)||/^file:/.test(le())&&!/^\w+:/.test(n))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(s,u){return c(this,void 0,void 0,function*(){const p=new Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,cache:s.cache,referrer:le(),signal:u.signal});let g,v;s.type!=="json"||p.headers.has("Accept")||p.headers.set("Accept","application/json");try{g=yield fetch(p)}catch(T){throw new ee(0,T.message,s.url,new Blob)}if(!g.ok){const T=yield g.blob();throw new ee(g.status,g.statusText,s.url,T)}v=s.type==="arrayBuffer"||s.type==="image"?g.arrayBuffer():s.type==="json"?g.json():g.text();const w=yield v;if(u.signal.aborted)throw me();return{data:w,cacheControl:g.headers.get("Cache-Control"),expires:g.headers.get("Expires")}})}(r,t);if(Wn(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:r,mustQueue:!0,targetMapId:Z},t)}var n;return function(s,u){return new Promise((p,g)=>{var v;const w=new XMLHttpRequest;w.open(s.method||"GET",s.url,!0),s.type!=="arrayBuffer"&&s.type!=="image"||(w.responseType="arraybuffer");for(const T in s.headers)w.setRequestHeader(T,s.headers[T]);s.type==="json"&&(w.responseType="text",!((v=s.headers)===null||v===void 0)&&v.Accept||w.setRequestHeader("Accept","application/json")),w.withCredentials=s.credentials==="include",w.onerror=()=>{g(new Error(w.statusText))},w.onload=()=>{if(!u.signal.aborted)if((w.status>=200&&w.status<300||w.status===0)&&w.response!==null){let T=w.response;if(s.type==="json")try{T=JSON.parse(w.response)}catch(P){return void g(P)}p({data:T,cacheControl:w.getResponseHeader("Cache-Control"),expires:w.getResponseHeader("Expires")})}else{const T=new Blob([w.response],{type:w.getResponseHeader("Content-Type")});g(new ee(w.status,w.statusText,s.url,T))}},u.signal.addEventListener("abort",()=>{w.abort(),g(me())}),w.send(s.body)})}(r,t)};function xe(r){if(!r||r.indexOf("://")<=0||r.indexOf("data:image/")===0||r.indexOf("blob:")===0)return!0;const t=new URL(r),n=window.location;return t.protocol===n.protocol&&t.host===n.host}function ye(r,t,n){n[r]&&n[r].indexOf(t)!==-1||(n[r]=n[r]||[],n[r].push(t))}function Pe(r,t,n){if(n&&n[r]){const s=n[r].indexOf(t);s!==-1&&n[r].splice(s,1)}}class Fe{constructor(t,n={}){vn(this,n),this.type=t}}class ze extends Fe{constructor(t,n={}){super("error",vn({error:t},n))}}class it{on(t,n){return this._listeners=this._listeners||{},ye(t,n,this._listeners),{unsubscribe:()=>{this.off(t,n)}}}off(t,n){return Pe(t,n,this._listeners),Pe(t,n,this._oneTimeListeners),this}once(t,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},ye(t,n,this._oneTimeListeners),this):new Promise(s=>this.once(t,s))}fire(t,n){typeof t=="string"&&(t=new Fe(t,n||{}));const s=t.type;if(this.listens(s)){t.target=this;const u=this._listeners&&this._listeners[s]?this._listeners[s].slice():[];for(const v of u)v.call(this,t);const p=this._oneTimeListeners&&this._oneTimeListeners[s]?this._oneTimeListeners[s].slice():[];for(const v of p)Pe(s,v,this._oneTimeListeners),v.call(this,t);const g=this._eventedParent;g&&(vn(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),g.fire(t))}else t instanceof ze&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,n){return this._eventedParent=t,this._eventedParentData=n,this}}var ve={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"array",value:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const gt=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Pt(r,t){const n={};for(const s in r)s!=="ref"&&(n[s]=r[s]);return gt.forEach(s=>{s in t&&(n[s]=t[s])}),n}function st(r,t){if(Array.isArray(r)){if(!Array.isArray(t)||r.length!==t.length)return!1;for(let n=0;n<r.length;n++)if(!st(r[n],t[n]))return!1;return!0}if(typeof r=="object"&&r!==null&&t!==null){if(typeof t!="object"||Object.keys(r).length!==Object.keys(t).length)return!1;for(const n in r)if(!st(r[n],t[n]))return!1;return!0}return r===t}function vt(r,t){r.push(t)}function Ht(r,t,n){vt(n,{command:"addSource",args:[r,t[r]]})}function wi(r,t,n){vt(t,{command:"removeSource",args:[r]}),n[r]=!0}function ji(r,t,n,s){wi(r,n,s),Ht(r,t,n)}function Oi(r,t,n){let s;for(s in r[n])if(Object.prototype.hasOwnProperty.call(r[n],s)&&s!=="data"&&!st(r[n][s],t[n][s]))return!1;for(s in t[n])if(Object.prototype.hasOwnProperty.call(t[n],s)&&s!=="data"&&!st(r[n][s],t[n][s]))return!1;return!0}function Vi(r,t,n,s,u,p){r=r||{},t=t||{};for(const g in r)Object.prototype.hasOwnProperty.call(r,g)&&(st(r[g],t[g])||n.push({command:p,args:[s,g,t[g],u]}));for(const g in t)Object.prototype.hasOwnProperty.call(t,g)&&!Object.prototype.hasOwnProperty.call(r,g)&&(st(r[g],t[g])||n.push({command:p,args:[s,g,t[g],u]}))}function Xt(r){return r.id}function Ci(r,t){return r[t.id]=t,r}class Ne{constructor(t,n,s,u){this.message=(t?`${t}: `:"")+s,u&&(this.identifier=u),n!=null&&n.__line__&&(this.line=n.__line__)}}function Ii(r,...t){for(const n of t)for(const s in n)r[s]=n[s];return r}class qn extends Error{constructor(t,n){super(n),this.message=n,this.key=t}}class Na{constructor(t,n=[]){this.parent=t,this.bindings={};for(const[s,u]of n)this.bindings[s]=u}concat(t){return new Na(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const hn={kind:"null"},je={kind:"number"},xt={kind:"string"},Ct={kind:"boolean"},nn={kind:"color"},Da={kind:"projectionDefinition"},ma={kind:"object"},bt={kind:"value"},cl={kind:"collator"},fa={kind:"formatted"},ul={kind:"padding"},Fr={kind:"colorArray"},vo={kind:"numberArray"},vi={kind:"resolvedImage"},hl={kind:"variableAnchorOffsetCollection"};function Fn(r,t){return{kind:"array",itemType:r,N:t}}function $t(r){if(r.kind==="array"){const t=$t(r.itemType);return typeof r.N=="number"?`array<${t}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${t}>`}return r.kind}const Jh=[hn,je,xt,Ct,nn,Da,fa,ma,Fn(bt),ul,vo,Fr,vi,hl];function ls(r,t){if(t.kind==="error")return null;if(r.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!ls(r.itemType,t.itemType))&&(typeof r.N!="number"||r.N===t.N))return null}else{if(r.kind===t.kind)return null;if(r.kind==="value"){for(const n of Jh)if(!ls(n,t))return null}}return`Expected ${$t(r)} but found ${$t(t)} instead.`}function Wc(r,t){return t.some(n=>n.kind===r.kind)}function ga(r,t){return t.some(n=>n==="null"?r===null:n==="array"?Array.isArray(r):n==="object"?r&&!Array.isArray(r)&&typeof r=="object":n===typeof r)}function ya(r,t){return r.kind==="array"&&t.kind==="array"?r.itemType.kind===t.itemType.kind&&typeof r.N=="number":r.kind===t.kind}const qc=.96422,Qh=.82521,ed=4/29,xo=6/29,td=3*xo*xo,Rm=xo*xo*xo,Fm=Math.PI/180,Bm=180/Math.PI;function Hc(r){return(r%=360)<0&&(r+=360),r}function bo([r,t,n,s]){let u,p;const g=Kc((.2225045*(r=Xc(r))+.7168786*(t=Xc(t))+.0606169*(n=Xc(n)))/1);r===t&&t===n?u=p=g:(u=Kc((.4360747*r+.3850649*t+.1430804*n)/qc),p=Kc((.0139322*r+.0971045*t+.7141733*n)/Qh));const v=116*g-16;return[v<0?0:v,500*(u-g),200*(g-p),s]}function Xc(r){return r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function Kc(r){return r>Rm?Math.pow(r,1/3):r/td+ed}function wo([r,t,n,s]){let u=(r+16)/116,p=isNaN(t)?u:u+t/500,g=isNaN(n)?u:u-n/200;return u=1*Jc(u),p=qc*Jc(p),g=Qh*Jc(g),[Yc(3.1338561*p-1.6168667*u-.4906146*g),Yc(-.9787684*p+1.9161415*u+.033454*g),Yc(.0719453*p-.2289914*u+1.4052427*g),s]}function Yc(r){return(r=r<=.00304?12.92*r:1.055*Math.pow(r,1/2.4)-.055)<0?0:r>1?1:r}function Jc(r){return r>xo?r*r*r:td*(r-ed)}const jm=Object.hasOwn||function(r,t){return Object.prototype.hasOwnProperty.call(r,t)};function Co(r,t){return jm(r,t)?r[t]:void 0}function cs(r){return parseInt(r.padEnd(2,r),16)/255}function _r(r,t){return St(t?r/100:r,0,1)}function St(r,t,n){return Math.min(Math.max(t,r),n)}function La(r){return!r.some(Number.isNaN)}const _a={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Xr(r,t,n){return r+n*(t-r)}function Ra(r,t,n){return r.map((s,u)=>Xr(s,t[u],n))}class Tt{constructor(t,n,s,u=1,p=!0){this.r=t,this.g=n,this.b=s,this.a=u,p||(this.r*=u,this.g*=u,this.b*=u,u||this.overwriteGetter("rgb",[t,n,s,u]))}static parse(t){if(t instanceof Tt)return t;if(typeof t!="string")return;const n=function(s){if((s=s.toLowerCase().trim())==="transparent")return[0,0,0,0];const u=Co(_a,s);if(u){const[g,v,w]=u;return[g/255,v/255,w/255,1]}if(s.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(s)){const g=s.length<6?1:2;let v=1;return[cs(s.slice(v,v+=g)),cs(s.slice(v,v+=g)),cs(s.slice(v,v+=g)),cs(s.slice(v,v+g)||"ff")]}if(s.startsWith("rgb")){const g=s.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(g){const[v,w,T,P,E,D,R,B,V,G,Y,_e]=g,ne=[P||" ",R||" ",G].join("");if(ne==="  "||ne==="  /"||ne===",,"||ne===",,,"){const ue=[T,D,V].join(""),we=ue==="%%%"?100:ue===""?255:0;if(we){const ke=[St(+w/we,0,1),St(+E/we,0,1),St(+B/we,0,1),Y?_r(+Y,_e):1];if(La(ke))return ke}}return}}const p=s.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(p){const[g,v,w,T,P,E,D,R,B]=p,V=[w||" ",P||" ",D].join("");if(V==="  "||V==="  /"||V===",,"||V===",,,"){const G=[+v,St(+T,0,100),St(+E,0,100),R?_r(+R,B):1];if(La(G))return function([Y,_e,ne,ue]){function we(ke){const Re=(ke+Y/30)%12,qe=_e*Math.min(ne,1-ne);return ne-qe*Math.max(-1,Math.min(Re-3,9-Re,1))}return Y=Hc(Y),_e/=100,ne/=100,[we(0),we(8),we(4),ue]}(G)}}}(t);return n?new Tt(...n,!1):void 0}get rgb(){const{r:t,g:n,b:s,a:u}=this,p=u||1/0;return this.overwriteGetter("rgb",[t/p,n/p,s/p,u])}get hcl(){return this.overwriteGetter("hcl",function(t){const[n,s,u,p]=bo(t),g=Math.sqrt(s*s+u*u);return[Math.round(1e4*g)?Hc(Math.atan2(u,s)*Bm):NaN,g,n,p]}(this.rgb))}get lab(){return this.overwriteGetter("lab",bo(this.rgb))}overwriteGetter(t,n){return Object.defineProperty(this,t,{value:n}),n}toString(){const[t,n,s,u]=this.rgb;return`rgba(${[t,n,s].map(p=>Math.round(255*p)).join(",")},${u})`}static interpolate(t,n,s,u="rgb"){switch(u){case"rgb":{const[p,g,v,w]=Ra(t.rgb,n.rgb,s);return new Tt(p,g,v,w,!1)}case"hcl":{const[p,g,v,w]=t.hcl,[T,P,E,D]=n.hcl;let R,B;if(isNaN(p)||isNaN(T))isNaN(p)?isNaN(T)?R=NaN:(R=T,v!==1&&v!==0||(B=P)):(R=p,E!==1&&E!==0||(B=g));else{let ne=T-p;T>p&&ne>180?ne-=360:T<p&&p-T>180&&(ne+=360),R=p+s*ne}const[V,G,Y,_e]=function([ne,ue,we,ke]){return ne=isNaN(ne)?0:ne*Fm,wo([we,Math.cos(ne)*ue,Math.sin(ne)*ue,ke])}([R,B??Xr(g,P,s),Xr(v,E,s),Xr(w,D,s)]);return new Tt(V,G,Y,_e,!1)}case"lab":{const[p,g,v,w]=wo(Ra(t.lab,n.lab,s));return new Tt(p,g,v,w,!1)}}}}Tt.black=new Tt(0,0,0,1),Tt.white=new Tt(1,1,1,1),Tt.transparent=new Tt(0,0,0,0),Tt.red=new Tt(1,0,0,1);class Fa{constructor(t,n,s){this.sensitivity=t?n?"variant":"case":n?"accent":"base",this.locale=s,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,n){return this.collator.compare(t,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const dl=["bottom","center","top"];class pl{constructor(t,n,s,u,p,g){this.text=t,this.image=n,this.scale=s,this.fontStack=u,this.textColor=p,this.verticalAlign=g}}class bn{constructor(t){this.sections=t}static fromString(t){return new bn([new pl(t,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof bn?t:bn.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class Hi{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Hi)return t;if(typeof t=="number")return new Hi([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const n of t)if(typeof n!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new Hi(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,n,s){return new Hi(Ra(t.values,n.values,s))}}class wn{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof wn)return t;if(typeof t=="number")return new wn([t]);if(Array.isArray(t)){for(const n of t)if(typeof n!="number")return;return new wn(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,n,s){return new wn(Ra(t.values,n.values,s))}}class Ni{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Ni)return t;if(typeof t=="string"){const s=Tt.parse(t);return s?new Ni([s]):void 0}if(!Array.isArray(t))return;const n=[];for(const s of t){if(typeof s!="string")return;const u=Tt.parse(s);if(!u)return;n.push(u)}return new Ni(n)}toString(){return JSON.stringify(this.values)}static interpolate(t,n,s,u="rgb"){const p=[];if(t.values.length!=n.values.length)throw new Error(`colorArray: Arrays have mismatched length (${t.values.length} vs. ${n.values.length}), cannot interpolate.`);for(let g=0;g<t.values.length;g++)p.push(Tt.interpolate(t.values[g],n.values[g],s,u));return new Ni(p)}}class Zt extends Error{constructor(t){super(t),this.name="RuntimeError"}toJSON(){return this.message}}const id=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Cn{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Cn)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let n=0;n<t.length;n+=2){const s=t[n],u=t[n+1];if(typeof s!="string"||!id.has(s)||!Array.isArray(u)||u.length!==2||typeof u[0]!="number"||typeof u[1]!="number")return}return new Cn(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,n,s){const u=t.values,p=n.values;if(u.length!==p.length)throw new Zt(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${n.toString()}`);const g=[];for(let v=0;v<u.length;v+=2){if(u[v]!==p[v])throw new Zt(`Cannot interpolate values containing mismatched anchors. from[${v}]: ${u[v]}, to[${v}]: ${p[v]}`);g.push(u[v]);const[w,T]=u[v+1],[P,E]=p[v+1];g.push([Xr(w,P,s),Xr(T,E,s)])}return new Cn(g)}}class Hn{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Hn({name:t,available:!1}):null}}class dn{constructor(t,n,s){this.from=t,this.to=n,this.transition=s}static interpolate(t,n,s){return new dn(t,n,s)}static parse(t){return t instanceof dn?t:Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"?new dn(t[0],t[1],t[2]):typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number"?new dn(t.from,t.to,t.transition):typeof t=="string"?new dn(t,t,1):void 0}}function Kt(r,t,n,s){return typeof r=="number"&&r>=0&&r<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof n=="number"&&n>=0&&n<=255?s===void 0||typeof s=="number"&&s>=0&&s<=1?null:`Invalid rgba value [${[r,t,n,s].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof s=="number"?[r,t,n,s]:[r,t,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ba(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof dn||r instanceof Tt||r instanceof Fa||r instanceof bn||r instanceof Hi||r instanceof wn||r instanceof Ni||r instanceof Cn||r instanceof Hn)return!0;if(Array.isArray(r)){for(const t of r)if(!Ba(t))return!1;return!0}if(typeof r=="object"){for(const t in r)if(!Ba(r[t]))return!1;return!0}return!1}function dt(r){if(r===null)return hn;if(typeof r=="string")return xt;if(typeof r=="boolean")return Ct;if(typeof r=="number")return je;if(r instanceof Tt)return nn;if(r instanceof dn)return Da;if(r instanceof Fa)return cl;if(r instanceof bn)return fa;if(r instanceof Hi)return ul;if(r instanceof wn)return vo;if(r instanceof Ni)return Fr;if(r instanceof Cn)return hl;if(r instanceof Hn)return vi;if(Array.isArray(r)){const t=r.length;let n;for(const s of r){const u=dt(s);if(n){if(n===u)continue;n=bt;break}n=u}return Fn(n||bt,t)}return ma}function _t(r){const t=typeof r;return r===null?"":t==="string"||t==="number"||t==="boolean"?String(r):r instanceof Tt||r instanceof dn||r instanceof bn||r instanceof Hi||r instanceof wn||r instanceof Ni||r instanceof Cn||r instanceof Hn?r.toString():JSON.stringify(r)}class Kr{constructor(t,n){this.type=t,this.value=n}static parse(t,n){if(t.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Ba(t[1]))return n.error("invalid value");const s=t[1];let u=dt(s);const p=n.expectedType;return u.kind!=="array"||u.N!==0||!p||p.kind!=="array"||typeof p.N=="number"&&p.N!==0||(u=p),new Kr(u,s)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const zt={string:xt,number:je,boolean:Ct,object:ma};class Xn{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");let s,u=1;const p=t[0];if(p==="array"){let v,w;if(t.length>2){const T=t[1];if(typeof T!="string"||!(T in zt)||T==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);v=zt[T],u++}else v=bt;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return n.error('The length argument to "array" must be a positive integer literal',2);w=t[2],u++}s=Fn(v,w)}else{if(!zt[p])throw new Error(`Types doesn't contain name = ${p}`);s=zt[p]}const g=[];for(;u<t.length;u++){const v=n.parse(t[u],u,bt);if(!v)return null;g.push(v)}return new Xn(s,g)}evaluate(t){for(let n=0;n<this.args.length;n++){const s=this.args[n].evaluate(t);if(!ls(this.type,dt(s)))return s;if(n===this.args.length-1)throw new Zt(`Expected value to be of type ${$t(this.type)}, but found ${$t(dt(s))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Br={"to-boolean":Ct,"to-color":nn,"to-number":je,"to-string":xt};class jr{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");const s=t[0];if(!Br[s])throw new Error(`Can't parse ${s} as it is not part of the known types`);if((s==="to-boolean"||s==="to-string")&&t.length!==2)return n.error("Expected one argument.");const u=Br[s],p=[];for(let g=1;g<t.length;g++){const v=n.parse(t[g],g,bt);if(!v)return null;p.push(v)}return new jr(u,p)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let n,s;for(const u of this.args){if(n=u.evaluate(t),s=null,n instanceof Tt)return n;if(typeof n=="string"){const p=t.parseColor(n);if(p)return p}else if(Array.isArray(n)&&(s=n.length<3||n.length>4?`Invalid rgba value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:Kt(n[0],n[1],n[2],n[3]),!s))return new Tt(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new Zt(s||`Could not parse color from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"padding":{let n;for(const s of this.args){n=s.evaluate(t);const u=Hi.parse(n);if(u)return u}throw new Zt(`Could not parse padding from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"numberArray":{let n;for(const s of this.args){n=s.evaluate(t);const u=wn.parse(n);if(u)return u}throw new Zt(`Could not parse numberArray from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"colorArray":{let n;for(const s of this.args){n=s.evaluate(t);const u=Ni.parse(n);if(u)return u}throw new Zt(`Could not parse colorArray from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"variableAnchorOffsetCollection":{let n;for(const s of this.args){n=s.evaluate(t);const u=Cn.parse(n);if(u)return u}throw new Zt(`Could not parse variableAnchorOffsetCollection from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"number":{let n=null;for(const s of this.args){if(n=s.evaluate(t),n===null)return 0;const u=Number(n);if(!isNaN(u))return u}throw new Zt(`Could not convert ${JSON.stringify(n)} to number.`)}case"formatted":return bn.fromString(_t(this.args[0].evaluate(t)));case"resolvedImage":return Hn.fromString(_t(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return _t(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const ml=["Unknown","Point","LineString","Polygon"];class Qc{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?ml[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let n=this._parseColorCache.get(t);return n||(n=Tt.parse(t),this._parseColorCache.set(t,n)),n}}class Io{constructor(t,n,s=[],u,p=new Na,g=[]){this.registry=t,this.path=s,this.key=s.map(v=>`[${v}]`).join(""),this.scope=p,this.errors=g,this.expectedType=u,this._isConstant=n}parse(t,n,s,u,p={}){return n?this.concat(n,s,u)._parse(t,p):this._parse(t,p)}_parse(t,n){function s(u,p,g){return g==="assert"?new Xn(p,[u]):g==="coerce"?new jr(p,[u]):u}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const u=t[0];if(typeof u!="string")return this.error(`Expression name must be a string, but found ${typeof u} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const p=this.registry[u];if(p){let g=p.parse(t,this);if(!g)return null;if(this.expectedType){const v=this.expectedType,w=g.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||w.kind!=="value"){if(v.kind==="projectionDefinition"&&["string","array"].includes(w.kind)||["color","formatted","resolvedImage"].includes(v.kind)&&["value","string"].includes(w.kind)||["padding","numberArray"].includes(v.kind)&&["value","number","array"].includes(w.kind)||v.kind==="colorArray"&&["value","string","array"].includes(w.kind)||v.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(w.kind))g=s(g,v,n.typeAnnotation||"coerce");else if(this.checkSubtype(v,w))return null}else g=s(g,v,n.typeAnnotation||"assert")}if(!(g instanceof Kr)&&g.type.kind!=="resolvedImage"&&this._isConstant(g)){const v=new Qc;try{g=new Kr(g.type,g.evaluate(v))}catch(w){return this.error(w.message),null}}return g}return this.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,n,s){const u=typeof t=="number"?this.path.concat(t):this.path,p=s?this.scope.concat(s):this.scope;return new Io(this.registry,this._isConstant,u,n||null,p,this.errors)}error(t,...n){const s=`${this.key}${n.map(u=>`[${u}]`).join("")}`;this.errors.push(new qn(s,t))}checkSubtype(t,n){const s=ls(t,n);return s&&this.error(s),s}}class us{constructor(t,n){this.type=n.type,this.bindings=[].concat(t),this.result=n}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const n of this.bindings)t(n[1]);t(this.result)}static parse(t,n){if(t.length<4)return n.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const s=[];for(let p=1;p<t.length-1;p+=2){const g=t[p];if(typeof g!="string")return n.error(`Expected string, but found ${typeof g} instead.`,p);if(/[^a-zA-Z0-9_]/.test(g))return n.error("Variable names must contain only alphanumeric characters or '_'.",p);const v=n.parse(t[p+1],p+1);if(!v)return null;s.push([g,v])}const u=n.parse(t[t.length-1],t.length-1,n.expectedType,s);return u?new us(s,u):null}outputDefined(){return this.result.outputDefined()}}class fl{constructor(t,n){this.type=n.type,this.name=t,this.boundExpression=n}static parse(t,n){if(t.length!==2||typeof t[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const s=t[1];return n.scope.has(s)?new fl(s,n.scope.get(s)):n.error(`Unknown variable "${s}". Make sure "${s}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class gl{constructor(t,n,s){this.type=t,this.index=n,this.input=s}static parse(t,n){if(t.length!==3)return n.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const s=n.parse(t[1],1,je),u=n.parse(t[2],2,Fn(n.expectedType||bt));return s&&u?new gl(u.type.itemType,s,u):null}evaluate(t){const n=this.index.evaluate(t),s=this.input.evaluate(t);if(n<0)throw new Zt(`Array index out of bounds: ${n} < 0.`);if(n>=s.length)throw new Zt(`Array index out of bounds: ${n} > ${s.length-1}.`);if(n!==Math.floor(n))throw new Zt(`Array index must be an integer, but found ${n} instead.`);return s[n]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class yl{constructor(t,n){this.type=Ct,this.needle=t,this.haystack=n}static parse(t,n){if(t.length!==3)return n.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const s=n.parse(t[1],1,bt),u=n.parse(t[2],2,bt);return s&&u?Wc(s.type,[Ct,xt,je,hn,bt])?new yl(s,u):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${$t(s.type)} instead`):null}evaluate(t){const n=this.needle.evaluate(t),s=this.haystack.evaluate(t);if(!s)return!1;if(!ga(n,["boolean","string","number","null"]))throw new Zt(`Expected first argument to be of type boolean, string, number or null, but found ${$t(dt(n))} instead.`);if(!ga(s,["string","array"]))throw new Zt(`Expected second argument to be of type array or string, but found ${$t(dt(s))} instead.`);return s.indexOf(n)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class vr{constructor(t,n,s){this.type=je,this.needle=t,this.haystack=n,this.fromIndex=s}static parse(t,n){if(t.length<=2||t.length>=5)return n.error(`Expected 2 or 3 arguments, but found ${t.length-1} instead.`);const s=n.parse(t[1],1,bt),u=n.parse(t[2],2,bt);if(!s||!u)return null;if(!Wc(s.type,[Ct,xt,je,hn,bt]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${$t(s.type)} instead`);if(t.length===4){const p=n.parse(t[3],3,je);return p?new vr(s,u,p):null}return new vr(s,u)}evaluate(t){const n=this.needle.evaluate(t),s=this.haystack.evaluate(t);if(!ga(n,["boolean","string","number","null"]))throw new Zt(`Expected first argument to be of type boolean, string, number or null, but found ${$t(dt(n))} instead.`);let u;if(this.fromIndex&&(u=this.fromIndex.evaluate(t)),ga(s,["string"])){const p=s.indexOf(n,u);return p===-1?-1:[...s.slice(0,p)].length}if(ga(s,["array"]))return s.indexOf(n,u);throw new Zt(`Expected second argument to be of type array or string, but found ${$t(dt(s))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class Xi{constructor(t,n,s,u,p,g){this.inputType=t,this.type=n,this.input=s,this.cases=u,this.outputs=p,this.otherwise=g}static parse(t,n){if(t.length<5)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return n.error("Expected an even number of arguments.");let s,u;n.expectedType&&n.expectedType.kind!=="value"&&(u=n.expectedType);const p={},g=[];for(let T=2;T<t.length-1;T+=2){let P=t[T];const E=t[T+1];Array.isArray(P)||(P=[P]);const D=n.concat(T);if(P.length===0)return D.error("Expected at least one branch label.");for(const B of P){if(typeof B!="number"&&typeof B!="string")return D.error("Branch labels must be numbers or strings.");if(typeof B=="number"&&Math.abs(B)>Number.MAX_SAFE_INTEGER)return D.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof B=="number"&&Math.floor(B)!==B)return D.error("Numeric branch labels must be integer values.");if(s){if(D.checkSubtype(s,dt(B)))return null}else s=dt(B);if(p[String(B)]!==void 0)return D.error("Branch labels must be unique.");p[String(B)]=g.length}const R=n.parse(E,T,u);if(!R)return null;u=u||R.type,g.push(R)}const v=n.parse(t[1],1,bt);if(!v)return null;const w=n.parse(t[t.length-1],t.length-1,u);return w?v.type.kind!=="value"&&n.concat(1).checkSubtype(s,v.type)?null:new Xi(s,u,v,p,g,w):null}evaluate(t){const n=this.input.evaluate(t);return(dt(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class Ao{constructor(t,n,s){this.type=t,this.branches=n,this.otherwise=s}static parse(t,n){if(t.length<4)return n.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return n.error("Expected an odd number of arguments.");let s;n.expectedType&&n.expectedType.kind!=="value"&&(s=n.expectedType);const u=[];for(let g=1;g<t.length-1;g+=2){const v=n.parse(t[g],g,Ct);if(!v)return null;const w=n.parse(t[g+1],g+1,s);if(!w)return null;u.push([v,w]),s=s||w.type}const p=n.parse(t[t.length-1],t.length-1,s);if(!p)return null;if(!s)throw new Error("Can't infer output type");return new Ao(s,u,p)}evaluate(t){for(const[n,s]of this.branches)if(n.evaluate(t))return s.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[n,s]of this.branches)t(n),t(s);t(this.otherwise)}outputDefined(){return this.branches.every(([t,n])=>n.outputDefined())&&this.otherwise.outputDefined()}}class hs{constructor(t,n,s,u){this.type=t,this.input=n,this.beginIndex=s,this.endIndex=u}static parse(t,n){if(t.length<=2||t.length>=5)return n.error(`Expected 2 or 3 arguments, but found ${t.length-1} instead.`);const s=n.parse(t[1],1,bt),u=n.parse(t[2],2,je);if(!s||!u)return null;if(!Wc(s.type,[Fn(bt),xt,bt]))return n.error(`Expected first argument to be of type array or string, but found ${$t(s.type)} instead`);if(t.length===4){const p=n.parse(t[3],3,je);return p?new hs(s.type,s,u,p):null}return new hs(s.type,s,u)}evaluate(t){const n=this.input.evaluate(t),s=this.beginIndex.evaluate(t);let u;if(this.endIndex&&(u=this.endIndex.evaluate(t)),ga(n,["string"]))return[...n].slice(s,u).join("");if(ga(n,["array"]))return n.slice(s,u);throw new Zt(`Expected first argument to be of type array or string, but found ${$t(dt(n))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function ja(r,t){const n=r.length-1;let s,u,p=0,g=n,v=0;for(;p<=g;)if(v=Math.floor((p+g)/2),s=r[v],u=r[v+1],s<=t){if(v===n||t<u)return v;p=v+1}else{if(!(s>t))throw new Zt("Input is not a number.");g=v-1}return 0}class xi{constructor(t,n,s){this.type=t,this.input=n,this.labels=[],this.outputs=[];for(const[u,p]of s)this.labels.push(u),this.outputs.push(p)}static parse(t,n){if(t.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");const s=n.parse(t[1],1,je);if(!s)return null;const u=[];let p=null;n.expectedType&&n.expectedType.kind!=="value"&&(p=n.expectedType);for(let g=1;g<t.length;g+=2){const v=g===1?-1/0:t[g],w=t[g+1],T=g,P=g+1;if(typeof v!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',T);if(u.length&&u[u.length-1][0]>=v)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',T);const E=n.parse(w,P,p);if(!E)return null;p=p||E.type,u.push([v,E])}return new xi(p,s,u)}evaluate(t){const n=this.labels,s=this.outputs;if(n.length===1)return s[0].evaluate(t);const u=this.input.evaluate(t);if(u<=n[0])return s[0].evaluate(t);const p=n.length;return u>=n[p-1]?s[p-1].evaluate(t):s[ja(n,u)].evaluate(t)}eachChild(t){t(this.input);for(const n of this.outputs)t(n)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function nd(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var ds,eu,Om=function(){if(eu)return ds;function r(t,n,s,u){this.cx=3*t,this.bx=3*(s-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(u-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=s,this.p2y=u}return eu=1,ds=r,r.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,n){if(n===void 0&&(n=1e-6),t<0)return 0;if(t>1)return 1;for(var s=t,u=0;u<8;u++){var p=this.sampleCurveX(s)-t;if(Math.abs(p)<n)return s;var g=this.sampleCurveDerivativeX(s);if(Math.abs(g)<1e-6)break;s-=p/g}var v=0,w=1;for(s=t,u=0;u<20&&(p=this.sampleCurveX(s),!(Math.abs(p-t)<n));u++)t>p?v=s:w=s,s=.5*(w-v)+v;return s},solve:function(t,n){return this.sampleCurveY(this.solveCurveX(t,n))}},ds}(),So=nd(Om);class rn{constructor(t,n,s,u,p){this.type=t,this.operator=n,this.interpolation=s,this.input=u,this.labels=[],this.outputs=[];for(const[g,v]of p)this.labels.push(g),this.outputs.push(v)}static interpolationFactor(t,n,s,u){let p=0;if(t.name==="exponential")p=ps(n,t.base,s,u);else if(t.name==="linear")p=ps(n,1,s,u);else if(t.name==="cubic-bezier"){const g=t.controlPoints;p=new So(g[0],g[1],g[2],g[3]).solve(ps(n,1,s,u))}return p}static parse(t,n){let[s,u,p,...g]=t;if(!Array.isArray(u)||u.length===0)return n.error("Expected an interpolation type expression.",1);if(u[0]==="linear")u={name:"linear"};else if(u[0]==="exponential"){const T=u[1];if(typeof T!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:T}}else{if(u[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(u[0])}`,1,0);{const T=u.slice(1);if(T.length!==4||T.some(P=>typeof P!="number"||P<0||P>1))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:T}}}if(t.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(p=n.parse(p,2,je),!p)return null;const v=[];let w=null;s!=="interpolate-hcl"&&s!=="interpolate-lab"||n.expectedType==Fr?n.expectedType&&n.expectedType.kind!=="value"&&(w=n.expectedType):w=nn;for(let T=0;T<g.length;T+=2){const P=g[T],E=g[T+1],D=T+3,R=T+4;if(typeof P!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(v.length&&v[v.length-1][0]>=P)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',D);const B=n.parse(E,R,w);if(!B)return null;w=w||B.type,v.push([P,B])}return ya(w,je)||ya(w,Da)||ya(w,nn)||ya(w,ul)||ya(w,vo)||ya(w,Fr)||ya(w,hl)||ya(w,Fn(je))?new rn(w,s,u,p,v):n.error(`Type ${$t(w)} is not interpolatable.`)}evaluate(t){const n=this.labels,s=this.outputs;if(n.length===1)return s[0].evaluate(t);const u=this.input.evaluate(t);if(u<=n[0])return s[0].evaluate(t);const p=n.length;if(u>=n[p-1])return s[p-1].evaluate(t);const g=ja(n,u),v=rn.interpolationFactor(this.interpolation,u,n[g],n[g+1]),w=s[g].evaluate(t),T=s[g+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Xr(w,T,v);case"color":return Tt.interpolate(w,T,v);case"padding":return Hi.interpolate(w,T,v);case"colorArray":return Ni.interpolate(w,T,v);case"numberArray":return wn.interpolate(w,T,v);case"variableAnchorOffsetCollection":return Cn.interpolate(w,T,v);case"array":return Ra(w,T,v);case"projectionDefinition":return dn.interpolate(w,T,v)}case"interpolate-hcl":switch(this.type.kind){case"color":return Tt.interpolate(w,T,v,"hcl");case"colorArray":return Ni.interpolate(w,T,v,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Tt.interpolate(w,T,v,"lab");case"colorArray":return Ni.interpolate(w,T,v,"lab")}}}eachChild(t){t(this.input);for(const n of this.outputs)t(n)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function ps(r,t,n,s){const u=s-n,p=r-n;return u===0?0:t===1?p/u:(Math.pow(t,p)-1)/(Math.pow(t,u)-1)}const Or={color:Tt.interpolate,number:Xr,padding:Hi.interpolate,numberArray:wn.interpolate,colorArray:Ni.interpolate,variableAnchorOffsetCollection:Cn.interpolate,array:Ra};class ms{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");let s=null;const u=n.expectedType;u&&u.kind!=="value"&&(s=u);const p=[];for(const v of t.slice(1)){const w=n.parse(v,1+p.length,s,void 0,{typeAnnotation:"omit"});if(!w)return null;s=s||w.type,p.push(w)}if(!s)throw new Error("No output type");const g=u&&p.some(v=>ls(u,v.type));return new ms(g?bt:s,p)}evaluate(t){let n,s=null,u=0;for(const p of this.args)if(u++,s=p.evaluate(t),s&&s instanceof Hn&&!s.available&&(n||(n=s.name),s=null,u===this.args.length&&(s=n)),s!==null)break;return s}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function fs(r,t){return r==="=="||r==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function gs(r,t,n,s){return s.compare(t,n)===0}function pn(r,t,n){const s=r!=="=="&&r!=="!=";return class ow{constructor(p,g,v){this.type=Ct,this.lhs=p,this.rhs=g,this.collator=v,this.hasUntypedArgument=p.type.kind==="value"||g.type.kind==="value"}static parse(p,g){if(p.length!==3&&p.length!==4)return g.error("Expected two or three arguments.");const v=p[0];let w=g.parse(p[1],1,bt);if(!w)return null;if(!fs(v,w.type))return g.concat(1).error(`"${v}" comparisons are not supported for type '${$t(w.type)}'.`);let T=g.parse(p[2],2,bt);if(!T)return null;if(!fs(v,T.type))return g.concat(2).error(`"${v}" comparisons are not supported for type '${$t(T.type)}'.`);if(w.type.kind!==T.type.kind&&w.type.kind!=="value"&&T.type.kind!=="value")return g.error(`Cannot compare types '${$t(w.type)}' and '${$t(T.type)}'.`);s&&(w.type.kind==="value"&&T.type.kind!=="value"?w=new Xn(T.type,[w]):w.type.kind!=="value"&&T.type.kind==="value"&&(T=new Xn(w.type,[T])));let P=null;if(p.length===4){if(w.type.kind!=="string"&&T.type.kind!=="string"&&w.type.kind!=="value"&&T.type.kind!=="value")return g.error("Cannot use collator to compare non-string types.");if(P=g.parse(p[3],3,cl),!P)return null}return new ow(w,T,P)}evaluate(p){const g=this.lhs.evaluate(p),v=this.rhs.evaluate(p);if(s&&this.hasUntypedArgument){const w=dt(g),T=dt(v);if(w.kind!==T.kind||w.kind!=="string"&&w.kind!=="number")throw new Zt(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${w.kind}, ${T.kind}) instead.`)}if(this.collator&&!s&&this.hasUntypedArgument){const w=dt(g),T=dt(v);if(w.kind!=="string"||T.kind!=="string")return t(p,g,v)}return this.collator?n(p,g,v,this.collator.evaluate(p)):t(p,g,v)}eachChild(p){p(this.lhs),p(this.rhs),this.collator&&p(this.collator)}outputDefined(){return!0}}}const rd=pn("==",function(r,t,n){return t===n},gs),_l=pn("!=",function(r,t,n){return t!==n},function(r,t,n,s){return!gs(0,t,n,s)}),Vm=pn("<",function(r,t,n){return t<n},function(r,t,n,s){return s.compare(t,n)<0}),tu=pn(">",function(r,t,n){return t>n},function(r,t,n,s){return s.compare(t,n)>0}),Um=pn("<=",function(r,t,n){return t<=n},function(r,t,n,s){return s.compare(t,n)<=0}),$m=pn(">=",function(r,t,n){return t>=n},function(r,t,n,s){return s.compare(t,n)>=0});class vl{constructor(t,n,s){this.type=cl,this.locale=s,this.caseSensitive=t,this.diacriticSensitive=n}static parse(t,n){if(t.length!==2)return n.error("Expected one argument.");const s=t[1];if(typeof s!="object"||Array.isArray(s))return n.error("Collator options argument must be an object.");const u=n.parse(s["case-sensitive"]!==void 0&&s["case-sensitive"],1,Ct);if(!u)return null;const p=n.parse(s["diacritic-sensitive"]!==void 0&&s["diacritic-sensitive"],1,Ct);if(!p)return null;let g=null;return s.locale&&(g=n.parse(s.locale,1,xt),!g)?null:new vl(u,p,g)}evaluate(t){return new Fa(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class iu{constructor(t,n,s,u,p){this.type=xt,this.number=t,this.locale=n,this.currency=s,this.minFractionDigits=u,this.maxFractionDigits=p}static parse(t,n){if(t.length!==3)return n.error("Expected two arguments.");const s=n.parse(t[1],1,je);if(!s)return null;const u=t[2];if(typeof u!="object"||Array.isArray(u))return n.error("NumberFormat options argument must be an object.");let p=null;if(u.locale&&(p=n.parse(u.locale,1,xt),!p))return null;let g=null;if(u.currency&&(g=n.parse(u.currency,1,xt),!g))return null;let v=null;if(u["min-fraction-digits"]&&(v=n.parse(u["min-fraction-digits"],1,je),!v))return null;let w=null;return u["max-fraction-digits"]&&(w=n.parse(u["max-fraction-digits"],1,je),!w)?null:new iu(s,p,g,v,w)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class Oa{constructor(t){this.type=fa,this.sections=t}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");const s=t[1];if(!Array.isArray(s)&&typeof s=="object")return n.error("First argument must be an image or text section.");const u=[];let p=!1;for(let g=1;g<=t.length-1;++g){const v=t[g];if(p&&typeof v=="object"&&!Array.isArray(v)){p=!1;let w=null;if(v["font-scale"]&&(w=n.parse(v["font-scale"],1,je),!w))return null;let T=null;if(v["text-font"]&&(T=n.parse(v["text-font"],1,Fn(xt)),!T))return null;let P=null;if(v["text-color"]&&(P=n.parse(v["text-color"],1,nn),!P))return null;let E=null;if(v["vertical-align"]){if(typeof v["vertical-align"]=="string"&&!dl.includes(v["vertical-align"]))return n.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${v["vertical-align"]}' instead.`);if(E=n.parse(v["vertical-align"],1,xt),!E)return null}const D=u[u.length-1];D.scale=w,D.font=T,D.textColor=P,D.verticalAlign=E}else{const w=n.parse(t[g],1,bt);if(!w)return null;const T=w.type.kind;if(T!=="string"&&T!=="value"&&T!=="null"&&T!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");p=!0,u.push({content:w,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Oa(u)}evaluate(t){return new bn(this.sections.map(n=>{const s=n.content.evaluate(t);return dt(s)===vi?new pl("",s,null,null,null,n.verticalAlign?n.verticalAlign.evaluate(t):null):new pl(_t(s),null,n.scale?n.scale.evaluate(t):null,n.font?n.font.evaluate(t).join(","):null,n.textColor?n.textColor.evaluate(t):null,n.verticalAlign?n.verticalAlign.evaluate(t):null)}))}eachChild(t){for(const n of this.sections)t(n.content),n.scale&&t(n.scale),n.font&&t(n.font),n.textColor&&t(n.textColor),n.verticalAlign&&t(n.verticalAlign)}outputDefined(){return!1}}class nu{constructor(t){this.type=vi,this.input=t}static parse(t,n){if(t.length!==2)return n.error("Expected two arguments.");const s=n.parse(t[1],1,xt);return s?new nu(s):n.error("No image name provided.")}evaluate(t){const n=this.input.evaluate(t),s=Hn.fromString(n);return s&&t.availableImages&&(s.available=t.availableImages.indexOf(n)>-1),s}eachChild(t){t(this.input)}outputDefined(){return!1}}class xl{constructor(t){this.type=je,this.input=t}static parse(t,n){if(t.length!==2)return n.error(`Expected 1 argument, but found ${t.length-1} instead.`);const s=n.parse(t[1],1);return s?s.type.kind!=="array"&&s.type.kind!=="string"&&s.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${$t(s.type)} instead.`):new xl(s):null}evaluate(t){const n=this.input.evaluate(t);if(typeof n=="string")return[...n].length;if(Array.isArray(n))return n.length;throw new Zt(`Expected value to be of type string or array, but found ${$t(dt(n))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const xr=8192;function Zm(r,t){const n=(180+r[0])/360,s=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,u=Math.pow(2,t.z);return[Math.round(n*u*xr),Math.round(s*u*xr)]}function bl(r,t){const n=Math.pow(2,t.z);return[(u=(r[0]/xr+t.x)/n,360*u-180),(s=(r[1]/xr+t.y)/n,360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90)];var s,u}function ys(r,t){r[0]=Math.min(r[0],t[0]),r[1]=Math.min(r[1],t[1]),r[2]=Math.max(r[2],t[0]),r[3]=Math.max(r[3],t[1])}function _s(r,t){return!(r[0]<=t[0]||r[2]>=t[2]||r[1]<=t[1]||r[3]>=t[3])}function Gm(r,t,n){const s=r[0]-t[0],u=r[1]-t[1],p=r[0]-n[0],g=r[1]-n[1];return s*g-p*u==0&&s*p<=0&&u*g<=0}function wl(r,t,n,s){return(u=[s[0]-n[0],s[1]-n[1]])[0]*(p=[t[0]-r[0],t[1]-r[1]])[1]-u[1]*p[0]!=0&&!(!od(r,t,n,s)||!od(n,s,r,t));var u,p}function Wm(r,t,n){for(const s of n)for(let u=0;u<s.length-1;++u)if(wl(r,t,s[u],s[u+1]))return!0;return!1}function Va(r,t,n=!1){let s=!1;for(const v of t)for(let w=0;w<v.length-1;w++){if(Gm(r,v[w],v[w+1]))return n;(p=v[w])[1]>(u=r)[1]!=(g=v[w+1])[1]>u[1]&&u[0]<(g[0]-p[0])*(u[1]-p[1])/(g[1]-p[1])+p[0]&&(s=!s)}var u,p,g;return s}function ad(r,t){for(const n of t)if(Va(r,n))return!0;return!1}function ru(r,t){for(const n of r)if(!Va(n,t))return!1;for(let n=0;n<r.length-1;++n)if(Wm(r[n],r[n+1],t))return!1;return!0}function qm(r,t){for(const n of t)if(ru(r,n))return!0;return!1}function od(r,t,n,s){const u=s[0]-n[0],p=s[1]-n[1],g=(r[0]-n[0])*p-u*(r[1]-n[1]),v=(t[0]-n[0])*p-u*(t[1]-n[1]);return g>0&&v<0||g<0&&v>0}function au(r,t,n){const s=[];for(let u=0;u<r.length;u++){const p=[];for(let g=0;g<r[u].length;g++){const v=Zm(r[u][g],n);ys(t,v),p.push(v)}s.push(p)}return s}function sd(r,t,n){const s=[];for(let u=0;u<r.length;u++){const p=au(r[u],t,n);s.push(p)}return s}function Cl(r,t,n,s){if(r[0]<n[0]||r[0]>n[2]){const u=.5*s;let p=r[0]-n[0]>u?-s:n[0]-r[0]>u?s:0;p===0&&(p=r[0]-n[2]>u?-s:n[2]-r[0]>u?s:0),r[0]+=p}ys(t,r)}function ld(r,t,n,s){const u=Math.pow(2,s.z)*xr,p=[s.x*xr,s.y*xr],g=[];for(const v of r)for(const w of v){const T=[w.x+p[0],w.y+p[1]];Cl(T,t,n,u),g.push(T)}return g}function cd(r,t,n,s){const u=Math.pow(2,s.z)*xr,p=[s.x*xr,s.y*xr],g=[];for(const w of r){const T=[];for(const P of w){const E=[P.x+p[0],P.y+p[1]];ys(t,E),T.push(E)}g.push(T)}if(t[2]-t[0]<=u/2){(v=t)[0]=v[1]=1/0,v[2]=v[3]=-1/0;for(const w of g)for(const T of w)Cl(T,t,n,u)}var v;return g}class Ua{constructor(t,n){this.type=Ct,this.geojson=t,this.geometries=n}static parse(t,n){if(t.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Ba(t[1])){const s=t[1];if(s.type==="FeatureCollection"){const u=[];for(const p of s.features){const{type:g,coordinates:v}=p.geometry;g==="Polygon"&&u.push(v),g==="MultiPolygon"&&u.push(...v)}if(u.length)return new Ua(s,{type:"MultiPolygon",coordinates:u})}else if(s.type==="Feature"){const u=s.geometry.type;if(u==="Polygon"||u==="MultiPolygon")return new Ua(s,s.geometry)}else if(s.type==="Polygon"||s.type==="MultiPolygon")return new Ua(s,s)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(n,s){const u=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],g=n.canonicalID();if(s.type==="Polygon"){const v=au(s.coordinates,p,g),w=ld(n.geometry(),u,p,g);if(!_s(u,p))return!1;for(const T of w)if(!Va(T,v))return!1}if(s.type==="MultiPolygon"){const v=sd(s.coordinates,p,g),w=ld(n.geometry(),u,p,g);if(!_s(u,p))return!1;for(const T of w)if(!ad(T,v))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(n,s){const u=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],g=n.canonicalID();if(s.type==="Polygon"){const v=au(s.coordinates,p,g),w=cd(n.geometry(),u,p,g);if(!_s(u,p))return!1;for(const T of w)if(!ru(T,v))return!1}if(s.type==="MultiPolygon"){const v=sd(s.coordinates,p,g),w=cd(n.geometry(),u,p,g);if(!_s(u,p))return!1;for(const T of w)if(!qm(T,v))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let ou=class{constructor(r=[],t=(n,s)=>n<s?-1:n>s?1:0){if(this.data=r,this.length=this.data.length,this.compare=t,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(r){this.data.push(r),this._up(this.length++)}pop(){if(this.length===0)return;const r=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:t,compare:n}=this,s=t[r];for(;r>0;){const u=r-1>>1,p=t[u];if(n(s,p)>=0)break;t[r]=p,r=u}t[r]=s}_down(r){const{data:t,compare:n}=this,s=this.length>>1,u=t[r];for(;r<s;){let p=1+(r<<1);const g=p+1;if(g<this.length&&n(t[g],t[p])<0&&(p=g),n(t[p],u)>=0)break;t[r]=t[p],r=p}t[r]=u}};function su(r,t,n=0,s=r.length-1,u=Hm){for(;s>n;){if(s-n>600){const w=s-n+1,T=t-n+1,P=Math.log(w),E=.5*Math.exp(2*P/3),D=.5*Math.sqrt(P*E*(w-E)/w)*(T-w/2<0?-1:1);su(r,t,Math.max(n,Math.floor(t-T*E/w+D)),Math.min(s,Math.floor(t+(w-T)*E/w+D)),u)}const p=r[t];let g=n,v=s;for(vs(r,n,t),u(r[s],p)>0&&vs(r,n,s);g<v;){for(vs(r,g,v),g++,v--;u(r[g],p)<0;)g++;for(;u(r[v],p)>0;)v--}u(r[n],p)===0?vs(r,n,v):(v++,vs(r,v,s)),v<=t&&(n=v+1),t<=v&&(s=v-1)}}function vs(r,t,n){const s=r[t];r[t]=r[n],r[n]=s}function Hm(r,t){return r<t?-1:r>t?1:0}function xs(r,t){if(r.length<=1)return[r];const n=[];let s,u;for(const p of r){const g=Xm(p);g!==0&&(p.area=Math.abs(g),u===void 0&&(u=g<0),u===g<0?(s&&n.push(s),s=[p]):s.push(p))}if(s&&n.push(s),t>1)for(let p=0;p<n.length;p++)n[p].length<=t||(su(n[p],t,1,n[p].length-1,ud),n[p]=n[p].slice(0,t));return n}function ud(r,t){return t.area-r.area}function Xm(r){let t=0;for(let n,s,u=0,p=r.length,g=p-1;u<p;g=u++)n=r[u],s=r[g],t+=(s.x-n.x)*(n.y+s.y);return t}const hd=1/298.257223563,dd=hd*(2-hd),lu=Math.PI/180;class cu{constructor(t){const n=6378.137*lu*1e3,s=Math.cos(t*lu),u=1/(1-dd*(1-s*s)),p=Math.sqrt(u);this.kx=n*p*s,this.ky=n*p*u*(1-dd)}distance(t,n){const s=this.wrap(t[0]-n[0])*this.kx,u=(t[1]-n[1])*this.ky;return Math.sqrt(s*s+u*u)}pointOnLine(t,n){let s,u,p,g,v=1/0;for(let w=0;w<t.length-1;w++){let T=t[w][0],P=t[w][1],E=this.wrap(t[w+1][0]-T)*this.kx,D=(t[w+1][1]-P)*this.ky,R=0;E===0&&D===0||(R=(this.wrap(n[0]-T)*this.kx*E+(n[1]-P)*this.ky*D)/(E*E+D*D),R>1?(T=t[w+1][0],P=t[w+1][1]):R>0&&(T+=E/this.kx*R,P+=D/this.ky*R)),E=this.wrap(n[0]-T)*this.kx,D=(n[1]-P)*this.ky;const B=E*E+D*D;B<v&&(v=B,s=T,u=P,p=w,g=R)}return{point:[s,u],index:p,t:Math.max(0,Math.min(1,g))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function pd(r,t){return t[0]-r[0]}function Il(r){return r[1]-r[0]+1}function Yr(r,t){return r[1]>=r[0]&&r[1]<t}function Dt(r,t){if(r[0]>r[1])return[null,null];const n=Il(r);if(t){if(n===2)return[r,null];const u=Math.floor(n/2);return[[r[0],r[0]+u],[r[0]+u,r[1]]]}if(n===1)return[r,null];const s=Math.floor(n/2)-1;return[[r[0],r[0]+s],[r[0]+s+1,r[1]]]}function uu(r,t){if(!Yr(t,r.length))return[1/0,1/0,-1/0,-1/0];const n=[1/0,1/0,-1/0,-1/0];for(let s=t[0];s<=t[1];++s)ys(n,r[s]);return n}function hu(r){const t=[1/0,1/0,-1/0,-1/0];for(const n of r)for(const s of n)ys(t,s);return t}function md(r){return r[0]!==-1/0&&r[1]!==-1/0&&r[2]!==1/0&&r[3]!==1/0}function du(r,t,n){if(!md(r)||!md(t))return NaN;let s=0,u=0;return r[2]<t[0]&&(s=t[0]-r[2]),r[0]>t[2]&&(s=r[0]-t[2]),r[1]>t[3]&&(u=r[1]-t[3]),r[3]<t[1]&&(u=t[1]-r[3]),n.distance([0,0],[s,u])}function $a(r,t,n){const s=n.pointOnLine(t,r);return n.distance(r,s.point)}function pu(r,t,n,s,u){const p=Math.min($a(r,[n,s],u),$a(t,[n,s],u)),g=Math.min($a(n,[r,t],u),$a(s,[r,t],u));return Math.min(p,g)}function Km(r,t,n,s,u){if(!Yr(t,r.length)||!Yr(s,n.length))return 1/0;let p=1/0;for(let g=t[0];g<t[1];++g){const v=r[g],w=r[g+1];for(let T=s[0];T<s[1];++T){const P=n[T],E=n[T+1];if(wl(v,w,P,E))return 0;p=Math.min(p,pu(v,w,P,E,u))}}return p}function Ym(r,t,n,s,u){if(!Yr(t,r.length)||!Yr(s,n.length))return NaN;let p=1/0;for(let g=t[0];g<=t[1];++g)for(let v=s[0];v<=s[1];++v)if(p=Math.min(p,u.distance(r[g],n[v])),p===0)return p;return p}function Jm(r,t,n){if(Va(r,t,!0))return 0;let s=1/0;for(const u of t){const p=u[0],g=u[u.length-1];if(p!==g&&(s=Math.min(s,$a(r,[g,p],n)),s===0))return s;const v=n.pointOnLine(u,r);if(s=Math.min(s,n.distance(r,v.point)),s===0)return s}return s}function Qm(r,t,n,s){if(!Yr(t,r.length))return NaN;for(let p=t[0];p<=t[1];++p)if(Va(r[p],n,!0))return 0;let u=1/0;for(let p=t[0];p<t[1];++p){const g=r[p],v=r[p+1];for(const w of n)for(let T=0,P=w.length,E=P-1;T<P;E=T++){const D=w[E],R=w[T];if(wl(g,v,D,R))return 0;u=Math.min(u,pu(g,v,D,R,s))}}return u}function fd(r,t){for(const n of r)for(const s of n)if(Va(s,t,!0))return!0;return!1}function ef(r,t,n,s=1/0){const u=hu(r),p=hu(t);if(s!==1/0&&du(u,p,n)>=s)return s;if(_s(u,p)){if(fd(r,t))return 0}else if(fd(t,r))return 0;let g=1/0;for(const v of r)for(let w=0,T=v.length,P=T-1;w<T;P=w++){const E=v[P],D=v[w];for(const R of t)for(let B=0,V=R.length,G=V-1;B<V;G=B++){const Y=R[G],_e=R[B];if(wl(E,D,Y,_e))return 0;g=Math.min(g,pu(E,D,Y,_e,n))}}return g}function gd(r,t,n,s,u,p){if(!p)return;const g=du(uu(s,p),u,n);g<t&&r.push([g,p,[0,0]])}function Al(r,t,n,s,u,p,g){if(!p||!g)return;const v=du(uu(s,p),uu(u,g),n);v<t&&r.push([v,p,g])}function Sl(r,t,n,s,u=1/0){let p=Math.min(s.distance(r[0],n[0][0]),u);if(p===0)return p;const g=new ou([[0,[0,r.length-1],[0,0]]],pd),v=hu(n);for(;g.length>0;){const w=g.pop();if(w[0]>=p)continue;const T=w[1],P=t?50:100;if(Il(T)<=P){if(!Yr(T,r.length))return NaN;if(t){const E=Qm(r,T,n,s);if(isNaN(E)||E===0)return E;p=Math.min(p,E)}else for(let E=T[0];E<=T[1];++E){const D=Jm(r[E],n,s);if(p=Math.min(p,D),p===0)return 0}}else{const E=Dt(T,t);gd(g,p,s,r,v,E[0]),gd(g,p,s,r,v,E[1])}}return p}function Tl(r,t,n,s,u,p=1/0){let g=Math.min(p,u.distance(r[0],n[0]));if(g===0)return g;const v=new ou([[0,[0,r.length-1],[0,n.length-1]]],pd);for(;v.length>0;){const w=v.pop();if(w[0]>=g)continue;const T=w[1],P=w[2],E=t?50:100,D=s?50:100;if(Il(T)<=E&&Il(P)<=D){if(!Yr(T,r.length)&&Yr(P,n.length))return NaN;let R;if(t&&s)R=Km(r,T,n,P,u),g=Math.min(g,R);else if(t&&!s){const B=r.slice(T[0],T[1]+1);for(let V=P[0];V<=P[1];++V)if(R=$a(n[V],B,u),g=Math.min(g,R),g===0)return g}else if(!t&&s){const B=n.slice(P[0],P[1]+1);for(let V=T[0];V<=T[1];++V)if(R=$a(r[V],B,u),g=Math.min(g,R),g===0)return g}else R=Ym(r,T,n,P,u),g=Math.min(g,R)}else{const R=Dt(T,t),B=Dt(P,s);Al(v,g,u,r,n,R[0],B[0]),Al(v,g,u,r,n,R[0],B[1]),Al(v,g,u,r,n,R[1],B[0]),Al(v,g,u,r,n,R[1],B[1])}}return g}function mu(r){return r.type==="MultiPolygon"?r.coordinates.map(t=>({type:"Polygon",coordinates:t})):r.type==="MultiLineString"?r.coordinates.map(t=>({type:"LineString",coordinates:t})):r.type==="MultiPoint"?r.coordinates.map(t=>({type:"Point",coordinates:t})):[r]}class Za{constructor(t,n){this.type=je,this.geojson=t,this.geometries=n}static parse(t,n){if(t.length!==2)return n.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Ba(t[1])){const s=t[1];if(s.type==="FeatureCollection")return new Za(s,s.features.map(u=>mu(u.geometry)).flat());if(s.type==="Feature")return new Za(s,mu(s.geometry));if("type"in s&&"coordinates"in s)return new Za(s,mu(s))}return n.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(n,s){const u=n.geometry(),p=u.flat().map(w=>bl([w.x,w.y],n.canonical));if(u.length===0)return NaN;const g=new cu(p[0][1]);let v=1/0;for(const w of s){switch(w.type){case"Point":v=Math.min(v,Tl(p,!1,[w.coordinates],!1,g,v));break;case"LineString":v=Math.min(v,Tl(p,!1,w.coordinates,!0,g,v));break;case"Polygon":v=Math.min(v,Sl(p,!1,w.coordinates,g,v))}if(v===0)return v}return v}(t,this.geometries);if(t.geometryType()==="LineString")return function(n,s){const u=n.geometry(),p=u.flat().map(w=>bl([w.x,w.y],n.canonical));if(u.length===0)return NaN;const g=new cu(p[0][1]);let v=1/0;for(const w of s){switch(w.type){case"Point":v=Math.min(v,Tl(p,!0,[w.coordinates],!1,g,v));break;case"LineString":v=Math.min(v,Tl(p,!0,w.coordinates,!0,g,v));break;case"Polygon":v=Math.min(v,Sl(p,!0,w.coordinates,g,v))}if(v===0)return v}return v}(t,this.geometries);if(t.geometryType()==="Polygon")return function(n,s){const u=n.geometry();if(u.length===0||u[0].length===0)return NaN;const p=xs(u,0).map(w=>w.map(T=>T.map(P=>bl([P.x,P.y],n.canonical)))),g=new cu(p[0][0][0][1]);let v=1/0;for(const w of s)for(const T of p){switch(w.type){case"Point":v=Math.min(v,Sl([w.coordinates],!1,T,g,v));break;case"LineString":v=Math.min(v,Sl(w.coordinates,!0,T,g,v));break;case"Polygon":v=Math.min(v,ef(T,w.coordinates,g,v))}if(v===0)return v}return v}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class bs{constructor(t){this.type=bt,this.key=t}static parse(t,n){if(t.length!==2)return n.error(`Expected 1 argument, but found ${t.length-1} instead.`);const s=t[1];return s==null?n.error("Global state property must be defined."):typeof s!="string"?n.error(`Global state property must be string, but found ${typeof t[1]} instead.`):new bs(s)}evaluate(t){var n;const s=(n=t.globals)===null||n===void 0?void 0:n.globalState;return s&&Object.keys(s).length!==0?Co(s,this.key):null}eachChild(){}outputDefined(){return!1}}const To={"==":rd,"!=":_l,">":tu,"<":Vm,">=":$m,"<=":Um,array:Xn,at:gl,boolean:Xn,case:Ao,coalesce:ms,collator:vl,format:Oa,image:nu,in:yl,"index-of":vr,interpolate:rn,"interpolate-hcl":rn,"interpolate-lab":rn,length:xl,let:us,literal:Kr,match:Xi,number:Xn,"number-format":iu,object:Xn,slice:hs,step:xi,string:Xn,"to-boolean":jr,"to-color":jr,"to-number":jr,"to-string":jr,var:fl,within:Ua,distance:Za,"global-state":bs};class or{constructor(t,n,s,u){this.name=t,this.type=n,this._evaluate=s,this.args=u}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,n){const s=t[0],u=or.definitions[s];if(!u)return n.error(`Unknown expression "${s}". If you wanted a literal array, use ["literal", [...]].`,0);const p=Array.isArray(u)?u[0]:u.type,g=Array.isArray(u)?[[u[1],u[2]]]:u.overloads,v=g.filter(([T])=>!Array.isArray(T)||T.length===t.length-1);let w=null;for(const[T,P]of v){w=new Io(n.registry,Pl,n.path,null,n.scope);const E=[];let D=!1;for(let R=1;R<t.length;R++){const B=t[R],V=Array.isArray(T)?T[R-1]:T.type,G=w.parse(B,1+E.length,V);if(!G){D=!0;break}E.push(G)}if(!D)if(Array.isArray(T)&&T.length!==E.length)w.error(`Expected ${T.length} arguments, but found ${E.length} instead.`);else{for(let R=0;R<E.length;R++){const B=Array.isArray(T)?T[R]:T.type,V=E[R];w.concat(R+1).checkSubtype(B,V.type)}if(w.errors.length===0)return new or(s,p,P,E)}}if(v.length===1)n.errors.push(...w.errors);else{const T=(v.length?v:g).map(([E])=>{return D=E,Array.isArray(D)?`(${D.map($t).join(", ")})`:`(${$t(D.type)}...)`;var D}).join(" | "),P=[];for(let E=1;E<t.length;E++){const D=n.parse(t[E],1+P.length);if(!D)return null;P.push($t(D.type))}n.error(`Expected arguments of type ${T}, but found (${P.join(", ")}) instead.`)}return null}static register(t,n){or.definitions=n;for(const s in n)t[s]=or}}function yd(r,[t,n,s,u]){t=t.evaluate(r),n=n.evaluate(r),s=s.evaluate(r);const p=u?u.evaluate(r):1,g=Kt(t,n,s,p);if(g)throw new Zt(g);return new Tt(t/255,n/255,s/255,p,!1)}function _d(r,t){return r in t}function fu(r,t){const n=t[r];return n===void 0?null:n}function Ga(r){return{type:r}}function Pl(r){if(r instanceof fl)return Pl(r.boundExpression);if(r instanceof or&&r.name==="error"||r instanceof vl||r instanceof Ua||r instanceof Za||r instanceof bs)return!1;const t=r instanceof jr||r instanceof Xn;let n=!0;return r.eachChild(s=>{n=t?n&&Pl(s):n&&s instanceof Kr}),!!n&&kl(r)&&Ml(r,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function kl(r){if(r instanceof or&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof Ua||r instanceof Za)return!1;let t=!0;return r.eachChild(n=>{t&&!kl(n)&&(t=!1)}),t}function ws(r){if(r instanceof or&&r.name==="feature-state")return!1;let t=!0;return r.eachChild(n=>{t&&!ws(n)&&(t=!1)}),t}function Ml(r,t){if(r instanceof or&&t.indexOf(r.name)>=0)return!1;let n=!0;return r.eachChild(s=>{n&&!Ml(s,t)&&(n=!1)}),n}function vd(r){return{result:"success",value:r}}function Po(r){return{result:"error",value:r}}function va(r){return r["property-type"]==="data-driven"||r["property-type"]==="cross-faded-data-driven"}function xd(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function gu(r){return!!r.expression&&r.expression.interpolated}function kt(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function Cs(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)&&dt(r)===ma}function tf(r){return r}function bd(r,t){const n=r.stops&&typeof r.stops[0][0]=="object",s=n||!(n||r.property!==void 0),u=r.type||(gu(t)?"exponential":"interval"),p=function(P){switch(P.type){case"color":return Tt.parse;case"padding":return Hi.parse;case"numberArray":return wn.parse;case"colorArray":return Ni.parse;default:return null}}(t);if(p&&((r=Ii({},r)).stops&&(r.stops=r.stops.map(P=>[P[0],p(P[1])])),r.default=p(r.default?r.default:t.default)),r.colorSpace&&(g=r.colorSpace)!=="rgb"&&g!=="hcl"&&g!=="lab")throw new Error(`Unknown color space: "${r.colorSpace}"`);var g;const v=function(P){switch(P){case"exponential":return Cd;case"interval":return nf;case"categorical":return wd;case"identity":return rf;default:throw new Error(`Unknown function type "${P}"`)}}(u);let w,T;if(u==="categorical"){w=Object.create(null);for(const P of r.stops)w[P[0]]=P[1];T=typeof r.stops[0][0]}if(n){const P={},E=[];for(let B=0;B<r.stops.length;B++){const V=r.stops[B],G=V[0].zoom;P[G]===void 0&&(P[G]={zoom:G,type:r.type,property:r.property,default:r.default,stops:[]},E.push(G)),P[G].stops.push([V[0].value,V[1]])}const D=[];for(const B of E)D.push([P[B].zoom,bd(P[B],t)]);const R={name:"linear"};return{kind:"composite",interpolationType:R,interpolationFactor:rn.interpolationFactor.bind(void 0,R),zoomStops:D.map(B=>B[0]),evaluate:({zoom:B},V)=>Cd({stops:D,base:r.base},t,B).evaluate(B,V)}}if(s){const P=u==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:P,interpolationFactor:rn.interpolationFactor.bind(void 0,P),zoomStops:r.stops.map(E=>E[0]),evaluate:({zoom:E})=>v(r,t,E,w,T)}}return{kind:"source",evaluate(P,E){const D=E&&E.properties?E.properties[r.property]:void 0;return D===void 0?xa(r.default,t.default):v(r,t,D,w,T)}}}function xa(r,t,n){return r!==void 0?r:t!==void 0?t:n!==void 0?n:void 0}function wd(r,t,n,s,u){return xa(typeof n===u?s[n]:void 0,r.default,t.default)}function nf(r,t,n){if(kt(n)!=="number")return xa(r.default,t.default);const s=r.stops.length;if(s===1||n<=r.stops[0][0])return r.stops[0][1];if(n>=r.stops[s-1][0])return r.stops[s-1][1];const u=ja(r.stops.map(p=>p[0]),n);return r.stops[u][1]}function Cd(r,t,n){const s=r.base!==void 0?r.base:1;if(kt(n)!=="number")return xa(r.default,t.default);const u=r.stops.length;if(u===1||n<=r.stops[0][0])return r.stops[0][1];if(n>=r.stops[u-1][0])return r.stops[u-1][1];const p=ja(r.stops.map(P=>P[0]),n),g=function(P,E,D,R){const B=R-D,V=P-D;return B===0?0:E===1?V/B:(Math.pow(E,V)-1)/(Math.pow(E,B)-1)}(n,s,r.stops[p][0],r.stops[p+1][0]),v=r.stops[p][1],w=r.stops[p+1][1],T=Or[t.type]||tf;return typeof v.evaluate=="function"?{evaluate(...P){const E=v.evaluate.apply(void 0,P),D=w.evaluate.apply(void 0,P);if(E!==void 0&&D!==void 0)return T(E,D,g,r.colorSpace)}}:T(v,w,g,r.colorSpace)}function rf(r,t,n){switch(t.type){case"color":n=Tt.parse(n);break;case"formatted":n=bn.fromString(n.toString());break;case"resolvedImage":n=Hn.fromString(n.toString());break;case"padding":n=Hi.parse(n);break;case"colorArray":n=Ni.parse(n);break;case"numberArray":n=wn.parse(n);break;default:kt(n)===t.type||t.type==="enum"&&t.values[n]||(n=void 0)}return xa(n,r.default,t.default)}or.register(To,{error:[{kind:"error"},[xt],(r,[t])=>{throw new Zt(t.evaluate(r))}],typeof:[xt,[bt],(r,[t])=>$t(dt(t.evaluate(r)))],"to-rgba":[Fn(je,4),[nn],(r,[t])=>{const[n,s,u,p]=t.evaluate(r).rgb;return[255*n,255*s,255*u,p]}],rgb:[nn,[je,je,je],yd],rgba:[nn,[je,je,je,je],yd],has:{type:Ct,overloads:[[[xt],(r,[t])=>_d(t.evaluate(r),r.properties())],[[xt,ma],(r,[t,n])=>_d(t.evaluate(r),n.evaluate(r))]]},get:{type:bt,overloads:[[[xt],(r,[t])=>fu(t.evaluate(r),r.properties())],[[xt,ma],(r,[t,n])=>fu(t.evaluate(r),n.evaluate(r))]]},"feature-state":[bt,[xt],(r,[t])=>fu(t.evaluate(r),r.featureState||{})],properties:[ma,[],r=>r.properties()],"geometry-type":[xt,[],r=>r.geometryType()],id:[bt,[],r=>r.id()],zoom:[je,[],r=>r.globals.zoom],"heatmap-density":[je,[],r=>r.globals.heatmapDensity||0],elevation:[je,[],r=>r.globals.elevation||0],"line-progress":[je,[],r=>r.globals.lineProgress||0],accumulated:[bt,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[je,Ga(je),(r,t)=>{let n=0;for(const s of t)n+=s.evaluate(r);return n}],"*":[je,Ga(je),(r,t)=>{let n=1;for(const s of t)n*=s.evaluate(r);return n}],"-":{type:je,overloads:[[[je,je],(r,[t,n])=>t.evaluate(r)-n.evaluate(r)],[[je],(r,[t])=>-t.evaluate(r)]]},"/":[je,[je,je],(r,[t,n])=>t.evaluate(r)/n.evaluate(r)],"%":[je,[je,je],(r,[t,n])=>t.evaluate(r)%n.evaluate(r)],ln2:[je,[],()=>Math.LN2],pi:[je,[],()=>Math.PI],e:[je,[],()=>Math.E],"^":[je,[je,je],(r,[t,n])=>Math.pow(t.evaluate(r),n.evaluate(r))],sqrt:[je,[je],(r,[t])=>Math.sqrt(t.evaluate(r))],log10:[je,[je],(r,[t])=>Math.log(t.evaluate(r))/Math.LN10],ln:[je,[je],(r,[t])=>Math.log(t.evaluate(r))],log2:[je,[je],(r,[t])=>Math.log(t.evaluate(r))/Math.LN2],sin:[je,[je],(r,[t])=>Math.sin(t.evaluate(r))],cos:[je,[je],(r,[t])=>Math.cos(t.evaluate(r))],tan:[je,[je],(r,[t])=>Math.tan(t.evaluate(r))],asin:[je,[je],(r,[t])=>Math.asin(t.evaluate(r))],acos:[je,[je],(r,[t])=>Math.acos(t.evaluate(r))],atan:[je,[je],(r,[t])=>Math.atan(t.evaluate(r))],min:[je,Ga(je),(r,t)=>Math.min(...t.map(n=>n.evaluate(r)))],max:[je,Ga(je),(r,t)=>Math.max(...t.map(n=>n.evaluate(r)))],abs:[je,[je],(r,[t])=>Math.abs(t.evaluate(r))],round:[je,[je],(r,[t])=>{const n=t.evaluate(r);return n<0?-Math.round(-n):Math.round(n)}],floor:[je,[je],(r,[t])=>Math.floor(t.evaluate(r))],ceil:[je,[je],(r,[t])=>Math.ceil(t.evaluate(r))],"filter-==":[Ct,[xt,bt],(r,[t,n])=>r.properties()[t.value]===n.value],"filter-id-==":[Ct,[bt],(r,[t])=>r.id()===t.value],"filter-type-==":[Ct,[xt],(r,[t])=>r.geometryType()===t.value],"filter-<":[Ct,[xt,bt],(r,[t,n])=>{const s=r.properties()[t.value],u=n.value;return typeof s==typeof u&&s<u}],"filter-id-<":[Ct,[bt],(r,[t])=>{const n=r.id(),s=t.value;return typeof n==typeof s&&n<s}],"filter->":[Ct,[xt,bt],(r,[t,n])=>{const s=r.properties()[t.value],u=n.value;return typeof s==typeof u&&s>u}],"filter-id->":[Ct,[bt],(r,[t])=>{const n=r.id(),s=t.value;return typeof n==typeof s&&n>s}],"filter-<=":[Ct,[xt,bt],(r,[t,n])=>{const s=r.properties()[t.value],u=n.value;return typeof s==typeof u&&s<=u}],"filter-id-<=":[Ct,[bt],(r,[t])=>{const n=r.id(),s=t.value;return typeof n==typeof s&&n<=s}],"filter->=":[Ct,[xt,bt],(r,[t,n])=>{const s=r.properties()[t.value],u=n.value;return typeof s==typeof u&&s>=u}],"filter-id->=":[Ct,[bt],(r,[t])=>{const n=r.id(),s=t.value;return typeof n==typeof s&&n>=s}],"filter-has":[Ct,[bt],(r,[t])=>t.value in r.properties()],"filter-has-id":[Ct,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[Ct,[Fn(xt)],(r,[t])=>t.value.indexOf(r.geometryType())>=0],"filter-id-in":[Ct,[Fn(bt)],(r,[t])=>t.value.indexOf(r.id())>=0],"filter-in-small":[Ct,[xt,Fn(bt)],(r,[t,n])=>n.value.indexOf(r.properties()[t.value])>=0],"filter-in-large":[Ct,[xt,Fn(bt)],(r,[t,n])=>function(s,u,p,g){for(;p<=g;){const v=p+g>>1;if(u[v]===s)return!0;u[v]>s?g=v-1:p=v+1}return!1}(r.properties()[t.value],n.value,0,n.value.length-1)],all:{type:Ct,overloads:[[[Ct,Ct],(r,[t,n])=>t.evaluate(r)&&n.evaluate(r)],[Ga(Ct),(r,t)=>{for(const n of t)if(!n.evaluate(r))return!1;return!0}]]},any:{type:Ct,overloads:[[[Ct,Ct],(r,[t,n])=>t.evaluate(r)||n.evaluate(r)],[Ga(Ct),(r,t)=>{for(const n of t)if(n.evaluate(r))return!0;return!1}]]},"!":[Ct,[Ct],(r,[t])=>!t.evaluate(r)],"is-supported-script":[Ct,[xt],(r,[t])=>{const n=r.globals&&r.globals.isSupportedScript;return!n||n(t.evaluate(r))}],upcase:[xt,[xt],(r,[t])=>t.evaluate(r).toUpperCase()],downcase:[xt,[xt],(r,[t])=>t.evaluate(r).toLowerCase()],concat:[xt,Ga(bt),(r,t)=>t.map(n=>_t(n.evaluate(r))).join("")],"resolved-locale":[xt,[cl],(r,[t])=>t.evaluate(r).resolvedLocale()]});class yu{constructor(t,n,s){this.expression=t,this._warningHistory={},this._evaluator=new Qc,this._defaultValue=n?function(u){if(u.type==="color"&&Cs(u.default))return new Tt(0,0,0,0);switch(u.type){case"color":return Tt.parse(u.default)||null;case"padding":return Hi.parse(u.default)||null;case"numberArray":return wn.parse(u.default)||null;case"colorArray":return Ni.parse(u.default)||null;case"variableAnchorOffsetCollection":return Cn.parse(u.default)||null;case"projectionDefinition":return dn.parse(u.default)||null;default:return u.default===void 0?null:u.default}}(n):null,this._enumValues=n&&n.type==="enum"?n.values:null,this._globalState=s}evaluateWithoutErrorHandling(t,n,s,u,p,g){return this._globalState&&(t=Wa(t,this._globalState)),this._evaluator.globals=t,this._evaluator.feature=n,this._evaluator.featureState=s,this._evaluator.canonical=u,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=g,this.expression.evaluate(this._evaluator)}evaluate(t,n,s,u,p,g){this._globalState&&(t=Wa(t,this._globalState)),this._evaluator.globals=t,this._evaluator.feature=n||null,this._evaluator.featureState=s||null,this._evaluator.canonical=u,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=g||null;try{const v=this.expression.evaluate(this._evaluator);if(v==null||typeof v=="number"&&v!=v)return this._defaultValue;if(this._enumValues&&!(v in this._enumValues))throw new Zt(`Expected value to be one of ${Object.keys(this._enumValues).map(w=>JSON.stringify(w)).join(", ")}, but found ${JSON.stringify(v)} instead.`);return v}catch(v){return this._warningHistory[v.message]||(this._warningHistory[v.message]=!0,typeof console<"u"&&console.warn(v.message)),this._defaultValue}}}function El(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in To}function Is(r,t,n){const s=new Io(To,Pl,[],t?function(p){const g={color:nn,string:xt,number:je,enum:xt,boolean:Ct,formatted:fa,padding:ul,numberArray:vo,colorArray:Fr,projectionDefinition:Da,resolvedImage:vi,variableAnchorOffsetCollection:hl};return p.type==="array"?Fn(g[p.value]||bt,p.length):g[p.type]}(t):void 0),u=s.parse(r,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?vd(new yu(u,t,n)):Po(s.errors)}class As{constructor(t,n,s){this.kind=t,this._styleExpression=n,this.isStateDependent=t!=="constant"&&!ws(n.expression),this.globalStateRefs=Ps(n.expression),this._globalState=s}evaluateWithoutErrorHandling(t,n,s,u,p,g){return this._globalState&&(t=Wa(t,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(t,n,s,u,p,g)}evaluate(t,n,s,u,p,g){return this._globalState&&(t=Wa(t,this._globalState)),this._styleExpression.evaluate(t,n,s,u,p,g)}}class _u{constructor(t,n,s,u,p){this.kind=t,this.zoomStops=s,this._styleExpression=n,this.isStateDependent=t!=="camera"&&!ws(n.expression),this.globalStateRefs=Ps(n.expression),this.interpolationType=u,this._globalState=p}evaluateWithoutErrorHandling(t,n,s,u,p,g){return this._globalState&&(t=Wa(t,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(t,n,s,u,p,g)}evaluate(t,n,s,u,p,g){return this._globalState&&(t=Wa(t,this._globalState)),this._styleExpression.evaluate(t,n,s,u,p,g)}interpolationFactor(t,n,s){return this.interpolationType?rn.interpolationFactor(this.interpolationType,t,n,s):0}}function Id(r,t,n){const s=Is(r,t,n);if(s.result==="error")return s;const u=s.value.expression,p=kl(u);if(!p&&!va(t))return Po([new qn("","data expressions not supported")]);const g=Ml(u,["zoom"]);if(!g&&!xd(t))return Po([new qn("","zoom expressions not supported")]);const v=Ts(u);return v||g?v instanceof qn?Po([v]):v instanceof rn&&!gu(t)?Po([new qn("",'"interpolate" expressions cannot be used with this property')]):vd(v?new _u(p?"camera":"composite",s.value,v.labels,v instanceof rn?v.interpolation:void 0,n):new As(p?"constant":"source",s.value,n)):Po([new qn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ss{constructor(t,n){this._parameters=t,this._specification=n,Ii(this,bd(this._parameters,this._specification))}static deserialize(t){return new Ss(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Ts(r){let t=null;if(r instanceof us)t=Ts(r.result);else if(r instanceof ms){for(const n of r.args)if(t=Ts(n),t)break}else(r instanceof xi||r instanceof rn)&&r.input instanceof or&&r.input.name==="zoom"&&(t=r);return t instanceof qn||r.eachChild(n=>{const s=Ts(n);s instanceof qn?t=s:!t&&s?t=new qn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&s&&t!==s&&(t=new qn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function Ps(r,t=new Set){return r instanceof bs&&t.add(r.key),r.eachChild(n=>{Ps(n,t)}),t}function Wa(r,t){const{zoom:n,heatmapDensity:s,elevation:u,lineProgress:p,isSupportedScript:g,accumulated:v}=r??{};return{zoom:n,heatmapDensity:s,elevation:u,lineProgress:p,isSupportedScript:g,accumulated:v,globalState:t}}function ks(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const t of r.slice(1))if(!ks(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const vu={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function qa(r,t){if(r==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};ks(r)||(r=zl(r));const n=Is(r,vu,t);if(n.result==="error")throw new Error(n.value.map(s=>`${s.key}: ${s.message}`).join(", "));return{filter:(s,u,p)=>n.value.evaluate(s,u,{},p),needGeometry:Ms(r),getGlobalStateRefs:()=>Ps(n.value.expression)}}function xu(r,t){return r<t?-1:r>t?1:0}function Ms(r){if(!Array.isArray(r))return!1;if(r[0]==="within"||r[0]==="distance")return!0;for(let t=1;t<r.length;t++)if(Ms(r[t]))return!0;return!1}function zl(r){if(!r)return!0;const t=r[0];return r.length<=1?t!=="any":t==="=="?bu(r[1],r[2],"=="):t==="!="?Nl(bu(r[1],r[2],"==")):t==="<"||t===">"||t==="<="||t===">="?bu(r[1],r[2],t):t==="any"?(n=r.slice(1),["any"].concat(n.map(zl))):t==="all"?["all"].concat(r.slice(1).map(zl)):t==="none"?["all"].concat(r.slice(1).map(zl).map(Nl)):t==="in"?Ad(r[1],r.slice(2)):t==="!in"?Nl(Ad(r[1],r.slice(2))):t==="has"?Sd(r[1]):t!=="!has"||Nl(Sd(r[1]));var n}function bu(r,t,n){switch(r){case"$type":return[`filter-type-${n}`,t];case"$id":return[`filter-id-${n}`,t];default:return[`filter-${n}`,r,t]}}function Ad(r,t){if(t.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(n=>typeof n!=typeof t[0])?["filter-in-large",r,["literal",t.sort(xu)]]:["filter-in-small",r,["literal",t]]}}function Sd(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function Nl(r){return["!",r]}function wu(r){const t=typeof r;if(t==="number"||t==="boolean"||t==="string"||r==null)return JSON.stringify(r);if(Array.isArray(r)){let u="[";for(const p of r)u+=`${wu(p)},`;return`${u}]`}const n=Object.keys(r).sort();let s="{";for(let u=0;u<n.length;u++)s+=`${JSON.stringify(n[u])}:${wu(r[n[u]])},`;return`${s}}`}function Td(r){let t="";for(const n of gt)t+=`/${wu(r[n])}`;return t}function Cu(r){const t=r.value;return t?[new Ne(r.key,t,"constants have been deprecated as of v8")]:[]}function ri(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function Ha(r){if(Array.isArray(r))return r.map(Ha);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const t={};for(const n in r)t[n]=Ha(r[n]);return t}return ri(r)}function Kn(r){const t=r.key,n=r.value,s=r.valueSpec||{},u=r.objectElementValidators||{},p=r.style,g=r.styleSpec,v=r.validateSpec;let w=[];const T=kt(n);if(T!=="object")return[new Ne(t,n,`object expected, ${T} found`)];for(const P in n){const E=P.split(".")[0],D=Co(s,E)||s["*"];let R;if(Co(u,E))R=u[E];else if(Co(s,E))R=v;else if(u["*"])R=u["*"];else{if(!s["*"]){w.push(new Ne(t,n[P],`unknown property "${P}"`));continue}R=v}w=w.concat(R({key:(t&&`${t}.`)+P,value:n[P],valueSpec:D,style:p,styleSpec:g,object:n,objectKey:P,validateSpec:v},n))}for(const P in s)u[P]||s[P].required&&s[P].default===void 0&&n[P]===void 0&&w.push(new Ne(t,n,`missing required property "${P}"`));return w}function Dl(r){const t=r.value,n=r.valueSpec,s=r.style,u=r.styleSpec,p=r.key,g=r.arrayElementValidator||r.validateSpec;if(kt(t)!=="array")return[new Ne(p,t,`array expected, ${kt(t)} found`)];if(n.length&&t.length!==n.length)return[new Ne(p,t,`array length ${n.length} expected, length ${t.length} found`)];if(n["min-length"]&&t.length<n["min-length"])return[new Ne(p,t,`array length at least ${n["min-length"]} expected, length ${t.length} found`)];let v={type:n.value,values:n.values};u.$version<7&&(v.function=n.function),kt(n.value)==="object"&&(v=n.value);let w=[];for(let T=0;T<t.length;T++)w=w.concat(g({array:t,arrayIndex:T,value:t[T],valueSpec:v,validateSpec:r.validateSpec,style:s,styleSpec:u,key:`${p}[${T}]`}));return w}function Ll(r){const t=r.key,n=r.value,s=r.valueSpec;let u=kt(n);return u==="number"&&n!=n&&(u="NaN"),u!=="number"?[new Ne(t,n,`number expected, ${u} found`)]:"minimum"in s&&n<s.minimum?[new Ne(t,n,`${n} is less than the minimum value ${s.minimum}`)]:"maximum"in s&&n>s.maximum?[new Ne(t,n,`${n} is greater than the maximum value ${s.maximum}`)]:[]}function Iu(r){const t=r.valueSpec,n=ri(r.value.type);let s,u,p,g={};const v=n!=="categorical"&&r.value.property===void 0,w=!v,T=kt(r.value.stops)==="array"&&kt(r.value.stops[0])==="array"&&kt(r.value.stops[0][0])==="object",P=Kn({key:r.key,value:r.value,valueSpec:r.styleSpec.function,validateSpec:r.validateSpec,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(R){if(n==="identity")return[new Ne(R.key,R.value,'identity function may not have a "stops" property')];let B=[];const V=R.value;return B=B.concat(Dl({key:R.key,value:V,valueSpec:R.valueSpec,validateSpec:R.validateSpec,style:R.style,styleSpec:R.styleSpec,arrayElementValidator:E})),kt(V)==="array"&&V.length===0&&B.push(new Ne(R.key,V,"array must have at least one stop")),B},default:function(R){return R.validateSpec({key:R.key,value:R.value,valueSpec:t,validateSpec:R.validateSpec,style:R.style,styleSpec:R.styleSpec})}}});return n==="identity"&&v&&P.push(new Ne(r.key,r.value,'missing required property "property"')),n==="identity"||r.value.stops||P.push(new Ne(r.key,r.value,'missing required property "stops"')),n==="exponential"&&r.valueSpec.expression&&!gu(r.valueSpec)&&P.push(new Ne(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(w&&!va(r.valueSpec)?P.push(new Ne(r.key,r.value,"property functions not supported")):v&&!xd(r.valueSpec)&&P.push(new Ne(r.key,r.value,"zoom functions not supported"))),n!=="categorical"&&!T||r.value.property!==void 0||P.push(new Ne(r.key,r.value,'"property" property is required')),P;function E(R){let B=[];const V=R.value,G=R.key;if(kt(V)!=="array")return[new Ne(G,V,`array expected, ${kt(V)} found`)];if(V.length!==2)return[new Ne(G,V,`array length 2 expected, length ${V.length} found`)];if(T){if(kt(V[0])!=="object")return[new Ne(G,V,`object expected, ${kt(V[0])} found`)];if(V[0].zoom===void 0)return[new Ne(G,V,"object stop key must have zoom")];if(V[0].value===void 0)return[new Ne(G,V,"object stop key must have value")];if(p&&p>ri(V[0].zoom))return[new Ne(G,V[0].zoom,"stop zoom values must appear in ascending order")];ri(V[0].zoom)!==p&&(p=ri(V[0].zoom),u=void 0,g={}),B=B.concat(Kn({key:`${G}[0]`,value:V[0],valueSpec:{zoom:{}},validateSpec:R.validateSpec,style:R.style,styleSpec:R.styleSpec,objectElementValidators:{zoom:Ll,value:D}}))}else B=B.concat(D({key:`${G}[0]`,value:V[0],validateSpec:R.validateSpec,style:R.style,styleSpec:R.styleSpec},V));return El(Ha(V[1]))?B.concat([new Ne(`${G}[1]`,V[1],"expressions are not allowed in function stops.")]):B.concat(R.validateSpec({key:`${G}[1]`,value:V[1],valueSpec:t,validateSpec:R.validateSpec,style:R.style,styleSpec:R.styleSpec}))}function D(R,B){const V=kt(R.value),G=ri(R.value),Y=R.value!==null?R.value:B;if(s){if(V!==s)return[new Ne(R.key,Y,`${V} stop domain type must match previous stop domain type ${s}`)]}else s=V;if(V!=="number"&&V!=="string"&&V!=="boolean")return[new Ne(R.key,Y,"stop domain value must be a number, string, or boolean")];if(V!=="number"&&n!=="categorical"){let _e=`number expected, ${V} found`;return va(t)&&n===void 0&&(_e+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ne(R.key,Y,_e)]}return n!=="categorical"||V!=="number"||isFinite(G)&&Math.floor(G)===G?n!=="categorical"&&V==="number"&&u!==void 0&&G<u?[new Ne(R.key,Y,"stop domain values must appear in ascending order")]:(u=G,n==="categorical"&&G in g?[new Ne(R.key,Y,"stop domain values must be unique")]:(g[G]=!0,[])):[new Ne(R.key,Y,`integer expected, found ${G}`)]}}function Xa(r){const t=(r.expressionContext==="property"?Id:Is)(Ha(r.value),r.valueSpec);if(t.result==="error")return t.value.map(s=>new Ne(`${r.key}${s.key}`,r.value,s.message));const n=t.value.expression||t.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!n.outputDefined())return[new Ne(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!ws(n))return[new Ne(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter"&&!ws(n))return[new Ne(r.key,r.value,'"feature-state" data expressions are not supported with filters.')];if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!Ml(n,["zoom","feature-state"]))return[new Ne(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!kl(n))return[new Ne(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ka(r){const t=r.key,n=r.value,s=kt(n);return s!=="string"?[new Ne(t,n,`color expected, ${s} found`)]:Tt.parse(String(n))?[]:[new Ne(t,n,`color expected, "${n}" found`)]}function Es(r){const t=r.key,n=r.value,s=r.valueSpec,u=[];return Array.isArray(s.values)?s.values.indexOf(ri(n))===-1&&u.push(new Ne(t,n,`expected one of [${s.values.join(", ")}], ${JSON.stringify(n)} found`)):Object.keys(s.values).indexOf(ri(n))===-1&&u.push(new Ne(t,n,`expected one of [${Object.keys(s.values).join(", ")}], ${JSON.stringify(n)} found`)),u}function Au(r){return ks(Ha(r.value))?Xa(Ii({},r,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Pd(r)}function Pd(r){const t=r.value,n=r.key;if(kt(t)!=="array")return[new Ne(n,t,`array expected, ${kt(t)} found`)];const s=r.styleSpec;let u,p=[];if(t.length<1)return[new Ne(n,t,"filter array must have at least 1 element")];switch(p=p.concat(Es({key:`${n}[0]`,value:t[0],valueSpec:s.filter_operator,style:r.style,styleSpec:r.styleSpec})),ri(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&ri(t[1])==="$type"&&p.push(new Ne(n,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&p.push(new Ne(n,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(u=kt(t[1]),u!=="string"&&p.push(new Ne(`${n}[1]`,t[1],`string expected, ${u} found`)));for(let g=2;g<t.length;g++)u=kt(t[g]),ri(t[1])==="$type"?p=p.concat(Es({key:`${n}[${g}]`,value:t[g],valueSpec:s.geometry_type,style:r.style,styleSpec:r.styleSpec})):u!=="string"&&u!=="number"&&u!=="boolean"&&p.push(new Ne(`${n}[${g}]`,t[g],`string, number, or boolean expected, ${u} found`));break;case"any":case"all":case"none":for(let g=1;g<t.length;g++)p=p.concat(Pd({key:`${n}[${g}]`,value:t[g],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":u=kt(t[1]),t.length!==2?p.push(new Ne(n,t,`filter array for "${t[0]}" operator must have 2 elements`)):u!=="string"&&p.push(new Ne(`${n}[1]`,t[1],`string expected, ${u} found`))}return p}function kd(r,t){const n=r.key,s=r.validateSpec,u=r.style,p=r.styleSpec,g=r.value,v=r.objectKey,w=p[`${t}_${r.layerType}`];if(!w)return[];const T=v.match(/^(.*)-transition$/);if(t==="paint"&&T&&w[T[1]]&&w[T[1]].transition)return s({key:n,value:g,valueSpec:p.transition,style:u,styleSpec:p});const P=r.valueSpec||w[v];if(!P)return[new Ne(n,g,`unknown property "${v}"`)];let E;if(kt(g)==="string"&&va(P)&&!P.tokens&&(E=/^{([^}]+)}$/.exec(g)))return[new Ne(n,g,`"${v}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(E[1])} }\`.`)];const D=[];return r.layerType==="symbol"&&(v==="text-field"&&u&&!u.glyphs&&D.push(new Ne(n,g,'use of "text-field" requires a style "glyphs" property')),v==="text-font"&&Cs(Ha(g))&&ri(g.type)==="identity"&&D.push(new Ne(n,g,'"text-font" does not support identity functions'))),D.concat(s({key:r.key,value:g,valueSpec:P,style:u,styleSpec:p,expressionContext:"property",propertyType:t,propertyKey:v}))}function Md(r){return kd(r,"paint")}function Ed(r){return kd(r,"layout")}function ko(r){let t=[];const n=r.value,s=r.key,u=r.style,p=r.styleSpec;if(kt(n)!=="object")return[new Ne(s,n,`object expected, ${kt(n)} found`)];n.type||n.ref||t.push(new Ne(s,n,'either "type" or "ref" is required'));let g=ri(n.type);const v=ri(n.ref);if(n.id){const w=ri(n.id);for(let T=0;T<r.arrayIndex;T++){const P=u.layers[T];ri(P.id)===w&&t.push(new Ne(s,n.id,`duplicate layer id "${n.id}", previously used at line ${P.id.__line__}`))}}if("ref"in n){let w;["type","source","source-layer","filter","layout"].forEach(T=>{T in n&&t.push(new Ne(s,n[T],`"${T}" is prohibited for ref layers`))}),u.layers.forEach(T=>{ri(T.id)===v&&(w=T)}),w?w.ref?t.push(new Ne(s,n.ref,"ref cannot reference another ref layer")):g=ri(w.type):t.push(new Ne(s,n.ref,`ref layer "${v}" not found`))}else if(g!=="background")if(n.source){const w=u.sources&&u.sources[n.source],T=w&&ri(w.type);w?T==="vector"&&g==="raster"?t.push(new Ne(s,n.source,`layer "${n.id}" requires a raster source`)):T!=="raster-dem"&&g==="hillshade"||T!=="raster-dem"&&g==="color-relief"?t.push(new Ne(s,n.source,`layer "${n.id}" requires a raster-dem source`)):T==="raster"&&g!=="raster"?t.push(new Ne(s,n.source,`layer "${n.id}" requires a vector source`)):T!=="vector"||n["source-layer"]?T==="raster-dem"&&g!=="hillshade"&&g!=="color-relief"?t.push(new Ne(s,n.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):g!=="line"||!n.paint||!n.paint["line-gradient"]||T==="geojson"&&w.lineMetrics||t.push(new Ne(s,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new Ne(s,n,`layer "${n.id}" must specify a "source-layer"`)):t.push(new Ne(s,n.source,`source "${n.source}" not found`))}else t.push(new Ne(s,n,'missing required property "source"'));return t=t.concat(Kn({key:s,value:n,valueSpec:p.layer,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,objectElementValidators:{"*":()=>[],type:()=>r.validateSpec({key:`${s}.type`,value:n.type,valueSpec:p.layer.type,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,object:n,objectKey:"type"}),filter:Au,layout:w=>Kn({layer:n,key:w.key,value:w.value,style:w.style,styleSpec:w.styleSpec,validateSpec:w.validateSpec,objectElementValidators:{"*":T=>Ed(Ii({layerType:g},T))}}),paint:w=>Kn({layer:n,key:w.key,value:w.value,style:w.style,styleSpec:w.styleSpec,validateSpec:w.validateSpec,objectElementValidators:{"*":T=>Md(Ii({layerType:g},T))}})}})),t}function br(r){const t=r.value,n=r.key,s=kt(t);return s!=="string"?[new Ne(n,t,`string expected, ${s} found`)]:[]}const Bn={promoteId:function({key:r,value:t}){if(kt(t)==="string")return br({key:r,value:t});{const n=[];for(const s in t)n.push(...br({key:`${r}.${s}`,value:t[s]}));return n}}};function Mo(r){const t=r.value,n=r.key,s=r.styleSpec,u=r.style,p=r.validateSpec;if(!t.type)return[new Ne(n,t,'"type" is required')];const g=ri(t.type);let v;switch(g){case"vector":case"raster":return v=Kn({key:n,value:t,valueSpec:s[`source_${g.replace("-","_")}`],style:r.style,styleSpec:s,objectElementValidators:Bn,validateSpec:p}),v;case"raster-dem":return v=function(w){var T;const P=(T=w.sourceName)!==null&&T!==void 0?T:"",E=w.value,D=w.styleSpec,R=D.source_raster_dem,B=w.style;let V=[];const G=kt(E);if(E===void 0)return V;if(G!=="object")return V.push(new Ne("source_raster_dem",E,`object expected, ${G} found`)),V;const Y=ri(E.encoding)==="custom",_e=["redFactor","greenFactor","blueFactor","baseShift"],ne=w.value.encoding?`"${w.value.encoding}"`:"Default";for(const ue in E)!Y&&_e.includes(ue)?V.push(new Ne(ue,E[ue],`In "${P}": "${ue}" is only valid when "encoding" is set to "custom". ${ne} encoding found`)):R[ue]?V=V.concat(w.validateSpec({key:ue,value:E[ue],valueSpec:R[ue],validateSpec:w.validateSpec,style:B,styleSpec:D})):V.push(new Ne(ue,E[ue],`unknown property "${ue}"`));return V}({sourceName:n,value:t,style:r.style,styleSpec:s,validateSpec:p}),v;case"geojson":if(v=Kn({key:n,value:t,valueSpec:s.source_geojson,style:u,styleSpec:s,validateSpec:p,objectElementValidators:Bn}),t.cluster)for(const w in t.clusterProperties){const[T,P]=t.clusterProperties[w],E=typeof T=="string"?[T,["accumulated"],["get",w]]:T;v.push(...Xa({key:`${n}.${w}.map`,value:P,expressionContext:"cluster-map"})),v.push(...Xa({key:`${n}.${w}.reduce`,value:E,expressionContext:"cluster-reduce"}))}return v;case"video":return Kn({key:n,value:t,valueSpec:s.source_video,style:u,validateSpec:p,styleSpec:s});case"image":return Kn({key:n,value:t,valueSpec:s.source_image,style:u,validateSpec:p,styleSpec:s});case"canvas":return[new Ne(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Es({key:`${n}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Su(r){const t=r.value,n=r.styleSpec,s=n.light,u=r.style;let p=[];const g=kt(t);if(t===void 0)return p;if(g!=="object")return p=p.concat([new Ne("light",t,`object expected, ${g} found`)]),p;for(const v in t){const w=v.match(/^(.*)-transition$/);p=p.concat(w&&s[w[1]]&&s[w[1]].transition?r.validateSpec({key:v,value:t[v],valueSpec:n.transition,validateSpec:r.validateSpec,style:u,styleSpec:n}):s[v]?r.validateSpec({key:v,value:t[v],valueSpec:s[v],validateSpec:r.validateSpec,style:u,styleSpec:n}):[new Ne(v,t[v],`unknown property "${v}"`)])}return p}function zd(r){const t=r.value,n=r.styleSpec,s=n.sky,u=r.style,p=kt(t);if(t===void 0)return[];if(p!=="object")return[new Ne("sky",t,`object expected, ${p} found`)];let g=[];for(const v in t)g=g.concat(s[v]?r.validateSpec({key:v,value:t[v],valueSpec:s[v],style:u,styleSpec:n}):[new Ne(v,t[v],`unknown property "${v}"`)]);return g}function Nd(r){const t=r.value,n=r.styleSpec,s=n.terrain,u=r.style;let p=[];const g=kt(t);if(t===void 0)return p;if(g!=="object")return p=p.concat([new Ne("terrain",t,`object expected, ${g} found`)]),p;for(const v in t)p=p.concat(s[v]?r.validateSpec({key:v,value:t[v],valueSpec:s[v],validateSpec:r.validateSpec,style:u,styleSpec:n}):[new Ne(v,t[v],`unknown property "${v}"`)]);return p}function Eo(r){let t=[];const n=r.value,s=r.key;if(Array.isArray(n)){const u=[],p=[];for(const g in n)n[g].id&&u.includes(n[g].id)&&t.push(new Ne(s,n,`all the sprites' ids must be unique, but ${n[g].id} is duplicated`)),u.push(n[g].id),n[g].url&&p.includes(n[g].url)&&t.push(new Ne(s,n,`all the sprites' URLs must be unique, but ${n[g].url} is duplicated`)),p.push(n[g].url),t=t.concat(Kn({key:`${s}[${g}]`,value:n[g],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:r.validateSpec}));return t}return br({key:s,value:n})}function Tu(r){return t=r.value,t&&t.constructor===Object?[]:[new Ne(r.key,r.value,`object expected, ${kt(r.value)} found`)];var t}const Rl={"*":()=>[],array:Dl,boolean:function(r){const t=r.value,n=r.key,s=kt(t);return s!=="boolean"?[new Ne(n,t,`boolean expected, ${s} found`)]:[]},number:Ll,color:Ka,constants:Cu,enum:Es,filter:Au,function:Iu,layer:ko,object:Kn,source:Mo,light:Su,sky:zd,terrain:Nd,projection:function(r){const t=r.value,n=r.styleSpec,s=n.projection,u=r.style,p=kt(t);if(t===void 0)return[];if(p!=="object")return[new Ne("projection",t,`object expected, ${p} found`)];let g=[];for(const v in t)g=g.concat(s[v]?r.validateSpec({key:v,value:t[v],valueSpec:s[v],style:u,styleSpec:n}):[new Ne(v,t[v],`unknown property "${v}"`)]);return g},projectionDefinition:function(r){const t=r.key;let n=r.value;n=n instanceof String?n.valueOf():n;const s=kt(n);return s!=="array"||function(u){return Array.isArray(u)&&u.length===3&&typeof u[0]=="string"&&typeof u[1]=="string"&&typeof u[2]=="number"}(n)||function(u){return!!["interpolate","step","literal"].includes(u[0])}(n)?["array","string"].includes(s)?[]:[new Ne(t,n,`projection expected, invalid type "${s}" found`)]:[new Ne(t,n,`projection expected, invalid array ${JSON.stringify(n)} found`)]},string:br,formatted:function(r){return br(r).length===0?[]:Xa(r)},resolvedImage:function(r){return br(r).length===0?[]:Xa(r)},padding:function(r){const t=r.key,n=r.value;if(kt(n)==="array"){if(n.length<1||n.length>4)return[new Ne(t,n,`padding requires 1 to 4 values; ${n.length} values found`)];const s={type:"number"};let u=[];for(let p=0;p<n.length;p++)u=u.concat(r.validateSpec({key:`${t}[${p}]`,value:n[p],validateSpec:r.validateSpec,valueSpec:s}));return u}return Ll({key:t,value:n,valueSpec:{}})},numberArray:function(r){const t=r.key,n=r.value;if(kt(n)==="array"){const s={type:"number"};if(n.length<1)return[new Ne(t,n,"array length at least 1 expected, length 0 found")];let u=[];for(let p=0;p<n.length;p++)u=u.concat(r.validateSpec({key:`${t}[${p}]`,value:n[p],validateSpec:r.validateSpec,valueSpec:s}));return u}return Ll({key:t,value:n,valueSpec:{}})},colorArray:function(r){const t=r.key,n=r.value;if(kt(n)==="array"){if(n.length<1)return[new Ne(t,n,"array length at least 1 expected, length 0 found")];let s=[];for(let u=0;u<n.length;u++)s=s.concat(Ka({key:`${t}[${u}]`,value:n[u]}));return s}return Ka({key:t,value:n})},variableAnchorOffsetCollection:function(r){const t=r.key,n=r.value,s=kt(n),u=r.styleSpec;if(s!=="array"||n.length<1||n.length%2!=0)return[new Ne(t,n,"variableAnchorOffsetCollection requires a non-empty array of even length")];let p=[];for(let g=0;g<n.length;g+=2)p=p.concat(Es({key:`${t}[${g}]`,value:n[g],valueSpec:u.layout_symbol["text-anchor"]})),p=p.concat(Dl({key:`${t}[${g+1}]`,value:n[g+1],valueSpec:{length:2,value:"number"},validateSpec:r.validateSpec,style:r.style,styleSpec:u}));return p},sprite:Eo,state:Tu};function Fl(r){const t=r.value,n=r.valueSpec,s=r.styleSpec;return r.validateSpec=Fl,n.expression&&Cs(ri(t))?Iu(r):n.expression&&El(Ha(t))?Xa(r):n.type&&Rl[n.type]?Rl[n.type](r):Kn(Ii({},r,{valueSpec:n.type?s[n.type]:n}))}function Bl(r){const t=r.value,n=r.key,s=br(r);return s.length||(t.indexOf("{fontstack}")===-1&&s.push(new Ne(n,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&s.push(new Ne(n,t,'"glyphs" url must include a "{range}" token'))),s}function sr(r,t=ve){let n=[];return n=n.concat(Fl({key:"",value:r,valueSpec:t.$root,styleSpec:t,style:r,validateSpec:Fl,objectElementValidators:{glyphs:Bl,"*":()=>[]}})),r.constants&&(n=n.concat(Cu({key:"constants",value:r.constants}))),Dd(n)}function In(r){return function(t){return r(Object.assign({},t,{validateSpec:Fl}))}}function Dd(r){return[].concat(r).sort((t,n)=>t.line-n.line)}function wr(r){return function(...t){return Dd(r.apply(this,t))}}sr.source=wr(In(Mo)),sr.sprite=wr(In(Eo)),sr.glyphs=wr(In(Bl)),sr.light=wr(In(Su)),sr.sky=wr(In(zd)),sr.terrain=wr(In(Nd)),sr.state=wr(In(Tu)),sr.layer=wr(In(ko)),sr.filter=wr(In(Au)),sr.paintProperty=wr(In(Md)),sr.layoutProperty=wr(In(Ed));const zo=sr,zs=zo.light,af=zo.sky,of=zo.paintProperty,jl=zo.layoutProperty;function Ld(r,t){let n=!1;if(t&&t.length)for(const s of t)r.fire(new ze(new Error(s.message))),n=!0;return n}class Ya{constructor(t,n,s){const u=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const g=new Int32Array(this.arrayBuffer);t=g[0],this.d=(n=g[1])+2*(s=g[2]);for(let w=0;w<this.d*this.d;w++){const T=g[3+w],P=g[3+w+1];u.push(T===P?null:g.subarray(T,P))}const v=g[3+u.length+1];this.keys=g.subarray(g[3+u.length],v),this.bboxes=g.subarray(v),this.insert=this._insertReadonly}else{this.d=n+2*s;for(let g=0;g<this.d*this.d;g++)u.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=t,this.padding=s,this.scale=n/t,this.uid=0;const p=s/n*t;this.min=-p,this.max=t+p}insert(t,n,s,u,p){this._forEachCell(n,s,u,p,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(n),this.bboxes.push(s),this.bboxes.push(u),this.bboxes.push(p)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,n,s,u,p,g){this.cells[p].push(g)}query(t,n,s,u,p){const g=this.min,v=this.max;if(t<=g&&n<=g&&v<=s&&v<=u&&!p)return Array.prototype.slice.call(this.keys);{const w=[];return this._forEachCell(t,n,s,u,this._queryCell,w,{},p),w}}_queryCell(t,n,s,u,p,g,v,w){const T=this.cells[p];if(T!==null){const P=this.keys,E=this.bboxes;for(let D=0;D<T.length;D++){const R=T[D];if(v[R]===void 0){const B=4*R;(w?w(E[B+0],E[B+1],E[B+2],E[B+3]):t<=E[B+2]&&n<=E[B+3]&&s>=E[B+0]&&u>=E[B+1])?(v[R]=!0,g.push(P[R])):v[R]=!1}}}}_forEachCell(t,n,s,u,p,g,v,w){const T=this._convertToCellCoord(t),P=this._convertToCellCoord(n),E=this._convertToCellCoord(s),D=this._convertToCellCoord(u);for(let R=T;R<=E;R++)for(let B=P;B<=D;B++){const V=this.d*B+R;if((!w||w(this._convertFromCellCoord(R),this._convertFromCellCoord(B),this._convertFromCellCoord(R+1),this._convertFromCellCoord(B+1)))&&p.call(this,t,n,s,u,V,g,v,w))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,n=3+this.cells.length+1+1;let s=0;for(let g=0;g<this.cells.length;g++)s+=this.cells[g].length;const u=new Int32Array(n+s+this.keys.length+this.bboxes.length);u[0]=this.extent,u[1]=this.n,u[2]=this.padding;let p=n;for(let g=0;g<t.length;g++){const v=t[g];u[3+g]=p,u.set(v,p),p+=v.length}return u[3+t.length]=p,u.set(this.keys,p),p+=this.keys.length,u[3+t.length+1]=p,u.set(this.bboxes,p),p+=this.bboxes.length,u.buffer}static serialize(t,n){const s=t.toArrayBuffer();return n&&n.push(s),{buffer:s}}static deserialize(t){return new Ya(t.buffer)}}const lr={};function Ke(r,t,n={}){if(lr[r])throw new Error(`${r} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:r,writeable:!1}),lr[r]={klass:t,omit:n.omit||[],shallow:n.shallow||[]}}Ke("Object",Object),Ke("Set",Set),Ke("TransferableGridIndex",Ya),Ke("Color",Tt),Ke("Error",Error),Ke("AJAXError",ee),Ke("ResolvedImage",Hn),Ke("StylePropertyFunction",Ss),Ke("StyleExpression",yu,{omit:["_evaluator"]}),Ke("ZoomDependentExpression",_u),Ke("ZoomConstantExpression",As),Ke("CompoundExpression",or,{omit:["_evaluate"]});for(const r in To)To[r]._classRegistryKey||Ke(`Expression_${r}`,To[r]);function Pu(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function Ol(r){return r.$name||r.constructor._classRegistryKey}function ku(r){return!function(t){if(t===null||typeof t!="object")return!1;const n=Ol(t);return!(!n||n==="Object")}(r)&&(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob||r instanceof Error||Pu(r)||Rn(r)||ArrayBuffer.isView(r)||r instanceof ImageData)}function Ja(r,t){if(ku(r))return(Pu(r)||Rn(r))&&t&&t.push(r),ArrayBuffer.isView(r)&&t&&t.push(r.buffer),r instanceof ImageData&&t&&t.push(r.data.buffer),r;if(Array.isArray(r)){const p=[];for(const g of r)p.push(Ja(g,t));return p}if(typeof r!="object")throw new Error("can't serialize object of type "+typeof r);const n=Ol(r);if(!n)throw new Error(`can't serialize object of unregistered class ${r.constructor.name}`);if(!lr[n])throw new Error(`${n} is not registered.`);const{klass:s}=lr[n],u=s.serialize?s.serialize(r,t):{};if(s.serialize){if(t&&u===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const p in r){if(!r.hasOwnProperty(p)||lr[n].omit.indexOf(p)>=0)continue;const g=r[p];u[p]=lr[n].shallow.indexOf(p)>=0?g:Ja(g,t)}r instanceof Error&&(u.message=r.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return n!=="Object"&&(u.$name=n),u}function No(r){if(ku(r))return r;if(Array.isArray(r))return r.map(No);if(typeof r!="object")throw new Error("can't deserialize object of type "+typeof r);const t=Ol(r)||"Object";if(!lr[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:n}=lr[t];if(!n)throw new Error(`can't deserialize unregistered class ${t}`);if(n.deserialize)return n.deserialize(r);const s=Object.create(n.prototype);for(const u of Object.keys(r)){if(u==="$name")continue;const p=r[u];s[u]=lr[t].shallow.indexOf(u)>=0?p:No(p)}return s}class Mu{constructor(){this.first=!0}update(t,n){const s=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=s,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=s,!0):(this.lastFloorZoom>s?(this.lastIntegerZoom=s+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<s&&(this.lastIntegerZoom=s,this.lastIntegerZoomTime=n),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=s,!0))}}const Mt={"Latin-1 Supplement":r=>r>=128&&r<=255,"Hangul Jamo":r=>r>=4352&&r<=4607,Khmer:r=>r>=6016&&r<=6143,"General Punctuation":r=>r>=8192&&r<=8303,"Letterlike Symbols":r=>r>=8448&&r<=8527,"Number Forms":r=>r>=8528&&r<=8591,"Miscellaneous Technical":r=>r>=8960&&r<=9215,"Control Pictures":r=>r>=9216&&r<=9279,"Optical Character Recognition":r=>r>=9280&&r<=9311,"Enclosed Alphanumerics":r=>r>=9312&&r<=9471,"Geometric Shapes":r=>r>=9632&&r<=9727,"Miscellaneous Symbols":r=>r>=9728&&r<=9983,"Miscellaneous Symbols and Arrows":r=>r>=11008&&r<=11263,"Ideographic Description Characters":r=>r>=12272&&r<=12287,"CJK Symbols and Punctuation":r=>r>=12288&&r<=12351,Hiragana:r=>r>=12352&&r<=12447,Katakana:r=>r>=12448&&r<=12543,Kanbun:r=>r>=12688&&r<=12703,"CJK Strokes":r=>r>=12736&&r<=12783,"Enclosed CJK Letters and Months":r=>r>=12800&&r<=13055,"CJK Compatibility":r=>r>=13056&&r<=13311,"Yijing Hexagram Symbols":r=>r>=19904&&r<=19967,"CJK Unified Ideographs":r=>r>=19968&&r<=40959,"Hangul Syllables":r=>r>=44032&&r<=55215,"Private Use Area":r=>r>=57344&&r<=63743,"Vertical Forms":r=>r>=65040&&r<=65055,"CJK Compatibility Forms":r=>r>=65072&&r<=65103,"Small Form Variants":r=>r>=65104&&r<=65135,"Halfwidth and Fullwidth Forms":r=>r>=65280&&r<=65519};function Eu(r){for(const t of r)if(Nu(t.charCodeAt(0)))return!0;return!1}function Rd(r){for(const t of r)if(!Bd(t.charCodeAt(0)))return!1;return!0}function zu(r){const t=r.map(n=>{try{return new RegExp(`\\p{sc=${n}}`,"u").source}catch{return null}}).filter(n=>n);return new RegExp(t.join("|"),"u")}const Fd=zu(["Arab","Dupl","Mong","Ougr","Syrc"]);function Bd(r){return!Fd.test(String.fromCodePoint(r))}const jd=zu(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Nu(r){return!(r!==746&&r!==747&&(r<4352||!(Mt["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||Mt["CJK Compatibility"](r)||Mt["CJK Strokes"](r)||!(!Mt["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||Mt["Enclosed CJK Letters and Months"](r)||Mt["Ideographic Description Characters"](r)||Mt.Kanbun(r)||Mt.Katakana(r)&&r!==12540||!(!Mt["Halfwidth and Fullwidth Forms"](r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!Mt["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||Mt["Vertical Forms"](r)||Mt["Yijing Hexagram Symbols"](r)||/\p{sc=Cans}/u.test(String.fromCodePoint(r))||/\p{sc=Hang}/u.test(String.fromCodePoint(r))||jd.test(String.fromCodePoint(r)))))}function Du(r){return!(Nu(r)||function(t){return!!(Mt["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Mt["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Mt["Letterlike Symbols"](t)||Mt["Number Forms"](t)||Mt["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Mt["Control Pictures"](t)&&t!==9251||Mt["Optical Character Recognition"](t)||Mt["Enclosed Alphanumerics"](t)||Mt["Geometric Shapes"](t)||Mt["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Mt["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Mt["CJK Symbols and Punctuation"](t)||Mt.Katakana(t)||Mt["Private Use Area"](t)||Mt["CJK Compatibility Forms"](t)||Mt["Small Form Variants"](t)||Mt["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(r))}const Od=zu(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Lu(r){return Od.test(String.fromCodePoint(r))}function Vd(r,t){return!(!t&&Lu(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||Mt.Khmer(r))}function Vl(r){for(const t of r)if(Lu(t.charCodeAt(0)))return!0;return!1}const ba=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(r){this.pluginStatus=r.pluginStatus,this.pluginURL=r.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(r){if(ba.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=r.applyArabicShaping,this.processBidirectionalText=r.processBidirectionalText,this.processStyledBidirectionalText=r.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(r,t){return c(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(r.pluginStatus!=="loading")return this.setState(r),r;const n=r.pluginURL,s=new Promise(p=>{this.loadScriptResolve=p});t(n);const u=new Promise(p=>setTimeout(()=>p(),this.TIMEOUT));if(yield Promise.race([s,u]),this.isParsed()){const p={pluginStatus:"loaded",pluginURL:n};return this.setState(p),p}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${n}`)})}};class Ot{constructor(t,n){this.isSupportedScript=sf,this.zoom=t,n?(this.now=n.now||0,this.fadeDuration=n.fadeDuration||0,this.zoomHistory=n.zoomHistory||new Mu,this.transition=n.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Mu,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,n=t-Math.floor(t),s=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*s}:{fromScale:.5,toScale:1,t:1-(1-s)*n}}}function sf(r){return function(t,n){for(const s of t)if(!Vd(s.charCodeAt(0),n))return!1;return!0}(r,ba.getRTLTextPluginStatus()==="loaded")}class Ul{constructor(t,n,s){this.property=t,this.value=n,this.expression=function(u,p,g){if(Cs(u))return new Ss(u,p);if(El(u)){const v=Id(u,p,g);if(v.result==="error")throw new Error(v.value.map(w=>`${w.key}: ${w.message}`).join(", "));return v.value}{let v=u;return p.type==="color"&&typeof u=="string"?v=Tt.parse(u):p.type!=="padding"||typeof u!="number"&&!Array.isArray(u)?p.type!=="numberArray"||typeof u!="number"&&!Array.isArray(u)?p.type!=="colorArray"||typeof u!="string"&&!Array.isArray(u)?p.type==="variableAnchorOffsetCollection"&&Array.isArray(u)?v=Cn.parse(u):p.type==="projectionDefinition"&&typeof u=="string"&&(v=dn.parse(u)):v=Ni.parse(u):v=wn.parse(u):v=Hi.parse(u),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>v}}}(n===void 0?t.specification.default:n,t.specification,s)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(t,n,s){return this.property.possiblyEvaluate(this,t,n,s)}}class $l{constructor(t,n){this.property=t,this.value=new Ul(t,void 0,n)}transitioned(t,n){return new Fu(this.property,this.value,n,vn({},t.transition,this.transition),t.now)}untransitioned(){return new Fu(this.property,this.value,null,{},0)}}class Ru{constructor(t,n){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues),this._globalState=n}getValue(t){return Ei(this._values[t].value.value)}setValue(t,n){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new $l(this._values[t].property,this._globalState)),this._values[t].value=new Ul(this._values[t].property,n===null?void 0:Ei(n),this._globalState)}getTransition(t){return Ei(this._values[t].transition)}setTransition(t,n){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new $l(this._values[t].property,this._globalState)),this._values[t].transition=Ei(n)||void 0}serialize(){const t={};for(const n of Object.keys(this._values)){const s=this.getValue(n);s!==void 0&&(t[n]=s);const u=this.getTransition(n);u!==void 0&&(t[`${n}-transition`]=u)}return t}transitioned(t,n){const s=new Ud(this._properties);for(const u of Object.keys(this._values))s._values[u]=this._values[u].transitioned(t,n._values[u]);return s}untransitioned(){const t=new Ud(this._properties);for(const n of Object.keys(this._values))t._values[n]=this._values[n].untransitioned();return t}}class Fu{constructor(t,n,s,u,p){this.property=t,this.value=n,this.begin=p+u.delay||0,this.end=this.begin+u.duration||0,t.specification.transition&&(u.delay||u.duration)&&(this.prior=s)}possiblyEvaluate(t,n,s){const u=t.now||0,p=this.value.possiblyEvaluate(t,n,s),g=this.prior;if(g){if(u>this.end)return this.prior=null,p;if(this.value.isDataDriven())return this.prior=null,p;if(u<this.begin)return g.possiblyEvaluate(t,n,s);{const v=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(g.possiblyEvaluate(t,n,s),p,qi(v))}}return p}}class Ud{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,n,s){const u=new Zl(this._properties);for(const p of Object.keys(this._values))u._values[p]=this._values[p].possiblyEvaluate(t,n,s);return u}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class lf{constructor(t,n){this._properties=t,this._values=Object.create(t.defaultPropertyValues),this._globalState=n}hasValue(t){return this._values[t].value!==void 0}getValue(t){return Ei(this._values[t].value)}setValue(t,n){this._values[t]=new Ul(this._values[t].property,n===null?void 0:Ei(n),this._globalState)}serialize(){const t={};for(const n of Object.keys(this._values)){const s=this.getValue(n);s!==void 0&&(t[n]=s)}return t}possiblyEvaluate(t,n,s){const u=new Zl(this._properties);for(const p of Object.keys(this._values))u._values[p]=this._values[p].possiblyEvaluate(t,n,s);return u}}class Vr{constructor(t,n,s){this.property=t,this.value=n,this.parameters=s}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,n,s,u){return this.property.evaluate(this.value,this.parameters,t,n,s,u)}}class Zl{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class rt{constructor(t){this.specification=t}possiblyEvaluate(t,n){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(n)}interpolate(t,n,s){const u=Or[this.specification.type];return u?u(t,n,s):t}}class ct{constructor(t,n){this.specification=t,this.overrides=n}possiblyEvaluate(t,n,s,u){return new Vr(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(n,null,{},s,u)}:t.expression,n)}interpolate(t,n,s){if(t.value.kind!=="constant"||n.value.kind!=="constant")return t;if(t.value.value===void 0||n.value.value===void 0)return new Vr(this,{kind:"constant",value:void 0},t.parameters);const u=Or[this.specification.type];if(u){const p=u(t.value.value,n.value.value,s);return new Vr(this,{kind:"constant",value:p},t.parameters)}return t}evaluate(t,n,s,u,p,g){return t.kind==="constant"?t.value:t.evaluate(n,s,u,p,g)}}class Ns extends ct{possiblyEvaluate(t,n,s,u){if(t.value===void 0)return new Vr(this,{kind:"constant",value:void 0},n);if(t.expression.kind==="constant"){const p=t.expression.evaluate(n,null,{},s,u),g=t.property.specification.type==="resolvedImage"&&typeof p!="string"?p.name:p,v=this._calculate(g,g,g,n);return new Vr(this,{kind:"constant",value:v},n)}if(t.expression.kind==="camera"){const p=this._calculate(t.expression.evaluate({zoom:n.zoom-1}),t.expression.evaluate({zoom:n.zoom}),t.expression.evaluate({zoom:n.zoom+1}),n);return new Vr(this,{kind:"constant",value:p},n)}return new Vr(this,t.expression,n)}evaluate(t,n,s,u,p,g){if(t.kind==="source"){const v=t.evaluate(n,s,u,p,g);return this._calculate(v,v,v,n)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(n.zoom)-1},s,u),t.evaluate({zoom:Math.floor(n.zoom)},s,u),t.evaluate({zoom:Math.floor(n.zoom)+1},s,u),n):t.value}_calculate(t,n,s,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:t,to:n}:{from:s,to:n}}interpolate(t){return t}}class $d{constructor(t){this.specification=t}possiblyEvaluate(t,n,s,u){if(t.value!==void 0){if(t.expression.kind==="constant"){const p=t.expression.evaluate(n,null,{},s,u);return this._calculate(p,p,p,n)}return this._calculate(t.expression.evaluate(new Ot(Math.floor(n.zoom-1),n)),t.expression.evaluate(new Ot(Math.floor(n.zoom),n)),t.expression.evaluate(new Ot(Math.floor(n.zoom+1),n)),n)}}_calculate(t,n,s,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:t,to:n}:{from:s,to:n}}interpolate(t){return t}}class Gl{constructor(t){this.specification=t}possiblyEvaluate(t,n,s,u){return!!t.expression.evaluate(n,null,{},s,u)}interpolate(){return!1}}class mn{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const n in t){const s=t[n];s.specification.overridable&&this.overridableProperties.push(n);const u=this.defaultPropertyValues[n]=new Ul(s,void 0,void 0),p=this.defaultTransitionablePropertyValues[n]=new $l(s,void 0);this.defaultTransitioningPropertyValues[n]=p.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=u.possiblyEvaluate({})}}}Ke("DataDrivenProperty",ct),Ke("DataConstantProperty",rt),Ke("CrossFadedDataDrivenProperty",Ns),Ke("CrossFadedProperty",$d),Ke("ColorRampProperty",Gl);const Zd="-transition";class Cr extends it{constructor(t,n,s){if(super(),this.id=t.id,this.type=t.type,this._globalState=s,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter,this._featureFilter=qa(t.filter,s)),n.layout&&(this._unevaluatedLayout=new lf(n.layout,s)),n.paint)){this._transitionablePaint=new Ru(n.paint,s);for(const u in t.paint)this.setPaintProperty(u,t.paint[u],{validate:!1});for(const u in t.layout)this.setLayoutProperty(u,t.layout[u],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Zl(n.paint)}}setFilter(t){this.filter=t,this._featureFilter=qa(t,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}getLayoutAffectingGlobalStateRefs(){const t=new Set;if(this._unevaluatedLayout)for(const n in this._unevaluatedLayout._values){const s=this._unevaluatedLayout._values[n];for(const u of s.getGlobalStateRefs())t.add(u)}for(const n of this._featureFilter.getGlobalStateRefs())t.add(n);return t}getPaintAffectingGlobalStateRefs(){var t;const n=new globalThis.Map;if(this._transitionablePaint)for(const s in this._transitionablePaint._values){const u=this._transitionablePaint._values[s].value;for(const p of u.getGlobalStateRefs()){const g=(t=n.get(p))!==null&&t!==void 0?t:[];g.push({name:s,value:u.value}),n.set(p,g)}}return n}setLayoutProperty(t,n,s={}){n!=null&&this._validate(jl,`layers.${this.id}.layout.${t}`,t,n,s)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,n):this.visibility=n)}getPaintProperty(t){return t.endsWith(Zd)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,n,s={}){if(n!=null&&this._validate(of,`layers.${this.id}.paint.${t}`,t,n,s))return!1;if(t.endsWith(Zd))return this._transitionablePaint.setTransition(t.slice(0,-11),n||void 0),!1;{const u=this._transitionablePaint._values[t],p=u.property.specification["property-type"]==="cross-faded-data-driven",g=u.value.isDataDriven(),v=u.value;this._transitionablePaint.setValue(t,n),this._handleSpecialPaintPropertyUpdate(t);const w=this._transitionablePaint._values[t].value;return w.isDataDriven()||g||p||this._handleOverridablePaintPropertyUpdate(t,v,w)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,n,s){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,n){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,n)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),gr(t,(n,s)=>!(n===void 0||s==="layout"&&!Object.keys(n).length||s==="paint"&&!Object.keys(n).length))}_validate(t,n,s,u,p={}){return(!p||p.validate!==!1)&&Ld(this,t.call(zo,{key:n,layerType:this.type,objectKey:s,value:u,styleSpec:ve,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const n=this.paint.get(t);if(n instanceof Vr&&va(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}}const Qa={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Do{constructor(t,n){this._structArray=t,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Yt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,n){return t._trim(),n&&(t.isTransferred=!0,n.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const n=Object.create(this.prototype);return n.arrayBuffer=t.arrayBuffer,n.length=t.length,n.capacity=t.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function mi(r,t=1){let n=0,s=0;return{members:r.map(u=>{const p=Qa[u.type].BYTES_PER_ELEMENT,g=n=Wl(n,Math.max(t,p)),v=u.components||1;return s=Math.max(s,p),n+=p*v,{name:u.name,type:u.type,components:v,offset:g}}),size:Wl(n,Math.max(s,t)),alignment:t}}function Wl(r,t){return Math.ceil(r/t)*t}class Ds extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n){const s=this.length;return this.resize(s+1),this.emplace(s,t,n)}emplace(t,n,s){const u=2*t;return this.int16[u+0]=n,this.int16[u+1]=s,t}}Ds.prototype.bytesPerElement=4,Ke("StructArrayLayout2i4",Ds);class eo extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,s){const u=this.length;return this.resize(u+1),this.emplace(u,t,n,s)}emplace(t,n,s,u){const p=3*t;return this.int16[p+0]=n,this.int16[p+1]=s,this.int16[p+2]=u,t}}eo.prototype.bytesPerElement=6,Ke("StructArrayLayout3i6",eo);class to extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,s,u){const p=this.length;return this.resize(p+1),this.emplace(p,t,n,s,u)}emplace(t,n,s,u,p){const g=4*t;return this.int16[g+0]=n,this.int16[g+1]=s,this.int16[g+2]=u,this.int16[g+3]=p,t}}to.prototype.bytesPerElement=8,Ke("StructArrayLayout4i8",to);class Bu extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,s,u,p,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,n,s,u,p,g)}emplace(t,n,s,u,p,g,v){const w=6*t;return this.int16[w+0]=n,this.int16[w+1]=s,this.int16[w+2]=u,this.int16[w+3]=p,this.int16[w+4]=g,this.int16[w+5]=v,t}}Bu.prototype.bytesPerElement=12,Ke("StructArrayLayout2i4i12",Bu);class ql extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,s,u,p,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,n,s,u,p,g)}emplace(t,n,s,u,p,g,v){const w=4*t,T=8*t;return this.int16[w+0]=n,this.int16[w+1]=s,this.uint8[T+4]=u,this.uint8[T+5]=p,this.uint8[T+6]=g,this.uint8[T+7]=v,t}}ql.prototype.bytesPerElement=8,Ke("StructArrayLayout2i4ub8",ql);class Jr extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n){const s=this.length;return this.resize(s+1),this.emplace(s,t,n)}emplace(t,n,s){const u=2*t;return this.float32[u+0]=n,this.float32[u+1]=s,t}}Jr.prototype.bytesPerElement=8,Ke("StructArrayLayout2f8",Jr);class ju extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,s,u,p,g,v,w,T,P){const E=this.length;return this.resize(E+1),this.emplace(E,t,n,s,u,p,g,v,w,T,P)}emplace(t,n,s,u,p,g,v,w,T,P,E){const D=10*t;return this.uint16[D+0]=n,this.uint16[D+1]=s,this.uint16[D+2]=u,this.uint16[D+3]=p,this.uint16[D+4]=g,this.uint16[D+5]=v,this.uint16[D+6]=w,this.uint16[D+7]=T,this.uint16[D+8]=P,this.uint16[D+9]=E,t}}ju.prototype.bytesPerElement=20,Ke("StructArrayLayout10ui20",ju);class Ou extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,s,u,p,g,v,w){const T=this.length;return this.resize(T+1),this.emplace(T,t,n,s,u,p,g,v,w)}emplace(t,n,s,u,p,g,v,w,T){const P=8*t;return this.uint16[P+0]=n,this.uint16[P+1]=s,this.uint16[P+2]=u,this.uint16[P+3]=p,this.uint16[P+4]=g,this.uint16[P+5]=v,this.uint16[P+6]=w,this.uint16[P+7]=T,t}}Ou.prototype.bytesPerElement=16,Ke("StructArrayLayout8ui16",Ou);class Hl extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,s,u,p,g,v,w,T,P,E,D){const R=this.length;return this.resize(R+1),this.emplace(R,t,n,s,u,p,g,v,w,T,P,E,D)}emplace(t,n,s,u,p,g,v,w,T,P,E,D,R){const B=12*t;return this.int16[B+0]=n,this.int16[B+1]=s,this.int16[B+2]=u,this.int16[B+3]=p,this.uint16[B+4]=g,this.uint16[B+5]=v,this.uint16[B+6]=w,this.uint16[B+7]=T,this.int16[B+8]=P,this.int16[B+9]=E,this.int16[B+10]=D,this.int16[B+11]=R,t}}Hl.prototype.bytesPerElement=24,Ke("StructArrayLayout4i4ui4i24",Hl);class Vu extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,s){const u=this.length;return this.resize(u+1),this.emplace(u,t,n,s)}emplace(t,n,s,u){const p=3*t;return this.float32[p+0]=n,this.float32[p+1]=s,this.float32[p+2]=u,t}}Vu.prototype.bytesPerElement=12,Ke("StructArrayLayout3f12",Vu);class m extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.uint32[1*t+0]=n,t}}m.prototype.bytesPerElement=4,Ke("StructArrayLayout1ul4",m);class e extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,s,u,p,g,v,w,T){const P=this.length;return this.resize(P+1),this.emplace(P,t,n,s,u,p,g,v,w,T)}emplace(t,n,s,u,p,g,v,w,T,P){const E=10*t,D=5*t;return this.int16[E+0]=n,this.int16[E+1]=s,this.int16[E+2]=u,this.int16[E+3]=p,this.int16[E+4]=g,this.int16[E+5]=v,this.uint32[D+3]=w,this.uint16[E+8]=T,this.uint16[E+9]=P,t}}e.prototype.bytesPerElement=20,Ke("StructArrayLayout6i1ul2ui20",e);class a extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,s,u,p,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,n,s,u,p,g)}emplace(t,n,s,u,p,g,v){const w=6*t;return this.int16[w+0]=n,this.int16[w+1]=s,this.int16[w+2]=u,this.int16[w+3]=p,this.int16[w+4]=g,this.int16[w+5]=v,t}}a.prototype.bytesPerElement=12,Ke("StructArrayLayout2i2i2i12",a);class l extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,s,u,p){const g=this.length;return this.resize(g+1),this.emplace(g,t,n,s,u,p)}emplace(t,n,s,u,p,g){const v=4*t,w=8*t;return this.float32[v+0]=n,this.float32[v+1]=s,this.float32[v+2]=u,this.int16[w+6]=p,this.int16[w+7]=g,t}}l.prototype.bytesPerElement=16,Ke("StructArrayLayout2f1f2i16",l);class h extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,s,u,p,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,n,s,u,p,g)}emplace(t,n,s,u,p,g,v){const w=16*t,T=4*t,P=8*t;return this.uint8[w+0]=n,this.uint8[w+1]=s,this.float32[T+1]=u,this.float32[T+2]=p,this.int16[P+6]=g,this.int16[P+7]=v,t}}h.prototype.bytesPerElement=16,Ke("StructArrayLayout2ub2f2i16",h);class f extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,s){const u=this.length;return this.resize(u+1),this.emplace(u,t,n,s)}emplace(t,n,s,u){const p=3*t;return this.uint16[p+0]=n,this.uint16[p+1]=s,this.uint16[p+2]=u,t}}f.prototype.bytesPerElement=6,Ke("StructArrayLayout3ui6",f);class _ extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,s,u,p,g,v,w,T,P,E,D,R,B,V,G,Y){const _e=this.length;return this.resize(_e+1),this.emplace(_e,t,n,s,u,p,g,v,w,T,P,E,D,R,B,V,G,Y)}emplace(t,n,s,u,p,g,v,w,T,P,E,D,R,B,V,G,Y,_e){const ne=24*t,ue=12*t,we=48*t;return this.int16[ne+0]=n,this.int16[ne+1]=s,this.uint16[ne+2]=u,this.uint16[ne+3]=p,this.uint32[ue+2]=g,this.uint32[ue+3]=v,this.uint32[ue+4]=w,this.uint16[ne+10]=T,this.uint16[ne+11]=P,this.uint16[ne+12]=E,this.float32[ue+7]=D,this.float32[ue+8]=R,this.uint8[we+36]=B,this.uint8[we+37]=V,this.uint8[we+38]=G,this.uint32[ue+10]=Y,this.int16[ne+22]=_e,t}}_.prototype.bytesPerElement=48,Ke("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",_);class C extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,s,u,p,g,v,w,T,P,E,D,R,B,V,G,Y,_e,ne,ue,we,ke,Re,qe,Ve,$e,at,Ue){const Ze=this.length;return this.resize(Ze+1),this.emplace(Ze,t,n,s,u,p,g,v,w,T,P,E,D,R,B,V,G,Y,_e,ne,ue,we,ke,Re,qe,Ve,$e,at,Ue)}emplace(t,n,s,u,p,g,v,w,T,P,E,D,R,B,V,G,Y,_e,ne,ue,we,ke,Re,qe,Ve,$e,at,Ue,Ze){const Ee=32*t,pt=16*t;return this.int16[Ee+0]=n,this.int16[Ee+1]=s,this.int16[Ee+2]=u,this.int16[Ee+3]=p,this.int16[Ee+4]=g,this.int16[Ee+5]=v,this.int16[Ee+6]=w,this.int16[Ee+7]=T,this.uint16[Ee+8]=P,this.uint16[Ee+9]=E,this.uint16[Ee+10]=D,this.uint16[Ee+11]=R,this.uint16[Ee+12]=B,this.uint16[Ee+13]=V,this.uint16[Ee+14]=G,this.uint16[Ee+15]=Y,this.uint16[Ee+16]=_e,this.uint16[Ee+17]=ne,this.uint16[Ee+18]=ue,this.uint16[Ee+19]=we,this.uint16[Ee+20]=ke,this.uint16[Ee+21]=Re,this.uint16[Ee+22]=qe,this.uint32[pt+12]=Ve,this.float32[pt+13]=$e,this.float32[pt+14]=at,this.uint16[Ee+30]=Ue,this.uint16[Ee+31]=Ze,t}}C.prototype.bytesPerElement=64,Ke("StructArrayLayout8i15ui1ul2f2ui64",C);class I extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.float32[1*t+0]=n,t}}I.prototype.bytesPerElement=4,Ke("StructArrayLayout1f4",I);class k extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,s){const u=this.length;return this.resize(u+1),this.emplace(u,t,n,s)}emplace(t,n,s,u){const p=3*t;return this.uint16[6*t+0]=n,this.float32[p+1]=s,this.float32[p+2]=u,t}}k.prototype.bytesPerElement=12,Ke("StructArrayLayout1ui2f12",k);class M extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,s){const u=this.length;return this.resize(u+1),this.emplace(u,t,n,s)}emplace(t,n,s,u){const p=4*t;return this.uint32[2*t+0]=n,this.uint16[p+2]=s,this.uint16[p+3]=u,t}}M.prototype.bytesPerElement=8,Ke("StructArrayLayout1ul2ui8",M);class N extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n){const s=this.length;return this.resize(s+1),this.emplace(s,t,n)}emplace(t,n,s){const u=2*t;return this.uint16[u+0]=n,this.uint16[u+1]=s,t}}N.prototype.bytesPerElement=4,Ke("StructArrayLayout2ui4",N);class z extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.uint16[1*t+0]=n,t}}z.prototype.bytesPerElement=2,Ke("StructArrayLayout1ui2",z);class L extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,s,u){const p=this.length;return this.resize(p+1),this.emplace(p,t,n,s,u)}emplace(t,n,s,u,p){const g=4*t;return this.float32[g+0]=n,this.float32[g+1]=s,this.float32[g+2]=u,this.float32[g+3]=p,t}}L.prototype.bytesPerElement=16,Ke("StructArrayLayout4f16",L);class U extends Do{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new F(this.anchorPointX,this.anchorPointY)}}U.prototype.size=20;class q extends e{get(t){return new U(this,t)}}Ke("CollisionBoxArray",q);class H extends Do{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}H.prototype.size=48;class X extends _{get(t){return new H(this,t)}}Ke("PlacedSymbolArray",X);class J extends Do{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}J.prototype.size=64;class ie extends C{get(t){return new J(this,t)}}Ke("SymbolInstanceArray",ie);class Q extends I{getoffsetX(t){return this.float32[1*t+0]}}Ke("GlyphOffsetArray",Q);class ae extends eo{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}Ke("SymbolLineVertexArray",ae);class de extends Do{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}de.prototype.size=12;class te extends k{get(t){return new de(this,t)}}Ke("TextAnchorOffsetArray",te);class pe extends Do{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}pe.prototype.size=8;class Ae extends M{get(t){return new pe(this,t)}}Ke("FeatureIndexArray",Ae);class be extends Ds{}class Ce extends Ds{}class Se extends Ds{}class Oe extends Bu{}class Be extends ql{}class Le extends Jr{}class Je extends ju{}class wt extends Ou{}class Ft extends Hl{}class Jt extends Vu{}class Wt extends m{}class ai extends a{}class Qt extends h{}class Ui extends f{}class ei extends N{}const Ut=mi([{name:"a_pos",components:2,type:"Int16"}],4),{members:ci}=Ut;class It{constructor(t=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,n,s,u){const p=this.segments[this.segments.length-1];return t>It.MAX_VERTEX_ARRAY_LENGTH&&li(`Max vertices per segment is ${It.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${It.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!p||p.vertexLength+t>It.MAX_VERTEX_ARRAY_LENGTH||p.sortKey!==u?this.createNewSegment(n,s,u):p}createNewSegment(t,n,s){const u={vertexOffset:t.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0,vaos:{}};return s!==void 0&&(u.sortKey=s),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(u),u}getOrCreateLatestSegment(t,n,s){return this.prepareSegment(0,t,n,s)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const t of this.segments)for(const n in t.vaos)t.vaos[n].destroy()}static simpleSegment(t,n,s,u){return new It([{vertexOffset:t,primitiveOffset:n,vertexLength:s,primitiveLength:u,vaos:{},sortKey:0}])}}function an(r,t){return 256*(r=jt(Math.floor(r),0,255))+jt(Math.floor(t),0,255)}It.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ke("SegmentVector",It);const Qr=mi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),io=mi([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var wa,no,Ls,Ca={exports:{}},ro={exports:{}},Yn={exports:{}},Ia=function(){if(Ls)return Ca.exports;Ls=1;var r=(wa||(wa=1,ro.exports=function(n,s){var u,p,g,v,w,T,P,E;for(p=n.length-(u=3&n.length),g=s,w=3432918353,T=461845907,E=0;E<p;)P=255&n.charCodeAt(E)|(255&n.charCodeAt(++E))<<8|(255&n.charCodeAt(++E))<<16|(255&n.charCodeAt(++E))<<24,++E,g=27492+(65535&(v=5*(65535&(g=(g^=P=(65535&(P=(P=(65535&P)*w+(((P>>>16)*w&65535)<<16)&4294967295)<<15|P>>>17))*T+(((P>>>16)*T&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(v>>>16)&65535)<<16);switch(P=0,u){case 3:P^=(255&n.charCodeAt(E+2))<<16;case 2:P^=(255&n.charCodeAt(E+1))<<8;case 1:g^=P=(65535&(P=(P=(65535&(P^=255&n.charCodeAt(E)))*w+(((P>>>16)*w&65535)<<16)&4294967295)<<15|P>>>17))*T+(((P>>>16)*T&65535)<<16)&4294967295}return g^=n.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0}),ro.exports),t=(no||(no=1,Yn.exports=function(n,s){for(var u,p=n.length,g=s^p,v=0;p>=4;)u=1540483477*(65535&(u=255&n.charCodeAt(v)|(255&n.charCodeAt(++v))<<8|(255&n.charCodeAt(++v))<<16|(255&n.charCodeAt(++v))<<24))+((1540483477*(u>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),p-=4,++v;switch(p){case 3:g^=(255&n.charCodeAt(v+2))<<16;case 2:g^=(255&n.charCodeAt(v+1))<<8;case 1:g=1540483477*(65535&(g^=255&n.charCodeAt(v)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0}),Yn.exports);return Ca.exports=r,Ca.exports.murmur3=r,Ca.exports.murmur2=t,Ca.exports}(),ea=W(Ia);class Aa{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,n,s,u){this.ids.push(Di(t)),this.positions.push(n,s,u)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const n=Di(t);let s=0,u=this.ids.length-1;for(;s<u;){const g=s+u>>1;this.ids[g]>=n?u=g:s=g+1}const p=[];for(;this.ids[s]===n;)p.push({index:this.positions[3*s],start:this.positions[3*s+1],end:this.positions[3*s+2]}),s++;return p}static serialize(t,n){const s=new Float64Array(t.ids),u=new Uint32Array(t.positions);return Li(s,u,0,s.length-1),n&&n.push(s.buffer,u.buffer),{ids:s,positions:u}}static deserialize(t){const n=new Aa;return n.ids=t.ids,n.positions=t.positions,n.indexed=!0,n}}function Di(r){const t=+r;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:ea(String(r))}function Li(r,t,n,s){for(;n<s;){const u=r[n+s>>1];let p=n-1,g=s+1;for(;;){do p++;while(r[p]<u);do g--;while(r[g]>u);if(p>=g)break;An(r,p,g),An(t,3*p,3*g),An(t,3*p+1,3*g+1),An(t,3*p+2,3*g+2)}g-n<s-g?(Li(r,t,n,g),n=g+1):(Li(r,t,g+1,s),s=g)}}function An(r,t,n){const s=r[t];r[t]=r[n],r[n]=s}Ke("FeaturePositionMap",Aa);class ti{constructor(t,n){this.gl=t.gl,this.location=n}}class Xl extends ti{constructor(t,n){super(t,n),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class Gd extends ti{constructor(t,n){super(t,n),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class Wd extends ti{constructor(t,n){super(t,n),this.current=Tt.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const cf=new Float32Array(16);function Uu(r){return[an(255*r.r,255*r.g),an(255*r.b,255*r.a)]}class Rs{constructor(t,n,s){this.value=t,this.uniformNames=n.map(u=>`u_${u}`),this.type=s}setUniform(t,n,s){t.set(s.constantOr(this.value))}getBinding(t,n,s){return this.type==="color"?new Wd(t,n):new Xl(t,n)}}class Jn{constructor(t,n){this.uniformNames=n.map(s=>`u_${s}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,n){this.pixelRatioFrom=n.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=n.tlbr,this.patternTo=t.tlbr}setConstantDashPositions(t,n){this.dashTo=[0,t.y,t.height,t.width],this.dashFrom=[0,n.y,n.height,n.width]}setUniform(t,n,s,u){let p=null;u==="u_pattern_to"?p=this.patternTo:u==="u_pattern_from"?p=this.patternFrom:u==="u_dasharray_to"?p=this.dashTo:u==="u_dasharray_from"?p=this.dashFrom:u==="u_pixel_ratio_to"?p=this.pixelRatioTo:u==="u_pixel_ratio_from"&&(p=this.pixelRatioFrom),p!==null&&t.set(p)}getBinding(t,n,s){return s.substr(0,9)==="u_pattern"||s.substr(0,12)==="u_dasharray_"?new Gd(t,n):new Xl(t,n)}}class Ur{constructor(t,n,s,u){this.expression=t,this.type=s,this.maxValue=0,this.paintVertexAttributes=n.map(p=>({name:`a_${p}`,type:"Float32",components:s==="color"?2:1,offset:0})),this.paintVertexArray=new u}populatePaintArray(t,n,s){const u=this.paintVertexArray.length,p=this.expression.evaluate(new Ot(0,s),n,{},s.canonical,[],s.formattedSection);this.paintVertexArray.resize(t),this._setPaintValue(u,t,p)}updatePaintArray(t,n,s,u,p){const g=this.expression.evaluate(new Ot(0,p),s,u);this._setPaintValue(t,n,g)}_setPaintValue(t,n,s){if(this.type==="color"){const u=Uu(s);for(let p=t;p<n;p++)this.paintVertexArray.emplace(p,u[0],u[1])}else{for(let u=t;u<n;u++)this.paintVertexArray.emplace(u,s);this.maxValue=Math.max(this.maxValue,Math.abs(s))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class cr{constructor(t,n,s,u,p,g){this.expression=t,this.uniformNames=n.map(v=>`u_${v}_t`),this.type=s,this.useIntegerZoom=u,this.zoom=p,this.maxValue=0,this.paintVertexAttributes=n.map(v=>({name:`a_${v}`,type:"Float32",components:s==="color"?4:2,offset:0})),this.paintVertexArray=new g}populatePaintArray(t,n,s){const u=this.expression.evaluate(new Ot(this.zoom,s),n,{},s.canonical,[],s.formattedSection),p=this.expression.evaluate(new Ot(this.zoom+1,s),n,{},s.canonical,[],s.formattedSection),g=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(g,t,u,p)}updatePaintArray(t,n,s,u,p){const g=this.expression.evaluate(new Ot(this.zoom,p),s,u),v=this.expression.evaluate(new Ot(this.zoom+1,p),s,u);this._setPaintValue(t,n,g,v)}_setPaintValue(t,n,s,u){if(this.type==="color"){const p=Uu(s),g=Uu(u);for(let v=t;v<n;v++)this.paintVertexArray.emplace(v,p[0],p[1],g[0],g[1])}else{for(let p=t;p<n;p++)this.paintVertexArray.emplace(p,s,u);this.maxValue=Math.max(this.maxValue,Math.abs(s),Math.abs(u))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,n){const s=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,u=jt(this.expression.interpolationFactor(s,this.zoom,this.zoom+1),0,1);t.set(u)}getBinding(t,n,s){return new Xl(t,n)}}class ta{constructor(t,n,s,u,p,g){this.expression=t,this.type=n,this.useIntegerZoom=s,this.zoom=u,this.layerId=g,this.zoomInPaintVertexArray=new p,this.zoomOutPaintVertexArray=new p}populatePaintArray(t,n,s){const u=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(u,t,this.getPositionIds(n),s)}updatePaintArray(t,n,s,u,p){this._setPaintValues(t,n,this.getPositionIds(s),p)}_setPaintValues(t,n,s,u){const p=this.getPositions(u);if(!p||!s)return;const g=p[s.min],v=p[s.mid],w=p[s.max];if(g&&v&&w)for(let T=t;T<n;T++)this.emplace(this.zoomInPaintVertexArray,T,v,g),this.emplace(this.zoomOutPaintVertexArray,T,v,w)}upload(t){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){const n=this.getVertexAttributes();this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,n,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,n,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Kl extends ta{getPositions(t){return t.imagePositions}getPositionIds(t){return t.patterns&&t.patterns[this.layerId]}getVertexAttributes(){return Qr.members}emplace(t,n,s,u){t.emplace(n,s.tlbr[0],s.tlbr[1],s.tlbr[2],s.tlbr[3],u.tlbr[0],u.tlbr[1],u.tlbr[2],u.tlbr[3],s.pixelRatio,u.pixelRatio)}}class $u extends ta{getPositions(t){return t.dashPositions}getPositionIds(t){return t.dashes&&t.dashes[this.layerId]}getVertexAttributes(){return io.members}emplace(t,n,s,u){t.emplace(n,0,s.y,s.height,s.width,0,u.y,u.height,u.width)}}class Yl{constructor(t,n,s){this.binders={},this._buffers=[];const u=[];for(const p in t.paint._values){if(!s(p))continue;const g=t.paint.get(p);if(!(g instanceof Vr&&va(g.property.specification)))continue;const v=bw(p,t.type),w=g.value,T=g.property.specification.type,P=g.property.useIntegerZoom,E=g.property.specification["property-type"],D=E==="cross-faded"||E==="cross-faded-data-driven";if(w.kind==="constant")this.binders[p]=D?new Jn(w.value,v):new Rs(w.value,v,T),u.push(`/u_${p}`);else if(w.kind==="source"||D){const R=Ty(p,T,"source");this.binders[p]=D?p==="line-dasharray"?new $u(w,T,P,n,R,t.id):new Kl(w,T,P,n,R,t.id):new Ur(w,v,T,R),u.push(`/a_${p}`)}else{const R=Ty(p,T,"composite");this.binders[p]=new cr(w,v,T,P,n,R),u.push(`/z_${p}`)}}this.cacheKey=u.sort().join("")}getMaxValue(t){const n=this.binders[t];return n instanceof Ur||n instanceof cr?n.maxValue:0}populatePaintArrays(t,n,s){for(const u in this.binders){const p=this.binders[u];(p instanceof Ur||p instanceof cr||p instanceof ta)&&p.populatePaintArray(t,n,s)}}setConstantPatternPositions(t,n){for(const s in this.binders){const u=this.binders[s];u instanceof Jn&&u.setConstantPatternPositions(t,n)}}setConstantDashPositions(t,n){for(const s in this.binders){const u=this.binders[s];u instanceof Jn&&u.setConstantDashPositions(t,n)}}updatePaintArrays(t,n,s,u,p){let g=!1;for(const v in t){const w=n.getPositions(v);for(const T of w){const P=s.feature(T.index);for(const E in this.binders){const D=this.binders[E];if((D instanceof Ur||D instanceof cr||D instanceof ta)&&D.expression.isStateDependent===!0){const R=u.paint.get(E);D.expression=R.value,D.updatePaintArray(T.start,T.end,P,t[v],p),g=!0}}}}return g}defines(){const t=[];for(const n in this.binders){const s=this.binders[n];(s instanceof Rs||s instanceof Jn)&&t.push(...s.uniformNames.map(u=>`#define HAS_UNIFORM_${u}`))}return t}getBinderAttributes(){const t=[];for(const n in this.binders){const s=this.binders[n];if(s instanceof Ur||s instanceof cr)for(let u=0;u<s.paintVertexAttributes.length;u++)t.push(s.paintVertexAttributes[u].name);else if(s instanceof ta){const u=s.getVertexAttributes();for(const p of u)t.push(p.name)}}return t}getBinderUniforms(){const t=[];for(const n in this.binders){const s=this.binders[n];if(s instanceof Rs||s instanceof Jn||s instanceof cr)for(const u of s.uniformNames)t.push(u)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,n){const s=[];for(const u in this.binders){const p=this.binders[u];if(p instanceof Rs||p instanceof Jn||p instanceof cr){for(const g of p.uniformNames)if(n[g]){const v=p.getBinding(t,n[g],g);s.push({name:g,property:u,binding:v})}}}return s}setUniforms(t,n,s,u){for(const{name:p,property:g,binding:v}of n)this.binders[g].setUniform(v,u,s.get(g),p)}updatePaintBuffers(t){this._buffers=[];for(const n in this.binders){const s=this.binders[n];if(t&&s instanceof ta){const u=t.fromScale===2?s.zoomInPaintVertexBuffer:s.zoomOutPaintVertexBuffer;u&&this._buffers.push(u)}else(s instanceof Ur||s instanceof cr)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer)}}upload(t){for(const n in this.binders){const s=this.binders[n];(s instanceof Ur||s instanceof cr||s instanceof ta)&&s.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const n=this.binders[t];(n instanceof Ur||n instanceof cr||n instanceof ta)&&n.destroy()}}}class Fs{constructor(t,n,s=()=>!0){this.programConfigurations={};for(const u of t)this.programConfigurations[u.id]=new Yl(u,n,s);this.needsUpload=!1,this._featureMap=new Aa,this._bufferOffset=0}populatePaintArrays(t,n,s,u){for(const p in this.programConfigurations)this.programConfigurations[p].populatePaintArrays(t,n,u);n.id!==void 0&&this._featureMap.add(n.id,s,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,n,s,u){for(const p of s)this.needsUpload=this.programConfigurations[p.id].updatePaintArrays(t,this._featureMap,n,p,u)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function bw(r,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[r]||[r.replace(`${t}-`,"").replace(/-/g,"_")]}function Ty(r,t,n){const s={color:{source:Jr,composite:L},number:{source:I,composite:Jr}},u=function(p){return{"line-pattern":{source:Je,composite:Je},"fill-pattern":{source:Je,composite:Je},"fill-extrusion-pattern":{source:Je,composite:Je},"line-dasharray":{source:wt,composite:wt}}[p]}(r);return u&&u[n]||s[t][n]}Ke("ConstantBinder",Rs),Ke("CrossFadedConstantBinder",Jn),Ke("SourceExpressionBinder",Ur),Ke("CrossFadedPatternBinder",Kl),Ke("CrossFadedDasharrayBinder",$u),Ke("CompositeExpressionBinder",cr),Ke("ProgramConfiguration",Yl,{omit:["_buffers"]}),Ke("ProgramConfigurationSet",Fs);const uf=Math.pow(2,14)-1,Py=-uf-1;function Bs(r){const t=He/r.extent,n=r.loadGeometry();for(let s=0;s<n.length;s++){const u=n[s];for(let p=0;p<u.length;p++){const g=u[p],v=Math.round(g.x*t),w=Math.round(g.y*t);g.x=jt(v,Py,uf),g.y=jt(w,Py,uf),(v<g.x||v>g.x+1||w<g.y||w>g.y+1)&&li("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return n}function js(r,t){return{type:r.type,id:r.id,properties:r.properties,geometry:t?Bs(r):[]}}const ky=-32768;function ww(r,t,n,s,u){r.emplaceBack(ky+8*t+s,ky+8*n+u)}class hf{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasDependencies=!1,this.layoutVertexArray=new Ce,this.indexArray=new Ui,this.segments=new It,this.programConfigurations=new Fs(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,s){const u=this.layers[0],p=[];let g=null,v=!1,w=u.type==="heatmap";if(u.type==="circle"){const P=u;g=P.layout.get("circle-sort-key"),v=!g.isConstant(),w=w||P.paint.get("circle-pitch-alignment")==="map"}const T=w?n.subdivisionGranularity.circle:1;for(const{feature:P,id:E,index:D,sourceLayerIndex:R}of t){const B=this.layers[0]._featureFilter.needGeometry,V=js(P,B);if(!this.layers[0]._featureFilter.filter(new Ot(this.zoom),V,s))continue;const G=v?g.evaluate(V,{},s):void 0,Y={id:E,properties:P.properties,type:P.type,sourceLayerIndex:R,index:D,geometry:B?V.geometry:Bs(P),patterns:{},sortKey:G};p.push(Y)}v&&p.sort((P,E)=>P.sortKey-E.sortKey);for(const P of p){const{geometry:E,index:D,sourceLayerIndex:R}=P,B=t[D].feature;this.addFeature(P,E,D,s,T),n.featureIndex.insert(B,E,D,R,this.index)}}update(t,n,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,{imagePositions:s})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ci),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,n,s,u,p=1){let g;switch(p){case 1:g=[0,7];break;case 3:g=[0,2,5,7];break;case 5:g=[0,1,3,4,6,7];break;case 7:g=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${p}; valid values are 1, 3, 5, 7.`)}const v=g.length;for(const w of n)for(const T of w){const P=T.x,E=T.y;if(P<0||P>=He||E<0||E>=He)continue;const D=this.segments.prepareSegment(v*v,this.layoutVertexArray,this.indexArray,t.sortKey),R=D.vertexLength;for(let B=0;B<v;B++)for(let V=0;V<v;V++)ww(this.layoutVertexArray,P,E,g[V],g[B]);for(let B=0;B<v-1;B++)for(let V=0;V<v-1;V++){const G=R+B*v+V,Y=R+(B+1)*v+V;this.indexArray.emplaceBack(G,Y+1,G+1),this.indexArray.emplaceBack(G,Y,Y+1)}D.vertexLength+=v*v,D.primitiveLength+=(v-1)*(v-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,{imagePositions:{},canonical:u})}}function My(r,t){for(let n=0;n<r.length;n++)if(Jl(t,r[n]))return!0;for(let n=0;n<t.length;n++)if(Jl(r,t[n]))return!0;return!!df(r,t)}function qd(r,t,n){return!!Jl(r,t)||!!pf(t,r,n)}function Ey(r,t){if(r.length===1)return Ny(t,r[0]);for(let n=0;n<t.length;n++){const s=t[n];for(let u=0;u<s.length;u++)if(Jl(r,s[u]))return!0}for(let n=0;n<r.length;n++)if(Ny(t,r[n]))return!0;for(let n=0;n<t.length;n++)if(df(r,t[n]))return!0;return!1}function Cw(r,t,n){if(r.length>1){if(df(r,t))return!0;for(let s=0;s<t.length;s++)if(pf(t[s],r,n))return!0}for(let s=0;s<r.length;s++)if(pf(r[s],t,n))return!0;return!1}function df(r,t){if(r.length===0||t.length===0)return!1;for(let n=0;n<r.length-1;n++){const s=r[n],u=r[n+1];for(let p=0;p<t.length-1;p++)if(Iw(s,u,t[p],t[p+1]))return!0}return!1}function Iw(r,t,n,s){return Dn(r,n,s)!==Dn(t,n,s)&&Dn(r,t,n)!==Dn(r,t,s)}function pf(r,t,n){const s=n*n;if(t.length===1)return r.distSqr(t[0])<s;for(let u=1;u<t.length;u++)if(zy(r,t[u-1],t[u])<s)return!0;return!1}function zy(r,t,n){const s=t.distSqr(n);if(s===0)return r.distSqr(t);const u=((r.x-t.x)*(n.x-t.x)+(r.y-t.y)*(n.y-t.y))/s;return r.distSqr(u<0?t:u>1?n:n.sub(t)._mult(u)._add(t))}function Ny(r,t){let n,s,u,p=!1;for(let g=0;g<r.length;g++){n=r[g];for(let v=0,w=n.length-1;v<n.length;w=v++)s=n[v],u=n[w],s.y>t.y!=u.y>t.y&&t.x<(u.x-s.x)*(t.y-s.y)/(u.y-s.y)+s.x&&(p=!p)}return p}function Jl(r,t){let n=!1;for(let s=0,u=r.length-1;s<r.length;u=s++){const p=r[s],g=r[u];p.y>t.y!=g.y>t.y&&t.x<(g.x-p.x)*(t.y-p.y)/(g.y-p.y)+p.x&&(n=!n)}return n}function Aw(r,t,n){const s=n[0],u=n[2];if(r.x<s.x&&t.x<s.x||r.x>u.x&&t.x>u.x||r.y<s.y&&t.y<s.y||r.y>u.y&&t.y>u.y)return!1;const p=Dn(r,t,n[0]);return p!==Dn(r,t,n[1])||p!==Dn(r,t,n[2])||p!==Dn(r,t,n[3])}function Ql(r,t,n){const s=t.paint.get(r).value;return s.kind==="constant"?s.value:n.programConfigurations.get(t.id).getMaxValue(r)}function Hd(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function Xd(r,t,n,s,u){if(!t[0]&&!t[1])return r;const p=F.convert(t)._mult(u);n==="viewport"&&p._rotate(-s);const g=[];for(let v=0;v<r.length;v++)g.push(r[v].sub(p));return g}function Sw({queryGeometry:r,size:t},n){return qd(r,n,t)}function Tw({queryGeometry:r,size:t,transform:n,unwrappedTileID:s,getElevation:u},p){return qd(r,p,t*(n.projectTileCoordinates(p.x,p.y,s,u).signedDistanceFromCamera/n.cameraToCenterDistance))}function Pw({queryGeometry:r,size:t,transform:n,unwrappedTileID:s,getElevation:u},p){const g=n.projectTileCoordinates(p.x,p.y,s,u).signedDistanceFromCamera,v=t*(n.cameraToCenterDistance/g);return qd(r,mf(p,n,s,u),v)}function kw({queryGeometry:r,size:t,transform:n,unwrappedTileID:s,getElevation:u},p){return qd(r,mf(p,n,s,u),t)}function Dy({queryGeometry:r,size:t,transform:n,unwrappedTileID:s,getElevation:u,pitchAlignment:p="map",pitchScale:g="map"},v){const w=p==="map"?g==="map"?Sw:Tw:g==="map"?Pw:kw,T={queryGeometry:r,size:t,transform:n,unwrappedTileID:s,getElevation:u};for(const P of v)for(const E of P)if(w(T,E))return!0;return!1}function mf(r,t,n,s){const u=t.projectTileCoordinates(r.x,r.y,n,s).point;return new F((.5*u.x+.5)*t.width,(.5*-u.y+.5)*t.height)}let Ly,Ry;Ke("CircleBucket",hf,{omit:["layers"]});var Mw={get paint(){return Ry=Ry||new mn({"circle-radius":new ct(ve.paint_circle["circle-radius"]),"circle-color":new ct(ve.paint_circle["circle-color"]),"circle-blur":new ct(ve.paint_circle["circle-blur"]),"circle-opacity":new ct(ve.paint_circle["circle-opacity"]),"circle-translate":new rt(ve.paint_circle["circle-translate"]),"circle-translate-anchor":new rt(ve.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new rt(ve.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new rt(ve.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ct(ve.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ct(ve.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ct(ve.paint_circle["circle-stroke-opacity"])})},get layout(){return Ly=Ly||new mn({"circle-sort-key":new ct(ve.layout_circle["circle-sort-key"])})}};class Ew extends Cr{constructor(t,n){super(t,Mw,n)}createBucket(t){return new hf(t)}queryRadius(t){const n=t;return Ql("circle-radius",this,n)+Ql("circle-stroke-width",this,n)+Hd(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:s,geometry:u,transform:p,pixelsToTileUnits:g,unwrappedTileID:v,getElevation:w}){const T=Xd(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-p.bearingInRadians,g),P=this.paint.get("circle-radius").evaluate(n,s)+this.paint.get("circle-stroke-width").evaluate(n,s),E=this.paint.get("circle-pitch-scale"),D=this.paint.get("circle-pitch-alignment");let R,B;return D==="map"?(R=T,B=P*g):(R=function(V,G,Y,_e){return V.map(ne=>mf(ne,G,Y,_e))}(T,p,v,w),B=P),Dy({queryGeometry:R,size:B,transform:p,unwrappedTileID:v,getElevation:w,pitchAlignment:D,pitchScale:E},u)}}class Fy extends hf{}let By;Ke("HeatmapBucket",Fy,{omit:["layers"]});var zw={get paint(){return By=By||new mn({"heatmap-radius":new ct(ve.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ct(ve.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new rt(ve.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Gl(ve.paint_heatmap["heatmap-color"]),"heatmap-opacity":new rt(ve.paint_heatmap["heatmap-opacity"])})}};function ff(r,{width:t,height:n},s,u){if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==t*n*s)throw new RangeError(`mismatched image size. expected: ${u.length} but got: ${t*n*s}`)}else u=new Uint8Array(t*n*s);return r.width=t,r.height=n,r.data=u,r}function jy(r,{width:t,height:n},s){if(t===r.width&&n===r.height)return;const u=ff({},{width:t,height:n},s);gf(r,u,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,t),height:Math.min(r.height,n)},s),r.width=t,r.height=n,r.data=u.data}function gf(r,t,n,s,u,p){if(u.width===0||u.height===0)return t;if(u.width>r.width||u.height>r.height||n.x>r.width-u.width||n.y>r.height-u.height)throw new RangeError("out of range source coordinates for image copy");if(u.width>t.width||u.height>t.height||s.x>t.width-u.width||s.y>t.height-u.height)throw new RangeError("out of range destination coordinates for image copy");const g=r.data,v=t.data;if(g===v)throw new Error("srcData equals dstData, so image is already copied");for(let w=0;w<u.height;w++){const T=((n.y+w)*r.width+n.x)*p,P=((s.y+w)*t.width+s.x)*p;for(let E=0;E<u.width*p;E++)v[P+E]=g[T+E]}return t}class Zu{constructor(t,n){ff(this,t,1,n)}resize(t){jy(this,t,1)}clone(){return new Zu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,n,s,u,p){gf(t,n,s,u,p,1)}}class Qn{constructor(t,n){ff(this,t,4,n)}resize(t){jy(this,t,4)}replace(t,n){n?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Qn({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,n,s,u,p){gf(t,n,s,u,p,4)}setPixel(t,n,s){const u=4*(t*this.width+n);this.data[u+0]=Math.round(255*s.r/s.a),this.data[u+1]=Math.round(255*s.g/s.a),this.data[u+2]=Math.round(255*s.b/s.a),this.data[u+3]=Math.round(255*s.a)}}function Oy(r){const t={},n=r.resolution||256,s=r.clips?r.clips.length:1,u=r.image||new Qn({width:n,height:s});if(Math.log(n)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${n}`);const p=(g,v,w)=>{t[r.evaluationKey]=w;const T=r.expression.evaluate(t);u.setPixel(g/4/n,v/4,T)};if(r.clips)for(let g=0,v=0;g<s;++g,v+=4*n)for(let w=0,T=0;w<n;w++,T+=4){const P=w/(n-1),{start:E,end:D}=r.clips[g];p(v,T,E*(1-P)+D*P)}else for(let g=0,v=0;g<n;g++,v+=4)p(0,v,g/(n-1));return u}Ke("AlphaImage",Zu),Ke("RGBAImage",Qn);const yf="big-fb";class Nw extends Cr{createBucket(t){return new Fy(t)}constructor(t,n){super(t,zw,n),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Oy({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(yf)&&this.heatmapFbos.delete(yf)}queryRadius(t){return Ql("heatmap-radius",this,t)}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:s,geometry:u,transform:p,pixelsToTileUnits:g,unwrappedTileID:v,getElevation:w}){return Dy({queryGeometry:t,size:this.paint.get("heatmap-radius").evaluate(n,s)*g,transform:p,unwrappedTileID:v,getElevation:w},u)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Vy;var Dw={get paint(){return Vy=Vy||new mn({"hillshade-illumination-direction":new rt(ve.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new rt(ve.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new rt(ve.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new rt(ve.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new rt(ve.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new rt(ve.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new rt(ve.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new rt(ve.paint_hillshade["hillshade-method"])})}};class Lw extends Cr{constructor(t,n){super(t,Dw,n),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let t=this.paint.get("hillshade-illumination-direction").values,n=this.paint.get("hillshade-illumination-altitude").values,s=this.paint.get("hillshade-highlight-color").values,u=this.paint.get("hillshade-shadow-color").values;const p=Math.max(t.length,n.length,s.length,u.length);t=t.concat(Array(p-t.length).fill(t.at(-1))),n=n.concat(Array(p-n.length).fill(n.at(-1))),s=s.concat(Array(p-s.length).fill(s.at(-1))),u=u.concat(Array(p-u.length).fill(u.at(-1)));const g=n.map(Ye);return{directionRadians:t.map(Ye),altitudeRadians:g,shadowColor:u,highlightColor:s}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let Uy;var Rw={get paint(){return Uy=Uy||new mn({"color-relief-opacity":new rt(ve["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new Gl(ve["paint_color-relief"]["color-relief-color"])})}};class _f{constructor(t,n,s,u){this.context=t,this.format=s,this.texture=t.gl.createTexture(),this.update(n,u)}update(t,n,s){const{width:u,height:p}=t,g=!(this.size&&this.size[0]===u&&this.size[1]===p||s),{context:v}=this,{gl:w}=v;if(this.useMipmap=!!(n&&n.useMipmap),w.bindTexture(w.TEXTURE_2D,this.texture),v.pixelStoreUnpackFlipY.set(!1),v.pixelStoreUnpack.set(1),v.pixelStoreUnpackPremultiplyAlpha.set(this.format===w.RGBA&&(!n||n.premultiply!==!1)),g)this.size=[u,p],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||Rn(t)?w.texImage2D(w.TEXTURE_2D,0,this.format,this.format,w.UNSIGNED_BYTE,t):w.texImage2D(w.TEXTURE_2D,0,this.format,u,p,0,this.format,w.UNSIGNED_BYTE,t.data);else{const{x:T,y:P}=s||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||Rn(t)?w.texSubImage2D(w.TEXTURE_2D,0,T,P,w.RGBA,w.UNSIGNED_BYTE,t):w.texSubImage2D(w.TEXTURE_2D,0,T,P,u,p,w.RGBA,w.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&w.generateMipmap(w.TEXTURE_2D),v.pixelStoreUnpackFlipY.setDefault(),v.pixelStoreUnpack.setDefault(),v.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(t,n,s){const{context:u}=this,{gl:p}=u;p.bindTexture(p.TEXTURE_2D,this.texture),s!==p.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(s=p.LINEAR),t!==this.filter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,t),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,s||t),this.filter=t),n!==this.wrap&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,n),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class $y{constructor(t,n,s,u=1,p=1,g=1,v=0){if(this.uid=t,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(s&&!["mapbox","terrarium","custom"].includes(s))return void li(`"${s}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=n.height;const w=this.dim=n.height-2;switch(this.data=new Uint32Array(n.data.buffer),s){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=u,this.greenFactor=p,this.blueFactor=g,this.baseShift=v;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let T=0;T<w;T++)this.data[this._idx(-1,T)]=this.data[this._idx(0,T)],this.data[this._idx(w,T)]=this.data[this._idx(w-1,T)],this.data[this._idx(T,-1)]=this.data[this._idx(T,0)],this.data[this._idx(T,w)]=this.data[this._idx(T,w-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(w,-1)]=this.data[this._idx(w-1,0)],this.data[this._idx(-1,w)]=this.data[this._idx(0,w-1)],this.data[this._idx(w,w)]=this.data[this._idx(w-1,w-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let T=0;T<w;T++)for(let P=0;P<w;P++){const E=this.get(T,P);E>this.max&&(this.max=E),E<this.min&&(this.min=E)}}get(t,n){const s=new Uint8Array(this.data.buffer),u=4*this._idx(t,n);return this.unpack(s[u],s[u+1],s[u+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,n){if(t<-1||t>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(t+1)}unpack(t,n,s){return t*this.redFactor+n*this.greenFactor+s*this.blueFactor-this.baseShift}pack(t){return Zy(t,this.getUnpackVector())}getPixels(){return new Qn({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,n,s){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let u=n*this.dim,p=n*this.dim+this.dim,g=s*this.dim,v=s*this.dim+this.dim;switch(n){case-1:u=p-1;break;case 1:p=u+1}switch(s){case-1:g=v-1;break;case 1:v=g+1}const w=-n*this.dim,T=-s*this.dim;for(let P=g;P<v;P++)for(let E=u;E<p;E++)this.data[this._idx(E,P)]=t.data[this._idx(E+w,P+T)]}}function Zy(r,t){const n=t[0],s=t[1],u=t[2],p=t[3],g=Math.min(n,s,u),v=Math.round((r+p)/g);return{r:Math.floor(v*g/n)%256,g:Math.floor(v*g/s)%256,b:Math.floor(v*g/u)%256}}Ke("DEMData",$y);class Fw extends Cr{constructor(t,n){super(t,Rw,n)}_createColorRamp(t){const n={elevationStops:[],colorStops:[]},s=this._transitionablePaint._values["color-relief-color"].value.expression;if(s instanceof As&&s._styleExpression.expression instanceof rn){this.colorRampExpression=s;const g=s._styleExpression.expression;n.elevationStops=g.labels,n.colorStops=[];for(const v of n.elevationStops)n.colorStops.push(g.evaluate({globals:{elevation:v}}))}if(n.elevationStops.length<1&&(n.elevationStops=[0],n.colorStops=[Tt.transparent]),n.elevationStops.length<2&&(n.elevationStops.push(n.elevationStops[0]+1),n.colorStops.push(n.colorStops[0])),n.elevationStops.length<=t)return n;const u={elevationStops:[],colorStops:[]},p=(n.elevationStops.length-1)/(t-1);for(let g=0;g<n.elevationStops.length-.5;g+=p)u.elevationStops.push(n.elevationStops[Math.round(g)]),u.colorStops.push(n.colorStops[Math.round(g)]);return li(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),u}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(t,n,s){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const u=this._createColorRamp(n),p=new Qn({width:u.colorStops.length,height:1}),g=new Qn({width:u.colorStops.length,height:1});for(let v=0;v<u.elevationStops.length;v++){const w=Zy(u.elevationStops[v],s);g.setPixel(0,v,new Tt(w.r/255,w.g/255,w.b/255,1)),p.setPixel(0,v,u.colorStops[v])}return this.colorRampTextures={elevationTexture:new _f(t,g,t.gl.RGBA),colorTexture:new _f(t,p,t.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const Bw=mi([{name:"a_pos",components:2,type:"Int16"}],4),{members:jw}=Bw;function Kd(r,t,n){const s=n.patternDependencies;let u=!1;for(const p of t){const g=p.paint.get(`${r}-pattern`);g.isConstant()||(u=!0);const v=g.constantOr(null);v&&(u=!0,s[v.to]=!0,s[v.from]=!0)}return u}function vf(r,t,n,s,u){const{zoom:p}=s,g=u.patternDependencies;for(const v of t){const w=v.paint.get(`${r}-pattern`).value;if(w.kind!=="constant"){let T=w.evaluate({zoom:p-1},n,{},u.availableImages),P=w.evaluate({zoom:p},n,{},u.availableImages),E=w.evaluate({zoom:p+1},n,{},u.availableImages);T=T&&T.name?T.name:T,P=P&&P.name?P.name:P,E=E&&E.name?E.name:E,g[T]=!0,g[P]=!0,g[E]=!0,n.patterns[v.id]={min:T,mid:P,max:E}}}return n}function Gy(r,t,n,s,u){let p;if(u===function(g,v,w,T){let P=0;for(let E=v,D=w-T;E<w;E+=T)P+=(g[D]-g[E])*(g[E+1]+g[D+1]),D=E;return P}(r,t,n,s)>0)for(let g=t;g<n;g+=s)p=Xy(g/s|0,r[g],r[g+1],p);else for(let g=n-s;g>=t;g-=s)p=Xy(g/s|0,r[g],r[g+1],p);return p&&ec(p,p.next)&&(Hu(p),p=p.next),p}function Os(r,t){if(!r)return r;t||(t=r);let n,s=r;do if(n=!1,s.steiner||!ec(s,s.next)&&Ai(s.prev,s,s.next)!==0)s=s.next;else{if(Hu(s),s=t=s.prev,s===s.next)break;n=!0}while(n||s!==t);return t}function Gu(r,t,n,s,u,p,g){if(!r)return;!g&&p&&function(w,T,P,E){let D=w;do D.z===0&&(D.z=xf(D.x,D.y,T,P,E)),D.prevZ=D.prev,D.nextZ=D.next,D=D.next;while(D!==w);D.prevZ.nextZ=null,D.prevZ=null,function(R){let B,V=1;do{let G,Y=R;R=null;let _e=null;for(B=0;Y;){B++;let ne=Y,ue=0;for(let ke=0;ke<V&&(ue++,ne=ne.nextZ,ne);ke++);let we=V;for(;ue>0||we>0&&ne;)ue!==0&&(we===0||!ne||Y.z<=ne.z)?(G=Y,Y=Y.nextZ,ue--):(G=ne,ne=ne.nextZ,we--),_e?_e.nextZ=G:R=G,G.prevZ=_e,_e=G;Y=ne}_e.nextZ=null,V*=2}while(B>1)}(D)}(r,s,u,p);let v=r;for(;r.prev!==r.next;){const w=r.prev,T=r.next;if(p?Vw(r,s,u,p):Ow(r))t.push(w.i,r.i,T.i),Hu(r),r=T.next,v=T.next;else if((r=T)===v){g?g===1?Gu(r=Uw(Os(r),t),t,n,s,u,p,2):g===2&&$w(r,t,n,s,u,p):Gu(Os(r),t,n,s,u,p,1);break}}}function Ow(r){const t=r.prev,n=r,s=r.next;if(Ai(t,n,s)>=0)return!1;const u=t.x,p=n.x,g=s.x,v=t.y,w=n.y,T=s.y,P=Math.min(u,p,g),E=Math.min(v,w,T),D=Math.max(u,p,g),R=Math.max(v,w,T);let B=s.next;for(;B!==t;){if(B.x>=P&&B.x<=D&&B.y>=E&&B.y<=R&&Wu(u,v,p,w,g,T,B.x,B.y)&&Ai(B.prev,B,B.next)>=0)return!1;B=B.next}return!0}function Vw(r,t,n,s){const u=r.prev,p=r,g=r.next;if(Ai(u,p,g)>=0)return!1;const v=u.x,w=p.x,T=g.x,P=u.y,E=p.y,D=g.y,R=Math.min(v,w,T),B=Math.min(P,E,D),V=Math.max(v,w,T),G=Math.max(P,E,D),Y=xf(R,B,t,n,s),_e=xf(V,G,t,n,s);let ne=r.prevZ,ue=r.nextZ;for(;ne&&ne.z>=Y&&ue&&ue.z<=_e;){if(ne.x>=R&&ne.x<=V&&ne.y>=B&&ne.y<=G&&ne!==u&&ne!==g&&Wu(v,P,w,E,T,D,ne.x,ne.y)&&Ai(ne.prev,ne,ne.next)>=0||(ne=ne.prevZ,ue.x>=R&&ue.x<=V&&ue.y>=B&&ue.y<=G&&ue!==u&&ue!==g&&Wu(v,P,w,E,T,D,ue.x,ue.y)&&Ai(ue.prev,ue,ue.next)>=0))return!1;ue=ue.nextZ}for(;ne&&ne.z>=Y;){if(ne.x>=R&&ne.x<=V&&ne.y>=B&&ne.y<=G&&ne!==u&&ne!==g&&Wu(v,P,w,E,T,D,ne.x,ne.y)&&Ai(ne.prev,ne,ne.next)>=0)return!1;ne=ne.prevZ}for(;ue&&ue.z<=_e;){if(ue.x>=R&&ue.x<=V&&ue.y>=B&&ue.y<=G&&ue!==u&&ue!==g&&Wu(v,P,w,E,T,D,ue.x,ue.y)&&Ai(ue.prev,ue,ue.next)>=0)return!1;ue=ue.nextZ}return!0}function Uw(r,t){let n=r;do{const s=n.prev,u=n.next.next;!ec(s,u)&&qy(s,n,n.next,u)&&qu(s,u)&&qu(u,s)&&(t.push(s.i,n.i,u.i),Hu(n),Hu(n.next),n=r=u),n=n.next}while(n!==r);return Os(n)}function $w(r,t,n,s,u,p){let g=r;do{let v=g.next.next;for(;v!==g.prev;){if(g.i!==v.i&&Hw(g,v)){let w=Hy(g,v);return g=Os(g,g.next),w=Os(w,w.next),Gu(g,t,n,s,u,p,0),void Gu(w,t,n,s,u,p,0)}v=v.next}g=g.next}while(g!==r)}function Zw(r,t){let n=r.x-t.x;return n===0&&(n=r.y-t.y,n===0)&&(n=(r.next.y-r.y)/(r.next.x-r.x)-(t.next.y-t.y)/(t.next.x-t.x)),n}function Gw(r,t){const n=function(u,p){let g=p;const v=u.x,w=u.y;let T,P=-1/0;if(ec(u,g))return g;do{if(ec(u,g.next))return g.next;if(w<=g.y&&w>=g.next.y&&g.next.y!==g.y){const V=g.x+(w-g.y)*(g.next.x-g.x)/(g.next.y-g.y);if(V<=v&&V>P&&(P=V,T=g.x<g.next.x?g:g.next,V===v))return T}g=g.next}while(g!==p);if(!T)return null;const E=T,D=T.x,R=T.y;let B=1/0;g=T;do{if(v>=g.x&&g.x>=D&&v!==g.x&&Wy(w<R?v:P,w,D,R,w<R?P:v,w,g.x,g.y)){const V=Math.abs(w-g.y)/(v-g.x);qu(g,u)&&(V<B||V===B&&(g.x>T.x||g.x===T.x&&Ww(T,g)))&&(T=g,B=V)}g=g.next}while(g!==E);return T}(r,t);if(!n)return t;const s=Hy(n,r);return Os(s,s.next),Os(n,n.next)}function Ww(r,t){return Ai(r.prev,r,t.prev)<0&&Ai(t.next,r,r.next)<0}function xf(r,t,n,s,u){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-n)*u|0)|r<<8))|r<<4))|r<<2))|r<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-s)*u|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function qw(r){let t=r,n=r;do(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next;while(t!==r);return n}function Wy(r,t,n,s,u,p,g,v){return(u-g)*(t-v)>=(r-g)*(p-v)&&(r-g)*(s-v)>=(n-g)*(t-v)&&(n-g)*(p-v)>=(u-g)*(s-v)}function Wu(r,t,n,s,u,p,g,v){return!(r===g&&t===v)&&Wy(r,t,n,s,u,p,g,v)}function Hw(r,t){return r.next.i!==t.i&&r.prev.i!==t.i&&!function(n,s){let u=n;do{if(u.i!==n.i&&u.next.i!==n.i&&u.i!==s.i&&u.next.i!==s.i&&qy(u,u.next,n,s))return!0;u=u.next}while(u!==n);return!1}(r,t)&&(qu(r,t)&&qu(t,r)&&function(n,s){let u=n,p=!1;const g=(n.x+s.x)/2,v=(n.y+s.y)/2;do u.y>v!=u.next.y>v&&u.next.y!==u.y&&g<(u.next.x-u.x)*(v-u.y)/(u.next.y-u.y)+u.x&&(p=!p),u=u.next;while(u!==n);return p}(r,t)&&(Ai(r.prev,r,t.prev)||Ai(r,t.prev,t))||ec(r,t)&&Ai(r.prev,r,r.next)>0&&Ai(t.prev,t,t.next)>0)}function Ai(r,t,n){return(t.y-r.y)*(n.x-t.x)-(t.x-r.x)*(n.y-t.y)}function ec(r,t){return r.x===t.x&&r.y===t.y}function qy(r,t,n,s){const u=Jd(Ai(r,t,n)),p=Jd(Ai(r,t,s)),g=Jd(Ai(n,s,r)),v=Jd(Ai(n,s,t));return u!==p&&g!==v||!(u!==0||!Yd(r,n,t))||!(p!==0||!Yd(r,s,t))||!(g!==0||!Yd(n,r,s))||!(v!==0||!Yd(n,t,s))}function Yd(r,t,n){return t.x<=Math.max(r.x,n.x)&&t.x>=Math.min(r.x,n.x)&&t.y<=Math.max(r.y,n.y)&&t.y>=Math.min(r.y,n.y)}function Jd(r){return r>0?1:r<0?-1:0}function qu(r,t){return Ai(r.prev,r,r.next)<0?Ai(r,t,r.next)>=0&&Ai(r,r.prev,t)>=0:Ai(r,t,r.prev)<0||Ai(r,r.next,t)<0}function Hy(r,t){const n=bf(r.i,r.x,r.y),s=bf(t.i,t.x,t.y),u=r.next,p=t.prev;return r.next=t,t.prev=r,n.next=u,u.prev=n,s.next=n,n.prev=s,p.next=s,s.prev=p,s}function Xy(r,t,n,s){const u=bf(r,t,n);return s?(u.next=s.next,u.prev=s,s.next.prev=u,s.next=u):(u.prev=u,u.next=u),u}function Hu(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function bf(r,t,n){return{i:r,x:t,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class tc{constructor(t,n){if(n>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=n}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class Qd{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}Qd.noSubdivision=new Qd({fill:new tc(0,0),line:new tc(0,0),tile:new tc(0,0),stencil:new tc(0,0),circle:1}),Ke("SubdivisionGranularityExpression",tc),Ke("SubdivisionGranularitySetting",Qd);const ic=-32768,Xu=32767;class Xw{constructor(t,n){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=He/t,this._canonical=n}_getKey(t,n){return(t+=32768)<<16|n+32768}_vertexToIndex(t,n){if(t<-32768||n<-32768||t>32767||n>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const s=0|Math.round(t),u=0|Math.round(n),p=this._getKey(s,u);if(this._vertexDictionary.has(p))return this._vertexDictionary.get(p);const g=this._vertexBuffer.length/2;return this._vertexDictionary.set(p,g),this._vertexBuffer.push(s,u),g}_subdivideTrianglesScanline(t){if(this._granularity<2)return function(u,p){const g=[];for(let v=0;v<p.length;v+=3){const w=p[v],T=p[v+1],P=p[v+2],E=u[2*w],D=u[2*w+1];(u[2*T]-E)*(u[2*P+1]-D)-(u[2*T+1]-D)*(u[2*P]-E)>0?(g.push(w),g.push(P),g.push(T)):(g.push(w),g.push(T),g.push(P))}return g}(this._vertexBuffer,t);const n=[],s=t.length;for(let u=0;u<s;u+=3){const p=[t[u+0],t[u+1],t[u+2]],g=[this._vertexBuffer[2*t[u+0]+0],this._vertexBuffer[2*t[u+0]+1],this._vertexBuffer[2*t[u+1]+0],this._vertexBuffer[2*t[u+1]+1],this._vertexBuffer[2*t[u+2]+0],this._vertexBuffer[2*t[u+2]+1]];let v=1/0,w=1/0,T=-1/0,P=-1/0;for(let V=0;V<3;V++){const G=g[2*V],Y=g[2*V+1];v=Math.min(v,G),T=Math.max(T,G),w=Math.min(w,Y),P=Math.max(P,Y)}if(v===T||w===P)continue;const E=Math.floor(v/this._granularityCellSize),D=Math.ceil(T/this._granularityCellSize),R=Math.floor(w/this._granularityCellSize),B=Math.ceil(P/this._granularityCellSize);if(E!==D||R!==B)for(let V=R;V<B;V++){const G=this._scanlineGenerateVertexRingForCellRow(V,g,p);Kw(this._vertexBuffer,G,n)}else n.push(...p)}return n}_scanlineGenerateVertexRingForCellRow(t,n,s){const u=t*this._granularityCellSize,p=u+this._granularityCellSize,g=[];for(let v=0;v<3;v++){const w=n[2*v],T=n[2*v+1],P=n[2*(v+1)%6],E=n[(2*(v+1)+1)%6],D=n[2*(v+2)%6],R=n[(2*(v+2)+1)%6],B=P-w,V=E-T,G=B===0,Y=V===0,_e=(u-T)/V,ne=(p-T)/V,ue=Math.min(_e,ne),we=Math.max(_e,ne);if(!Y&&(ue>=1||we<=0)||Y&&(T<u||T>p)){E>=u&&E<=p&&g.push(s[(v+1)%3]);continue}!Y&&ue>0&&g.push(this._vertexToIndex(w+B*ue,T+V*ue));const ke=w+B*Math.max(ue,0),Re=w+B*Math.min(we,1);G||this._generateIntraEdgeVertices(g,w,T,P,E,ke,Re),!Y&&we<1&&g.push(this._vertexToIndex(w+B*we,T+V*we)),(Y||E>=u&&E<=p)&&g.push(s[(v+1)%3]),!Y&&(E<=u||E>=p)&&this._generateInterEdgeVertices(g,w,T,P,E,D,R,Re,u,p)}return g}_generateIntraEdgeVertices(t,n,s,u,p,g,v){const w=u-n,T=p-s,P=T===0,E=P?Math.min(n,u):Math.min(g,v),D=P?Math.max(n,u):Math.max(g,v),R=Math.floor(E/this._granularityCellSize)+1,B=Math.ceil(D/this._granularityCellSize)-1;if(P?n<u:g<v)for(let V=R;V<=B;V++){const G=V*this._granularityCellSize;t.push(this._vertexToIndex(G,s+T*(G-n)/w))}else for(let V=B;V>=R;V--){const G=V*this._granularityCellSize;t.push(this._vertexToIndex(G,s+T*(G-n)/w))}}_generateInterEdgeVertices(t,n,s,u,p,g,v,w,T,P){const E=p-s,D=g-u,R=v-p,B=(T-p)/R,V=(P-p)/R,G=Math.min(B,V),Y=Math.max(B,V),_e=u+D*G;let ne=Math.floor(Math.min(_e,w)/this._granularityCellSize)+1,ue=Math.ceil(Math.max(_e,w)/this._granularityCellSize)-1,we=w<_e;const ke=R===0;if(ke&&(v===T||v===P))return;if(ke||G>=1||Y<=0){const qe=s-v,Ve=g+(n-g)*Math.min((T-v)/qe,(P-v)/qe);ne=Math.floor(Math.min(Ve,w)/this._granularityCellSize)+1,ue=Math.ceil(Math.max(Ve,w)/this._granularityCellSize)-1,we=w<Ve}const Re=E>0?P:T;if(we)for(let qe=ne;qe<=ue;qe++)t.push(this._vertexToIndex(qe*this._granularityCellSize,Re));else for(let qe=ue;qe>=ne;qe--)t.push(this._vertexToIndex(qe*this._granularityCellSize,Re))}_generateOutline(t){const n=[];for(const s of t){const u=Vs(s,this._granularity,!0),p=this._pointArrayToIndices(u),g=[];for(let v=1;v<p.length;v++)g.push(p[v-1]),g.push(p[v]);n.push(g)}return n}_handlePoles(t){let n=!1,s=!1;this._canonical&&(this._canonical.y===0&&(n=!0),this._canonical.y===(1<<this._canonical.z)-1&&(s=!0)),(n||s)&&this._fillPoles(t,n,s)}_ensureNoPoleVertices(){const t=this._vertexBuffer;for(let n=0;n<t.length;n+=2){const s=t[n+1];s===ic&&(t[n+1]=-32767),s===Xu&&(t[n+1]=32766)}}_generatePoleQuad(t,n,s,u,p,g){u>p!=(g===ic)?(t.push(n),t.push(s),t.push(this._vertexToIndex(u,g)),t.push(s),t.push(this._vertexToIndex(p,g)),t.push(this._vertexToIndex(u,g))):(t.push(s),t.push(n),t.push(this._vertexToIndex(u,g)),t.push(this._vertexToIndex(p,g)),t.push(s),t.push(this._vertexToIndex(u,g)))}_fillPoles(t,n,s){const u=this._vertexBuffer,p=He,g=t.length;for(let v=2;v<g;v+=3){const w=t[v-2],T=t[v-1],P=t[v],E=u[2*w],D=u[2*w+1],R=u[2*T],B=u[2*T+1],V=u[2*P],G=u[2*P+1];n&&(D===0&&B===0&&this._generatePoleQuad(t,w,T,E,R,ic),B===0&&G===0&&this._generatePoleQuad(t,T,P,R,V,ic),G===0&&D===0&&this._generatePoleQuad(t,P,w,V,E,ic)),s&&(D===p&&B===p&&this._generatePoleQuad(t,w,T,E,R,Xu),B===p&&G===p&&this._generatePoleQuad(t,T,P,R,V,Xu),G===p&&D===p&&this._generatePoleQuad(t,P,w,V,E,Xu))}}_initializeVertices(t){for(let n=0;n<t.length;n+=2)this._vertexToIndex(t[n],t[n+1])}subdividePolygonInternal(t,n){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:s,holeIndices:u}=function(v){const w=[],T=[];for(const P of v)if(P.length!==0){P!==v[0]&&w.push(T.length/2);for(let E=0;E<P.length;E++)T.push(P[E].x),T.push(P[E].y)}return{flattened:T,holeIndices:w}}(t);let p;this._initializeVertices(s);try{const v=function(T,P,E=2){const D=P&&P.length,R=D?P[0]*E:T.length;let B=Gy(T,0,R,E,!0);const V=[];if(!B||B.next===B.prev)return V;let G,Y,_e;if(D&&(B=function(ne,ue,we,ke){const Re=[];for(let qe=0,Ve=ue.length;qe<Ve;qe++){const $e=Gy(ne,ue[qe]*ke,qe<Ve-1?ue[qe+1]*ke:ne.length,ke,!1);$e===$e.next&&($e.steiner=!0),Re.push(qw($e))}Re.sort(Zw);for(let qe=0;qe<Re.length;qe++)we=Gw(Re[qe],we);return we}(T,P,B,E)),T.length>80*E){G=T[0],Y=T[1];let ne=G,ue=Y;for(let we=E;we<R;we+=E){const ke=T[we],Re=T[we+1];ke<G&&(G=ke),Re<Y&&(Y=Re),ke>ne&&(ne=ke),Re>ue&&(ue=Re)}_e=Math.max(ne-G,ue-Y),_e=_e!==0?32767/_e:0}return Gu(B,V,E,G,Y,_e,0),V}(s,u),w=this._convertIndices(s,v);p=this._subdivideTrianglesScanline(w)}catch(v){console.error(v)}let g=[];return n&&(g=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(p),{verticesFlattened:this._vertexBuffer,indicesTriangles:p,indicesLineList:g}}_convertIndices(t,n){const s=[];for(let u=0;u<n.length;u++)s.push(this._vertexToIndex(t[2*n[u]],t[2*n[u]+1]));return s}_pointArrayToIndices(t){const n=[];for(let s=0;s<t.length;s++){const u=t[s];n.push(this._vertexToIndex(u.x,u.y))}return n}}function Ky(r,t,n,s=!0){return new Xw(n,t).subdividePolygonInternal(r,s)}function Vs(r,t,n=!1){if(!r||r.length<1)return[];if(r.length<2)return[];const s=r[0],u=r[r.length-1],p=n&&(s.x!==u.x||s.y!==u.y);if(t<2)return p?[...r,r[0]]:[...r];const g=Math.floor(He/t),v=[];v.push(new F(r[0].x,r[0].y));const w=r.length,T=p?w:w-1;for(let P=0;P<T;P++){const E=r[P],D=P<w-1?r[P+1]:r[0],R=E.x,B=E.y,V=D.x,G=D.y,Y=R!==V,_e=B!==G;if(!Y&&!_e)continue;const ne=V-R,ue=G-B,we=Math.abs(ne),ke=Math.abs(ue);let Re=R,qe=B;for(;;){const $e=ne>0?(Math.floor(Re/g)+1)*g:(Math.ceil(Re/g)-1)*g,at=ue>0?(Math.floor(qe/g)+1)*g:(Math.ceil(qe/g)-1)*g,Ue=Math.abs(Re-$e),Ze=Math.abs(qe-at),Ee=Math.abs(Re-V),pt=Math.abs(qe-G),ft=Y?Ue/we:Number.POSITIVE_INFINITY,ut=_e?Ze/ke:Number.POSITIVE_INFINITY;if((Ee<=Ue||!Y)&&(pt<=Ze||!_e))break;if(ft<ut&&Y||!_e){Re=$e,qe+=ue*ft;const nt=new F(Re,Math.round(qe));v[v.length-1].x===nt.x&&v[v.length-1].y===nt.y||v.push(nt)}else{Re+=ne*ut,qe=at;const nt=new F(Math.round(Re),qe);v[v.length-1].x===nt.x&&v[v.length-1].y===nt.y||v.push(nt)}}const Ve=new F(V,G);v[v.length-1].x===Ve.x&&v[v.length-1].y===Ve.y||v.push(Ve)}return v}function Kw(r,t,n){if(t.length===0)throw new Error("Subdivision vertex ring is empty.");let s=0,u=r[2*t[0]];for(let w=1;w<t.length;w++){const T=r[2*t[w]];T<u&&(u=T,s=w)}const p=t.length;let g=s,v=(g+1)%p;for(;;){const w=g-1>=0?g-1:p-1,T=(v+1)%p,P=r[2*t[w]],E=r[2*t[T]],D=r[2*t[g]],R=r[2*t[g]+1],B=r[2*t[v]+1];let V=!1;if(P<E)V=!0;else if(P>E)V=!1;else{const G=B-R,Y=-(r[2*t[v]]-D),_e=R<B?1:-1;((P-D)*G+(r[2*t[w]+1]-R)*Y)*_e>((E-D)*G+(r[2*t[T]+1]-R)*Y)*_e&&(V=!0)}if(V){const G=t[w],Y=t[g],_e=t[v];G!==Y&&G!==_e&&Y!==_e&&n.push(_e,Y,G),g--,g<0&&(g=p-1)}else{const G=t[T],Y=t[g],_e=t[v];G!==Y&&G!==_e&&Y!==_e&&n.push(_e,Y,G),v++,v>=p&&(v=0)}if(w===T)break}}function Yy(r,t,n,s,u,p,g,v,w){const T=u.length/2,P=g&&v&&w;if(T<It.MAX_VERTEX_ARRAY_LENGTH){const E=t.prepareSegment(T,n,s),D=E.vertexLength;for(let V=0;V<p.length;V+=3)s.emplaceBack(D+p[V],D+p[V+1],D+p[V+2]);let R,B;E.vertexLength+=T,E.primitiveLength+=p.length/3,P&&(B=g.prepareSegment(T,n,v),R=B.vertexLength,B.vertexLength+=T);for(let V=0;V<u.length;V+=2)r(u[V],u[V+1]);if(P)for(let V=0;V<w.length;V++){const G=w[V];for(let Y=1;Y<G.length;Y+=2)v.emplaceBack(R+G[Y-1],R+G[Y]);B.primitiveLength+=G.length/2}}else(function(E,D,R,B,V,G){const Y=[];for(let ke=0;ke<B.length/2;ke++)Y.push(-1);const _e={count:0};let ne=0,ue=E.getOrCreateLatestSegment(D,R),we=ue.vertexLength;for(let ke=2;ke<V.length;ke+=3){const Re=V[ke-2],qe=V[ke-1],Ve=V[ke];let $e=Y[Re]<ne,at=Y[qe]<ne,Ue=Y[Ve]<ne;ue.vertexLength+(($e?1:0)+(at?1:0)+(Ue?1:0))>It.MAX_VERTEX_ARRAY_LENGTH&&(ue=E.createNewSegment(D,R),ne=_e.count,$e=!0,at=!0,Ue=!0,we=0);const Ze=Ku(Y,B,G,_e,Re,$e,ue),Ee=Ku(Y,B,G,_e,qe,at,ue),pt=Ku(Y,B,G,_e,Ve,Ue,ue);R.emplaceBack(we+Ze-ne,we+Ee-ne,we+pt-ne),ue.primitiveLength++}})(t,n,s,u,p,r),P&&function(E,D,R,B,V,G){const Y=[];for(let ke=0;ke<B.length/2;ke++)Y.push(-1);const _e={count:0};let ne=0,ue=E.getOrCreateLatestSegment(D,R),we=ue.vertexLength;for(let ke=0;ke<V.length;ke++){const Re=V[ke];for(let qe=1;qe<V[ke].length;qe+=2){const Ve=Re[qe-1],$e=Re[qe];let at=Y[Ve]<ne,Ue=Y[$e]<ne;ue.vertexLength+((at?1:0)+(Ue?1:0))>It.MAX_VERTEX_ARRAY_LENGTH&&(ue=E.createNewSegment(D,R),ne=_e.count,at=!0,Ue=!0,we=0);const Ze=Ku(Y,B,G,_e,Ve,at,ue),Ee=Ku(Y,B,G,_e,$e,Ue,ue);R.emplaceBack(we+Ze-ne,we+Ee-ne),ue.primitiveLength++}}}(g,n,v,u,w,r),t.forceNewSegmentOnNextPrepare(),g==null||g.forceNewSegmentOnNextPrepare()}function Ku(r,t,n,s,u,p,g){if(p){const v=s.count;return n(t[2*u],t[2*u+1]),r[u]=s.count,s.count++,g.vertexLength++,v}return r[u]}class wf{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new Se,this.indexArray=new Ui,this.indexArray2=new ei,this.programConfigurations=new Fs(t.layers,t.zoom),this.segments=new It,this.segments2=new It,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,s){this.hasDependencies=Kd("fill",this.layers,n);const u=this.layers[0].layout.get("fill-sort-key"),p=!u.isConstant(),g=[];for(const{feature:v,id:w,index:T,sourceLayerIndex:P}of t){const E=this.layers[0]._featureFilter.needGeometry,D=js(v,E);if(!this.layers[0]._featureFilter.filter(new Ot(this.zoom),D,s))continue;const R=p?u.evaluate(D,{},s,n.availableImages):void 0,B={id:w,properties:v.properties,type:v.type,sourceLayerIndex:P,index:T,geometry:E?D.geometry:Bs(v),patterns:{},sortKey:R};g.push(B)}p&&g.sort((v,w)=>v.sortKey-w.sortKey);for(const v of g){const{geometry:w,index:T,sourceLayerIndex:P}=v;if(this.hasDependencies){const E=vf("fill",this.layers,v,{zoom:this.zoom},n);this.patternFeatures.push(E)}else this.addFeature(v,w,T,s,{},n.subdivisionGranularity);n.featureIndex.insert(t[T].feature,w,T,P,this.index)}}update(t,n,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,{imagePositions:s})}addFeatures(t,n,s){for(const u of this.patternFeatures)this.addFeature(u,u.geometry,u.index,n,s,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,jw),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,n,s,u,p,g){for(const v of xs(n,500)){const w=Ky(v,u,g.fill.getGranularityForZoomLevel(u.z)),T=this.layoutVertexArray;Yy((P,E)=>{T.emplaceBack(P,E)},this.segments,this.layoutVertexArray,this.indexArray,w.verticesFlattened,w.indicesTriangles,this.segments2,this.indexArray2,w.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,{imagePositions:p,canonical:u})}}let Jy,Qy;Ke("FillBucket",wf,{omit:["layers","patternFeatures"]});var Yw={get paint(){return Qy=Qy||new mn({"fill-antialias":new rt(ve.paint_fill["fill-antialias"]),"fill-opacity":new ct(ve.paint_fill["fill-opacity"]),"fill-color":new ct(ve.paint_fill["fill-color"]),"fill-outline-color":new ct(ve.paint_fill["fill-outline-color"]),"fill-translate":new rt(ve.paint_fill["fill-translate"]),"fill-translate-anchor":new rt(ve.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ns(ve.paint_fill["fill-pattern"])})},get layout(){return Jy=Jy||new mn({"fill-sort-key":new ct(ve.layout_fill["fill-sort-key"])})}};class Jw extends Cr{constructor(t,n){super(t,Yw,n)}recalculate(t,n){super.recalculate(t,n);const s=this.paint._values["fill-outline-color"];s.value.kind==="constant"&&s.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new wf(t)}queryRadius(){return Hd(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:t,geometry:n,transform:s,pixelsToTileUnits:u}){return Ey(Xd(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-s.bearingInRadians,u),n)}isTileClipped(){return!0}}const Qw=mi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),e2=mi([{name:"a_centroid",components:2,type:"Int16"}],4),{members:t2}=Qw;class nc{constructor(t,n,s,u,p){this.properties={},this.extent=s,this.type=0,this.id=void 0,this._pbf=t,this._geometry=-1,this._keys=u,this._values=p,t.readFields(i2,this,n)}loadGeometry(){const t=this._pbf;t.pos=this._geometry;const n=t.readVarint()+t.pos,s=[];let u,p=1,g=0,v=0,w=0;for(;t.pos<n;){if(g<=0){const T=t.readVarint();p=7&T,g=T>>3}if(g--,p===1||p===2)v+=t.readSVarint(),w+=t.readSVarint(),p===1&&(u&&s.push(u),u=[]),u&&u.push(new F(v,w));else{if(p!==7)throw new Error(`unknown command ${p}`);u&&u.push(u[0].clone())}}return u&&s.push(u),s}bbox(){const t=this._pbf;t.pos=this._geometry;const n=t.readVarint()+t.pos;let s=1,u=0,p=0,g=0,v=1/0,w=-1/0,T=1/0,P=-1/0;for(;t.pos<n;){if(u<=0){const E=t.readVarint();s=7&E,u=E>>3}if(u--,s===1||s===2)p+=t.readSVarint(),g+=t.readSVarint(),p<v&&(v=p),p>w&&(w=p),g<T&&(T=g),g>P&&(P=g);else if(s!==7)throw new Error(`unknown command ${s}`)}return[v,T,w,P]}toGeoJSON(t,n,s){const u=this.extent*Math.pow(2,s),p=this.extent*t,g=this.extent*n,v=this.loadGeometry();function w(D){return[360*(D.x+p)/u-180,360/Math.PI*Math.atan(Math.exp((1-2*(D.y+g)/u)*Math.PI))-90]}function T(D){return D.map(w)}let P;if(this.type===1){const D=[];for(const B of v)D.push(B[0]);const R=T(D);P=D.length===1?{type:"Point",coordinates:R[0]}:{type:"MultiPoint",coordinates:R}}else if(this.type===2){const D=v.map(T);P=D.length===1?{type:"LineString",coordinates:D[0]}:{type:"MultiLineString",coordinates:D}}else{if(this.type!==3)throw new Error("unknown feature type");{const D=function(B){const V=B.length;if(V<=1)return[B];const G=[];let Y,_e;for(let ne=0;ne<V;ne++){const ue=n2(B[ne]);ue!==0&&(_e===void 0&&(_e=ue<0),_e===ue<0?(Y&&G.push(Y),Y=[B[ne]]):Y&&Y.push(B[ne]))}return Y&&G.push(Y),G}(v),R=[];for(const B of D)R.push(B.map(T));P=R.length===1?{type:"Polygon",coordinates:R[0]}:{type:"MultiPolygon",coordinates:R}}}const E={type:"Feature",geometry:P,properties:this.properties};return this.id!=null&&(E.id=this.id),E}}function i2(r,t,n){r===1?t.id=n.readVarint():r===2?function(s,u){const p=s.readVarint()+s.pos;for(;s.pos<p;){const g=u._keys[s.readVarint()],v=u._values[s.readVarint()];u.properties[g]=v}}(n,t):r===3?t.type=n.readVarint():r===4&&(t._geometry=n.pos)}function n2(r){let t=0;for(let n,s,u=0,p=r.length,g=p-1;u<p;g=u++)n=r[u],s=r[g],t+=(s.x-n.x)*(n.y+s.y);return t}nc.types=["Unknown","Point","LineString","Polygon"];class e_{constructor(t,n){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(r2,this,n),this.length=this._features.length}feature(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];const n=this._pbf.readVarint()+this._pbf.pos;return new nc(this._pbf,n,this.extent,this._keys,this._values)}}function r2(r,t,n){r===15?t.version=n.readVarint():r===1?t.name=n.readString():r===5?t.extent=n.readVarint():r===2?t._features.push(n.pos):r===3?t._keys.push(n.readString()):r===4&&t._values.push(function(s){let u=null;const p=s.readVarint()+s.pos;for(;s.pos<p;){const g=s.readVarint()>>3;u=g===1?s.readString():g===2?s.readFloat():g===3?s.readDouble():g===4?s.readVarint64():g===5?s.readVarint():g===6?s.readSVarint():g===7?s.readBoolean():null}if(u==null)throw new Error("unknown feature value");return u}(n))}class t_{constructor(t,n){this.layers=t.readFields(a2,{},n)}}function a2(r,t,n){if(r===3){const s=new e_(n,n.readVarint()+n.pos);s.length&&(t[s.name]=s)}}const Cf=Math.pow(2,13);function Yu(r,t,n,s,u,p,g,v){r.emplaceBack(t,n,2*Math.floor(s*Cf)+g,u*Cf*2,p*Cf*2,Math.round(v))}class If{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasDependencies=!1,this.layoutVertexArray=new Oe,this.centroidVertexArray=new be,this.indexArray=new Ui,this.programConfigurations=new Fs(t.layers,t.zoom),this.segments=new It,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,s){this.features=[],this.hasDependencies=Kd("fill-extrusion",this.layers,n);for(const{feature:u,id:p,index:g,sourceLayerIndex:v}of t){const w=this.layers[0]._featureFilter.needGeometry,T=js(u,w);if(!this.layers[0]._featureFilter.filter(new Ot(this.zoom),T,s))continue;const P={id:p,sourceLayerIndex:v,index:g,geometry:w?T.geometry:Bs(u),properties:u.properties,type:u.type,patterns:{}};this.hasDependencies?this.features.push(vf("fill-extrusion",this.layers,P,{zoom:this.zoom},n)):this.addFeature(P,P.geometry,g,s,{},n.subdivisionGranularity),n.featureIndex.insert(u,P.geometry,g,v,this.index,!0)}}addFeatures(t,n,s){for(const u of this.features){const{geometry:p}=u;this.addFeature(u,p,u.index,n,s,t.subdivisionGranularity)}}update(t,n,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,{imagePositions:s})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,t2),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,e2.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,n,s,u,p,g){for(const v of xs(n,500)){const w={x:0,y:0,sampleCount:0},T=this.layoutVertexArray.length;this.processPolygon(w,u,t,v,g);const P=this.layoutVertexArray.length-T,E=Math.floor(w.x/w.sampleCount),D=Math.floor(w.y/w.sampleCount);for(let R=0;R<P;R++)this.centroidVertexArray.emplaceBack(E,D)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,{imagePositions:p,canonical:u})}processPolygon(t,n,s,u,p){if(u.length<1||i_(u[0]))return;for(const E of u)E.length!==0&&o2(t,E);const g={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},v=p.fill.getGranularityForZoomLevel(n.z),w=nc.types[s.type]==="Polygon";for(const E of u){if(E.length===0||i_(E))continue;const D=Vs(E,v,w);this._generateSideFaces(D,g)}if(!w)return;const T=Ky(u,n,v,!1),P=this.layoutVertexArray;Yy((E,D)=>{Yu(P,E,D,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,T.verticesFlattened,T.indicesTriangles)}_generateSideFaces(t,n){let s=0;for(let u=1;u<t.length;u++){const p=t[u],g=t[u-1];if(s2(p,g))continue;n.segment.vertexLength+4>It.MAX_VERTEX_ARRAY_LENGTH&&(n.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const v=p.sub(g)._perp()._unit(),w=g.dist(p);s+w>32768&&(s=0),Yu(this.layoutVertexArray,p.x,p.y,v.x,v.y,0,0,s),Yu(this.layoutVertexArray,p.x,p.y,v.x,v.y,0,1,s),s+=w,Yu(this.layoutVertexArray,g.x,g.y,v.x,v.y,0,0,s),Yu(this.layoutVertexArray,g.x,g.y,v.x,v.y,0,1,s);const T=n.segment.vertexLength;this.indexArray.emplaceBack(T,T+2,T+1),this.indexArray.emplaceBack(T+1,T+2,T+3),n.segment.vertexLength+=4,n.segment.primitiveLength+=2}}}function o2(r,t){for(let n=0;n<t.length;n++){const s=t[n];n===t.length-1&&t[0].x===s.x&&t[0].y===s.y||(r.x+=s.x,r.y+=s.y,r.sampleCount++)}}function s2(r,t){return r.x===t.x&&(r.x<0||r.x>He)||r.y===t.y&&(r.y<0||r.y>He)}function i_(r){return r.every(t=>t.x<0)||r.every(t=>t.x>He)||r.every(t=>t.y<0)||r.every(t=>t.y>He)}let n_;Ke("FillExtrusionBucket",If,{omit:["layers","features"]});var l2={get paint(){return n_=n_||new mn({"fill-extrusion-opacity":new rt(ve["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ct(ve["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new rt(ve["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new rt(ve["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ns(ve["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ct(ve["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ct(ve["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new rt(ve["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class c2 extends Cr{constructor(t,n){super(t,l2,n)}createBucket(t){return new If(t)}queryRadius(){return Hd(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:s,geometry:u,transform:p,pixelsToTileUnits:g,pixelPosMatrix:v}){const w=Xd(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-p.bearingInRadians,g),T=this.paint.get("fill-extrusion-height").evaluate(n,s),P=this.paint.get("fill-extrusion-base").evaluate(n,s),E=function(R,B){const V=[];for(const G of R){const Y=[G.x,G.y,0,1];si(Y,Y,B),V.push(new F(Y[0]/Y[3],Y[1]/Y[3]))}return V}(w,v),D=function(R,B,V,G){const Y=[],_e=[],ne=G[8]*B,ue=G[9]*B,we=G[10]*B,ke=G[11]*B,Re=G[8]*V,qe=G[9]*V,Ve=G[10]*V,$e=G[11]*V;for(const at of R){const Ue=[],Ze=[];for(const Ee of at){const pt=Ee.x,ft=Ee.y,ut=G[0]*pt+G[4]*ft+G[12],nt=G[1]*pt+G[5]*ft+G[13],Et=G[2]*pt+G[6]*ft+G[14],fi=G[3]*pt+G[7]*ft+G[15],$i=Et+we,gn=fi+ke,Ar=ut+Re,er=nt+qe,on=Et+Ve,ui=fi+$e,Yi=new F((ut+ne)/gn,(nt+ue)/gn);Yi.z=$i/gn,Ue.push(Yi);const sn=new F(Ar/ui,er/ui);sn.z=on/ui,Ze.push(sn)}Y.push(Ue),_e.push(Ze)}return[Y,_e]}(u,P,T,v);return function(R,B,V){let G=1/0;Ey(V,B)&&(G=r_(V,B[0]));for(let Y=0;Y<B.length;Y++){const _e=B[Y],ne=R[Y];for(let ue=0;ue<_e.length-1;ue++){const we=_e[ue],ke=[we,_e[ue+1],ne[ue+1],ne[ue],we];My(V,ke)&&(G=Math.min(G,r_(V,ke)))}}return G!==1/0&&G}(D[0],D[1],E)}}function Ju(r,t){return r.x*t.x+r.y*t.y}function r_(r,t){if(r.length===1){let n=0;const s=t[n++];let u;for(;!u||s.equals(u);)if(u=t[n++],!u)return 1/0;for(;n<t.length;n++){const p=t[n],g=r[0],v=u.sub(s),w=p.sub(s),T=g.sub(s),P=Ju(v,v),E=Ju(v,w),D=Ju(w,w),R=Ju(T,v),B=Ju(T,w),V=P*D-E*E,G=(D*R-E*B)/V,Y=(P*B-E*R)/V,_e=s.z*(1-G-Y)+u.z*G+p.z*Y;if(isFinite(_e))return _e}return 1/0}{let n=1/0;for(const s of t)n=Math.min(n,s.z);return n}}const u2=mi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:h2}=u2,d2=mi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:p2}=d2,m2=Math.cos(Math.PI/180*37.5),a_=Math.pow(2,14)/.5;class Af{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(n=>{this.gradients[n.id]={}}),this.layoutVertexArray=new Be,this.layoutVertexArray2=new Le,this.indexArray=new Ui,this.programConfigurations=new Fs(t.layers,t.zoom),this.segments=new It,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,s){this.hasDependencies=Kd("line",this.layers,n)||this.hasLineDasharray(this.layers);const u=this.layers[0].layout.get("line-sort-key"),p=!u.isConstant(),g=[];for(const{feature:v,id:w,index:T,sourceLayerIndex:P}of t){const E=this.layers[0]._featureFilter.needGeometry,D=js(v,E);if(!this.layers[0]._featureFilter.filter(new Ot(this.zoom),D,s))continue;const R=p?u.evaluate(D,{},s):void 0,B={id:w,properties:v.properties,type:v.type,sourceLayerIndex:P,index:T,geometry:E?D.geometry:Bs(v),patterns:{},dashes:{},sortKey:R};g.push(B)}p&&g.sort((v,w)=>v.sortKey-w.sortKey);for(const v of g){const{geometry:w,index:T,sourceLayerIndex:P}=v;this.hasDependencies?(Kd("line",this.layers,n)?vf("line",this.layers,v,{zoom:this.zoom},n):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,v,this.zoom,n),this.patternFeatures.push(v)):this.addFeature(v,w,T,s,{},{},n.subdivisionGranularity),n.featureIndex.insert(t[T].feature,w,T,P,this.index)}}update(t,n,s,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,{imagePositions:s,dashPositions:u})}addFeatures(t,n,s,u){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,n,s,u,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,p2)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,h2),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,n,s,u,p,g,v){const w=this.layers[0].layout,T=w.get("line-join").evaluate(t,{}),P=w.get("line-cap"),E=w.get("line-miter-limit"),D=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const R of n)this.addLine(R,t,T,P,E,D,u,v);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,{imagePositions:p,dashPositions:g,canonical:u})}addLine(t,n,s,u,p,g,v,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=Vs(t,v?w.line.getGranularityForZoomLevel(v.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ne=0;ne<t.length-1;ne++)this.totalDistance+=t[ne].dist(t[ne+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const T=nc.types[n.type]==="Polygon";let P=t.length;for(;P>=2&&t[P-1].equals(t[P-2]);)P--;let E=0;for(;E<P-1&&t[E].equals(t[E+1]);)E++;if(P<(T?3:2))return;s==="bevel"&&(p=1.05);const D=this.overscaling<=16?122880/(512*this.overscaling):0,R=this.segments.prepareSegment(10*P,this.layoutVertexArray,this.indexArray);let B,V,G,Y,_e;this.e1=this.e2=-1,T&&(B=t[P-2],_e=t[E].sub(B)._unit()._perp());for(let ne=E;ne<P;ne++){if(G=ne===P-1?T?t[E+1]:void 0:t[ne+1],G&&t[ne].equals(G))continue;_e&&(Y=_e),B&&(V=B),B=t[ne],_e=G?G.sub(B)._unit()._perp():Y,Y=Y||_e;let ue=Y.add(_e);ue.x===0&&ue.y===0||ue._unit();const we=Y.x*_e.x+Y.y*_e.y,ke=ue.x*_e.x+ue.y*_e.y,Re=ke!==0?1/ke:1/0,qe=2*Math.sqrt(2-2*ke),Ve=ke<m2&&V&&G,$e=Y.x*_e.y-Y.y*_e.x>0;if(Ve&&ne>E){const Ze=B.dist(V);if(Ze>2*D){const Ee=B.sub(B.sub(V)._mult(D/Ze)._round());this.updateDistance(V,Ee),this.addCurrentVertex(Ee,Y,0,0,R),V=Ee}}const at=V&&G;let Ue=at?s:T?"butt":u;if(at&&Ue==="round"&&(Re<g?Ue="miter":Re<=2&&(Ue="fakeround")),Ue==="miter"&&Re>p&&(Ue="bevel"),Ue==="bevel"&&(Re>2&&(Ue="flipbevel"),Re<p&&(Ue="miter")),V&&this.updateDistance(V,B),Ue==="miter")ue._mult(Re),this.addCurrentVertex(B,ue,0,0,R);else if(Ue==="flipbevel"){if(Re>100)ue=_e.mult(-1);else{const Ze=Re*Y.add(_e).mag()/Y.sub(_e).mag();ue._perp()._mult(Ze*($e?-1:1))}this.addCurrentVertex(B,ue,0,0,R),this.addCurrentVertex(B,ue.mult(-1),0,0,R)}else if(Ue==="bevel"||Ue==="fakeround"){const Ze=-Math.sqrt(Re*Re-1),Ee=$e?Ze:0,pt=$e?0:Ze;if(V&&this.addCurrentVertex(B,Y,Ee,pt,R),Ue==="fakeround"){const ft=Math.round(180*qe/Math.PI/20);for(let ut=1;ut<ft;ut++){let nt=ut/ft;if(nt!==.5){const fi=nt-.5;nt+=nt*fi*(nt-1)*((1.0904+we*(we*(3.55645-1.43519*we)-3.2452))*fi*fi+(.848013+we*(.215638*we-1.06021)))}const Et=_e.sub(Y)._mult(nt)._add(Y)._unit()._mult($e?-1:1);this.addHalfVertex(B,Et.x,Et.y,!1,$e,0,R)}}G&&this.addCurrentVertex(B,_e,-Ee,-pt,R)}else if(Ue==="butt")this.addCurrentVertex(B,ue,0,0,R);else if(Ue==="square"){const Ze=V?1:-1;this.addCurrentVertex(B,ue,Ze,Ze,R)}else Ue==="round"&&(V&&(this.addCurrentVertex(B,Y,0,0,R),this.addCurrentVertex(B,Y,1,1,R,!0)),G&&(this.addCurrentVertex(B,_e,-1,-1,R,!0),this.addCurrentVertex(B,_e,0,0,R)));if(Ve&&ne<P-1){const Ze=B.dist(G);if(Ze>2*D){const Ee=B.add(G.sub(B)._mult(D/Ze)._round());this.updateDistance(B,Ee),this.addCurrentVertex(Ee,_e,0,0,R),B=Ee}}}}addCurrentVertex(t,n,s,u,p,g=!1){const v=n.y*u-n.x,w=-n.y-n.x*u;this.addHalfVertex(t,n.x+n.y*s,n.y-n.x*s,g,!1,s,p),this.addHalfVertex(t,v,w,g,!0,-u,p),this.distance>a_/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,n,s,u,p,g))}addHalfVertex({x:t,y:n},s,u,p,g,v,w){const T=.5*(this.lineClips?this.scaledDistance*(a_-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(p?1:0),(n<<1)+(g?1:0),Math.round(63*s)+128,Math.round(63*u)+128,1+(v===0?0:v<0?-1:1)|(63&T)<<2,T>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const P=w.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,P,this.e2),w.primitiveLength++),g?this.e2=P:this.e1=P}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,n){this.distance+=t.dist(n),this.updateScaledDistance()}hasLineDasharray(t){for(const n of t){const s=n.paint.get("line-dasharray");if(s&&!s.isConstant())return!0}return!1}addLineDashDependencies(t,n,s,u){for(const p of t){const g=p.paint.get("line-dasharray");if(!g||g.value.kind==="constant")continue;const v=p.layout.get("line-cap")==="round",w={dasharray:g.value.evaluate({zoom:s-1},n,{}),round:v},T={dasharray:g.value.evaluate({zoom:s},n,{}),round:v},P={dasharray:g.value.evaluate({zoom:s+1},n,{}),round:v},E=`${w.dasharray.join(",")},${w.round}`,D=`${T.dasharray.join(",")},${T.round}`,R=`${P.dasharray.join(",")},${P.round}`;u.dashDependencies[E]=w,u.dashDependencies[D]=T,u.dashDependencies[R]=P,n.dashes[p.id]={min:E,mid:D,max:R}}}}let o_,s_;Ke("LineBucket",Af,{omit:["layers","patternFeatures"]});var l_={get paint(){return s_=s_||new mn({"line-opacity":new ct(ve.paint_line["line-opacity"]),"line-color":new ct(ve.paint_line["line-color"]),"line-translate":new rt(ve.paint_line["line-translate"]),"line-translate-anchor":new rt(ve.paint_line["line-translate-anchor"]),"line-width":new ct(ve.paint_line["line-width"]),"line-gap-width":new ct(ve.paint_line["line-gap-width"]),"line-offset":new ct(ve.paint_line["line-offset"]),"line-blur":new ct(ve.paint_line["line-blur"]),"line-dasharray":new Ns(ve.paint_line["line-dasharray"]),"line-pattern":new Ns(ve.paint_line["line-pattern"]),"line-gradient":new Gl(ve.paint_line["line-gradient"])})},get layout(){return o_=o_||new mn({"line-cap":new rt(ve.layout_line["line-cap"]),"line-join":new ct(ve.layout_line["line-join"]),"line-miter-limit":new rt(ve.layout_line["line-miter-limit"]),"line-round-limit":new rt(ve.layout_line["line-round-limit"]),"line-sort-key":new ct(ve.layout_line["line-sort-key"])})}};class f2 extends ct{possiblyEvaluate(t,n){return n=new Ot(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,zoomHistory:n.zoomHistory,transition:n.transition}),super.possiblyEvaluate(t,n)}evaluate(t,n,s,u){return n=vn({},n,{zoom:Math.floor(n.zoom)}),super.evaluate(t,n,s,u)}}let ep;class g2 extends Cr{constructor(t,n){super(t,l_,n),this.gradientVersion=0,ep||(ep=new f2(l_.paint.properties["line-width"].specification),ep.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const n=this.gradientExpression();this.stepInterpolant=!!function(s){return s._styleExpression!==void 0}(n)&&n._styleExpression.expression instanceof xi,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,n){super.recalculate(t,n),this.paint._values["line-floorwidth"]=ep.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new Af(t)}queryRadius(t){const n=t,s=c_(Ql("line-width",this,n),Ql("line-gap-width",this,n)),u=Ql("line-offset",this,n);return s/2+Math.abs(u)+Hd(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:s,geometry:u,transform:p,pixelsToTileUnits:g}){const v=Xd(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-p.bearingInRadians,g),w=g/2*c_(this.paint.get("line-width").evaluate(n,s),this.paint.get("line-gap-width").evaluate(n,s)),T=this.paint.get("line-offset").evaluate(n,s);return T&&(u=function(P,E){const D=[];for(let R=0;R<P.length;R++){const B=P[R],V=[];for(let G=0;G<B.length;G++){const Y=B[G-1],_e=B[G],ne=B[G+1],ue=G===0?new F(0,0):_e.sub(Y)._unit()._perp(),we=G===B.length-1?new F(0,0):ne.sub(_e)._unit()._perp(),ke=ue._add(we)._unit(),Re=ke.x*we.x+ke.y*we.y;Re!==0&&ke._mult(1/Re),V.push(ke._mult(E)._add(_e))}D.push(V)}return D}(u,T*g)),function(P,E,D){for(let R=0;R<E.length;R++){const B=E[R];if(P.length>=3){for(let V=0;V<B.length;V++)if(Jl(P,B[V]))return!0}if(Cw(P,B,D))return!0}return!1}(v,u,w)}isTileClipped(){return!0}}function c_(r,t){return t>0?t+2*r:r}const y2=mi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),_2=mi([{name:"a_projected_pos",components:3,type:"Float32"}],4);mi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const v2=mi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);mi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const u_=mi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),x2=mi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function b2(r,t,n){return r.sections.forEach(s=>{s.text=function(u,p,g){const v=p.layout.get("text-transform").evaluate(g,{});return v==="uppercase"?u=u.toLocaleUpperCase():v==="lowercase"&&(u=u.toLocaleLowerCase()),ba.applyArabicShaping&&(u=ba.applyArabicShaping(u)),u}(s.text,t,n)}),r}mi([{name:"triangle",components:3,type:"Uint16"}]),mi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),mi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),mi([{type:"Float32",name:"offsetX"}]),mi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),mi([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Qu={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Ki=24;const Sf=4294967296,h_=1/Sf,d_=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class Tf{constructor(t=new Uint8Array(16)){this.buf=ArrayBuffer.isView(t)?t:new Uint8Array(t),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(t,n,s=this.length){for(;this.pos<s;){const u=this.readVarint(),p=u>>3,g=this.pos;this.type=7&u,t(p,n,this),this.pos===g&&this.skip(u)}return n}readMessage(t,n){return this.readFields(t,n,this.readVarint()+this.pos)}readFixed32(){const t=this.dataView.getUint32(this.pos,!0);return this.pos+=4,t}readSFixed32(){const t=this.dataView.getInt32(this.pos,!0);return this.pos+=4,t}readFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*Sf;return this.pos+=8,t}readSFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*Sf;return this.pos+=8,t}readFloat(){const t=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,t}readDouble(){const t=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,t}readVarint(t){const n=this.buf;let s,u;return u=n[this.pos++],s=127&u,u<128?s:(u=n[this.pos++],s|=(127&u)<<7,u<128?s:(u=n[this.pos++],s|=(127&u)<<14,u<128?s:(u=n[this.pos++],s|=(127&u)<<21,u<128?s:(u=n[this.pos],s|=(15&u)<<28,function(p,g,v){const w=v.buf;let T,P;if(P=w[v.pos++],T=(112&P)>>4,P<128||(P=w[v.pos++],T|=(127&P)<<3,P<128)||(P=w[v.pos++],T|=(127&P)<<10,P<128)||(P=w[v.pos++],T|=(127&P)<<17,P<128)||(P=w[v.pos++],T|=(127&P)<<24,P<128)||(P=w[v.pos++],T|=(1&P)<<31,P<128))return rc(p,T,g);throw new Error("Expected varint not more than 10 bytes")}(s,t,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const t=this.readVarint();return t%2==1?(t+1)/-2:t/2}readBoolean(){return!!this.readVarint()}readString(){const t=this.readVarint()+this.pos,n=this.pos;return this.pos=t,t-n>=12&&d_?d_.decode(this.buf.subarray(n,t)):function(s,u,p){let g="",v=u;for(;v<p;){const w=s[v];let T,P,E,D=null,R=w>239?4:w>223?3:w>191?2:1;if(v+R>p)break;R===1?w<128&&(D=w):R===2?(T=s[v+1],(192&T)==128&&(D=(31&w)<<6|63&T,D<=127&&(D=null))):R===3?(T=s[v+1],P=s[v+2],(192&T)==128&&(192&P)==128&&(D=(15&w)<<12|(63&T)<<6|63&P,(D<=2047||D>=55296&&D<=57343)&&(D=null))):R===4&&(T=s[v+1],P=s[v+2],E=s[v+3],(192&T)==128&&(192&P)==128&&(192&E)==128&&(D=(15&w)<<18|(63&T)<<12|(63&P)<<6|63&E,(D<=65535||D>=1114112)&&(D=null))),D===null?(D=65533,R=1):D>65535&&(D-=65536,g+=String.fromCharCode(D>>>10&1023|55296),D=56320|1023&D),g+=String.fromCharCode(D),v+=R}return g}(this.buf,n,t)}readBytes(){const t=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,t);return this.pos=t,n}readPackedVarint(t=[],n){const s=this.readPackedEnd();for(;this.pos<s;)t.push(this.readVarint(n));return t}readPackedSVarint(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readSVarint());return t}readPackedBoolean(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readBoolean());return t}readPackedFloat(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readFloat());return t}readPackedDouble(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readDouble());return t}readPackedFixed32(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readFixed32());return t}readPackedSFixed32(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readSFixed32());return t}readPackedFixed64(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readFixed64());return t}readPackedSFixed64(t=[]){const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readSFixed64());return t}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(t){const n=7&t;if(n===0)for(;this.buf[this.pos++]>127;);else if(n===2)this.pos=this.readVarint()+this.pos;else if(n===5)this.pos+=4;else{if(n!==1)throw new Error(`Unimplemented type: ${n}`);this.pos+=8}}writeTag(t,n){this.writeVarint(t<<3|n)}realloc(t){let n=this.length||16;for(;n<this.pos+t;)n*=2;if(n!==this.length){const s=new Uint8Array(n);s.set(this.buf),this.buf=s,this.dataView=new DataView(s.buffer),this.length=n}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeSFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,-1&t,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*h_),!0),this.pos+=8}writeSFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,-1&t,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*h_),!0),this.pos+=8}writeVarint(t){(t=+t||0)>268435455||t<0?function(n,s){let u,p;if(n>=0?(u=n%4294967296|0,p=n/4294967296|0):(u=~(-n%4294967296),p=~(-n/4294967296),4294967295^u?u=u+1|0:(u=0,p=p+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");s.realloc(10),function(g,v,w){w.buf[w.pos++]=127&g|128,g>>>=7,w.buf[w.pos++]=127&g|128,g>>>=7,w.buf[w.pos++]=127&g|128,g>>>=7,w.buf[w.pos++]=127&g|128,w.buf[w.pos]=127&(g>>>=7)}(u,0,s),function(g,v){const w=(7&g)<<4;v.buf[v.pos++]|=w|((g>>>=3)?128:0),g&&(v.buf[v.pos++]=127&g|((g>>>=7)?128:0),g&&(v.buf[v.pos++]=127&g|((g>>>=7)?128:0),g&&(v.buf[v.pos++]=127&g|((g>>>=7)?128:0),g&&(v.buf[v.pos++]=127&g|((g>>>=7)?128:0),g&&(v.buf[v.pos++]=127&g)))))}(p,s)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))}writeSVarint(t){this.writeVarint(t<0?2*-t-1:2*t)}writeBoolean(t){this.writeVarint(+t)}writeString(t){t=String(t),this.realloc(4*t.length),this.pos++;const n=this.pos;this.pos=function(u,p,g){for(let v,w,T=0;T<p.length;T++){if(v=p.charCodeAt(T),v>55295&&v<57344){if(!w){v>56319||T+1===p.length?(u[g++]=239,u[g++]=191,u[g++]=189):w=v;continue}if(v<56320){u[g++]=239,u[g++]=191,u[g++]=189,w=v;continue}v=w-55296<<10|v-56320|65536,w=null}else w&&(u[g++]=239,u[g++]=191,u[g++]=189,w=null);v<128?u[g++]=v:(v<2048?u[g++]=v>>6|192:(v<65536?u[g++]=v>>12|224:(u[g++]=v>>18|240,u[g++]=v>>12&63|128),u[g++]=v>>6&63|128),u[g++]=63&v|128)}return g}(this.buf,t,this.pos);const s=this.pos-n;s>=128&&p_(n,s,this),this.pos=n-1,this.writeVarint(s),this.pos+=s}writeFloat(t){this.realloc(4),this.dataView.setFloat32(this.pos,t,!0),this.pos+=4}writeDouble(t){this.realloc(8),this.dataView.setFloat64(this.pos,t,!0),this.pos+=8}writeBytes(t){const n=t.length;this.writeVarint(n),this.realloc(n);for(let s=0;s<n;s++)this.buf[this.pos++]=t[s]}writeRawMessage(t,n){this.pos++;const s=this.pos;t(n,this);const u=this.pos-s;u>=128&&p_(s,u,this),this.pos=s-1,this.writeVarint(u),this.pos+=u}writeMessage(t,n,s){this.writeTag(t,2),this.writeRawMessage(n,s)}writePackedVarint(t,n){n.length&&this.writeMessage(t,w2,n)}writePackedSVarint(t,n){n.length&&this.writeMessage(t,C2,n)}writePackedBoolean(t,n){n.length&&this.writeMessage(t,S2,n)}writePackedFloat(t,n){n.length&&this.writeMessage(t,I2,n)}writePackedDouble(t,n){n.length&&this.writeMessage(t,A2,n)}writePackedFixed32(t,n){n.length&&this.writeMessage(t,T2,n)}writePackedSFixed32(t,n){n.length&&this.writeMessage(t,P2,n)}writePackedFixed64(t,n){n.length&&this.writeMessage(t,k2,n)}writePackedSFixed64(t,n){n.length&&this.writeMessage(t,M2,n)}writeBytesField(t,n){this.writeTag(t,2),this.writeBytes(n)}writeFixed32Field(t,n){this.writeTag(t,5),this.writeFixed32(n)}writeSFixed32Field(t,n){this.writeTag(t,5),this.writeSFixed32(n)}writeFixed64Field(t,n){this.writeTag(t,1),this.writeFixed64(n)}writeSFixed64Field(t,n){this.writeTag(t,1),this.writeSFixed64(n)}writeVarintField(t,n){this.writeTag(t,0),this.writeVarint(n)}writeSVarintField(t,n){this.writeTag(t,0),this.writeSVarint(n)}writeStringField(t,n){this.writeTag(t,2),this.writeString(n)}writeFloatField(t,n){this.writeTag(t,5),this.writeFloat(n)}writeDoubleField(t,n){this.writeTag(t,1),this.writeDouble(n)}writeBooleanField(t,n){this.writeVarintField(t,+n)}}function rc(r,t,n){return n?4294967296*t+(r>>>0):4294967296*(t>>>0)+(r>>>0)}function p_(r,t,n){const s=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));n.realloc(s);for(let u=n.pos-1;u>=r;u--)n.buf[u+s]=n.buf[u]}function w2(r,t){for(let n=0;n<r.length;n++)t.writeVarint(r[n])}function C2(r,t){for(let n=0;n<r.length;n++)t.writeSVarint(r[n])}function I2(r,t){for(let n=0;n<r.length;n++)t.writeFloat(r[n])}function A2(r,t){for(let n=0;n<r.length;n++)t.writeDouble(r[n])}function S2(r,t){for(let n=0;n<r.length;n++)t.writeBoolean(r[n])}function T2(r,t){for(let n=0;n<r.length;n++)t.writeFixed32(r[n])}function P2(r,t){for(let n=0;n<r.length;n++)t.writeSFixed32(r[n])}function k2(r,t){for(let n=0;n<r.length;n++)t.writeFixed64(r[n])}function M2(r,t){for(let n=0;n<r.length;n++)t.writeSFixed64(r[n])}function E2(r,t,n){r===1&&n.readMessage(z2,t)}function z2(r,t,n){if(r===3){const{id:s,bitmap:u,width:p,height:g,left:v,top:w,advance:T}=n.readMessage(N2,{});t.push({id:s,bitmap:new Zu({width:p+6,height:g+6},u),metrics:{width:p,height:g,left:v,top:w,advance:T}})}}function N2(r,t,n){r===1?t.id=n.readVarint():r===2?t.bitmap=n.readBytes():r===3?t.width=n.readVarint():r===4?t.height=n.readVarint():r===5?t.left=n.readSVarint():r===6?t.top=n.readSVarint():r===7&&(t.advance=n.readVarint())}function m_(r){let t=0,n=0;for(const g of r)t+=g.w*g.h,n=Math.max(n,g.w);r.sort((g,v)=>v.h-g.h);const s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),n),h:1/0}];let u=0,p=0;for(const g of r)for(let v=s.length-1;v>=0;v--){const w=s[v];if(!(g.w>w.w||g.h>w.h)){if(g.x=w.x,g.y=w.y,p=Math.max(p,g.y+g.h),u=Math.max(u,g.x+g.w),g.w===w.w&&g.h===w.h){const T=s.pop();T&&v<s.length&&(s[v]=T)}else g.h===w.h?(w.x+=g.w,w.w-=g.w):g.w===w.w?(w.y+=g.h,w.h-=g.h):(s.push({x:w.x+g.w,y:w.y,w:w.w-g.w,h:g.h}),w.y+=g.h,w.h-=g.h);break}}return{w:u,h:p,fill:t/(u*p)||0}}class Pf{constructor(t,{pixelRatio:n,version:s,stretchX:u,stretchY:p,content:g,textFitWidth:v,textFitHeight:w}){this.paddedRect=t,this.pixelRatio=n,this.stretchX=u,this.stretchY=p,this.content=g,this.version=s,this.textFitWidth=v,this.textFitHeight=w}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class f_{constructor(t,n){const s={},u={};this.haveRenderCallbacks=[];const p=[];this.addImages(t,s,p),this.addImages(n,u,p);const{w:g,h:v}=m_(p),w=new Qn({width:g||1,height:v||1});for(const T in t){const P=t[T],E=s[T].paddedRect;Qn.copy(P.data,w,{x:0,y:0},{x:E.x+1,y:E.y+1},P.data)}for(const T in n){const P=n[T],E=u[T].paddedRect,D=E.x+1,R=E.y+1,B=P.data.width,V=P.data.height;Qn.copy(P.data,w,{x:0,y:0},{x:D,y:R},P.data),Qn.copy(P.data,w,{x:0,y:V-1},{x:D,y:R-1},{width:B,height:1}),Qn.copy(P.data,w,{x:0,y:0},{x:D,y:R+V},{width:B,height:1}),Qn.copy(P.data,w,{x:B-1,y:0},{x:D-1,y:R},{width:1,height:V}),Qn.copy(P.data,w,{x:0,y:0},{x:D+B,y:R},{width:1,height:V})}this.image=w,this.iconPositions=s,this.patternPositions=u}addImages(t,n,s){for(const u in t){const p=t[u],g={x:0,y:0,w:p.data.width+2,h:p.data.height+2};s.push(g),n[u]=new Pf(g,p),p.hasRenderCallback&&this.haveRenderCallbacks.push(u)}}patchUpdatedImages(t,n){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const s in t.updatedImages)this.patchUpdatedImage(this.iconPositions[s],t.getImage(s),n),this.patchUpdatedImage(this.patternPositions[s],t.getImage(s),n)}patchUpdatedImage(t,n,s){if(!t||!n||t.version===n.version)return;t.version=n.version;const[u,p]=t.tl;s.update(n.data,void 0,{x:u,y:p})}}var Lo;Ke("ImagePosition",Pf),Ke("ImageAtlas",f_),b.ao=void 0,(Lo=b.ao||(b.ao={}))[Lo.none=0]="none",Lo[Lo.horizontal=1]="horizontal",Lo[Lo.vertical=2]="vertical",Lo[Lo.horizontalOnly=3]="horizontalOnly";class eh{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(t,n,s){const u=new eh;return u.scale=t||1,u.fontStack=n,u.verticalAlign=s||"bottom",u}static forImage(t,n){const s=new eh;return s.imageName=t,s.verticalAlign=n||"bottom",s}}class ac{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,n){const s=new ac;for(let u=0;u<t.sections.length;u++){const p=t.sections[u];p.image?s.addImageSection(p):s.addTextSection(p,n)}return s}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let n="";for(let s=0;s<t.length;s++){const u=t.charCodeAt(s+1)||null,p=t.charCodeAt(s-1)||null;n+=u&&Du(u)&&!Qu[t[s+1]]||p&&Du(p)&&!Qu[t[s-1]]||!Qu[t[s]]?t[s]:Qu[t[s]]}return n}(this.text)}trim(){let t=0;for(let s=0;s<this.text.length&&ip[this.text.charCodeAt(s)];s++)t++;let n=this.text.length;for(let s=this.text.length-1;s>=0&&s>=t&&ip[this.text.charCodeAt(s)];s--)n--;this.text=this.text.substring(t,n),this.sectionIndex=this.sectionIndex.slice(t,n)}substring(t,n){const s=new ac;return s.text=this.text.substring(t,n),s.sectionIndex=this.sectionIndex.slice(t,n),s.sections=this.sections,s}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,n)=>Math.max(t,this.sections[n].scale),0)}getMaxImageSize(t){let n=0,s=0;for(let u=0;u<this.length();u++){const p=this.getSection(u);if(p.imageName){const g=t[p.imageName];if(!g)continue;const v=g.displaySize;n=Math.max(n,v[0]),s=Math.max(s,v[1])}}return{maxImageWidth:n,maxImageHeight:s}}addTextSection(t,n){this.text+=t.text,this.sections.push(eh.forText(t.scale,t.fontStack||n,t.verticalAlign));const s=this.sections.length-1;for(let u=0;u<t.text.length;++u)this.sectionIndex.push(s)}addImageSection(t){const n=t.image?t.image.name:"";if(n.length===0)return void li("Can't add FormattedSection with an empty image.");const s=this.getNextImageSectionCharCode();s?(this.text+=String.fromCharCode(s),this.sections.push(eh.forImage(n,t.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):li("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function tp(r,t,n,s,u,p,g,v,w,T,P,E,D,R,B){const V=ac.fromFeature(r,u);let G;E===b.ao.vertical&&V.verticalizePunctuation();const{processBidirectionalText:Y,processStyledBidirectionalText:_e}=ba;if(Y&&V.sections.length===1){G=[];const we=Y(V.toString(),kf(V,T,p,t,s,R));for(const ke of we){const Re=new ac;Re.text=ke,Re.sections=V.sections;for(let qe=0;qe<ke.length;qe++)Re.sectionIndex.push(0);G.push(Re)}}else if(_e){G=[];const we=_e(V.text,V.sectionIndex,kf(V,T,p,t,s,R));for(const ke of we){const Re=new ac;Re.text=ke[0],Re.sectionIndex=ke[1],Re.sections=V.sections,G.push(Re)}}else G=function(we,ke){const Re=[],qe=we.text;let Ve=0;for(const $e of ke)Re.push(we.substring(Ve,$e)),Ve=$e;return Ve<qe.length&&Re.push(we.substring(Ve,qe.length)),Re}(V,kf(V,T,p,t,s,R));const ne=[],ue={positionedLines:ne,text:V.toString(),top:P[1],bottom:P[1],left:P[0],right:P[0],writingMode:E,iconsInText:!1,verticalizable:!1};return function(we,ke,Re,qe,Ve,$e,at,Ue,Ze,Ee,pt,ft){let ut=0,nt=0,Et=0,fi=0;const $i=Ue==="right"?1:Ue==="left"?0:.5,gn=Ki/ft;let Ar=0;for(const ui of Ve){ui.trim();const Yi=ui.getMaxScale(),sn={positionedGlyphs:[],lineOffset:0};we.positionedLines[Ar]=sn;const ln=sn.positionedGlyphs;let jn=0;if(!ui.length()){nt+=$e,++Ar;continue}const Sr=F2(qe,ui,gn);for(let tr=0;tr<ui.length();tr++){const Zi=ui.getSection(tr),Qi=ui.getSectionIndex(tr),en=ui.getCharCode(tr),Ri=B2(Ze,pt,en);let ii;if(Zi.imageName){if(we.iconsInText=!0,Zi.scale=Zi.scale*gn,ii=O2(Zi,Ri,Yi,Sr,qe),!ii)continue;jn=Math.max(jn,ii.imageOffset)}else if(ii=j2(Zi,en,Ri,Sr,ke,Re),!ii)continue;const{rect:ia,metrics:cc,baselineOffset:na}=ii;ln.push({glyph:en,imageName:Zi.imageName,x:ut,y:nt+na+-17,vertical:Ri,scale:Zi.scale,fontStack:Zi.fontStack,sectionIndex:Qi,metrics:cc,rect:ia}),Ri?(we.verticalizable=!0,ut+=(Zi.imageName?cc.advance:Ki)*Zi.scale+Ee):ut+=cc.advance*Zi.scale+Ee}ln.length!==0&&(Et=Math.max(ut-Ee,Et),V2(ln,0,ln.length-1,$i)),ut=0,sn.lineOffset=Math.max(jn,(Yi-1)*Ki);const Ji=$e*Yi+jn;nt+=Ji,fi=Math.max(Ji,fi),++Ar}const{horizontalAlign:er,verticalAlign:on}=Mf(at);(function(ui,Yi,sn,ln,jn,Sr,Ji,tr,Zi){const Qi=(Yi-sn)*jn;let en=0;en=Sr!==Ji?-tr*ln- -17:-ln*Zi*Ji+.5*Ji;for(const Ri of ui)for(const ii of Ri.positionedGlyphs)ii.x+=Qi,ii.y+=en})(we.positionedLines,$i,er,on,Et,fi,$e,nt,Ve.length),we.top+=-on*nt,we.bottom=we.top+nt,we.left+=-er*Et,we.right=we.left+Et}(ue,t,n,s,G,g,v,w,E,T,D,B),!function(we){for(const ke of we)if(ke.positionedGlyphs.length!==0)return!1;return!0}(ne)&&ue}const ip={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},D2={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},L2={40:!0};function g_(r,t,n,s,u,p){if(t.imageName){const g=s[t.imageName];return g?g.displaySize[0]*t.scale*Ki/p+u:0}{const g=n[t.fontStack],v=g&&g[r];return v?v.metrics.advance*t.scale+u:0}}function y_(r,t,n,s){const u=Math.pow(r-t,2);return s?r<t?u/2:2*u:u+Math.abs(n)*n}function R2(r,t,n){let s=0;return r===10&&(s-=1e4),n&&(s+=150),r!==40&&r!==65288||(s+=50),t!==41&&t!==65289||(s+=50),s}function __(r,t,n,s,u,p){let g=null,v=y_(t,n,u,p);for(const w of s){const T=y_(t-w.x,n,u,p)+w.badness;T<=v&&(g=w,v=T)}return{index:r,x:t,priorBreak:g,badness:v}}function v_(r){return r?v_(r.priorBreak).concat(r.index):[]}function kf(r,t,n,s,u,p){if(!r)return[];const g=[],v=function(E,D,R,B,V,G){let Y=0;for(let _e=0;_e<E.length();_e++){const ne=E.getSection(_e);Y+=g_(E.getCharCode(_e),ne,B,V,D,G)}return Y/Math.max(1,Math.ceil(Y/R))}(r,t,n,s,u,p),w=r.text.indexOf("")>=0;let T=0;for(let E=0;E<r.length();E++){const D=r.getSection(E),R=r.getCharCode(E);if(ip[R]||(T+=g_(R,D,s,u,t,p)),E<r.length()-1){const B=!((P=R)<11904)&&(!!Mt["CJK Compatibility Forms"](P)||!!Mt["CJK Compatibility"](P)||!!Mt["CJK Strokes"](P)||!!Mt["CJK Symbols and Punctuation"](P)||!!Mt["Enclosed CJK Letters and Months"](P)||!!Mt["Halfwidth and Fullwidth Forms"](P)||!!Mt["Ideographic Description Characters"](P)||!!Mt["Vertical Forms"](P)||jd.test(String.fromCodePoint(P)));(D2[R]||B||D.imageName||E!==r.length()-2&&L2[r.getCharCode(E+1)])&&g.push(__(E+1,T,v,g,R2(R,r.getCharCode(E+1),B&&w),!1))}}var P;return v_(__(r.length(),T,v,g,0,!0))}function Mf(r){let t=.5,n=.5;switch(r){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:t,verticalAlign:n}}function F2(r,t,n){const s=t.getMaxScale()*Ki,{maxImageWidth:u,maxImageHeight:p}=t.getMaxImageSize(r),g=Math.max(s,p*n);return{verticalLineContentWidth:Math.max(s,u*n),horizontalLineContentHeight:g}}function x_(r){switch(r){case"top":return 0;case"center":return .5;default:return 1}}function B2(r,t,n){return!(r===b.ao.horizontal||!t&&!Nu(n)||t&&(ip[n]||(s=n,/\p{sc=Arab}/u.test(String.fromCodePoint(s)))));var s}function j2(r,t,n,s,u,p){const g=p[r.fontStack],v=function(T,P,E,D){if(T&&T.rect)return T;const R=P[E.fontStack],B=R&&R[D];return B?{rect:null,metrics:B.metrics}:null}(g&&g[t],u,r,t);if(v===null)return null;let w;if(n)w=s.verticalLineContentWidth-r.scale*Ki;else{const T=x_(r.verticalAlign);w=(s.horizontalLineContentHeight-r.scale*Ki)*T}return{rect:v.rect,metrics:v.metrics,baselineOffset:w}}function O2(r,t,n,s,u){const p=u[r.imageName];if(!p)return null;const g=p.paddedRect,v=p.displaySize,w={width:v[0],height:v[1],left:1,top:-3,advance:t?v[1]:v[0]};let T;if(t)T=s.verticalLineContentWidth-v[1]*r.scale;else{const P=x_(r.verticalAlign);T=(s.horizontalLineContentHeight-v[1]*r.scale)*P}return{rect:g,metrics:w,baselineOffset:T,imageOffset:(t?v[0]:v[1])*r.scale-Ki*n}}function V2(r,t,n,s){if(s===0)return;const u=r[n],p=(r[n].x+u.metrics.advance*u.scale)*s;for(let g=t;g<=n;g++)r[g].x-=p}function U2(r,t,n){const{horizontalAlign:s,verticalAlign:u}=Mf(n),p=t[0]-r.displaySize[0]*s,g=t[1]-r.displaySize[1]*u;return{image:r,top:g,bottom:g+r.displaySize[1],left:p,right:p+r.displaySize[0]}}function b_(r){var t,n;let s=r.left,u=r.top,p=r.right-s,g=r.bottom-u;const v=(t=r.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",w=(n=r.image.textFitHeight)!==null&&n!==void 0?n:"stretchOrShrink",T=(r.image.content[2]-r.image.content[0])/(r.image.content[3]-r.image.content[1]);if(w==="proportional"){if(v==="stretchOnly"&&p/g<T||v==="proportional"){const P=Math.ceil(g*T);s*=P/p,p=P}}else if(v==="proportional"&&w==="stretchOnly"&&T!==0&&p/g>T){const P=Math.ceil(p/T);u*=P/g,g=P}return{x1:s,y1:u,x2:s+p,y2:u+g}}function w_(r,t,n,s,u,p){const g=r.image;let v;if(g.content){const G=g.content,Y=g.pixelRatio||1;v=[G[0]/Y,G[1]/Y,g.displaySize[0]-G[2]/Y,g.displaySize[1]-G[3]/Y]}const w=t.left*p,T=t.right*p;let P,E,D,R;n==="width"||n==="both"?(R=u[0]+w-s[3],E=u[0]+T+s[1]):(R=u[0]+(w+T-g.displaySize[0])/2,E=R+g.displaySize[0]);const B=t.top*p,V=t.bottom*p;return n==="height"||n==="both"?(P=u[1]+B-s[0],D=u[1]+V+s[2]):(P=u[1]+(B+V-g.displaySize[1])/2,D=P+g.displaySize[1]),{image:g,top:P,right:E,bottom:D,left:R,collisionPadding:v}}const ao=128,Ro=32640;function C_(r,t){const{expression:n}=t;if(n.kind==="constant")return{kind:"constant",layoutSize:n.evaluate(new Ot(r+1))};if(n.kind==="source")return{kind:"source"};{const{zoomStops:s,interpolationType:u}=n;let p=0;for(;p<s.length&&s[p]<=r;)p++;p=Math.max(0,p-1);let g=p;for(;g<s.length&&s[g]<r+1;)g++;g=Math.min(s.length-1,g);const v=s[p],w=s[g];return n.kind==="composite"?{kind:"composite",minZoom:v,maxZoom:w,interpolationType:u}:{kind:"camera",minZoom:v,maxZoom:w,minSize:n.evaluate(new Ot(v)),maxSize:n.evaluate(new Ot(w)),interpolationType:u}}}function Ef(r,t,n){let s="never";const u=r.get(t);return u?s=u:r.get(n)&&(s="always"),s}const $2=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function np(r,t,n,s,u,p,g,v,w,T,P,E,D){const R=v?Math.min(Ro,Math.round(v[0])):0,B=v?Math.min(Ro,Math.round(v[1])):0;r.emplaceBack(t,n,Math.round(32*s),Math.round(32*u),p,g,(R<<1)+(w?1:0),B,16*T,16*P,256*E,256*D)}function zf(r,t,n){r.emplaceBack(t.x,t.y,n),r.emplaceBack(t.x,t.y,n),r.emplaceBack(t.x,t.y,n),r.emplaceBack(t.x,t.y,n)}function Z2(r){for(const t of r.sections)if(Vl(t.text))return!0;return!1}class Nf{constructor(t){this.layoutVertexArray=new Ft,this.indexArray=new Ui,this.programConfigurations=t,this.segments=new It,this.dynamicLayoutVertexArray=new Jt,this.opacityVertexArray=new Wt,this.hasVisibleVertices=!1,this.placedSymbolArray=new X}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,n,s,u){this.isEmpty()||(s&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,y2.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,_2.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,$2,!0),this.opacityVertexBuffer.itemSize=1),(s||u)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Ke("SymbolBuffers",Nf);class Df{constructor(t,n,s){this.layoutVertexArray=new t,this.layoutAttributes=n,this.indexArray=new s,this.segments=new It,this.collisionVertexArray=new Qt}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,v2.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Ke("CollisionBuffers",Df);class oc{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(g=>g.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=C_(this.zoom,n["text-size"]),this.iconSizeData=C_(this.zoom,n["icon-size"]);const s=this.layers[0].layout,u=s.get("symbol-sort-key"),p=s.get("symbol-z-order");this.canOverlap=Ef(s,"text-overlap","text-allow-overlap")!=="never"||Ef(s,"icon-overlap","icon-allow-overlap")!=="never"||s.get("text-ignore-placement")||s.get("icon-ignore-placement"),this.sortFeaturesByKey=p!=="viewport-y"&&!u.isConstant(),this.sortFeaturesByY=(p==="viewport-y"||p==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,s.get("symbol-placement")==="point"&&(this.writingModes=s.get("text-writing-mode").map(g=>b.ao[g])),this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id),this.sourceID=t.sourceID}createArrays(){this.text=new Nf(new Fs(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new Nf(new Fs(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new Q,this.lineVertexArray=new ae,this.symbolInstances=new ie,this.textAnchorOffsets=new te}calculateGlyphDependencies(t,n,s,u,p){for(let g=0;g<t.length;g++)if(n[t.charCodeAt(g)]=!0,(s||u)&&p){const v=Qu[t.charAt(g)];v&&(n[v.charCodeAt(0)]=!0)}}populate(t,n,s){const u=this.layers[0],p=u.layout,g=p.get("text-font"),v=p.get("text-field"),w=p.get("icon-image"),T=(v.value.kind!=="constant"||v.value.value instanceof bn&&!v.value.value.isEmpty()||v.value.value.toString().length>0)&&(g.value.kind!=="constant"||g.value.value.length>0),P=w.value.kind!=="constant"||!!w.value.value||Object.keys(w.parameters).length>0,E=p.get("symbol-sort-key");if(this.features=[],!T&&!P)return;const D=n.iconDependencies,R=n.glyphDependencies,B=n.availableImages,V=new Ot(this.zoom);for(const{feature:G,id:Y,index:_e,sourceLayerIndex:ne}of t){const ue=u._featureFilter.needGeometry,we=js(G,ue);if(!u._featureFilter.filter(V,we,s))continue;let ke,Re;if(ue||(we.geometry=Bs(G)),T){const Ve=u.getValueAndResolveTokens("text-field",we,s,B),$e=bn.factory(Ve),at=this.hasRTLText=this.hasRTLText||Z2($e);(!at||ba.getRTLTextPluginStatus()==="unavailable"||at&&ba.isParsed())&&(ke=b2($e,u,we))}if(P){const Ve=u.getValueAndResolveTokens("icon-image",we,s,B);Re=Ve instanceof Hn?Ve:Hn.fromString(Ve)}if(!ke&&!Re)continue;const qe=this.sortFeaturesByKey?E.evaluate(we,{},s):void 0;if(this.features.push({id:Y,text:ke,icon:Re,index:_e,sourceLayerIndex:ne,geometry:we.geometry,properties:G.properties,type:nc.types[G.type],sortKey:qe}),Re&&(D[Re.name]=!0),ke){const Ve=g.evaluate(we,{},s).join(","),$e=p.get("text-rotation-alignment")!=="viewport"&&p.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(b.ao.vertical)>=0;for(const at of ke.sections)if(at.image)D[at.image.name]=!0;else{const Ue=Eu(ke.toString()),Ze=at.fontStack||Ve,Ee=R[Ze]=R[Ze]||{};this.calculateGlyphDependencies(at.text,Ee,$e,this.allowVerticalPlacement,Ue)}}}p.get("symbol-placement")==="line"&&(this.features=function(G){const Y={},_e={},ne=[];let ue=0;function we(Ve){ne.push(G[Ve]),ue++}function ke(Ve,$e,at){const Ue=_e[Ve];return delete _e[Ve],_e[$e]=Ue,ne[Ue].geometry[0].pop(),ne[Ue].geometry[0]=ne[Ue].geometry[0].concat(at[0]),Ue}function Re(Ve,$e,at){const Ue=Y[$e];return delete Y[$e],Y[Ve]=Ue,ne[Ue].geometry[0].shift(),ne[Ue].geometry[0]=at[0].concat(ne[Ue].geometry[0]),Ue}function qe(Ve,$e,at){const Ue=at?$e[0][$e[0].length-1]:$e[0][0];return`${Ve}:${Ue.x}:${Ue.y}`}for(let Ve=0;Ve<G.length;Ve++){const $e=G[Ve],at=$e.geometry,Ue=$e.text?$e.text.toString():null;if(!Ue){we(Ve);continue}const Ze=qe(Ue,at),Ee=qe(Ue,at,!0);if(Ze in _e&&Ee in Y&&_e[Ze]!==Y[Ee]){const pt=Re(Ze,Ee,at),ft=ke(Ze,Ee,ne[pt].geometry);delete Y[Ze],delete _e[Ee],_e[qe(Ue,ne[ft].geometry,!0)]=ft,ne[pt].geometry=null}else Ze in _e?ke(Ze,Ee,at):Ee in Y?Re(Ze,Ee,at):(we(Ve),Y[Ze]=ue-1,_e[Ee]=ue-1)}return ne.filter(Ve=>Ve.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((G,Y)=>G.sortKey-Y.sortKey)}update(t,n,s){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,n,this.layers,{imagePositions:s}),this.icon.programConfigurations.updatePaintArrays(t,n,this.layers,{imagePositions:s}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,n){const s=this.lineVertexArray.length;if(t.segment!==void 0){let u=t.dist(n[t.segment+1]),p=t.dist(n[t.segment]);const g={};for(let v=t.segment+1;v<n.length;v++)g[v]={x:n[v].x,y:n[v].y,tileUnitDistanceFromAnchor:u},v<n.length-1&&(u+=n[v+1].dist(n[v]));for(let v=t.segment||0;v>=0;v--)g[v]={x:n[v].x,y:n[v].y,tileUnitDistanceFromAnchor:p},v>0&&(p+=n[v-1].dist(n[v]));for(let v=0;v<n.length;v++){const w=g[v];this.lineVertexArray.emplaceBack(w.x,w.y,w.tileUnitDistanceFromAnchor)}}return{lineStartIndex:s,lineLength:this.lineVertexArray.length-s}}addSymbols(t,n,s,u,p,g,v,w,T,P,E,D){const R=t.indexArray,B=t.layoutVertexArray,V=t.segments.prepareSegment(4*n.length,B,R,this.canOverlap?g.sortKey:void 0),G=this.glyphOffsetArray.length,Y=V.vertexLength,_e=this.allowVerticalPlacement&&v===b.ao.vertical?Math.PI/2:0,ne=g.text&&g.text.sections;for(let ue=0;ue<n.length;ue++){const{tl:we,tr:ke,bl:Re,br:qe,tex:Ve,pixelOffsetTL:$e,pixelOffsetBR:at,minFontScaleX:Ue,minFontScaleY:Ze,glyphOffset:Ee,isSDF:pt,sectionIndex:ft}=n[ue],ut=V.vertexLength,nt=Ee[1];np(B,w.x,w.y,we.x,nt+we.y,Ve.x,Ve.y,s,pt,$e.x,$e.y,Ue,Ze),np(B,w.x,w.y,ke.x,nt+ke.y,Ve.x+Ve.w,Ve.y,s,pt,at.x,$e.y,Ue,Ze),np(B,w.x,w.y,Re.x,nt+Re.y,Ve.x,Ve.y+Ve.h,s,pt,$e.x,at.y,Ue,Ze),np(B,w.x,w.y,qe.x,nt+qe.y,Ve.x+Ve.w,Ve.y+Ve.h,s,pt,at.x,at.y,Ue,Ze),zf(t.dynamicLayoutVertexArray,w,_e),R.emplaceBack(ut,ut+2,ut+1),R.emplaceBack(ut+1,ut+2,ut+3),V.vertexLength+=4,V.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ee[0]),ue!==n.length-1&&ft===n[ue+1].sectionIndex||t.programConfigurations.populatePaintArrays(B.length,g,g.index,{imagePositions:{},canonical:D,formattedSection:ne&&ne[ft]})}t.placedSymbolArray.emplaceBack(w.x,w.y,G,this.glyphOffsetArray.length-G,Y,T,P,w.segment,s?s[0]:0,s?s[1]:0,u[0],u[1],v,0,!1,0,E)}_addCollisionDebugVertex(t,n,s,u,p,g){return n.emplaceBack(0,0),t.emplaceBack(s.x,s.y,u,p,Math.round(g.x),Math.round(g.y))}addCollisionDebugVertices(t,n,s,u,p,g,v){const w=p.segments.prepareSegment(4,p.layoutVertexArray,p.indexArray),T=w.vertexLength,P=p.layoutVertexArray,E=p.collisionVertexArray,D=v.anchorX,R=v.anchorY;this._addCollisionDebugVertex(P,E,g,D,R,new F(t,n)),this._addCollisionDebugVertex(P,E,g,D,R,new F(s,n)),this._addCollisionDebugVertex(P,E,g,D,R,new F(s,u)),this._addCollisionDebugVertex(P,E,g,D,R,new F(t,u)),w.vertexLength+=4;const B=p.indexArray;B.emplaceBack(T,T+1),B.emplaceBack(T+1,T+2),B.emplaceBack(T+2,T+3),B.emplaceBack(T+3,T),w.primitiveLength+=4}addDebugCollisionBoxes(t,n,s,u){for(let p=t;p<n;p++){const g=this.collisionBoxArray.get(p);this.addCollisionDebugVertices(g.x1,g.y1,g.x2,g.y2,u?this.textCollisionBox:this.iconCollisionBox,g.anchorPoint,s)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Df(ai,u_.members,ei),this.iconCollisionBox=new Df(ai,u_.members,ei);for(let t=0;t<this.symbolInstances.length;t++){const n=this.symbolInstances.get(t);this.addDebugCollisionBoxes(n.textBoxStartIndex,n.textBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.iconBoxStartIndex,n.iconBoxEndIndex,n,!1),this.addDebugCollisionBoxes(n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex,n,!1)}}_deserializeCollisionBoxesForSymbol(t,n,s,u,p,g,v,w,T){const P={};for(let E=n;E<s;E++){const D=t.get(E);P.textBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},P.textFeatureIndex=D.featureIndex;break}for(let E=u;E<p;E++){const D=t.get(E);P.verticalTextBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},P.verticalTextFeatureIndex=D.featureIndex;break}for(let E=g;E<v;E++){const D=t.get(E);P.iconBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},P.iconFeatureIndex=D.featureIndex;break}for(let E=w;E<T;E++){const D=t.get(E);P.verticalIconBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},P.verticalIconFeatureIndex=D.featureIndex;break}return P}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const s=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,s.textBoxStartIndex,s.textBoxEndIndex,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,n){const s=t.placedSymbolArray.get(n),u=s.vertexStartIndex+4*s.numGlyphs;for(let p=s.vertexStartIndex;p<u;p+=4)t.indexArray.emplaceBack(p,p+2,p+1),t.indexArray.emplaceBack(p+1,p+2,p+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const n=Math.sin(t),s=Math.cos(t),u=[],p=[],g=[];for(let v=0;v<this.symbolInstances.length;++v){g.push(v);const w=this.symbolInstances.get(v);u.push(0|Math.round(n*w.anchorX+s*w.anchorY)),p.push(w.featureIndex)}return g.sort((v,w)=>u[v]-u[w]||p[w]-p[v]),g}addToSortKeyRanges(t,n){const s=this.sortKeyRanges[this.sortKeyRanges.length-1];s&&s.sortKey===n?s.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const s=this.symbolInstances.get(n);this.featureSortOrder.push(s.featureIndex),[s.rightJustifiedTextSymbolIndex,s.centerJustifiedTextSymbolIndex,s.leftJustifiedTextSymbolIndex].forEach((u,p,g)=>{u>=0&&g.indexOf(u)===p&&this.addIndicesForPlacedSymbol(this.text,u)}),s.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,s.verticalPlacedTextSymbolIndex),s.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,s.placedIconSymbolIndex),s.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,s.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let I_,A_;Ke("SymbolBucket",oc,{omit:["layers","collisionBoxArray","features","compareText"]}),oc.MAX_GLYPHS=65535,oc.addDynamicAttributes=zf;var Lf={get paint(){return A_=A_||new mn({"icon-opacity":new ct(ve.paint_symbol["icon-opacity"]),"icon-color":new ct(ve.paint_symbol["icon-color"]),"icon-halo-color":new ct(ve.paint_symbol["icon-halo-color"]),"icon-halo-width":new ct(ve.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ct(ve.paint_symbol["icon-halo-blur"]),"icon-translate":new rt(ve.paint_symbol["icon-translate"]),"icon-translate-anchor":new rt(ve.paint_symbol["icon-translate-anchor"]),"text-opacity":new ct(ve.paint_symbol["text-opacity"]),"text-color":new ct(ve.paint_symbol["text-color"],{runtimeType:nn,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new ct(ve.paint_symbol["text-halo-color"]),"text-halo-width":new ct(ve.paint_symbol["text-halo-width"]),"text-halo-blur":new ct(ve.paint_symbol["text-halo-blur"]),"text-translate":new rt(ve.paint_symbol["text-translate"]),"text-translate-anchor":new rt(ve.paint_symbol["text-translate-anchor"])})},get layout(){return I_=I_||new mn({"symbol-placement":new rt(ve.layout_symbol["symbol-placement"]),"symbol-spacing":new rt(ve.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new rt(ve.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ct(ve.layout_symbol["symbol-sort-key"]),"symbol-z-order":new rt(ve.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new rt(ve.layout_symbol["icon-allow-overlap"]),"icon-overlap":new rt(ve.layout_symbol["icon-overlap"]),"icon-ignore-placement":new rt(ve.layout_symbol["icon-ignore-placement"]),"icon-optional":new rt(ve.layout_symbol["icon-optional"]),"icon-rotation-alignment":new rt(ve.layout_symbol["icon-rotation-alignment"]),"icon-size":new ct(ve.layout_symbol["icon-size"]),"icon-text-fit":new rt(ve.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new rt(ve.layout_symbol["icon-text-fit-padding"]),"icon-image":new ct(ve.layout_symbol["icon-image"]),"icon-rotate":new ct(ve.layout_symbol["icon-rotate"]),"icon-padding":new ct(ve.layout_symbol["icon-padding"]),"icon-keep-upright":new rt(ve.layout_symbol["icon-keep-upright"]),"icon-offset":new ct(ve.layout_symbol["icon-offset"]),"icon-anchor":new ct(ve.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new rt(ve.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new rt(ve.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new rt(ve.layout_symbol["text-rotation-alignment"]),"text-field":new ct(ve.layout_symbol["text-field"]),"text-font":new ct(ve.layout_symbol["text-font"]),"text-size":new ct(ve.layout_symbol["text-size"]),"text-max-width":new ct(ve.layout_symbol["text-max-width"]),"text-line-height":new rt(ve.layout_symbol["text-line-height"]),"text-letter-spacing":new ct(ve.layout_symbol["text-letter-spacing"]),"text-justify":new ct(ve.layout_symbol["text-justify"]),"text-radial-offset":new ct(ve.layout_symbol["text-radial-offset"]),"text-variable-anchor":new rt(ve.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new ct(ve.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new ct(ve.layout_symbol["text-anchor"]),"text-max-angle":new rt(ve.layout_symbol["text-max-angle"]),"text-writing-mode":new rt(ve.layout_symbol["text-writing-mode"]),"text-rotate":new ct(ve.layout_symbol["text-rotate"]),"text-padding":new rt(ve.layout_symbol["text-padding"]),"text-keep-upright":new rt(ve.layout_symbol["text-keep-upright"]),"text-transform":new ct(ve.layout_symbol["text-transform"]),"text-offset":new ct(ve.layout_symbol["text-offset"]),"text-allow-overlap":new rt(ve.layout_symbol["text-allow-overlap"]),"text-overlap":new rt(ve.layout_symbol["text-overlap"]),"text-ignore-placement":new rt(ve.layout_symbol["text-ignore-placement"]),"text-optional":new rt(ve.layout_symbol["text-optional"])})}};class S_{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:hn,this.defaultValue=t}evaluate(t){if(t.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(t.formattedSection))return n.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ke("FormatSectionOverride",S_,{omit:["defaultValue"]});class rp extends Cr{constructor(t,n){super(t,Lf,n)}recalculate(t,n){if(super.recalculate(t,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const s=this.layout.get("text-writing-mode");if(s){const u=[];for(const p of s)u.indexOf(p)<0&&u.push(p);this.layout._values["text-writing-mode"]=u}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,n,s,u){const p=this.layout.get(t).evaluate(n,{},s,u),g=this._unevaluatedLayout._values[t];return g.isDataDriven()||El(g.value)||!p?p:function(v,w){return w.replace(/{([^{}]+)}/g,(T,P)=>v&&P in v?String(v[P]):"")}(n.properties,p)}createBucket(t){return new oc(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of Lf.paint.overridableProperties){if(!rp.hasPaintOverride(this.layout,t))continue;const n=this.paint.get(t),s=new S_(n),u=new yu(s,n.property.specification);let p=null;p=n.value.kind==="constant"||n.value.kind==="source"?new As("source",u):new _u("composite",u,n.value.zoomStops),this.paint._values[t]=new Vr(n.property,p,n.parameters)}}_handleOverridablePaintPropertyUpdate(t,n,s){return!(!this.layout||n.isDataDriven()||s.isDataDriven())&&rp.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,n){const s=t.get("text-field"),u=Lf.paint.properties[n];let p=!1;const g=v=>{for(const w of v)if(u.overrides&&u.overrides.hasOverride(w))return void(p=!0)};if(s.value.kind==="constant"&&s.value.value instanceof bn)g(s.value.value.sections);else if(s.value.kind==="source"||s.value.kind==="composite"){const v=T=>{p||(T instanceof Kr&&dt(T.value)===fa?g(T.value.sections):T instanceof Oa?g(T.sections):T.eachChild(v))},w=s.value;w._styleExpression&&v(w._styleExpression.expression)}return p}}let T_;var G2={get paint(){return T_=T_||new mn({"background-color":new rt(ve.paint_background["background-color"]),"background-pattern":new $d(ve.paint_background["background-pattern"]),"background-opacity":new rt(ve.paint_background["background-opacity"])})}};class W2 extends Cr{constructor(t,n){super(t,G2,n)}}let P_;var q2={get paint(){return P_=P_||new mn({"raster-opacity":new rt(ve.paint_raster["raster-opacity"]),"raster-hue-rotate":new rt(ve.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new rt(ve.paint_raster["raster-brightness-min"]),"raster-brightness-max":new rt(ve.paint_raster["raster-brightness-max"]),"raster-saturation":new rt(ve.paint_raster["raster-saturation"]),"raster-contrast":new rt(ve.paint_raster["raster-contrast"]),"raster-resampling":new rt(ve.paint_raster["raster-resampling"]),"raster-fade-duration":new rt(ve.paint_raster["raster-fade-duration"])})}};class H2 extends Cr{constructor(t,n){super(t,q2,n)}}class X2 extends Cr{constructor(t,n){super(t,{},n),this.onAdd=s=>{this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)},this.onRemove=s=>{this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class K2{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Y2={once:!0},Rf=63710088e-1;class Fo{constructor(t,n){if(isNaN(t)||isNaN(n))throw new Error(`Invalid LngLat object: (${t}, ${n})`);if(this.lng=+t,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Fo(zn(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const n=Math.PI/180,s=this.lat*n,u=t.lat*n,p=Math.sin(s)*Math.sin(u)+Math.cos(s)*Math.cos(u)*Math.cos((t.lng-this.lng)*n);return Rf*Math.acos(Math.min(p,1))}static convert(t){if(t instanceof Fo)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Fo(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Fo(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const k_=2*Math.PI*Rf;function M_(r){return k_*Math.cos(r*Math.PI/180)}function E_(r){return(180+r)/360}function z_(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function N_(r,t){return r/M_(t)}function Ff(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}function D_(r,t){return r*M_(Ff(t))}class th{constructor(t,n,s=0){this.x=+t,this.y=+n,this.z=+s}static fromLngLat(t,n=0){const s=Fo.convert(t);return new th(E_(s.lng),z_(s.lat),N_(n,s.lat))}toLngLat(){return new Fo(360*this.x-180,Ff(this.y))}toAltitude(){return D_(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/k_*(t=Ff(this.y),1/Math.cos(t*Math.PI/180));var t}}function L_(r,t,n){var s=2*Math.PI*6378137/256/Math.pow(2,n);return[r*s-2*Math.PI*6378137/2,t*s-2*Math.PI*6378137/2]}class Bf{constructor(t,n,s){if(!function(u,p,g){return!(u<0||u>25||g<0||g>=Math.pow(2,u)||p<0||p>=Math.pow(2,u))}(t,n,s))throw new Error(`x=${n}, y=${s}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=n,this.y=s,this.key=sc(0,t,t,n,s)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,n,s){const u=(g=this.y,v=this.z,w=L_(256*(p=this.x),256*(g=Math.pow(2,v)-g-1),v),T=L_(256*(p+1),256*(g+1),v),w[0]+","+w[1]+","+T[0]+","+T[1]);var p,g,v,w,T;const P=function(E,D,R){let B,V="";for(let G=E;G>0;G--)B=1<<G-1,V+=(D&B?1:0)+(R&B?2:0);return V}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(s==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,n>1?"@2x":"").replace(/{quadkey}/g,P).replace(/{bbox-epsg-3857}/g,u)}isChildOf(t){const n=this.z-t.z;return n>0&&t.x===this.x>>n&&t.y===this.y>>n}getTilePoint(t){const n=Math.pow(2,this.z);return new F((t.x*n-this.x)*He,(t.y*n-this.y)*He)}toString(){return`${this.z}/${this.x}/${this.y}`}}class R_{constructor(t,n){this.wrap=t,this.canonical=n,this.key=sc(t,n.z,n.z,n.x,n.y)}}class Ir{constructor(t,n,s,u,p){if(this.terrainRttPosMatrix32f=null,t<s)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${s}`);this.overscaledZ=t,this.wrap=n,this.canonical=new Bf(s,+u,+p),this.key=sc(n,t,s,u,p)}clone(){return new Ir(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const n=this.canonical.z-t;return t>this.canonical.z?new Ir(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ir(t,this.wrap,t,this.canonical.x>>n,this.canonical.y>>n)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(t,n){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const s=this.canonical.z-t;return t>this.canonical.z?sc(this.wrap*+n,t,this.canonical.z,this.canonical.x,this.canonical.y):sc(this.wrap*+n,t,t,this.canonical.x>>s,this.canonical.y>>s)}isChildOf(t){if(t.wrap!==this.wrap||this.overscaledZ-t.overscaledZ<=0)return!1;if(t.overscaledZ===0)return this.overscaledZ>0;const n=this.canonical.z-t.canonical.z;return!(n<0)&&t.canonical.x===this.canonical.x>>n&&t.canonical.y===this.canonical.y>>n}children(t){if(this.overscaledZ>=t)return[new Ir(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,s=2*this.canonical.x,u=2*this.canonical.y;return[new Ir(n,this.wrap,n,s,u),new Ir(n,this.wrap,n,s+1,u),new Ir(n,this.wrap,n,s,u+1),new Ir(n,this.wrap,n,s+1,u+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Ir(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Ir(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new R_(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new th(t.x-this.wrap,t.y))}}function sc(r,t,n,s,u){(r*=2)<0&&(r=-1*r-1);const p=1<<n;return(p*p*r+p*u+s).toString(36)+n.toString(36)+t.toString(36)}function ih(r,t){return t?r.properties[t]:r.id}Ke("CanonicalTileID",Bf),Ke("OverscaledTileID",Ir,{omit:["terrainRttPosMatrix32f"]});class Us{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(t){return this.minX=Math.min(this.minX,t.x),this.minY=Math.min(this.minY,t.y),this.maxX=Math.max(this.maxX,t.x),this.maxY=Math.max(this.maxY,t.y),this}expandBy(t){return this.minX-=t,this.minY-=t,this.maxX+=t,this.maxY+=t,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(t){return this.expandBy(-t)}map(t){const n=new Us;return n.extend(t(new F(this.minX,this.minY))),n.extend(t(new F(this.maxX,this.minY))),n.extend(t(new F(this.minX,this.maxY))),n.extend(t(new F(this.maxX,this.maxY))),n}static fromPoints(t){const n=new Us;for(const s of t)n.extend(s);return n}contains(t){return t.x>=this.minX&&t.x<=this.maxX&&t.y>=this.minY&&t.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(t){return!this.empty()&&!t.empty()&&t.minX>=this.minX&&t.maxX<=this.maxX&&t.minY>=this.minY&&t.maxY<=this.maxY}intersects(t){return!this.empty()&&!t.empty()&&t.minX<=this.maxX&&t.maxX>=this.minX&&t.minY<=this.maxY&&t.maxY>=this.minY}}class F_{constructor(t){this._stringToNumber={},this._numberToString=[];for(let n=0;n<t.length;n++){const s=t[n];this._stringToNumber[s]=n,this._numberToString[n]=s}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class B_{constructor(t,n,s,u,p){this.type="Feature",this._vectorTileFeature=t,t._z=n,t._x=s,t._y=u,this.properties=t.properties,this.id=p}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const n in this)n!=="_geometry"&&n!=="_vectorTileFeature"&&(t[n]=this[n]);return t}}class j_{constructor(t,n){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Ya(He,16,0),this.grid3D=new Ya(He,16,0),this.featureIndexArray=new Ae,this.promoteId=n}insert(t,n,s,u,p,g){const v=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(s,u,p);const w=g?this.grid3D:this.grid;for(let T=0;T<n.length;T++){const P=n[T],E=[1/0,1/0,-1/0,-1/0];for(let D=0;D<P.length;D++){const R=P[D];E[0]=Math.min(E[0],R.x),E[1]=Math.min(E[1],R.y),E[2]=Math.max(E[2],R.x),E[3]=Math.max(E[3],R.y)}E[0]<He&&E[1]<He&&E[2]>=0&&E[3]>=0&&w.insert(v,E[0],E[1],E[2],E[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new t_(new Tf(this.rawTileData)).layers,this.sourceLayerCoder=new F_(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,n,s,u){this.loadVTLayers();const p=t.params,g=He/t.tileSize/t.scale,v=qa(p.filter,p.globalState),w=t.queryGeometry,T=t.queryPadding*g,P=Us.fromPoints(w),E=this.grid.query(P.minX-T,P.minY-T,P.maxX+T,P.maxY+T),D=Us.fromPoints(t.cameraQueryGeometry).expandBy(T),R=this.grid3D.query(D.minX,D.minY,D.maxX,D.maxY,(G,Y,_e,ne)=>function(ue,we,ke,Re,qe){for(const $e of ue)if(we<=$e.x&&ke<=$e.y&&Re>=$e.x&&qe>=$e.y)return!0;const Ve=[new F(we,ke),new F(we,qe),new F(Re,qe),new F(Re,ke)];if(ue.length>2){for(const $e of Ve)if(Jl(ue,$e))return!0}for(let $e=0;$e<ue.length-1;$e++)if(Aw(ue[$e],ue[$e+1],Ve))return!0;return!1}(t.cameraQueryGeometry,G-T,Y-T,_e+T,ne+T));for(const G of R)E.push(G);E.sort(J2);const B={};let V;for(let G=0;G<E.length;G++){const Y=E[G];if(Y===V)continue;V=Y;const _e=this.featureIndexArray.get(Y);let ne=null;this.loadMatchingFeature(B,_e.bucketIndex,_e.sourceLayerIndex,_e.featureIndex,v,p.layers,p.availableImages,n,s,u,(ue,we,ke)=>(ne||(ne=Bs(ue)),we.queryIntersectsFeature({queryGeometry:w,feature:ue,featureState:ke,geometry:ne,zoom:this.z,transform:t.transform,pixelsToTileUnits:g,pixelPosMatrix:t.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:t.getElevation})))}return B}loadMatchingFeature(t,n,s,u,p,g,v,w,T,P,E){const D=this.bucketLayerIDs[n];if(g&&!D.some(G=>g.has(G)))return;const R=this.sourceLayerCoder.decode(s),B=this.vtLayers[R].feature(u);if(p.needGeometry){const G=js(B,!0);if(!p.filter(new Ot(this.tileID.overscaledZ),G,this.tileID.canonical))return}else if(!p.filter(new Ot(this.tileID.overscaledZ),B))return;const V=this.getId(B,R);for(let G=0;G<D.length;G++){const Y=D[G];if(g&&!g.has(Y))continue;const _e=w[Y];if(!_e)continue;let ne={};V&&P&&(ne=P.getState(_e.sourceLayer||"_geojsonTileLayer",V));const ue=vn({},T[Y]);ue.paint=O_(ue.paint,_e.paint,B,ne,v),ue.layout=O_(ue.layout,_e.layout,B,ne,v);const we=!E||E(B,_e,ne);if(!we)continue;const ke=new B_(B,this.z,this.x,this.y,V);ke.layer=ue;let Re=t[Y];Re===void 0&&(Re=t[Y]=[]),Re.push({featureIndex:u,feature:ke,intersectionZ:we})}}lookupSymbolFeatures(t,n,s,u,p,g,v,w){const T={};this.loadVTLayers();const P=qa(p.filterSpec,p.globalState);for(const E of t)this.loadMatchingFeature(T,s,u,E,P,g,v,w,n);return T}hasLayer(t){for(const n of this.bucketLayerIDs)for(const s of n)if(t===s)return!0;return!1}getId(t,n){var s;let u=t.id;return this.promoteId&&(u=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[n]],typeof u=="boolean"&&(u=Number(u)),u===void 0&&(!((s=t.properties)===null||s===void 0)&&s.cluster)&&this.promoteId&&(u=Number(t.properties.cluster_id))),u}}function O_(r,t,n,s,u){return fr(r,(p,g)=>{const v=t instanceof Zl?t.get(g):null;return v&&v.evaluate?v.evaluate(n,s,u):v})}function J2(r,t){return t-r}function V_(r,t,n,s,u){const p=[];for(let g=0;g<r.length;g++){const v=r[g];let w;for(let T=0;T<v.length-1;T++){let P=v[T],E=v[T+1];P.x<t&&E.x<t||(P.x<t?P=new F(t,P.y+(t-P.x)/(E.x-P.x)*(E.y-P.y))._round():E.x<t&&(E=new F(t,P.y+(t-P.x)/(E.x-P.x)*(E.y-P.y))._round()),P.y<n&&E.y<n||(P.y<n?P=new F(P.x+(n-P.y)/(E.y-P.y)*(E.x-P.x),n)._round():E.y<n&&(E=new F(P.x+(n-P.y)/(E.y-P.y)*(E.x-P.x),n)._round()),P.x>=s&&E.x>=s||(P.x>=s?P=new F(s,P.y+(s-P.x)/(E.x-P.x)*(E.y-P.y))._round():E.x>=s&&(E=new F(s,P.y+(s-P.x)/(E.x-P.x)*(E.y-P.y))._round()),P.y>=u&&E.y>=u||(P.y>=u?P=new F(P.x+(u-P.y)/(E.y-P.y)*(E.x-P.x),u)._round():E.y>=u&&(E=new F(P.x+(u-P.y)/(E.y-P.y)*(E.x-P.x),u)._round()),w&&P.equals(w[w.length-1])||(w=[P],p.push(w)),w.push(E)))))}}return p}Ke("FeatureIndex",j_,{omit:["rawTileData","sourceLayerCoder"]});class Bo extends F{constructor(t,n,s,u){super(t,n),this.angle=s,u!==void 0&&(this.segment=u)}clone(){return new Bo(this.x,this.y,this.angle,this.segment)}}function U_(r,t,n,s,u){if(t.segment===void 0||n===0)return!0;let p=t,g=t.segment+1,v=0;for(;v>-n/2;){if(g--,g<0)return!1;v-=r[g].dist(p),p=r[g]}v+=r[g].dist(r[g+1]),g++;const w=[];let T=0;for(;v<n/2;){const P=r[g],E=r[g+1];if(!E)return!1;let D=r[g-1].angleTo(P)-P.angleTo(E);for(D=Math.abs((D+3*Math.PI)%(2*Math.PI)-Math.PI),w.push({distance:v,angleDelta:D}),T+=D;v-w[0].distance>s;)T-=w.shift().angleDelta;if(T>u)return!1;g++,v+=P.dist(E)}return!0}function $_(r){let t=0;for(let n=0;n<r.length-1;n++)t+=r[n].dist(r[n+1]);return t}function Z_(r,t,n){return r?.6*t*n:0}function G_(r,t){return Math.max(r?r.right-r.left:0,t?t.right-t.left:0)}function Q2(r,t,n,s,u,p){const g=Z_(n,u,p),v=G_(n,s)*p;let w=0;const T=$_(r)/2;for(let P=0;P<r.length-1;P++){const E=r[P],D=r[P+1],R=E.dist(D);if(w+R>T){const B=(T-w)/R,V=Or.number(E.x,D.x,B),G=Or.number(E.y,D.y,B),Y=new Bo(V,G,D.angleTo(E),P);return Y._round(),!g||U_(r,Y,v,g,t)?Y:void 0}w+=R}}function eC(r,t,n,s,u,p,g,v,w){const T=Z_(s,p,g),P=G_(s,u),E=P*g,D=r[0].x===0||r[0].x===w||r[0].y===0||r[0].y===w;return t-E<t/4&&(t=E+t/4),W_(r,D?t/2*v%t:(P/2+2*p)*g*v%t,t,T,n,E,D,!1,w)}function W_(r,t,n,s,u,p,g,v,w){const T=p/2,P=$_(r);let E=0,D=t-n,R=[];for(let B=0;B<r.length-1;B++){const V=r[B],G=r[B+1],Y=V.dist(G),_e=G.angleTo(V);for(;D+n<E+Y;){D+=n;const ne=(D-E)/Y,ue=Or.number(V.x,G.x,ne),we=Or.number(V.y,G.y,ne);if(ue>=0&&ue<w&&we>=0&&we<w&&D-T>=0&&D+T<=P){const ke=new Bo(ue,we,_e,B);ke._round(),s&&!U_(r,ke,p,s,u)||R.push(ke)}}E+=Y}return v||R.length||g||(R=W_(r,E/2,n,s,u,p,g,!0,w)),R}function q_(r,t,n,s){const u=[],p=r.image,g=p.pixelRatio,v=p.paddedRect.w-2,w=p.paddedRect.h-2;let T={x1:r.left,y1:r.top,x2:r.right,y2:r.bottom};const P=p.stretchX||[[0,v]],E=p.stretchY||[[0,w]],D=(Ee,pt)=>Ee+pt[1]-pt[0],R=P.reduce(D,0),B=E.reduce(D,0),V=v-R,G=w-B;let Y=0,_e=R,ne=0,ue=B,we=0,ke=V,Re=0,qe=G;if(p.content&&s){const Ee=p.content,pt=Ee[2]-Ee[0],ft=Ee[3]-Ee[1];(p.textFitWidth||p.textFitHeight)&&(T=b_(r)),Y=ap(P,0,Ee[0]),ne=ap(E,0,Ee[1]),_e=ap(P,Ee[0],Ee[2]),ue=ap(E,Ee[1],Ee[3]),we=Ee[0]-Y,Re=Ee[1]-ne,ke=pt-_e,qe=ft-ue}const Ve=T.x1,$e=T.y1,at=T.x2-Ve,Ue=T.y2-$e,Ze=(Ee,pt,ft,ut)=>{const nt=op(Ee.stretch-Y,_e,at,Ve),Et=sp(Ee.fixed-we,ke,Ee.stretch,R),fi=op(pt.stretch-ne,ue,Ue,$e),$i=sp(pt.fixed-Re,qe,pt.stretch,B),gn=op(ft.stretch-Y,_e,at,Ve),Ar=sp(ft.fixed-we,ke,ft.stretch,R),er=op(ut.stretch-ne,ue,Ue,$e),on=sp(ut.fixed-Re,qe,ut.stretch,B),ui=new F(nt,fi),Yi=new F(gn,fi),sn=new F(gn,er),ln=new F(nt,er),jn=new F(Et/g,$i/g),Sr=new F(Ar/g,on/g),Ji=t*Math.PI/180;if(Ji){const Qi=Math.sin(Ji),en=Math.cos(Ji),Ri=[en,-Qi,Qi,en];ui._matMult(Ri),Yi._matMult(Ri),ln._matMult(Ri),sn._matMult(Ri)}const tr=Ee.stretch+Ee.fixed,Zi=pt.stretch+pt.fixed;return{tl:ui,tr:Yi,bl:ln,br:sn,tex:{x:p.paddedRect.x+1+tr,y:p.paddedRect.y+1+Zi,w:ft.stretch+ft.fixed-tr,h:ut.stretch+ut.fixed-Zi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:jn,pixelOffsetBR:Sr,minFontScaleX:ke/g/at,minFontScaleY:qe/g/Ue,isSDF:n}};if(s&&(p.stretchX||p.stretchY)){const Ee=H_(P,V,R),pt=H_(E,G,B);for(let ft=0;ft<Ee.length-1;ft++){const ut=Ee[ft],nt=Ee[ft+1];for(let Et=0;Et<pt.length-1;Et++)u.push(Ze(ut,pt[Et],nt,pt[Et+1]))}}else u.push(Ze({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:w+1}));return u}function ap(r,t,n){let s=0;for(const u of r)s+=Math.max(t,Math.min(n,u[1]))-Math.max(t,Math.min(n,u[0]));return s}function H_(r,t,n){const s=[{fixed:-1,stretch:0}];for(const[u,p]of r){const g=s[s.length-1];s.push({fixed:u-g.stretch,stretch:g.stretch}),s.push({fixed:u-g.stretch,stretch:g.stretch+(p-u)})}return s.push({fixed:t+1,stretch:n}),s}function op(r,t,n,s){return r/t*n+s}function sp(r,t,n,s){return r-t*n/s}Ke("Anchor",Bo);class lp{constructor(t,n,s,u,p,g,v,w,T,P){var E;if(this.boxStartIndex=t.length,T){let D=g.top,R=g.bottom;const B=g.collisionPadding;B&&(D-=B[1],R+=B[3]);let V=R-D;V>0&&(V=Math.max(10,V),this.circleDiameter=V)}else{const D=!((E=g.image)===null||E===void 0)&&E.content&&(g.image.textFitWidth||g.image.textFitHeight)?b_(g):{x1:g.left,y1:g.top,x2:g.right,y2:g.bottom};D.y1=D.y1*v-w[0],D.y2=D.y2*v+w[2],D.x1=D.x1*v-w[3],D.x2=D.x2*v+w[1];const R=g.collisionPadding;if(R&&(D.x1-=R[0]*v,D.y1-=R[1]*v,D.x2+=R[2]*v,D.y2+=R[3]*v),P){const B=new F(D.x1,D.y1),V=new F(D.x2,D.y1),G=new F(D.x1,D.y2),Y=new F(D.x2,D.y2),_e=P*Math.PI/180;B._rotate(_e),V._rotate(_e),G._rotate(_e),Y._rotate(_e),D.x1=Math.min(B.x,V.x,G.x,Y.x),D.x2=Math.max(B.x,V.x,G.x,Y.x),D.y1=Math.min(B.y,V.y,G.y,Y.y),D.y2=Math.max(B.y,V.y,G.y,Y.y)}t.emplaceBack(n.x,n.y,D.x1,D.y1,D.x2,D.y2,s,u,p)}this.boxEndIndex=t.length}}class tC{constructor(t=[],n=(s,u)=>s<u?-1:s>u?1:0){if(this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:n,compare:s}=this,u=n[t];for(;t>0;){const p=t-1>>1,g=n[p];if(s(u,g)>=0)break;n[t]=g,t=p}n[t]=u}_down(t){const{data:n,compare:s}=this,u=this.length>>1,p=n[t];for(;t<u;){let g=1+(t<<1);const v=g+1;if(v<this.length&&s(n[v],n[g])<0&&(g=v),s(n[g],p)>=0)break;n[t]=n[g],t=g}n[t]=p}}function iC(r,t=1,n=!1){const s=Us.fromPoints(r[0]),u=Math.min(s.width(),s.height());let p=u/2;const g=new tC([],nC),{minX:v,minY:w,maxX:T,maxY:P}=s;if(u===0)return new F(v,w);for(let R=v;R<T;R+=u)for(let B=w;B<P;B+=u)g.push(new lc(R+p,B+p,p,r));let E=function(R){let B=0,V=0,G=0;const Y=R[0];for(let _e=0,ne=Y.length,ue=ne-1;_e<ne;ue=_e++){const we=Y[_e],ke=Y[ue],Re=we.x*ke.y-ke.x*we.y;V+=(we.x+ke.x)*Re,G+=(we.y+ke.y)*Re,B+=3*Re}return new lc(V/B,G/B,0,R)}(r),D=g.length;for(;g.length;){const R=g.pop();(R.d>E.d||!E.d)&&(E=R,n&&console.log("found best %d after %d probes",Math.round(1e4*R.d)/1e4,D)),R.max-E.d<=t||(p=R.h/2,g.push(new lc(R.p.x-p,R.p.y-p,p,r)),g.push(new lc(R.p.x+p,R.p.y-p,p,r)),g.push(new lc(R.p.x-p,R.p.y+p,p,r)),g.push(new lc(R.p.x+p,R.p.y+p,p,r)),D+=4)}return n&&(console.log(`num probes: ${D}`),console.log(`best distance: ${E.d}`)),E.p}function nC(r,t){return t.max-r.max}function lc(r,t,n,s){this.p=new F(r,t),this.h=n,this.d=function(u,p){let g=!1,v=1/0;for(let w=0;w<p.length;w++){const T=p[w];for(let P=0,E=T.length,D=E-1;P<E;D=P++){const R=T[P],B=T[D];R.y>u.y!=B.y>u.y&&u.x<(B.x-R.x)*(u.y-R.y)/(B.y-R.y)+R.x&&(g=!g),v=Math.min(v,zy(u,R,B))}}return(g?1:-1)*Math.sqrt(v)}(this.p,s),this.max=this.d+this.h*Math.SQRT2}var fn;b.aE=void 0,(fn=b.aE||(b.aE={}))[fn.center=1]="center",fn[fn.left=2]="left",fn[fn.right=3]="right",fn[fn.top=4]="top",fn[fn.bottom=5]="bottom",fn[fn["top-left"]=6]="top-left",fn[fn["top-right"]=7]="top-right",fn[fn["bottom-left"]=8]="bottom-left",fn[fn["bottom-right"]=9]="bottom-right";const jf=Number.POSITIVE_INFINITY;function X_(r,t){return t[1]!==jf?function(n,s,u){let p=0,g=0;switch(s=Math.abs(s),u=Math.abs(u),n){case"top-right":case"top-left":case"top":g=u-7;break;case"bottom-right":case"bottom-left":case"bottom":g=7-u}switch(n){case"top-right":case"bottom-right":case"right":p=-s;break;case"top-left":case"bottom-left":case"left":p=s}return[p,g]}(r,t[0],t[1]):function(n,s){let u=0,p=0;s<0&&(s=0);const g=s/Math.SQRT2;switch(n){case"top-right":case"top-left":p=g-7;break;case"bottom-right":case"bottom-left":p=7-g;break;case"bottom":p=7-s;break;case"top":p=s-7}switch(n){case"top-right":case"bottom-right":u=-g;break;case"top-left":case"bottom-left":u=g;break;case"left":u=s;break;case"right":u=-s}return[u,p]}(r,t[0])}function K_(r,t,n){var s;const u=r.layout,p=(s=u.get("text-variable-anchor-offset"))===null||s===void 0?void 0:s.evaluate(t,{},n);if(p){const v=p.values,w=[];for(let T=0;T<v.length;T+=2){const P=w[T]=v[T],E=v[T+1].map(D=>D*Ki);P.startsWith("top")?E[1]-=7:P.startsWith("bottom")&&(E[1]+=7),w[T+1]=E}return new Cn(w)}const g=u.get("text-variable-anchor");if(g){let v;v=r._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[u.get("text-radial-offset").evaluate(t,{},n)*Ki,jf]:u.get("text-offset").evaluate(t,{},n).map(T=>T*Ki);const w=[];for(const T of g)w.push(T,X_(T,v));return new Cn(w)}return null}function Of(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function rC(r,t,n,s,u,p,g,v,w,T,P,E){let D=p.textMaxSize.evaluate(t,{});D===void 0&&(D=g);const R=r.layers[0].layout,B=R.get("icon-offset").evaluate(t,{},P),V=J_(n.horizontal),G=g/24,Y=r.tilePixelRatio*G,_e=r.tilePixelRatio*D/24,ne=r.tilePixelRatio*v,ue=r.tilePixelRatio*R.get("symbol-spacing"),we=R.get("text-padding")*r.tilePixelRatio,ke=function(ft,ut,nt,Et=1){const fi=ft.get("icon-padding").evaluate(ut,{},nt),$i=fi&&fi.values;return[$i[0]*Et,$i[1]*Et,$i[2]*Et,$i[3]*Et]}(R,t,P,r.tilePixelRatio),Re=R.get("text-max-angle")/180*Math.PI,qe=R.get("text-rotation-alignment")!=="viewport"&&R.get("symbol-placement")!=="point",Ve=R.get("icon-rotation-alignment")==="map"&&R.get("symbol-placement")!=="point",$e=R.get("symbol-placement"),at=ue/2,Ue=R.get("icon-text-fit");let Ze;s&&Ue!=="none"&&(r.allowVerticalPlacement&&n.vertical&&(Ze=w_(s,n.vertical,Ue,R.get("icon-text-fit-padding"),B,G)),V&&(s=w_(s,V,Ue,R.get("icon-text-fit-padding"),B,G)));const Ee=P?E.line.getGranularityForZoomLevel(P.z):1,pt=(ft,ut)=>{ut.x<0||ut.x>=He||ut.y<0||ut.y>=He||function(nt,Et,fi,$i,gn,Ar,er,on,ui,Yi,sn,ln,jn,Sr,Ji,tr,Zi,Qi,en,Ri,ii,ia,cc,na,sC){const uc=nt.addToLineVertexArray(Et,fi);let $s,hc,dc,pc,iv=0,nv=0,rv=0,av=0,Hf=-1,Xf=-1;const oo={};let ov=ea("");if(nt.allowVerticalPlacement&&$i.vertical){const Sn=on.layout.get("text-rotate").evaluate(ii,{},na)+90;dc=new lp(ui,Et,Yi,sn,ln,$i.vertical,jn,Sr,Ji,Sn),er&&(pc=new lp(ui,Et,Yi,sn,ln,er,Zi,Qi,Ji,Sn))}if(gn){const Sn=on.layout.get("icon-rotate").evaluate(ii,{}),Tr=on.layout.get("icon-text-fit")!=="none",Zs=q_(gn,Sn,cc,Tr),aa=er?q_(er,Sn,cc,Tr):void 0;hc=new lp(ui,Et,Yi,sn,ln,gn,Zi,Qi,!1,Sn),iv=4*Zs.length;const Gs=nt.iconSizeData;let Sa=null;Gs.kind==="source"?(Sa=[ao*on.layout.get("icon-size").evaluate(ii,{})],Sa[0]>Ro&&li(`${nt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Gs.kind==="composite"&&(Sa=[ao*ia.compositeIconSizes[0].evaluate(ii,{},na),ao*ia.compositeIconSizes[1].evaluate(ii,{},na)],(Sa[0]>Ro||Sa[1]>Ro)&&li(`${nt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),nt.addSymbols(nt.icon,Zs,Sa,Ri,en,ii,b.ao.none,Et,uc.lineStartIndex,uc.lineLength,-1,na),Hf=nt.icon.placedSymbolArray.length-1,aa&&(nv=4*aa.length,nt.addSymbols(nt.icon,aa,Sa,Ri,en,ii,b.ao.vertical,Et,uc.lineStartIndex,uc.lineLength,-1,na),Xf=nt.icon.placedSymbolArray.length-1)}const sv=Object.keys($i.horizontal);for(const Sn of sv){const Tr=$i.horizontal[Sn];if(!$s){ov=ea(Tr.text);const aa=on.layout.get("text-rotate").evaluate(ii,{},na);$s=new lp(ui,Et,Yi,sn,ln,Tr,jn,Sr,Ji,aa)}const Zs=Tr.positionedLines.length===1;if(rv+=Y_(nt,Et,Tr,Ar,on,Ji,ii,tr,uc,$i.vertical?b.ao.horizontal:b.ao.horizontalOnly,Zs?sv:[Sn],oo,Hf,ia,na),Zs)break}$i.vertical&&(av+=Y_(nt,Et,$i.vertical,Ar,on,Ji,ii,tr,uc,b.ao.vertical,["vertical"],oo,Xf,ia,na));const lC=$s?$s.boxStartIndex:nt.collisionBoxArray.length,cC=$s?$s.boxEndIndex:nt.collisionBoxArray.length,uC=dc?dc.boxStartIndex:nt.collisionBoxArray.length,hC=dc?dc.boxEndIndex:nt.collisionBoxArray.length,dC=hc?hc.boxStartIndex:nt.collisionBoxArray.length,pC=hc?hc.boxEndIndex:nt.collisionBoxArray.length,mC=pc?pc.boxStartIndex:nt.collisionBoxArray.length,fC=pc?pc.boxEndIndex:nt.collisionBoxArray.length;let ra=-1;const up=(Sn,Tr)=>Sn&&Sn.circleDiameter?Math.max(Sn.circleDiameter,Tr):Tr;ra=up($s,ra),ra=up(dc,ra),ra=up(hc,ra),ra=up(pc,ra);const lv=ra>-1?1:0;lv&&(ra*=sC/Ki),nt.glyphOffsetArray.length>=oc.MAX_GLYPHS&&li("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ii.sortKey!==void 0&&nt.addToSortKeyRanges(nt.symbolInstances.length,ii.sortKey);const gC=K_(on,ii,na),[yC,_C]=function(Sn,Tr){const Zs=Sn.length,aa=Tr==null?void 0:Tr.values;if((aa==null?void 0:aa.length)>0)for(let Gs=0;Gs<aa.length;Gs+=2){const Sa=aa[Gs+1];Sn.emplaceBack(b.aE[aa[Gs]],Sa[0],Sa[1])}return[Zs,Sn.length]}(nt.textAnchorOffsets,gC);nt.symbolInstances.emplaceBack(Et.x,Et.y,oo.right>=0?oo.right:-1,oo.center>=0?oo.center:-1,oo.left>=0?oo.left:-1,oo.vertical||-1,Hf,Xf,ov,lC,cC,uC,hC,dC,pC,mC,fC,Yi,rv,av,iv,nv,lv,0,jn,ra,yC,_C)}(r,ut,ft,n,s,u,Ze,r.layers[0],r.collisionBoxArray,t.index,t.sourceLayerIndex,r.index,Y,[we,we,we,we],qe,w,ne,ke,Ve,B,t,p,T,P,g)};if($e==="line")for(const ft of V_(t.geometry,0,0,He,He)){const ut=Vs(ft,Ee),nt=eC(ut,ue,Re,n.vertical||V,s,24,_e,r.overscaling,He);for(const Et of nt)V&&aC(r,V.text,at,Et)||pt(ut,Et)}else if($e==="line-center"){for(const ft of t.geometry)if(ft.length>1){const ut=Vs(ft,Ee),nt=Q2(ut,Re,n.vertical||V,s,24,_e);nt&&pt(ut,nt)}}else if(t.type==="Polygon")for(const ft of xs(t.geometry,0)){const ut=iC(ft,16);pt(Vs(ft[0],Ee,!0),new Bo(ut.x,ut.y,0))}else if(t.type==="LineString")for(const ft of t.geometry){const ut=Vs(ft,Ee);pt(ut,new Bo(ut[0].x,ut[0].y,0))}else if(t.type==="Point")for(const ft of t.geometry)for(const ut of ft)pt([ut],new Bo(ut.x,ut.y,0))}function Y_(r,t,n,s,u,p,g,v,w,T,P,E,D,R,B){const V=function(_e,ne,ue,we,ke,Re,qe,Ve){const $e=we.layout.get("text-rotate").evaluate(Re,{})*Math.PI/180,at=[];for(const Ue of ne.positionedLines)for(const Ze of Ue.positionedGlyphs){if(!Ze.rect)continue;const Ee=Ze.rect||{};let pt=4,ft=!0,ut=1,nt=0;const Et=(ke||Ve)&&Ze.vertical,fi=Ze.metrics.advance*Ze.scale/2;if(Ve&&ne.verticalizable&&(nt=Ue.lineOffset/2-(Ze.imageName?-(Ki-Ze.metrics.width*Ze.scale)/2:(Ze.scale-1)*Ki)),Ze.imageName){const Qi=qe[Ze.imageName];ft=Qi.sdf,ut=Qi.pixelRatio,pt=1/ut}const $i=ke?[Ze.x+fi,Ze.y]:[0,0];let gn=ke?[0,0]:[Ze.x+fi+ue[0],Ze.y+ue[1]-nt],Ar=[0,0];Et&&(Ar=gn,gn=[0,0]);const er=Ze.metrics.isDoubleResolution?2:1,on=(Ze.metrics.left-pt)*Ze.scale-fi+gn[0],ui=(-Ze.metrics.top-pt)*Ze.scale+gn[1],Yi=on+Ee.w/er*Ze.scale/ut,sn=ui+Ee.h/er*Ze.scale/ut,ln=new F(on,ui),jn=new F(Yi,ui),Sr=new F(on,sn),Ji=new F(Yi,sn);if(Et){const Qi=new F(-fi,fi- -17),en=-Math.PI/2,Ri=12-fi,ii=new F(22-Ri,-(Ze.imageName?Ri:0)),ia=new F(...Ar);ln._rotateAround(en,Qi)._add(ii)._add(ia),jn._rotateAround(en,Qi)._add(ii)._add(ia),Sr._rotateAround(en,Qi)._add(ii)._add(ia),Ji._rotateAround(en,Qi)._add(ii)._add(ia)}if($e){const Qi=Math.sin($e),en=Math.cos($e),Ri=[en,-Qi,Qi,en];ln._matMult(Ri),jn._matMult(Ri),Sr._matMult(Ri),Ji._matMult(Ri)}const tr=new F(0,0),Zi=new F(0,0);at.push({tl:ln,tr:jn,bl:Sr,br:Ji,tex:Ee,writingMode:ne.writingMode,glyphOffset:$i,sectionIndex:Ze.sectionIndex,isSDF:ft,pixelOffsetTL:tr,pixelOffsetBR:Zi,minFontScaleX:0,minFontScaleY:0})}return at}(0,n,v,u,p,g,s,r.allowVerticalPlacement),G=r.textSizeData;let Y=null;G.kind==="source"?(Y=[ao*u.layout.get("text-size").evaluate(g,{})],Y[0]>Ro&&li(`${r.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):G.kind==="composite"&&(Y=[ao*R.compositeTextSizes[0].evaluate(g,{},B),ao*R.compositeTextSizes[1].evaluate(g,{},B)],(Y[0]>Ro||Y[1]>Ro)&&li(`${r.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),r.addSymbols(r.text,V,Y,v,p,g,T,t,w.lineStartIndex,w.lineLength,D,B);for(const _e of P)E[_e]=r.text.placedSymbolArray.length-1;return 4*V.length}function J_(r){for(const t in r)return r[t];return null}function aC(r,t,n,s){const u=r.compareText;if(t in u){const p=u[t];for(let g=p.length-1;g>=0;g--)if(s.dist(p[g])<n)return!0}else u[t]=[];return u[t].push(s),!1}const Q_=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Vf{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,s]=new Uint8Array(t,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const u=s>>4;if(u!==1)throw new Error(`Got v${u} data when expected v1.`);const p=Q_[15&s];if(!p)throw new Error("Unrecognized array type.");const[g]=new Uint16Array(t,2,1),[v]=new Uint32Array(t,4,1);return new Vf(v,g,p,t)}constructor(t,n=64,s=Float64Array,u){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=s,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const p=Q_.indexOf(this.ArrayType),g=2*t*this.ArrayType.BYTES_PER_ELEMENT,v=t*this.IndexArrayType.BYTES_PER_ELEMENT,w=(8-v%8)%8;if(p<0)throw new Error(`Unexpected typed array class: ${s}.`);u&&u instanceof ArrayBuffer?(this.data=u,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+v+w,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+g+v+w),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+v+w,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+p]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=t)}add(t,n){const s=this._pos>>1;return this.ids[s]=s,this.coords[this._pos++]=t,this.coords[this._pos++]=n,s}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return Uf(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,n,s,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:g,nodeSize:v}=this,w=[0,p.length-1,0],T=[];for(;w.length;){const P=w.pop()||0,E=w.pop()||0,D=w.pop()||0;if(E-D<=v){for(let G=D;G<=E;G++){const Y=g[2*G],_e=g[2*G+1];Y>=t&&Y<=s&&_e>=n&&_e<=u&&T.push(p[G])}continue}const R=D+E>>1,B=g[2*R],V=g[2*R+1];B>=t&&B<=s&&V>=n&&V<=u&&T.push(p[R]),(P===0?t<=B:n<=V)&&(w.push(D),w.push(R-1),w.push(1-P)),(P===0?s>=B:u>=V)&&(w.push(R+1),w.push(E),w.push(1-P))}return T}within(t,n,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:u,coords:p,nodeSize:g}=this,v=[0,u.length-1,0],w=[],T=s*s;for(;v.length;){const P=v.pop()||0,E=v.pop()||0,D=v.pop()||0;if(E-D<=g){for(let G=D;G<=E;G++)tv(p[2*G],p[2*G+1],t,n)<=T&&w.push(u[G]);continue}const R=D+E>>1,B=p[2*R],V=p[2*R+1];tv(B,V,t,n)<=T&&w.push(u[R]),(P===0?t-s<=B:n-s<=V)&&(v.push(D),v.push(R-1),v.push(1-P)),(P===0?t+s>=B:n+s>=V)&&(v.push(R+1),v.push(E),v.push(1-P))}return w}}function Uf(r,t,n,s,u,p){if(u-s<=n)return;const g=s+u>>1;ev(r,t,g,s,u,p),Uf(r,t,n,s,g-1,1-p),Uf(r,t,n,g+1,u,1-p)}function ev(r,t,n,s,u,p){for(;u>s;){if(u-s>600){const T=u-s+1,P=n-s+1,E=Math.log(T),D=.5*Math.exp(2*E/3),R=.5*Math.sqrt(E*D*(T-D)/T)*(P-T/2<0?-1:1);ev(r,t,n,Math.max(s,Math.floor(n-P*D/T+R)),Math.min(u,Math.floor(n+(T-P)*D/T+R)),p)}const g=t[2*n+p];let v=s,w=u;for(nh(r,t,s,n),t[2*u+p]>g&&nh(r,t,s,u);v<w;){for(nh(r,t,v,w),v++,w--;t[2*v+p]<g;)v++;for(;t[2*w+p]>g;)w--}t[2*s+p]===g?nh(r,t,s,w):(w++,nh(r,t,w,u)),w<=n&&(s=w+1),n<=w&&(u=w-1)}}function nh(r,t,n,s){$f(r,n,s),$f(t,2*n,2*s),$f(t,2*n+1,2*s+1)}function $f(r,t,n){const s=r[t];r[t]=r[n],r[n]=s}function tv(r,t,n,s){const u=r-n,p=t-s;return u*u+p*p}var Zf;b.cx=void 0,(Zf=b.cx||(b.cx={})).create="create",Zf.load="load",Zf.fullLoad="fullLoad";let cp=null,rh=[];const Gf=1e3/60,Wf="loadTime",qf="fullLoadTime",oC={mark(r){performance.mark(r)},frame(r){const t=r;cp!=null&&rh.push(t-cp),cp=t},clearMetrics(){cp=null,rh=[],performance.clearMeasures(Wf),performance.clearMeasures(qf);for(const r in b.cx)performance.clearMarks(b.cx[r])},getPerformanceMetrics(){performance.measure(Wf,b.cx.create,b.cx.load),performance.measure(qf,b.cx.create,b.cx.fullLoad);const r=performance.getEntriesByName(Wf)[0].duration,t=performance.getEntriesByName(qf)[0].duration,n=rh.length,s=1/(rh.reduce((p,g)=>p+g,0)/n/1e3),u=rh.filter(p=>p>Gf).reduce((p,g)=>p+(g-Gf)/Gf,0);return{loadTime:r,fullLoadTime:t,fps:s,percentDroppedFrames:u/(n+u)*100,totalFrames:n}}};b.$=He,b.A=fe,b.B=function([r,t,n]){return t+=90,t*=Math.PI/180,n*=Math.PI/180,{x:r*Math.cos(t)*Math.sin(n),y:r*Math.sin(t)*Math.sin(n),z:r*Math.cos(n)}},b.C=Or,b.D=rt,b.E=it,b.F=Ot,b.G=af,b.H=function(r){if(Ln==null){const t=r.navigator?r.navigator.userAgent:null;Ln=!!r.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Ln},b.I=Pf,b.J=class{constructor(r,t){this.target=r,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new K2(()=>this.process()),this.subscription=Rr(this.target,"message",n=>this.receive(n),!1),this.globalScope=Wn(self)?r:window}registerMessageHandler(r,t){this.messageHandlers[r]=t}sendAsync(r,t){return new Promise((n,s)=>{const u=Math.round(1e18*Math.random()).toString(36).substring(0,10),p=t?Rr(t.signal,"abort",()=>{p==null||p.unsubscribe(),delete this.resolveRejects[u];const w={id:u,type:"<cancel>",origin:location.origin,targetMapId:r.targetMapId,sourceMapId:this.mapId};this.target.postMessage(w)},Y2):null;this.resolveRejects[u]={resolve:w=>{p==null||p.unsubscribe(),n(w)},reject:w=>{p==null||p.unsubscribe(),s(w)}};const g=[],v=Object.assign(Object.assign({},r),{id:u,sourceMapId:this.mapId,origin:location.origin,data:Ja(r.data,g)});this.target.postMessage(v,{transfer:g})})}receive(r){const t=r.data,n=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[n];const s=this.abortControllers[n];return delete this.abortControllers[n],void(s&&s.abort())}if(Wn(self)||t.mustQueue)return this.tasks[n]=t,this.taskQueue.push(n),void this.invoker.trigger();this.processTask(n,t)}}process(){if(this.taskQueue.length===0)return;const r=this.taskQueue.shift(),t=this.tasks[r];delete this.tasks[r],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(r,t)}processTask(r,t){return c(this,void 0,void 0,function*(){if(t.type==="<response>"){const u=this.resolveRejects[r];return delete this.resolveRejects[r],u?void(t.error?u.reject(No(t.error)):u.resolve(No(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(r,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const n=No(t.data),s=new AbortController;this.abortControllers[r]=s;try{const u=yield this.messageHandlers[t.type](t.sourceMapId,n,s);this.completeTask(r,null,u)}catch(u){this.completeTask(r,u)}})}completeTask(r,t,n){const s=[];delete this.abortControllers[r];const u={id:r,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?Ja(t):null,data:Ja(n,s)};this.target.postMessage(u,{transfer:s})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},b.K=Z,b.L=function(){var r=new fe(16);return fe!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},b.M=function(r,t,n){var s,u,p,g,v,w,T,P,E,D,R,B,V=n[0],G=n[1],Y=n[2];return t===r?(r[12]=t[0]*V+t[4]*G+t[8]*Y+t[12],r[13]=t[1]*V+t[5]*G+t[9]*Y+t[13],r[14]=t[2]*V+t[6]*G+t[10]*Y+t[14],r[15]=t[3]*V+t[7]*G+t[11]*Y+t[15]):(u=t[1],p=t[2],g=t[3],v=t[4],w=t[5],T=t[6],P=t[7],E=t[8],D=t[9],R=t[10],B=t[11],r[0]=s=t[0],r[1]=u,r[2]=p,r[3]=g,r[4]=v,r[5]=w,r[6]=T,r[7]=P,r[8]=E,r[9]=D,r[10]=R,r[11]=B,r[12]=s*V+v*G+E*Y+t[12],r[13]=u*V+w*G+D*Y+t[13],r[14]=p*V+T*G+R*Y+t[14],r[15]=g*V+P*G+B*Y+t[15]),r},b.N=function(r,t,n){var s=n[0],u=n[1],p=n[2];return r[0]=t[0]*s,r[1]=t[1]*s,r[2]=t[2]*s,r[3]=t[3]*s,r[4]=t[4]*u,r[5]=t[5]*u,r[6]=t[6]*u,r[7]=t[7]*u,r[8]=t[8]*p,r[9]=t[9]*p,r[10]=t[10]*p,r[11]=t[11]*p,r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},b.O=function(r,t,n){var s=t[0],u=t[1],p=t[2],g=t[3],v=t[4],w=t[5],T=t[6],P=t[7],E=t[8],D=t[9],R=t[10],B=t[11],V=t[12],G=t[13],Y=t[14],_e=t[15],ne=n[0],ue=n[1],we=n[2],ke=n[3];return r[0]=ne*s+ue*v+we*E+ke*V,r[1]=ne*u+ue*w+we*D+ke*G,r[2]=ne*p+ue*T+we*R+ke*Y,r[3]=ne*g+ue*P+we*B+ke*_e,r[4]=(ne=n[4])*s+(ue=n[5])*v+(we=n[6])*E+(ke=n[7])*V,r[5]=ne*u+ue*w+we*D+ke*G,r[6]=ne*p+ue*T+we*R+ke*Y,r[7]=ne*g+ue*P+we*B+ke*_e,r[8]=(ne=n[8])*s+(ue=n[9])*v+(we=n[10])*E+(ke=n[11])*V,r[9]=ne*u+ue*w+we*D+ke*G,r[10]=ne*p+ue*T+we*R+ke*Y,r[11]=ne*g+ue*P+we*B+ke*_e,r[12]=(ne=n[12])*s+(ue=n[13])*v+(we=n[14])*E+(ke=n[15])*V,r[13]=ne*u+ue*w+we*D+ke*G,r[14]=ne*p+ue*T+we*R+ke*Y,r[15]=ne*g+ue*P+we*B+ke*_e,r},b.P=F,b.Q=function(r,t){const n={};for(let s=0;s<t.length;s++){const u=t[s];u in r&&(n[u]=r[u])}return n},b.R=Qn,b.S=Fo,b.T=_f,b.U=z_,b.V=E_,b.W=We,b.X=he,b.Y=yr,b.Z=Ir,b._=c,b.a=j,b.a$=Bi,b.a0=function(r,t){var n,s,u,p,g;if(!r)return t??{};if(!t)return r;let v=Object.assign({},r);if(t.removeAll&&(v={removeAll:!0}),t.remove){const w=new Set(t.remove);v.add&&(v.add=v.add.filter(P=>!w.has(P.id))),v.update&&(v.update=v.update.filter(P=>!w.has(P.id)));const T=new Set(((n=r.add)!==null&&n!==void 0?n:[]).map(P=>P.id));t.remove=t.remove.filter(P=>!T.has(P))}if(t.remove){const w=new Set(v.remove?v.remove.concat(t.remove):t.remove);v.remove=Array.from(w.values())}if(t.add){const w=v.add?v.add.concat(t.add):t.add,T=new Map(w.map(P=>[P.id,P]));v.add=Array.from(T.values())}if(t.update){const w=new Map((s=v.update)===null||s===void 0?void 0:s.map(T=>[T.id,T]));for(const T of t.update){const P=(u=w.get(T.id))!==null&&u!==void 0?u:{id:T.id};T.newGeometry&&(P.newGeometry=T.newGeometry),T.addOrUpdateProperties&&(P.addOrUpdateProperties=((p=P.addOrUpdateProperties)!==null&&p!==void 0?p:[]).concat(T.addOrUpdateProperties)),T.removeProperties&&(P.removeProperties=((g=P.removeProperties)!==null&&g!==void 0?g:[]).concat(T.removeProperties)),T.removeAllProperties&&(P.removeAllProperties=!0),w.set(T.id,P)}v.update=Array.from(w.values())}return v.remove&&v.add&&(v.remove=v.remove.filter(w=>v.add.findIndex(T=>T.id===w)===-1)),v},b.a1=th,b.a2=Us,b.a3=25,b.a4=Bf,b.a5=r=>{const t=window.document.createElement("video");return t.muted=!0,new Promise(n=>{t.onloadstart=()=>{n(t)};for(const s of r){const u=window.document.createElement("source");xe(s)||(t.crossOrigin="Anonymous"),u.src=s,t.appendChild(u)}})},b.a6=Ne,b.a7=function(){return Nn++},b.a8=q,b.a9=oc,b.aA=function(r){let t=1/0,n=1/0,s=-1/0,u=-1/0;for(const p of r)t=Math.min(t,p.x),n=Math.min(n,p.y),s=Math.max(s,p.x),u=Math.max(u,p.y);return[t,n,s,u]},b.aB=Ki,b.aC=yt,b.aD=function(r,t,n,s,u=!1){if(!n[0]&&!n[1])return[0,0];const p=u?s==="map"?-r.bearingInRadians:0:s==="viewport"?r.bearingInRadians:0;if(p){const g=Math.sin(p),v=Math.cos(p);n=[n[0]*v-n[1]*g,n[0]*g+n[1]*v]}return[u?n[0]:yt(t,n[0],r.zoom),u?n[1]:yt(t,n[1],r.zoom)]},b.aF=Ef,b.aG=Of,b.aH=Mf,b.aI=Vf,b.aJ=mi,b.aK=Qd,b.aL=be,b.aM=It,b.aN=Ui,b.aO=zn,b.aP=ht,b.aQ=D_,b.aR=mt,b.aS=Lt,b.aT=function(r){var t=new fe(3);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t},b.aU=function(r,t,n){return r[0]=t[0]-n[0],r[1]=t[1]-n[1],r[2]=t[2]-n[2],r},b.aV=function(r,t){var n=t[0],s=t[1],u=t[2],p=n*n+s*s+u*u;return p>0&&(p=1/Math.sqrt(p)),r[0]=t[0]*p,r[1]=t[1]*p,r[2]=t[2]*p,r},b.aW=di,b.aX=function(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]},b.aY=function(r,t,n){return r[0]=t[0]*n[0],r[1]=t[1]*n[1],r[2]=t[2]*n[2],r[3]=t[3]*n[3],r},b.aZ=et,b.a_=function(r,t,n){const s=t[0]*n[0]+t[1]*n[1]+t[2]*n[2];return s===0?null:(-(r[0]*n[0]+r[1]*n[1]+r[2]*n[2])-n[3])/s},b.aa=qa,b.ab=js,b.ac=B_,b.ad=function(r){const t={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(n,s,u,p)=>{const g=u||p;return t[s]=!g||g.toLowerCase(),""}),t["max-age"]){const n=parseInt(t["max-age"],10);isNaN(n)?delete t["max-age"]:t["max-age"]=n}return t},b.ae=Ye,b.af=function(r){return Math.pow(2,r)},b.ag=Xe,b.ah=jt,b.ai=85.051129,b.aj=N_,b.ak=function(r){return Math.log(r)/Math.LN2},b.al=function(r){var t=r[0],n=r[1];return t*t+n*n},b.am=function(r,t){const n=[];for(const s in r)s in t||n.push(s);return n},b.an=function(r,t){let n=0,s=0;if(r.kind==="constant")s=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:u,minZoom:p,maxZoom:g}=r,v=u?jt(rn.interpolationFactor(u,t,p,g),0,1):0;r.kind==="camera"?s=Or.number(r.minSize,r.maxSize,v):n=v}return{uSizeT:n,uSize:s}},b.ap=function(r,{uSize:t,uSizeT:n},{lowerSize:s,upperSize:u}){return r.kind==="source"?s/ao:r.kind==="composite"?Or.number(s/ao,u/ao,n):t},b.aq=function(r,t){var n=t[0],s=t[1],u=t[2],p=t[3],g=t[4],v=t[5],w=t[6],T=t[7],P=t[8],E=t[9],D=t[10],R=t[11],B=t[12],V=t[13],G=t[14],Y=t[15],_e=n*v-s*g,ne=n*w-u*g,ue=n*T-p*g,we=s*w-u*v,ke=s*T-p*v,Re=u*T-p*w,qe=P*V-E*B,Ve=P*G-D*B,$e=P*Y-R*B,at=E*G-D*V,Ue=E*Y-R*V,Ze=D*Y-R*G,Ee=_e*Ze-ne*Ue+ue*at+we*$e-ke*Ve+Re*qe;return Ee?(r[0]=(v*Ze-w*Ue+T*at)*(Ee=1/Ee),r[1]=(u*Ue-s*Ze-p*at)*Ee,r[2]=(V*Re-G*ke+Y*we)*Ee,r[3]=(D*ke-E*Re-R*we)*Ee,r[4]=(w*$e-g*Ze-T*Ve)*Ee,r[5]=(n*Ze-u*$e+p*Ve)*Ee,r[6]=(G*ue-B*Re-Y*ne)*Ee,r[7]=(P*Re-D*ue+R*ne)*Ee,r[8]=(g*Ue-v*$e+T*qe)*Ee,r[9]=(s*$e-n*Ue-p*qe)*Ee,r[10]=(B*ke-V*ue+Y*_e)*Ee,r[11]=(E*ue-P*ke-R*_e)*Ee,r[12]=(v*Ve-g*at-w*qe)*Ee,r[13]=(n*at-s*Ve+u*qe)*Ee,r[14]=(V*ne-B*we-G*_e)*Ee,r[15]=(P*we-E*ne+D*_e)*Ee,r):null},b.ar=Mn,b.as=function(r){var t=r[0],n=r[1];return Math.sqrt(t*t+n*n)},b.at=function(r){return r[0]=0,r[1]=0,r},b.au=function(r,t,n){return r[0]=t[0]*n,r[1]=t[1]*n,r},b.av=zf,b.aw=si,b.ax=function(r,t,n,s){const u=t.y-r.y,p=t.x-r.x,g=s.y-n.y,v=s.x-n.x,w=g*p-v*u;if(w===0)return null;const T=(v*(r.y-n.y)-g*(r.x-n.x))/w;return new F(r.x+T*p,r.y+T*u)},b.ay=V_,b.az=My,b.b=Rn,b.b$=class extends l{},b.b0=function(r,t,n){return r[0]=t[0]*n,r[1]=t[1]*n,r[2]=t[2]*n,r[3]=t[3]*n,r},b.b1=function(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]+r[3]},b.b2=R_,b.b3=sc,b.b4=function(r,t,n,s,u){var p=1/Math.tan(t/2);if(r[0]=p/n,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=p,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,u!=null&&u!==1/0){var g=1/(s-u);r[10]=(u+s)*g,r[14]=2*u*s*g}else r[10]=-1,r[14]=-2*s;return r},b.b5=function(r){var t=new fe(16);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},b.b6=function(r,t,n){var s=Math.sin(n),u=Math.cos(n),p=t[0],g=t[1],v=t[2],w=t[3],T=t[4],P=t[5],E=t[6],D=t[7];return t!==r&&(r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=p*u+T*s,r[1]=g*u+P*s,r[2]=v*u+E*s,r[3]=w*u+D*s,r[4]=T*u-p*s,r[5]=P*u-g*s,r[6]=E*u-v*s,r[7]=D*u-w*s,r},b.b7=function(r,t,n){var s=Math.sin(n),u=Math.cos(n),p=t[4],g=t[5],v=t[6],w=t[7],T=t[8],P=t[9],E=t[10],D=t[11];return t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[4]=p*u+T*s,r[5]=g*u+P*s,r[6]=v*u+E*s,r[7]=w*u+D*s,r[8]=T*u-p*s,r[9]=P*u-g*s,r[10]=E*u-v*s,r[11]=D*u-w*s,r},b.b8=function(){const r=new Float32Array(16);return Xe(r),r},b.b9=function(){const r=new Float64Array(16);return Xe(r),r},b.bA=function(r,t){const n=At(r,360),s=At(t,360),u=s-n,p=s>n?u-360:u+360;return Math.abs(u)<Math.abs(p)?u:p},b.bB=function(r){return r[0]=0,r[1]=0,r[2]=0,r},b.bC=function(r,t,n,s){const u=Math.sqrt(r*r+t*t),p=Math.sqrt(n*n+s*s);r/=u,t/=u,n/=p,s/=p;const g=Math.acos(r*n+t*s);return-t*n+r*s>0?g:-g},b.bD=function(r,t){const n=At(r,2*Math.PI),s=At(t,2*Math.PI);return Math.min(Math.abs(n-s),Math.abs(n-s+2*Math.PI),Math.abs(n-s-2*Math.PI))},b.bE=function(){const r={},t=ve.$version;for(const n in ve.$root){const s=ve.$root[n];if(s.required){let u=null;u=n==="version"?t:s.type==="array"?[]:{},u!=null&&(r[n]=u)}}return r},b.bF=Mu,b.bG=le,b.bH=function r(t,n){if(Array.isArray(t)){if(!Array.isArray(n)||t.length!==n.length)return!1;for(let s=0;s<t.length;s++)if(!r(t[s],n[s]))return!1;return!0}if(typeof t=="object"&&t!==null&&n!==null){if(typeof n!="object"||Object.keys(t).length!==Object.keys(n).length)return!1;for(const s in t)if(!r(t[s],n[s]))return!1;return!0}return t===n},b.bI=function(r){r=r.slice();const t=Object.create(null);for(let n=0;n<r.length;n++)t[r[n].id]=r[n];for(let n=0;n<r.length;n++)"ref"in r[n]&&(r[n]=Pt(r[n],t[r[n].ref]));return r},b.bJ=function(r,t){if(r.type==="custom")return new X2(r,t);switch(r.type){case"background":return new W2(r,t);case"circle":return new Ew(r,t);case"color-relief":return new Fw(r,t);case"fill":return new Jw(r,t);case"fill-extrusion":return new c2(r,t);case"heatmap":return new Nw(r,t);case"hillshade":return new Lw(r,t);case"line":return new g2(r,t);case"raster":return new H2(r,t);case"symbol":return new rp(r,t)}},b.bK=Ei,b.bL=function(r,t){if(!r)return[{command:"setStyle",args:[t]}];let n=[];try{if(!st(r.version,t.version))return[{command:"setStyle",args:[t]}];st(r.center,t.center)||n.push({command:"setCenter",args:[t.center]}),st(r.state,t.state)||n.push({command:"setGlobalState",args:[t.state]}),st(r.centerAltitude,t.centerAltitude)||n.push({command:"setCenterAltitude",args:[t.centerAltitude]}),st(r.zoom,t.zoom)||n.push({command:"setZoom",args:[t.zoom]}),st(r.bearing,t.bearing)||n.push({command:"setBearing",args:[t.bearing]}),st(r.pitch,t.pitch)||n.push({command:"setPitch",args:[t.pitch]}),st(r.roll,t.roll)||n.push({command:"setRoll",args:[t.roll]}),st(r.sprite,t.sprite)||n.push({command:"setSprite",args:[t.sprite]}),st(r.glyphs,t.glyphs)||n.push({command:"setGlyphs",args:[t.glyphs]}),st(r.transition,t.transition)||n.push({command:"setTransition",args:[t.transition]}),st(r.light,t.light)||n.push({command:"setLight",args:[t.light]}),st(r.terrain,t.terrain)||n.push({command:"setTerrain",args:[t.terrain]}),st(r.sky,t.sky)||n.push({command:"setSky",args:[t.sky]}),st(r.projection,t.projection)||n.push({command:"setProjection",args:[t.projection]});const s={},u=[];(function(g,v,w,T){let P;for(P in v=v||{},g=g||{})Object.prototype.hasOwnProperty.call(g,P)&&(Object.prototype.hasOwnProperty.call(v,P)||wi(P,w,T));for(P in v)Object.prototype.hasOwnProperty.call(v,P)&&(Object.prototype.hasOwnProperty.call(g,P)?st(g[P],v[P])||(g[P].type==="geojson"&&v[P].type==="geojson"&&Oi(g,v,P)?vt(w,{command:"setGeoJSONSourceData",args:[P,v[P].data]}):ji(P,v,w,T)):Ht(P,v,w))})(r.sources,t.sources,u,s);const p=[];r.layers&&r.layers.forEach(g=>{"source"in g&&s[g.source]?n.push({command:"removeLayer",args:[g.id]}):p.push(g)}),n=n.concat(u),function(g,v,w){v=v||[];const T=(g=g||[]).map(Xt),P=v.map(Xt),E=g.reduce(Ci,{}),D=v.reduce(Ci,{}),R=T.slice(),B=Object.create(null);let V,G,Y,_e,ne;for(let ue=0,we=0;ue<T.length;ue++)V=T[ue],Object.prototype.hasOwnProperty.call(D,V)?we++:(vt(w,{command:"removeLayer",args:[V]}),R.splice(R.indexOf(V,we),1));for(let ue=0,we=0;ue<P.length;ue++)V=P[P.length-1-ue],R[R.length-1-ue]!==V&&(Object.prototype.hasOwnProperty.call(E,V)?(vt(w,{command:"removeLayer",args:[V]}),R.splice(R.lastIndexOf(V,R.length-we),1)):we++,_e=R[R.length-ue],vt(w,{command:"addLayer",args:[D[V],_e]}),R.splice(R.length-ue,0,V),B[V]=!0);for(let ue=0;ue<P.length;ue++)if(V=P[ue],G=E[V],Y=D[V],!B[V]&&!st(G,Y))if(st(G.source,Y.source)&&st(G["source-layer"],Y["source-layer"])&&st(G.type,Y.type)){for(ne in Vi(G.layout,Y.layout,w,V,null,"setLayoutProperty"),Vi(G.paint,Y.paint,w,V,null,"setPaintProperty"),st(G.filter,Y.filter)||vt(w,{command:"setFilter",args:[V,Y.filter]}),st(G.minzoom,Y.minzoom)&&st(G.maxzoom,Y.maxzoom)||vt(w,{command:"setLayerZoomRange",args:[V,Y.minzoom,Y.maxzoom]}),G)Object.prototype.hasOwnProperty.call(G,ne)&&ne!=="layout"&&ne!=="paint"&&ne!=="filter"&&ne!=="metadata"&&ne!=="minzoom"&&ne!=="maxzoom"&&(ne.indexOf("paint.")===0?Vi(G[ne],Y[ne],w,V,ne.slice(6),"setPaintProperty"):st(G[ne],Y[ne])||vt(w,{command:"setLayerProperty",args:[V,ne,Y[ne]]}));for(ne in Y)Object.prototype.hasOwnProperty.call(Y,ne)&&!Object.prototype.hasOwnProperty.call(G,ne)&&ne!=="layout"&&ne!=="paint"&&ne!=="filter"&&ne!=="metadata"&&ne!=="minzoom"&&ne!=="maxzoom"&&(ne.indexOf("paint.")===0?Vi(G[ne],Y[ne],w,V,ne.slice(6),"setPaintProperty"):st(G[ne],Y[ne])||vt(w,{command:"setLayerProperty",args:[V,ne,Y[ne]]}))}else vt(w,{command:"removeLayer",args:[V]}),_e=R[R.lastIndexOf(V)+1],vt(w,{command:"addLayer",args:[Y,_e]})}(p,t.layers,n)}catch(s){console.warn("Unable to compute style diff:",s),n=[{command:"setStyle",args:[t]}]}return n},b.bM=function(r){const t=[],n=r.id;return n===void 0&&t.push({message:`layers.${n}: missing required property "id"`}),r.render===void 0&&t.push({message:`layers.${n}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&t.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),t},b.bN=fr,b.bO=gr,b.bP=class extends ti{constructor(r,t){super(r,t),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}},b.bQ=Wd,b.bR=class extends ti{constructor(r,t){super(r,t),this.current=cf}set(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let t=1;t<16;t++)if(r[t]!==this.current[t]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}},b.bS=Gd,b.bT=class extends ti{constructor(r,t){super(r,t),this.current=[0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))}},b.bU=class extends ti{constructor(r,t){super(r,t),this.current=[0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))}},b.bV=De,b.bW=function(r,t){var n=Math.sin(t),s=Math.cos(t);return r[0]=s,r[1]=n,r[2]=0,r[3]=-n,r[4]=s,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},b.bX=function(r,t,n){var s=t[0],u=t[1],p=t[2];return r[0]=s*n[0]+u*n[3]+p*n[6],r[1]=s*n[1]+u*n[4]+p*n[7],r[2]=s*n[2]+u*n[5]+p*n[8],r},b.bY=function(r,t,n,s,u,p,g){var v=1/(t-n),w=1/(s-u),T=1/(p-g);return r[0]=-2*v,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*w,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*T,r[11]=0,r[12]=(t+n)*v,r[13]=(u+s)*w,r[14]=(g+p)*T,r[15]=1,r},b.bZ=class extends ti{constructor(r,t){super(r,t),this.current=new Array}set(r){if(r!=this.current){this.current=r;const t=new Float32Array(4*r.length);for(let n=0;n<r.length;n++)t[4*n]=r[n].r,t[4*n+1]=r[n].g,t[4*n+2]=r[n].b,t[4*n+3]=r[n].a;this.gl.uniform4fv(this.location,t)}}},b.b_=class extends ti{constructor(r,t){super(r,t),this.current=new Array}set(r){if(r!=this.current){this.current=r;const t=new Float32Array(r);this.gl.uniform1fv(this.location,t)}}},b.ba=function(){return new Float64Array(16)},b.bb=function(r,t,n){const s=new Float64Array(4);return Gn(s,r,t-90,n),s},b.bc=function(r,t,n,s){var u,p,g,v,w,T=t[0],P=t[1],E=t[2],D=t[3],R=n[0],B=n[1],V=n[2],G=n[3];return(p=T*R+P*B+E*V+D*G)<0&&(p=-p,R=-R,B=-B,V=-V,G=-G),1-p>oe?(u=Math.acos(p),g=Math.sin(u),v=Math.sin((1-s)*u)/g,w=Math.sin(s*u)/g):(v=1-s,w=s),r[0]=v*T+w*R,r[1]=v*P+w*B,r[2]=v*E+w*V,r[3]=v*D+w*G,r},b.bd=function(r){const t=new Float64Array(9);var n,s,u,p,g,v,w,T,P,E,D,R,B,V,G,Y,_e,ne;E=(u=(s=r)[0])*(w=u+u),D=(p=s[1])*w,B=(g=s[2])*w,V=g*(T=p+p),Y=(v=s[3])*w,_e=v*T,ne=v*(P=g+g),(n=t)[0]=1-(R=p*T)-(G=g*P),n[3]=D-ne,n[6]=B+_e,n[1]=D+ne,n[4]=1-E-G,n[7]=V-Y,n[2]=B-_e,n[5]=V+Y,n[8]=1-E-R;const ue=ht(-Math.asin(jt(t[2],-1,1)));let we,ke;return Math.hypot(t[5],t[8])<.001?(we=0,ke=-ht(Math.atan2(t[3],t[4]))):(we=ht(t[5]===0&&t[8]===0?0:Math.atan2(t[5],t[8])),ke=ht(t[1]===0&&t[0]===0?0:Math.atan2(t[1],t[0]))),{roll:we,pitch:ue+90,bearing:ke}},b.be=function(r,t){return r.roll==t.roll&&r.pitch==t.pitch&&r.bearing==t.bearing},b.bf=Tt,b.bg=Xl,b.bh=ic,b.bi=Xu,b.bj=tc,b.bk=Rt,b.bl=qi,b.bm=dn,b.bn=function(r,t,n,s,u){return Rt(s,u,jt((r-t)/(n-t),0,1))},b.bo=At,b.bp=function(){return new Float64Array(3)},b.bq=function(r,t,n,s){return r[0]=t[0]+n[0]*s,r[1]=t[1]+n[1]*s,r[2]=t[2]+n[2]*s,r},b.br=Gn,b.bs=function(r,t,n){var s=n[0],u=n[1],p=n[2],g=n[3],v=t[0],w=t[1],T=t[2],P=u*T-p*w,E=p*v-s*T,D=s*w-u*v;return r[0]=v+g*(P+=P)+u*(D+=D)-p*(E+=E),r[1]=w+g*E+p*P-s*D,r[2]=T+g*D+s*E-u*P,r},b.bt=function(r,t,n){const s=(u=[r[0],r[1],r[2],t[0],t[1],t[2],n[0],n[1],n[2]])[0]*((P=u[8])*(g=u[4])-(v=u[5])*(T=u[7]))+u[1]*(-P*(p=u[3])+v*(w=u[6]))+u[2]*(T*p-g*w);var u,p,g,v,w,T,P;if(s===0)return null;const E=di([],[t[0],t[1],t[2]],[n[0],n[1],n[2]]),D=di([],[n[0],n[1],n[2]],[r[0],r[1],r[2]]),R=di([],[r[0],r[1],r[2]],[t[0],t[1],t[2]]),B=mt([],E,-r[3]);return Lt(B,B,mt([],D,-t[3])),Lt(B,B,mt([],R,-n[3])),mt(B,B,1/s),B},b.bu=Rf,b.bv=function(){return new Float64Array(4)},b.bw=function(r,t,n,s){var u=[],p=[];return u[0]=t[0]-n[0],u[1]=t[1]-n[1],u[2]=t[2]-n[2],p[0]=u[0]*Math.cos(s)-u[1]*Math.sin(s),p[1]=u[0]*Math.sin(s)+u[1]*Math.cos(s),p[2]=u[2],r[0]=p[0]+n[0],r[1]=p[1]+n[1],r[2]=p[2]+n[2],r},b.bx=function(r,t,n,s){var u=[],p=[];return u[0]=t[0]-n[0],u[1]=t[1]-n[1],u[2]=t[2]-n[2],p[0]=u[0],p[1]=u[1]*Math.cos(s)-u[2]*Math.sin(s),p[2]=u[1]*Math.sin(s)+u[2]*Math.cos(s),r[0]=p[0]+n[0],r[1]=p[1]+n[1],r[2]=p[2]+n[2],r},b.by=function(r,t,n,s){var u=[],p=[];return u[0]=t[0]-n[0],u[1]=t[1]-n[1],u[2]=t[2]-n[2],p[0]=u[2]*Math.sin(s)+u[0]*Math.cos(s),p[1]=u[1],p[2]=u[2]*Math.cos(s)-u[0]*Math.sin(s),r[0]=p[0]+n[0],r[1]=p[1]+n[1],r[2]=p[2]+n[2],r},b.bz=function(r,t,n){var s=Math.sin(n),u=Math.cos(n),p=t[0],g=t[1],v=t[2],w=t[3],T=t[8],P=t[9],E=t[10],D=t[11];return t!==r&&(r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=p*u-T*s,r[1]=g*u-P*s,r[2]=v*u-E*s,r[3]=w*u-D*s,r[8]=p*s+T*u,r[9]=g*s+P*u,r[10]=v*s+E*u,r[11]=w*s+D*u,r},b.c=me,b.c0=x2,b.c1=class extends f{},b.c2=yf,b.c3=function(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))},b.c4=Oy,b.c5=function(r,t,n){var s=t[0],u=t[1],p=t[2],g=n[3]*s+n[7]*u+n[11]*p+n[15];return r[0]=(n[0]*s+n[4]*u+n[8]*p+n[12])/(g=g||1),r[1]=(n[1]*s+n[5]*u+n[9]*p+n[13])/g,r[2]=(n[2]*s+n[6]*u+n[10]*p+n[14])/g,r},b.c6=class extends to{},b.c7=class extends z{},b.c8=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]&&r[4]===t[4]&&r[5]===t[5]&&r[6]===t[6]&&r[7]===t[7]&&r[8]===t[8]&&r[9]===t[9]&&r[10]===t[10]&&r[11]===t[11]&&r[12]===t[12]&&r[13]===t[13]&&r[14]===t[14]&&r[15]===t[15]},b.c9=function(r,t){var n=r[0],s=r[1],u=r[2],p=r[3],g=r[4],v=r[5],w=r[6],T=r[7],P=r[8],E=r[9],D=r[10],R=r[11],B=r[12],V=r[13],G=r[14],Y=r[15],_e=t[0],ne=t[1],ue=t[2],we=t[3],ke=t[4],Re=t[5],qe=t[6],Ve=t[7],$e=t[8],at=t[9],Ue=t[10],Ze=t[11],Ee=t[12],pt=t[13],ft=t[14],ut=t[15];return Math.abs(n-_e)<=oe*Math.max(1,Math.abs(n),Math.abs(_e))&&Math.abs(s-ne)<=oe*Math.max(1,Math.abs(s),Math.abs(ne))&&Math.abs(u-ue)<=oe*Math.max(1,Math.abs(u),Math.abs(ue))&&Math.abs(p-we)<=oe*Math.max(1,Math.abs(p),Math.abs(we))&&Math.abs(g-ke)<=oe*Math.max(1,Math.abs(g),Math.abs(ke))&&Math.abs(v-Re)<=oe*Math.max(1,Math.abs(v),Math.abs(Re))&&Math.abs(w-qe)<=oe*Math.max(1,Math.abs(w),Math.abs(qe))&&Math.abs(T-Ve)<=oe*Math.max(1,Math.abs(T),Math.abs(Ve))&&Math.abs(P-$e)<=oe*Math.max(1,Math.abs(P),Math.abs($e))&&Math.abs(E-at)<=oe*Math.max(1,Math.abs(E),Math.abs(at))&&Math.abs(D-Ue)<=oe*Math.max(1,Math.abs(D),Math.abs(Ue))&&Math.abs(R-Ze)<=oe*Math.max(1,Math.abs(R),Math.abs(Ze))&&Math.abs(B-Ee)<=oe*Math.max(1,Math.abs(B),Math.abs(Ee))&&Math.abs(V-pt)<=oe*Math.max(1,Math.abs(V),Math.abs(pt))&&Math.abs(G-ft)<=oe*Math.max(1,Math.abs(G),Math.abs(ft))&&Math.abs(Y-ut)<=oe*Math.max(1,Math.abs(Y),Math.abs(ut))},b.cA=function(r,t){j.REGISTERED_PROTOCOLS[r]=t},b.cB=function(r){delete j.REGISTERED_PROTOCOLS[r]},b.cC=function(r,t){const n={};for(let u=0;u<r.length;u++){const p=t&&t[r[u].id]||Td(r[u]);t&&(t[r[u].id]=p);let g=n[p];g||(g=n[p]=[]),g.push(r[u])}const s=[];for(const u in n)s.push(n[u]);return s},b.cD=Ke,b.cE=F_,b.cF=j_,b.cG=f_,b.cH=function(r){r.bucket.createArrays(),r.bucket.tilePixelRatio=He/(512*r.bucket.overscaling),r.bucket.compareText={},r.bucket.iconsNeedLinear=!1;const t=r.bucket.layers[0],n=t.layout,s=t._unevaluatedLayout._values,u={layoutIconSize:s["icon-size"].possiblyEvaluate(new Ot(r.bucket.zoom+1),r.canonical),layoutTextSize:s["text-size"].possiblyEvaluate(new Ot(r.bucket.zoom+1),r.canonical),textMaxSize:s["text-size"].possiblyEvaluate(new Ot(18))};if(r.bucket.textSizeData.kind==="composite"){const{minZoom:T,maxZoom:P}=r.bucket.textSizeData;u.compositeTextSizes=[s["text-size"].possiblyEvaluate(new Ot(T),r.canonical),s["text-size"].possiblyEvaluate(new Ot(P),r.canonical)]}if(r.bucket.iconSizeData.kind==="composite"){const{minZoom:T,maxZoom:P}=r.bucket.iconSizeData;u.compositeIconSizes=[s["icon-size"].possiblyEvaluate(new Ot(T),r.canonical),s["icon-size"].possiblyEvaluate(new Ot(P),r.canonical)]}const p=n.get("text-line-height")*Ki,g=n.get("text-rotation-alignment")!=="viewport"&&n.get("symbol-placement")!=="point",v=n.get("text-keep-upright"),w=n.get("text-size");for(const T of r.bucket.features){const P=n.get("text-font").evaluate(T,{},r.canonical).join(","),E=w.evaluate(T,{},r.canonical),D=u.layoutTextSize.evaluate(T,{},r.canonical),R=u.layoutIconSize.evaluate(T,{},r.canonical),B={horizontal:{},vertical:void 0},V=T.text;let G,Y=[0,0];if(V){const ue=V.toString(),we=n.get("text-letter-spacing").evaluate(T,{},r.canonical)*Ki,ke=Rd(ue)?we:0,Re=n.get("text-anchor").evaluate(T,{},r.canonical),qe=K_(t,T,r.canonical);if(!qe){const Ue=n.get("text-radial-offset").evaluate(T,{},r.canonical);Y=Ue?X_(Re,[Ue*Ki,jf]):n.get("text-offset").evaluate(T,{},r.canonical).map(Ze=>Ze*Ki)}let Ve=g?"center":n.get("text-justify").evaluate(T,{},r.canonical);const $e=n.get("symbol-placement")==="point"?n.get("text-max-width").evaluate(T,{},r.canonical)*Ki:1/0,at=()=>{r.bucket.allowVerticalPlacement&&Eu(ue)&&(B.vertical=tp(V,r.glyphMap,r.glyphPositions,r.imagePositions,P,$e,p,Re,"left",ke,Y,b.ao.vertical,!0,D,E))};if(!g&&qe){const Ue=new Set;if(Ve==="auto")for(let Ee=0;Ee<qe.values.length;Ee+=2)Ue.add(Of(qe.values[Ee]));else Ue.add(Ve);let Ze=!1;for(const Ee of Ue)if(!B.horizontal[Ee])if(Ze)B.horizontal[Ee]=B.horizontal[0];else{const pt=tp(V,r.glyphMap,r.glyphPositions,r.imagePositions,P,$e,p,"center",Ee,ke,Y,b.ao.horizontal,!1,D,E);pt&&(B.horizontal[Ee]=pt,Ze=pt.positionedLines.length===1)}at()}else{Ve==="auto"&&(Ve=Of(Re));const Ue=tp(V,r.glyphMap,r.glyphPositions,r.imagePositions,P,$e,p,Re,Ve,ke,Y,b.ao.horizontal,!1,D,E);Ue&&(B.horizontal[Ve]=Ue),at(),Eu(ue)&&g&&v&&(B.vertical=tp(V,r.glyphMap,r.glyphPositions,r.imagePositions,P,$e,p,Re,Ve,ke,Y,b.ao.vertical,!1,D,E))}}let _e=!1;if(T.icon&&T.icon.name){const ue=r.imageMap[T.icon.name];ue&&(G=U2(r.imagePositions[T.icon.name],n.get("icon-offset").evaluate(T,{},r.canonical),n.get("icon-anchor").evaluate(T,{},r.canonical)),_e=!!ue.sdf,r.bucket.sdfIcons===void 0?r.bucket.sdfIcons=_e:r.bucket.sdfIcons!==_e&&li("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ue.pixelRatio!==r.bucket.pixelRatio||n.get("icon-rotate").constantOr(1)!==0)&&(r.bucket.iconsNeedLinear=!0))}const ne=J_(B.horizontal)||B.vertical;r.bucket.iconsInText=!!ne&&ne.iconsInText,(ne||G)&&rC(r.bucket,T,B,G,r.imageMap,u,D,R,Y,_e,r.canonical,r.subdivisionGranularity)}r.showCollisionBoxes&&r.bucket.generateCollisionDebugBuffers()},b.cI=wf,b.cJ=If,b.cK=Af,b.cL=t_,b.cM=Tf,b.cN=class{constructor(r){this._marks={start:[r.url,"start"].join("#"),end:[r.url,"end"].join("#"),measure:r.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let r=performance.getEntriesByName(this._marks.measure);return r.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),r=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),r}},b.cO=function(r,t,n,s,u){return c(this,void 0,void 0,function*(){if(he())try{return yield yr(r,t,n,s,u)}catch{}return function(p,g,v,w,T){const P=p.width,E=p.height;Dr&&Lr||(Dr=new OffscreenCanvas(P,E),Lr=Dr.getContext("2d",{willReadFrequently:!0})),Dr.width=P,Dr.height=E,Lr.drawImage(p,0,0,P,E);const D=Lr.getImageData(g,v,w,T);return Lr.clearRect(0,0,P,E),D.data}(r,t,n,s,u)})},b.cP=$y,b.cQ=W,b.cR=e_,b.cS=nc,b.cT=Is,b.cU=function(r,t){const n=new Map;if(r!=null)if(r.type==="Feature")n.set(ih(r,t),r);else for(const s of r.features)n.set(ih(s,t),s);return n},b.cV=function(r,t){if(r==null)return!0;if(r.type==="Feature")return ih(r,t)!=null;if(r.type==="FeatureCollection"){const n=new Set;for(const s of r.features){const u=ih(s,t);if(u==null||n.has(u))return!1;n.add(u)}return!0}return!1},b.cW=function(r,t,n){var s,u,p,g;if(t.removeAll&&r.clear(),t.remove)for(const v of t.remove)r.delete(v);if(t.add)for(const v of t.add){const w=ih(v,n);w!=null&&r.set(w,v)}if(t.update)for(const v of t.update){let w=r.get(v.id);if(w==null)continue;const T=!v.removeAllProperties&&(((s=v.removeProperties)===null||s===void 0?void 0:s.length)>0||((u=v.addOrUpdateProperties)===null||u===void 0?void 0:u.length)>0);if((v.newGeometry||v.removeAllProperties||T)&&(w=Object.assign({},w),r.set(v.id,w),T&&(w.properties=Object.assign({},w.properties))),v.newGeometry&&(w.geometry=v.newGeometry),v.removeAllProperties)w.properties={};else if(((p=v.removeProperties)===null||p===void 0?void 0:p.length)>0)for(const P of v.removeProperties)Object.prototype.hasOwnProperty.call(w.properties,P)&&delete w.properties[P];if(((g=v.addOrUpdateProperties)===null||g===void 0?void 0:g.length)>0)for(const{key:P,value:E}of v.addOrUpdateProperties)w.properties[P]=E}},b.cX=ba,b.ca=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},b.cb=r=>r.type==="symbol",b.cc=r=>r.type==="circle",b.cd=r=>r.type==="heatmap",b.ce=r=>r.type==="line",b.cf=r=>r.type==="fill",b.cg=r=>r.type==="fill-extrusion",b.ch=r=>r.type==="hillshade",b.ci=r=>r.type==="color-relief",b.cj=r=>r.type==="raster",b.ck=r=>r.type==="background",b.cl=r=>r.type==="custom",b.cm=pi,b.cn=function(r,t,n){const s=Qe(t.x-n.x,t.y-n.y),u=Qe(r.x-n.x,r.y-n.y);var p,g;return ht(Math.atan2(s[0]*u[1]-s[1]*u[0],(p=s)[0]*(g=u)[0]+p[1]*g[1]))},b.co=En,b.cp=function(r,t){return Gt[t]&&(r instanceof MouseEvent||r instanceof WheelEvent)},b.cq=function(r,t){return Vt[t]&&"touches"in r},b.cr=function(r){return Vt[r]||Gt[r]},b.cs=function(r,t,n){var s=t[0],u=t[1];return r[0]=n[0]*s+n[4]*u+n[12],r[1]=n[1]*s+n[5]*u+n[13],r},b.ct=function(r,t){const{x:n,y:s}=th.fromLngLat(t);return!(r<0||r>25||s<0||s>=1||n<0||n>=1)},b.cu=function(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=t[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},b.cv=class extends eo{},b.cw=oC,b.cy=function(r){return r.message===zi},b.cz=ee,b.d=xe,b.e=vn,b.f=r=>c(void 0,void 0,void 0,function*(){if(r.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(r)],{type:"image/png"});try{return createImageBitmap(t)}catch(n){throw new Error(`Could not load image because of ${n.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),b.g=O,b.h=r=>new Promise((t,n)=>{const s=new Image;s.onload=()=>{t(s),URL.revokeObjectURL(s.src),s.onload=null,window.requestAnimationFrame(()=>{s.src=xn})},s.onerror=()=>n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const u=new Blob([new Uint8Array(r)],{type:"image/png"});s.src=r.byteLength?URL.createObjectURL(u):xn}),b.i=Wn,b.j=(r,t)=>ge(vn(r,{type:"json"}),t),b.k=ze,b.l=Fe,b.m=ge,b.n=(r,t)=>ge(vn(r,{type:"arrayBuffer"}),t),b.o=function(r){return new Tf(r).readFields(E2,[])},b.p=m_,b.q=Zu,b.r=mn,b.s=Rr,b.t=Ru,b.u=Mt,b.v=ve,b.w=li,b.x=zs,b.y=Ld,b.z=zo}),x("worker",["./shared"],function(b){class c{constructor(j,O){this.keyCache={},j&&this.replace(j,O)}replace(j,O){this._layerConfigs={},this._layers={},this.update(j,[],O)}update(j,O,Z){for(const le of j){this._layerConfigs[le.id]=le;const ge=this._layers[le.id]=b.bJ(le,Z);ge._featureFilter=b.aa(ge.filter,Z),this.keyCache[le.id]&&delete this.keyCache[le.id]}for(const le of O)delete this.keyCache[le],delete this._layerConfigs[le],delete this._layers[le];this.familiesBySource={};const ee=b.cC(Object.values(this._layerConfigs),this.keyCache);for(const le of ee){const ge=le.map(it=>this._layers[it.id]),xe=ge[0];if(xe.visibility==="none")continue;const ye=xe.source||"";let Pe=this.familiesBySource[ye];Pe||(Pe=this.familiesBySource[ye]={});const Fe=xe.sourceLayer||"_geojsonTileLayer";let ze=Pe[Fe];ze||(ze=Pe[Fe]=[]),ze.push(ge)}}}class F{constructor(j){const O={},Z=[];for(const xe in j){const ye=j[xe],Pe=O[xe]={};for(const Fe in ye){const ze=ye[+Fe];if(!ze||ze.bitmap.width===0||ze.bitmap.height===0)continue;const it={x:0,y:0,w:ze.bitmap.width+2,h:ze.bitmap.height+2};Z.push(it),Pe[Fe]={rect:it,metrics:ze.metrics}}}const{w:ee,h:le}=b.p(Z),ge=new b.q({width:ee||1,height:le||1});for(const xe in j){const ye=j[xe];for(const Pe in ye){const Fe=ye[+Pe];if(!Fe||Fe.bitmap.width===0||Fe.bitmap.height===0)continue;const ze=O[xe][Pe].rect;b.q.copy(Fe.bitmap,ge,{x:0,y:0},{x:ze.x+1,y:ze.y+1},Fe.bitmap)}}this.image=ge,this.positions=O}}b.cD("GlyphAtlas",F);class W{constructor(j){this.tileID=new b.Z(j.tileID.overscaledZ,j.tileID.wrap,j.tileID.canonical.z,j.tileID.canonical.x,j.tileID.canonical.y),this.uid=j.uid,this.zoom=j.zoom,this.pixelRatio=j.pixelRatio,this.tileSize=j.tileSize,this.source=j.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=j.showCollisionBoxes,this.collectResourceTiming=!!j.collectResourceTiming,this.returnDependencies=!!j.returnDependencies,this.promoteId=j.promoteId,this.inFlightDependencies=[]}parse(j,O,Z,ee,le){return b._(this,void 0,void 0,function*(){this.status="parsing",this.data=j,this.collisionBoxArray=new b.a8;const ge=new b.cE(Object.keys(j.layers).sort()),xe=new b.cF(this.tileID,this.promoteId);xe.bucketLayerIDs=[];const ye={},Pe={featureIndex:xe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:Z,subdivisionGranularity:le},Fe=O.familiesBySource[this.source];for(const Ne in Fe){const Ii=j.layers[Ne];if(!Ii)continue;Ii.version===1&&b.w(`Vector tile source "${this.source}" layer "${Ne}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const qn=ge.encode(Ne),Na=[];for(let hn=0;hn<Ii.length;hn++){const je=Ii.feature(hn),xt=xe.getId(je,Ne);Na.push({feature:je,id:xt,index:hn,sourceLayerIndex:qn})}for(const hn of Fe[Ne]){const je=hn[0];je.source!==this.source&&b.w(`layer.source = ${je.source} does not equal this.source = ${this.source}`),je.minzoom&&this.zoom<Math.floor(je.minzoom)||je.maxzoom&&this.zoom>=je.maxzoom||je.visibility!=="none"&&(se(hn,this.zoom,Z),(ye[je.id]=je.createBucket({index:xe.bucketLayerIDs.length,layers:hn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:qn,sourceID:this.source})).populate(Na,Pe,this.tileID.canonical),xe.bucketLayerIDs.push(hn.map(xt=>xt.id)))}}const ze=b.bN(Pe.glyphDependencies,Ne=>Object.keys(Ne).map(Number));this.inFlightDependencies.forEach(Ne=>Ne==null?void 0:Ne.abort()),this.inFlightDependencies=[];let it=Promise.resolve({});if(Object.keys(ze).length){const Ne=new AbortController;this.inFlightDependencies.push(Ne),it=ee.sendAsync({type:"GG",data:{stacks:ze,source:this.source,tileID:this.tileID,type:"glyphs"}},Ne)}const ve=Object.keys(Pe.iconDependencies);let gt=Promise.resolve({});if(ve.length){const Ne=new AbortController;this.inFlightDependencies.push(Ne),gt=ee.sendAsync({type:"GI",data:{icons:ve,source:this.source,tileID:this.tileID,type:"icons"}},Ne)}const Pt=Object.keys(Pe.patternDependencies);let st=Promise.resolve({});if(Pt.length){const Ne=new AbortController;this.inFlightDependencies.push(Ne),st=ee.sendAsync({type:"GI",data:{icons:Pt,source:this.source,tileID:this.tileID,type:"patterns"}},Ne)}const vt=Pe.dashDependencies;let Ht=Promise.resolve({});if(Object.keys(vt).length){const Ne=new AbortController;this.inFlightDependencies.push(Ne),Ht=ee.sendAsync({type:"GDA",data:{dashes:vt}},Ne)}const[wi,ji,Oi,Vi]=yield Promise.all([it,gt,st,Ht]),Xt=new F(wi),Ci=new b.cG(ji,Oi);for(const Ne in ye){const Ii=ye[Ne];Ii instanceof b.a9?(se(Ii.layers,this.zoom,Z),b.cH({bucket:Ii,glyphMap:wi,glyphPositions:Xt.positions,imageMap:ji,imagePositions:Ci.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Pe.subdivisionGranularity})):Ii.hasDependencies&&(Ii instanceof b.cI||Ii instanceof b.cJ||Ii instanceof b.cK)&&(se(Ii.layers,this.zoom,Z),Ii.addFeatures(Pe,this.tileID.canonical,Ci.patternPositions,Vi))}return this.status="done",{buckets:Object.values(ye).filter(Ne=>!Ne.isEmpty()),featureIndex:xe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Xt.image,imageAtlas:Ci,dashPositions:Vi,glyphMap:this.returnDependencies?wi:null,iconMap:this.returnDependencies?ji:null,glyphPositions:this.returnDependencies?Xt.positions:null}})}}function se(me,j,O){const Z=new b.F(j);for(const ee of me)ee.recalculate(Z,O)}class re{constructor(j,O,Z){this.actor=j,this.layerIndex=O,this.availableImages=Z,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(j,O){return b._(this,void 0,void 0,function*(){const Z=yield b.n(j.request,O);try{return{vectorTile:new b.cL(new b.cM(Z.data)),rawData:Z.data,cacheControl:Z.cacheControl,expires:Z.expires}}catch(ee){const le=new Uint8Array(Z.data);let ge=`Unable to parse the tile at ${j.request.url}, `;throw ge+=le[0]===31&&le[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ee.message}`,new Error(ge)}})}loadTile(j){return b._(this,void 0,void 0,function*(){const O=j.uid,Z=!!(j&&j.request&&j.request.collectResourceTiming)&&new b.cN(j.request),ee=new W(j);this.loading[O]=ee;const le=new AbortController;ee.abort=le;try{const ge=yield this.loadVectorTile(j,le);if(delete this.loading[O],!ge)return null;const xe=ge.rawData,ye={};ge.expires&&(ye.expires=ge.expires),ge.cacheControl&&(ye.cacheControl=ge.cacheControl);const Pe={};if(Z){const ze=Z.finish();ze&&(Pe.resourceTiming=JSON.parse(JSON.stringify(ze)))}ee.vectorTile=ge.vectorTile;const Fe=ee.parse(ge.vectorTile,this.layerIndex,this.availableImages,this.actor,j.subdivisionGranularity);this.loaded[O]=ee,this.fetching[O]={rawTileData:xe,cacheControl:ye,resourceTiming:Pe};try{const ze=yield Fe;return b.e({rawTileData:xe.slice(0)},ze,ye,Pe)}finally{delete this.fetching[O]}}catch(ge){throw delete this.loading[O],ee.status="done",this.loaded[O]=ee,ge}})}reloadTile(j){return b._(this,void 0,void 0,function*(){const O=j.uid;if(!this.loaded||!this.loaded[O])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const Z=this.loaded[O];if(Z.showCollisionBoxes=j.showCollisionBoxes,Z.status==="parsing"){const ee=yield Z.parse(Z.vectorTile,this.layerIndex,this.availableImages,this.actor,j.subdivisionGranularity);let le;if(this.fetching[O]){const{rawTileData:ge,cacheControl:xe,resourceTiming:ye}=this.fetching[O];delete this.fetching[O],le=b.e({rawTileData:ge.slice(0)},ee,xe,ye)}else le=ee;return le}if(Z.status==="done"&&Z.vectorTile)return Z.parse(Z.vectorTile,this.layerIndex,this.availableImages,this.actor,j.subdivisionGranularity)})}abortTile(j){return b._(this,void 0,void 0,function*(){const O=this.loading,Z=j.uid;O&&O[Z]&&O[Z].abort&&(O[Z].abort.abort(),delete O[Z])})}removeTile(j){return b._(this,void 0,void 0,function*(){this.loaded&&this.loaded[j.uid]&&delete this.loaded[j.uid]})}}class ce{constructor(){this.loaded={}}loadTile(j){return b._(this,void 0,void 0,function*(){const{uid:O,encoding:Z,rawImageData:ee,redFactor:le,greenFactor:ge,blueFactor:xe,baseShift:ye}=j,Pe=ee.width+2,Fe=ee.height+2,ze=b.b(ee)?new b.R({width:Pe,height:Fe},yield b.cO(ee,-1,-1,Pe,Fe)):ee,it=new b.cP(O,ze,Z,le,ge,xe,ye);return this.loaded=this.loaded||{},this.loaded[O]=it,it})}removeTile(j){const O=this.loaded,Z=j.uid;O&&O[Z]&&delete O[Z]}}var K,Ie,Te=function(){if(Ie)return K;function me(O,Z){if(O.length!==0){j(O[0],Z);for(var ee=1;ee<O.length;ee++)j(O[ee],!Z)}}function j(O,Z){for(var ee=0,le=0,ge=0,xe=O.length,ye=xe-1;ge<xe;ye=ge++){var Pe=(O[ge][0]-O[ye][0])*(O[ye][1]+O[ge][1]),Fe=ee+Pe;le+=Math.abs(ee)>=Math.abs(Pe)?ee-Fe+Pe:Pe-Fe+ee,ee=Fe}ee+le>=0!=!!Z&&O.reverse()}return Ie=1,K=function O(Z,ee){var le,ge=Z&&Z.type;if(ge==="FeatureCollection")for(le=0;le<Z.features.length;le++)O(Z.features[le],ee);else if(ge==="GeometryCollection")for(le=0;le<Z.geometries.length;le++)O(Z.geometries[le],ee);else if(ge==="Feature")O(Z.geometry,ee);else if(ge==="Polygon")me(Z.coordinates,ee);else if(ge==="MultiPolygon")for(le=0;le<Z.coordinates.length;le++)me(Z.coordinates[le],ee);return Z}}(),We=b.cQ(Te);class he extends b.cS{constructor(j,O){super(new b.cM,0,O,[],[]),this.feature=j,this.type=j.type,this.properties=j.tags?j.tags:{},"id"in j&&(typeof j.id=="string"?this.id=parseInt(j.id,10):typeof j.id!="number"||isNaN(j.id)||(this.id=j.id))}loadGeometry(){const j=[],O=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const Z of O){const ee=[];for(const le of Z)ee.push(new b.P(le[0],le[1]));j.push(ee)}return j}}class oe extends b.cR{constructor(j,O){super(new b.cM),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=O?O.version:1,this.extent=O?O.extent:4096,this.length=j.length,this.features=j}feature(j){return new he(this.features[j],this.extent)}}function fe(me,j){j.writeVarintField(15,me.version||1),j.writeStringField(1,me.name||""),j.writeVarintField(5,me.extent||4096);const O={keys:[],values:[],keycache:{},valuecache:{}};for(let le=0;le<me.length;le++)O.feature=me.feature(le),j.writeMessage(2,De,O);const Z=O.keys;for(const le of Z)j.writeStringField(3,le);const ee=O.values;for(const le of ee)j.writeMessage(4,Lt,le)}function De(me,j){if(!me.feature)return;const O=me.feature;O.id!==void 0&&j.writeVarintField(1,O.id),j.writeMessage(2,Xe,me),j.writeVarintField(3,O.type),j.writeMessage(4,lt,O)}function Xe(me,j){var O;for(const Z in(O=me.feature)==null?void 0:O.properties){let ee=me.feature.properties[Z],le=me.keycache[Z];if(ee===null)continue;le===void 0&&(me.keys.push(Z),le=me.keys.length-1,me.keycache[Z]=le),j.writeVarint(le),typeof ee!="string"&&typeof ee!="boolean"&&typeof ee!="number"&&(ee=JSON.stringify(ee));const ge=typeof ee+":"+ee;let xe=me.valuecache[ge];xe===void 0&&(me.values.push(ee),xe=me.values.length-1,me.valuecache[ge]=xe),j.writeVarint(xe)}}function tt(me,j){return(j<<3)+(7&me)}function et(me){return me<<1^me>>31}function lt(me,j){const O=me.loadGeometry(),Z=me.type;let ee=0,le=0;for(const ge of O){let xe=1;Z===1&&(xe=ge.length),j.writeVarint(tt(1,xe));const ye=Z===3?ge.length-1:ge.length;for(let Pe=0;Pe<ye;Pe++){Pe===1&&Z!==1&&j.writeVarint(tt(2,ye-1));const Fe=ge[Pe].x-ee,ze=ge[Pe].y-le;j.writeVarint(et(Fe)),j.writeVarint(et(ze)),ee+=Fe,le+=ze}me.type===3&&j.writeVarint(tt(7,1))}}function Lt(me,j){const O=typeof me;O==="string"?j.writeStringField(1,me):O==="boolean"?j.writeBooleanField(7,me):O==="number"&&(me%1!=0?j.writeDoubleField(3,me):me<0?j.writeSVarintField(6,me):j.writeVarintField(5,me))}const mt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:me=>me},di=Math.fround||(Mi=new Float32Array(1),me=>(Mi[0]=+me,Mi[0]));var Mi;class Bi{constructor(j){this.options=Object.assign(Object.create(mt),j),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(j){const{log:O,minZoom:Z,maxZoom:ee}=this.options;O&&console.time("total time");const le=`prepare ${j.length} points`;O&&console.time(le),this.points=j;const ge=[];for(let ye=0;ye<j.length;ye++){const Pe=j[ye];if(!Pe.geometry)continue;const[Fe,ze]=Pe.geometry.coordinates,it=di(Gn(Fe)),ve=di(Mn(ze));ge.push(it,ve,1/0,ye,-1,1),this.options.reduce&&ge.push(0)}let xe=this.trees[ee+1]=this._createTree(ge);O&&console.timeEnd(le);for(let ye=ee;ye>=Z;ye--){const Pe=+Date.now();xe=this.trees[ye]=this._createTree(this._cluster(xe,ye)),O&&console.log("z%d: %d clusters in %dms",ye,xe.numItems,+Date.now()-Pe)}return O&&console.timeEnd("total time"),this}getClusters(j,O){let Z=((j[0]+180)%360+360)%360-180;const ee=Math.max(-90,Math.min(90,j[1]));let le=j[2]===180?180:((j[2]+180)%360+360)%360-180;const ge=Math.max(-90,Math.min(90,j[3]));if(j[2]-j[0]>=360)Z=-180,le=180;else if(Z>le){const ze=this.getClusters([Z,ee,180,ge],O),it=this.getClusters([-180,ee,le,ge],O);return ze.concat(it)}const xe=this.trees[this._limitZoom(O)],ye=xe.range(Gn(Z),Mn(ge),Gn(le),Mn(ee)),Pe=xe.data,Fe=[];for(const ze of ye){const it=this.stride*ze;Fe.push(Pe[it+5]>1?si(Pe,it,this.clusterProps):this.points[Pe[it+3]])}return Fe}getChildren(j){const O=this._getOriginId(j),Z=this._getOriginZoom(j),ee="No cluster with the specified id.",le=this.trees[Z];if(!le)throw new Error(ee);const ge=le.data;if(O*this.stride>=ge.length)throw new Error(ee);const xe=this.options.radius/(this.options.extent*Math.pow(2,Z-1)),ye=le.within(ge[O*this.stride],ge[O*this.stride+1],xe),Pe=[];for(const Fe of ye){const ze=Fe*this.stride;ge[ze+4]===j&&Pe.push(ge[ze+5]>1?si(ge,ze,this.clusterProps):this.points[ge[ze+3]])}if(Pe.length===0)throw new Error(ee);return Pe}getLeaves(j,O,Z){const ee=[];return this._appendLeaves(ee,j,O=O||10,Z=Z||0,0),ee}getTile(j,O,Z){const ee=this.trees[this._limitZoom(j)],le=Math.pow(2,j),{extent:ge,radius:xe}=this.options,ye=xe/ge,Pe=(Z-ye)/le,Fe=(Z+1+ye)/le,ze={features:[]};return this._addTileFeatures(ee.range((O-ye)/le,Pe,(O+1+ye)/le,Fe),ee.data,O,Z,le,ze),O===0&&this._addTileFeatures(ee.range(1-ye/le,Pe,1,Fe),ee.data,le,Z,le,ze),O===le-1&&this._addTileFeatures(ee.range(0,Pe,ye/le,Fe),ee.data,-1,Z,le,ze),ze.features.length?ze:null}getClusterExpansionZoom(j){let O=this._getOriginZoom(j)-1;for(;O<=this.options.maxZoom;){const Z=this.getChildren(j);if(O++,Z.length!==1)break;j=Z[0].properties.cluster_id}return O}_appendLeaves(j,O,Z,ee,le){const ge=this.getChildren(O);for(const xe of ge){const ye=xe.properties;if(ye&&ye.cluster?le+ye.point_count<=ee?le+=ye.point_count:le=this._appendLeaves(j,ye.cluster_id,Z,ee,le):le<ee?le++:j.push(xe),j.length===Z)break}return le}_createTree(j){const O=new b.aI(j.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Z=0;Z<j.length;Z+=this.stride)O.add(j[Z],j[Z+1]);return O.finish(),O.data=j,O}_addTileFeatures(j,O,Z,ee,le,ge){for(const xe of j){const ye=xe*this.stride,Pe=O[ye+5]>1;let Fe,ze,it;if(Pe)Fe=_i(O,ye,this.clusterProps),ze=O[ye],it=O[ye+1];else{const Pt=this.points[O[ye+3]];Fe=Pt.properties;const[st,vt]=Pt.geometry.coordinates;ze=Gn(st),it=Mn(vt)}const ve={type:1,geometry:[[Math.round(this.options.extent*(ze*le-Z)),Math.round(this.options.extent*(it*le-ee))]],tags:Fe};let gt;gt=Pe||this.options.generateId?O[ye+3]:this.points[O[ye+3]].id,gt!==void 0&&(ve.id=gt),ge.features.push(ve)}}_limitZoom(j){return Math.max(this.options.minZoom,Math.min(Math.floor(+j),this.options.maxZoom+1))}_cluster(j,O){const{radius:Z,extent:ee,reduce:le,minPoints:ge}=this.options,xe=Z/(ee*Math.pow(2,O)),ye=j.data,Pe=[],Fe=this.stride;for(let ze=0;ze<ye.length;ze+=Fe){if(ye[ze+2]<=O)continue;ye[ze+2]=O;const it=ye[ze],ve=ye[ze+1],gt=j.within(ye[ze],ye[ze+1],xe),Pt=ye[ze+5];let st=Pt;for(const vt of gt){const Ht=vt*Fe;ye[Ht+2]>O&&(st+=ye[Ht+5])}if(st>Pt&&st>=ge){let vt,Ht=it*Pt,wi=ve*Pt,ji=-1;const Oi=(ze/Fe<<5)+(O+1)+this.points.length;for(const Vi of gt){const Xt=Vi*Fe;if(ye[Xt+2]<=O)continue;ye[Xt+2]=O;const Ci=ye[Xt+5];Ht+=ye[Xt]*Ci,wi+=ye[Xt+1]*Ci,ye[Xt+4]=Oi,le&&(vt||(vt=this._map(ye,ze,!0),ji=this.clusterProps.length,this.clusterProps.push(vt)),le(vt,this._map(ye,Xt)))}ye[ze+4]=Oi,Pe.push(Ht/st,wi/st,1/0,Oi,-1,st),le&&Pe.push(ji)}else{for(let vt=0;vt<Fe;vt++)Pe.push(ye[ze+vt]);if(st>1)for(const vt of gt){const Ht=vt*Fe;if(!(ye[Ht+2]<=O)){ye[Ht+2]=O;for(let wi=0;wi<Fe;wi++)Pe.push(ye[Ht+wi])}}}}return Pe}_getOriginId(j){return j-this.points.length>>5}_getOriginZoom(j){return(j-this.points.length)%32}_map(j,O,Z){if(j[O+5]>1){const ge=this.clusterProps[j[O+6]];return Z?Object.assign({},ge):ge}const ee=this.points[j[O+3]].properties,le=this.options.map(ee);return Z&&le===ee?Object.assign({},le):le}}function si(me,j,O){return{type:"Feature",id:me[j+3],properties:_i(me,j,O),geometry:{type:"Point",coordinates:[(Z=me[j],360*(Z-.5)),Qe(me[j+1])]}};var Z}function _i(me,j,O){const Z=me[j+5],ee=Z>=1e4?`${Math.round(Z/1e3)}k`:Z>=1e3?Math.round(Z/100)/10+"k":Z,le=me[j+6],ge=le===-1?{}:Object.assign({},O[le]);return Object.assign(ge,{cluster:!0,cluster_id:me[j+3],point_count:Z,point_count_abbreviated:ee})}function Gn(me){return me/360+.5}function Mn(me){const j=Math.sin(me*Math.PI/180),O=.5-.25*Math.log((1+j)/(1-j))/Math.PI;return O<0?0:O>1?1:O}function Qe(me){const j=(180-360*me)*Math.PI/180;return 360*Math.atan(Math.exp(j))/Math.PI-90}function He(me,j,O,Z){let ee=Z;const le=j+(O-j>>1);let ge,xe=O-j;const ye=me[j],Pe=me[j+1],Fe=me[O],ze=me[O+1];for(let it=j+3;it<O;it+=3){const ve=yt(me[it],me[it+1],ye,Pe,Fe,ze);if(ve>ee)ge=it,ee=ve;else if(ve===ee){const gt=Math.abs(it-le);gt<xe&&(ge=it,xe=gt)}}ee>Z&&(ge-j>3&&He(me,j,ge,Z),me[ge+2]=ee,O-ge>3&&He(me,ge,O,Z))}function yt(me,j,O,Z,ee,le){let ge=ee-O,xe=le-Z;if(ge!==0||xe!==0){const ye=((me-O)*ge+(j-Z)*xe)/(ge*ge+xe*xe);ye>1?(O=ee,Z=le):ye>0&&(O+=ge*ye,Z+=xe*ye)}return ge=me-O,xe=j-Z,ge*ge+xe*xe}function At(me,j,O,Z){const ee={id:me??null,type:j,geometry:O,tags:Z,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(j==="Point"||j==="MultiPoint"||j==="LineString")Rt(ee,O);else if(j==="Polygon")Rt(ee,O[0]);else if(j==="MultiLineString")for(const le of O)Rt(ee,le);else if(j==="MultiPolygon")for(const le of O)Rt(ee,le[0]);return ee}function Rt(me,j){for(let O=0;O<j.length;O+=3)me.minX=Math.min(me.minX,j[O]),me.minY=Math.min(me.minY,j[O+1]),me.maxX=Math.max(me.maxX,j[O]),me.maxY=Math.max(me.maxY,j[O+1])}function qi(me,j,O,Z){if(!j.geometry)return;const ee=j.geometry.coordinates;if(ee&&ee.length===0)return;const le=j.geometry.type,ge=Math.pow(O.tolerance/((1<<O.maxZoom)*O.extent),2);let xe=[],ye=j.id;if(O.promoteId?ye=j.properties[O.promoteId]:O.generateId&&(ye=Z||0),le==="Point")pi(ee,xe);else if(le==="MultiPoint")for(const Pe of ee)pi(Pe,xe);else if(le==="LineString")En(ee,xe,ge,!1);else if(le==="MultiLineString"){if(O.lineMetrics){for(const Pe of ee)xe=[],En(Pe,xe,ge,!1),me.push(At(ye,"LineString",xe,j.properties));return}jt(ee,xe,ge,!1)}else if(le==="Polygon")jt(ee,xe,ge,!0);else{if(le!=="MultiPolygon"){if(le==="GeometryCollection"){for(const Pe of j.geometry.geometries)qi(me,{id:ye,geometry:Pe,properties:j.properties},O,Z);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Pe of ee){const Fe=[];jt(Pe,Fe,ge,!0),xe.push(Fe)}}me.push(At(ye,le,xe,j.properties))}function pi(me,j){j.push(zn(me[0]),vn(me[1]),0)}function En(me,j,O,Z){let ee,le,ge=0;for(let ye=0;ye<me.length;ye++){const Pe=zn(me[ye][0]),Fe=vn(me[ye][1]);j.push(Pe,Fe,0),ye>0&&(ge+=Z?(ee*Fe-Pe*le)/2:Math.sqrt(Math.pow(Pe-ee,2)+Math.pow(Fe-le,2))),ee=Pe,le=Fe}const xe=j.length-3;j[2]=1,He(j,0,xe,O),j[xe+2]=1,j.size=Math.abs(ge),j.start=0,j.end=j.size}function jt(me,j,O,Z){for(let ee=0;ee<me.length;ee++){const le=[];En(me[ee],le,O,Z),j.push(le)}}function zn(me){return me/360+.5}function vn(me){const j=Math.sin(me*Math.PI/180),O=.5-.25*Math.log((1+j)/(1-j))/Math.PI;return O<0?0:O>1?1:O}function Nn(me,j,O,Z,ee,le,ge,xe){if(Z/=j,le>=(O/=j)&&ge<Z)return me;if(ge<O||le>=Z)return null;const ye=[];for(const Pe of me){const Fe=Pe.geometry;let ze=Pe.type;const it=ee===0?Pe.minX:Pe.minY,ve=ee===0?Pe.maxX:Pe.maxY;if(it>=O&&ve<Z){ye.push(Pe);continue}if(ve<O||it>=Z)continue;let gt=[];if(ze==="Point"||ze==="MultiPoint")fr(Fe,gt,O,Z,ee);else if(ze==="LineString")gr(Fe,gt,O,Z,ee,!1,xe.lineMetrics);else if(ze==="MultiLineString")ni(Fe,gt,O,Z,ee,!1);else if(ze==="Polygon")ni(Fe,gt,O,Z,ee,!0);else if(ze==="MultiPolygon")for(const Pt of Fe){const st=[];ni(Pt,st,O,Z,ee,!0),st.length&&gt.push(st)}if(gt.length){if(xe.lineMetrics&&ze==="LineString"){for(const Pt of gt)ye.push(At(Pe.id,ze,Pt,Pe.tags));continue}ze!=="LineString"&&ze!=="MultiLineString"||(gt.length===1?(ze="LineString",gt=gt[0]):ze="MultiLineString"),ze!=="Point"&&ze!=="MultiPoint"||(ze=gt.length===3?"Point":"MultiPoint"),ye.push(At(Pe.id,ze,gt,Pe.tags))}}return ye.length?ye:null}function fr(me,j,O,Z,ee){for(let le=0;le<me.length;le+=3){const ge=me[le+ee];ge>=O&&ge<=Z&&li(j,me[le],me[le+1],me[le+2])}}function gr(me,j,O,Z,ee,le,ge){let xe=Ei(me);const ye=ee===0?Dn:Wn;let Pe,Fe,ze=me.start;for(let st=0;st<me.length-3;st+=3){const vt=me[st],Ht=me[st+1],wi=me[st+2],ji=me[st+3],Oi=me[st+4],Vi=ee===0?vt:Ht,Xt=ee===0?ji:Oi;let Ci=!1;ge&&(Pe=Math.sqrt(Math.pow(vt-ji,2)+Math.pow(Ht-Oi,2))),Vi<O?Xt>O&&(Fe=ye(xe,vt,Ht,ji,Oi,O),ge&&(xe.start=ze+Pe*Fe)):Vi>Z?Xt<Z&&(Fe=ye(xe,vt,Ht,ji,Oi,Z),ge&&(xe.start=ze+Pe*Fe)):li(xe,vt,Ht,wi),Xt<O&&Vi>=O&&(Fe=ye(xe,vt,Ht,ji,Oi,O),Ci=!0),Xt>Z&&Vi<=Z&&(Fe=ye(xe,vt,Ht,ji,Oi,Z),Ci=!0),!le&&Ci&&(ge&&(xe.end=ze+Pe*Fe),j.push(xe),xe=Ei(me)),ge&&(ze+=Pe)}let it=me.length-3;const ve=me[it],gt=me[it+1],Pt=ee===0?ve:gt;Pt>=O&&Pt<=Z&&li(xe,ve,gt,me[it+2]),it=xe.length-3,le&&it>=3&&(xe[it]!==xe[0]||xe[it+1]!==xe[1])&&li(xe,xe[0],xe[1],xe[2]),xe.length&&j.push(xe)}function Ei(me){const j=[];return j.size=me.size,j.start=me.start,j.end=me.end,j}function ni(me,j,O,Z,ee,le){for(const ge of me)gr(ge,j,O,Z,ee,le,!1)}function li(me,j,O,Z){me.push(j,O,Z)}function Dn(me,j,O,Z,ee,le){const ge=(le-j)/(Z-j);return li(me,le,O+(ee-O)*ge,1),ge}function Wn(me,j,O,Z,ee,le){const ge=(le-O)/(ee-O);return li(me,j+(Z-j)*ge,le,1),ge}function Ln(me,j){const O=[];for(let Z=0;Z<me.length;Z++){const ee=me[Z],le=ee.type;let ge;if(le==="Point"||le==="MultiPoint"||le==="LineString")ge=Rn(ee.geometry,j);else if(le==="MultiLineString"||le==="Polygon"){ge=[];for(const xe of ee.geometry)ge.push(Rn(xe,j))}else if(le==="MultiPolygon"){ge=[];for(const xe of ee.geometry){const ye=[];for(const Pe of xe)ye.push(Rn(Pe,j));ge.push(ye)}}O.push(At(ee.id,le,ge,ee.tags))}return O}function Rn(me,j){const O=[];O.size=me.size,me.start!==void 0&&(O.start=me.start,O.end=me.end);for(let Z=0;Z<me.length;Z+=3)O.push(me[Z]+j,me[Z+1],me[Z+2]);return O}function xn(me,j){if(me.transformed)return me;const O=1<<me.z,Z=me.x,ee=me.y;for(const le of me.features){const ge=le.geometry,xe=le.type;if(le.geometry=[],xe===1)for(let ye=0;ye<ge.length;ye+=2)le.geometry.push(yr(ge[ye],ge[ye+1],j,O,Z,ee));else for(let ye=0;ye<ge.length;ye++){const Pe=[];for(let Fe=0;Fe<ge[ye].length;Fe+=2)Pe.push(yr(ge[ye][Fe],ge[ye][Fe+1],j,O,Z,ee));le.geometry.push(Pe)}}return me.transformed=!0,me}function yr(me,j,O,Z,ee,le){return[Math.round(O*(me*Z-ee)),Math.round(O*(j*Z-le))]}function Dr(me,j,O,Z,ee){const le=j===ee.maxZoom?0:ee.tolerance/((1<<j)*ee.extent),ge={features:[],numPoints:0,numSimplified:0,numFeatures:me.length,source:null,x:O,y:Z,z:j,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const xe of me)Lr(ge,xe,le,ee);return ge}function Lr(me,j,O,Z){const ee=j.geometry,le=j.type,ge=[];if(me.minX=Math.min(me.minX,j.minX),me.minY=Math.min(me.minY,j.minY),me.maxX=Math.max(me.maxX,j.maxX),me.maxY=Math.max(me.maxY,j.maxY),le==="Point"||le==="MultiPoint")for(let xe=0;xe<ee.length;xe+=3)ge.push(ee[xe],ee[xe+1]),me.numPoints++,me.numSimplified++;else if(le==="LineString")Rr(ge,ee,me,O,!1,!1);else if(le==="MultiLineString"||le==="Polygon")for(let xe=0;xe<ee.length;xe++)Rr(ge,ee[xe],me,O,le==="Polygon",xe===0);else if(le==="MultiPolygon")for(let xe=0;xe<ee.length;xe++){const ye=ee[xe];for(let Pe=0;Pe<ye.length;Pe++)Rr(ge,ye[Pe],me,O,!0,Pe===0)}if(ge.length){let xe=j.tags||null;if(le==="LineString"&&Z.lineMetrics){xe={};for(const Pe in j.tags)xe[Pe]=j.tags[Pe];xe.mapbox_clip_start=ee.start/ee.size,xe.mapbox_clip_end=ee.end/ee.size}const ye={geometry:ge,type:le==="Polygon"||le==="MultiPolygon"?3:le==="LineString"||le==="MultiLineString"?2:1,tags:xe};j.id!==null&&(ye.id=j.id),me.features.push(ye)}}function Rr(me,j,O,Z,ee,le){const ge=Z*Z;if(Z>0&&j.size<(ee?ge:Z))return void(O.numPoints+=j.length/3);const xe=[];for(let ye=0;ye<j.length;ye+=3)(Z===0||j[ye+2]>ge)&&(O.numSimplified++,xe.push(j[ye],j[ye+1])),O.numPoints++;ee&&function(ye,Pe){let Fe=0;for(let ze=0,it=ye.length,ve=it-2;ze<it;ve=ze,ze+=2)Fe+=(ye[ze]-ye[ve])*(ye[ze+1]+ye[ve+1]);if(Fe>0===Pe)for(let ze=0,it=ye.length;ze<it/2;ze+=2){const ve=ye[ze],gt=ye[ze+1];ye[ze]=ye[it-2-ze],ye[ze+1]=ye[it-1-ze],ye[it-2-ze]=ve,ye[it-1-ze]=gt}}(xe,le),me.push(xe)}const Ye={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class ht{constructor(j,O){const Z=(O=this.options=function(le,ge){for(const xe in ge)le[xe]=ge[xe];return le}(Object.create(Ye),O)).debug;if(Z&&console.time("preprocess data"),O.maxZoom<0||O.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(O.promoteId&&O.generateId)throw new Error("promoteId and generateId cannot be used together.");let ee=function(le,ge){const xe=[];if(le.type==="FeatureCollection")for(let ye=0;ye<le.features.length;ye++)qi(xe,le.features[ye],ge,ye);else qi(xe,le.type==="Feature"?le:{geometry:le},ge);return xe}(j,O);this.tiles={},this.tileCoords=[],Z&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",O.indexMaxZoom,O.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ee=function(le,ge){const xe=ge.buffer/ge.extent;let ye=le;const Pe=Nn(le,1,-1-xe,xe,0,-1,2,ge),Fe=Nn(le,1,1-xe,2+xe,0,-1,2,ge);return(Pe||Fe)&&(ye=Nn(le,1,-xe,1+xe,0,-1,2,ge)||[],Pe&&(ye=Ln(Pe,1).concat(ye)),Fe&&(ye=ye.concat(Ln(Fe,-1)))),ye}(ee,O),ee.length&&this.splitTile(ee,0,0,0),Z&&(ee.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(j,O,Z,ee,le,ge,xe){const ye=[j,O,Z,ee],Pe=this.options,Fe=Pe.debug;for(;ye.length;){ee=ye.pop(),Z=ye.pop(),O=ye.pop(),j=ye.pop();const ze=1<<O,it=Vt(O,Z,ee);let ve=this.tiles[it];if(!ve&&(Fe>1&&console.time("creation"),ve=this.tiles[it]=Dr(j,O,Z,ee,Pe),this.tileCoords.push({z:O,x:Z,y:ee}),Fe)){Fe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",O,Z,ee,ve.numFeatures,ve.numPoints,ve.numSimplified),console.timeEnd("creation"));const Ci=`z${O}`;this.stats[Ci]=(this.stats[Ci]||0)+1,this.total++}if(ve.source=j,le==null){if(O===Pe.indexMaxZoom||ve.numPoints<=Pe.indexMaxPoints)continue}else{if(O===Pe.maxZoom||O===le)continue;if(le!=null){const Ci=le-O;if(Z!==ge>>Ci||ee!==xe>>Ci)continue}}if(ve.source=null,j.length===0)continue;Fe>1&&console.time("clipping");const gt=.5*Pe.buffer/Pe.extent,Pt=.5-gt,st=.5+gt,vt=1+gt;let Ht=null,wi=null,ji=null,Oi=null,Vi=Nn(j,ze,Z-gt,Z+st,0,ve.minX,ve.maxX,Pe),Xt=Nn(j,ze,Z+Pt,Z+vt,0,ve.minX,ve.maxX,Pe);j=null,Vi&&(Ht=Nn(Vi,ze,ee-gt,ee+st,1,ve.minY,ve.maxY,Pe),wi=Nn(Vi,ze,ee+Pt,ee+vt,1,ve.minY,ve.maxY,Pe),Vi=null),Xt&&(ji=Nn(Xt,ze,ee-gt,ee+st,1,ve.minY,ve.maxY,Pe),Oi=Nn(Xt,ze,ee+Pt,ee+vt,1,ve.minY,ve.maxY,Pe),Xt=null),Fe>1&&console.timeEnd("clipping"),ye.push(Ht||[],O+1,2*Z,2*ee),ye.push(wi||[],O+1,2*Z,2*ee+1),ye.push(ji||[],O+1,2*Z+1,2*ee),ye.push(Oi||[],O+1,2*Z+1,2*ee+1)}}getTile(j,O,Z){j=+j,O=+O,Z=+Z;const ee=this.options,{extent:le,debug:ge}=ee;if(j<0||j>24)return null;const xe=1<<j,ye=Vt(j,O=O+xe&xe-1,Z);if(this.tiles[ye])return xn(this.tiles[ye],le);ge>1&&console.log("drilling down to z%d-%d-%d",j,O,Z);let Pe,Fe=j,ze=O,it=Z;for(;!Pe&&Fe>0;)Fe--,ze>>=1,it>>=1,Pe=this.tiles[Vt(Fe,ze,it)];return Pe&&Pe.source?(ge>1&&(console.log("found parent tile z%d-%d-%d",Fe,ze,it),console.time("drilling down")),this.splitTile(Pe.source,Fe,ze,it,j,O,Z),ge>1&&console.timeEnd("drilling down"),this.tiles[ye]?xn(this.tiles[ye],le):null):null}}function Vt(me,j,O){return 32*((1<<me)*O+j)+me}class Gt extends re{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(j,O){return b._(this,void 0,void 0,function*(){const Z=j.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const ee=this._geoJSONIndex.getTile(Z.z,Z.x,Z.y);if(!ee)return null;const le=new oe(ee.features,{version:2,extent:b.$});let ge=function(xe){const ye=new b.cM;return function(Pe,Fe){for(const ze in Pe.layers)Fe.writeMessage(3,fe,Pe.layers[ze])}(xe,ye),ye.finish()}(le);return ge.byteOffset===0&&ge.byteLength===ge.buffer.byteLength||(ge=new Uint8Array(ge)),{vectorTile:le,rawData:ge.buffer}})}loadData(j){return b._(this,void 0,void 0,function*(){var O;(O=this._pendingRequest)===null||O===void 0||O.abort();const Z=!!(j&&j.request&&j.request.collectResourceTiming)&&new b.cN(j.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(j,this._pendingRequest);const ee=yield this._pendingData;this._geoJSONIndex=j.cluster?new Bi(function({superclusterOptions:ge,clusterProperties:xe}){if(!xe||!ge)return ge;const ye={},Pe={},Fe={accumulated:null,zoom:0},ze={properties:null},it=Object.keys(xe);for(const ve of it){const[gt,Pt]=xe[ve],st=b.cT(Pt),vt=b.cT(typeof gt=="string"?[gt,["accumulated"],["get",ve]]:gt);ye[ve]=st.value,Pe[ve]=vt.value}return ge.map=ve=>{ze.properties=ve;const gt={};for(const Pt of it)gt[Pt]=ye[Pt].evaluate(Fe,ze);return gt},ge.reduce=(ve,gt)=>{ze.properties=gt;for(const Pt of it)Fe.accumulated=ve[Pt],ve[Pt]=Pe[Pt].evaluate(Fe,ze)},ge}(j)).load(ee.features):function(ge,xe){return new ht(ge,xe)}(ee,j.geojsonVtOptions),this.loaded={};const le={data:ee};if(Z){const ge=Z.finish();ge&&(le.resourceTiming={},le.resourceTiming[j.source]=JSON.parse(JSON.stringify(ge)))}return le}catch(ee){if(delete this._pendingRequest,b.cy(ee))return{abandoned:!0};throw ee}})}getData(){return b._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(j){const O=this.loaded;return O&&O[j.uid]?super.reloadTile(j):this.loadTile(j)}loadAndProcessGeoJSON(j,O){return b._(this,void 0,void 0,function*(){let Z=yield this.loadGeoJSON(j,O);if(delete this._pendingRequest,typeof Z!="object")throw new Error(`Input data given to '${j.source}' is not a valid GeoJSON object.`);if(We(Z,!0),j.filter){const ee=b.cT(j.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ee.result==="error")throw new Error(ee.value.map(ge=>`${ge.key}: ${ge.message}`).join(", "));Z={type:"FeatureCollection",features:Z.features.filter(ge=>ee.value.evaluate({zoom:0},ge))}}return Z})}loadGeoJSON(j,O){return b._(this,void 0,void 0,function*(){const{promoteId:Z}=j;if(j.request){const ee=yield b.j(j.request,O);return this._dataUpdateable=b.cV(ee.data,Z)?b.cU(ee.data,Z):void 0,ee.data}if(typeof j.data=="string")try{const ee=JSON.parse(j.data);return this._dataUpdateable=b.cV(ee,Z)?b.cU(ee,Z):void 0,ee}catch{throw new Error(`Input data given to '${j.source}' is not a valid GeoJSON object.`)}if(!j.dataDiff)throw new Error(`Input data given to '${j.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${j.source}`);return b.cW(this._dataUpdateable,j.dataDiff,Z),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(j){return b._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(j){return this._geoJSONIndex.getClusterExpansionZoom(j.clusterId)}getClusterChildren(j){return this._geoJSONIndex.getChildren(j.clusterId)}getClusterLeaves(j){return this._geoJSONIndex.getLeaves(j.clusterId,j.limit,j.offset)}}class zi{constructor(j){this.self=j,this.actor=new b.J(j),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(O,Z)=>{if(this.externalWorkerSourceTypes[O])throw new Error(`Worker source with name "${O}" already registered.`);this.externalWorkerSourceTypes[O]=Z},this.self.addProtocol=b.cA,this.self.removeProtocol=b.cB,this.self.registerRTLTextPlugin=O=>{b.cX.setMethods(O)},this.actor.registerMessageHandler("LDT",(O,Z)=>this._getDEMWorkerSource(O,Z.source).loadTile(Z)),this.actor.registerMessageHandler("RDT",(O,Z)=>b._(this,void 0,void 0,function*(){this._getDEMWorkerSource(O,Z.source).removeTile(Z)})),this.actor.registerMessageHandler("GCEZ",(O,Z)=>b._(this,void 0,void 0,function*(){return this._getWorkerSource(O,Z.type,Z.source).getClusterExpansionZoom(Z)})),this.actor.registerMessageHandler("GCC",(O,Z)=>b._(this,void 0,void 0,function*(){return this._getWorkerSource(O,Z.type,Z.source).getClusterChildren(Z)})),this.actor.registerMessageHandler("GCL",(O,Z)=>b._(this,void 0,void 0,function*(){return this._getWorkerSource(O,Z.type,Z.source).getClusterLeaves(Z)})),this.actor.registerMessageHandler("LD",(O,Z)=>this._getWorkerSource(O,Z.type,Z.source).loadData(Z)),this.actor.registerMessageHandler("GD",(O,Z)=>this._getWorkerSource(O,Z.type,Z.source).getData()),this.actor.registerMessageHandler("LT",(O,Z)=>this._getWorkerSource(O,Z.type,Z.source).loadTile(Z)),this.actor.registerMessageHandler("RT",(O,Z)=>this._getWorkerSource(O,Z.type,Z.source).reloadTile(Z)),this.actor.registerMessageHandler("AT",(O,Z)=>this._getWorkerSource(O,Z.type,Z.source).abortTile(Z)),this.actor.registerMessageHandler("RMT",(O,Z)=>this._getWorkerSource(O,Z.type,Z.source).removeTile(Z)),this.actor.registerMessageHandler("RS",(O,Z)=>b._(this,void 0,void 0,function*(){if(!this.workerSources[O]||!this.workerSources[O][Z.type]||!this.workerSources[O][Z.type][Z.source])return;const ee=this.workerSources[O][Z.type][Z.source];delete this.workerSources[O][Z.type][Z.source],ee.removeSource!==void 0&&ee.removeSource(Z)})),this.actor.registerMessageHandler("RM",O=>b._(this,void 0,void 0,function*(){delete this.layerIndexes[O],delete this.availableImages[O],delete this.workerSources[O],delete this.demWorkerSources[O],this.globalStates.delete(O)})),this.actor.registerMessageHandler("SR",(O,Z)=>b._(this,void 0,void 0,function*(){this.referrer=Z})),this.actor.registerMessageHandler("SRPS",(O,Z)=>this._syncRTLPluginState(O,Z)),this.actor.registerMessageHandler("IS",(O,Z)=>b._(this,void 0,void 0,function*(){this.self.importScripts(Z)})),this.actor.registerMessageHandler("SI",(O,Z)=>this._setImages(O,Z)),this.actor.registerMessageHandler("UL",(O,Z)=>b._(this,void 0,void 0,function*(){this._getLayerIndex(O).update(Z.layers,Z.removedIds,this._getGlobalState(O))})),this.actor.registerMessageHandler("UGS",(O,Z)=>b._(this,void 0,void 0,function*(){const ee=this._getGlobalState(O);for(const le in Z)ee[le]=Z[le]})),this.actor.registerMessageHandler("SL",(O,Z)=>b._(this,void 0,void 0,function*(){this._getLayerIndex(O).replace(Z,this._getGlobalState(O))}))}_getGlobalState(j){let O=this.globalStates.get(j);return O||(O={},this.globalStates.set(j,O)),O}_setImages(j,O){return b._(this,void 0,void 0,function*(){this.availableImages[j]=O;for(const Z in this.workerSources[j]){const ee=this.workerSources[j][Z];for(const le in ee)ee[le].availableImages=O}})}_syncRTLPluginState(j,O){return b._(this,void 0,void 0,function*(){return yield b.cX.syncState(O,this.self.importScripts)})}_getAvailableImages(j){let O=this.availableImages[j];return O||(O=[]),O}_getLayerIndex(j){let O=this.layerIndexes[j];return O||(O=this.layerIndexes[j]=new c),O}_getWorkerSource(j,O,Z){if(this.workerSources[j]||(this.workerSources[j]={}),this.workerSources[j][O]||(this.workerSources[j][O]={}),!this.workerSources[j][O][Z]){const ee={sendAsync:(le,ge)=>(le.targetMapId=j,this.actor.sendAsync(le,ge))};switch(O){case"vector":this.workerSources[j][O][Z]=new re(ee,this._getLayerIndex(j),this._getAvailableImages(j));break;case"geojson":this.workerSources[j][O][Z]=new Gt(ee,this._getLayerIndex(j),this._getAvailableImages(j));break;default:this.workerSources[j][O][Z]=new this.externalWorkerSourceTypes[O](ee,this._getLayerIndex(j),this._getAvailableImages(j))}}return this.workerSources[j][O][Z]}_getDEMWorkerSource(j,O){return this.demWorkerSources[j]||(this.demWorkerSources[j]={}),this.demWorkerSources[j][O]||(this.demWorkerSources[j][O]=new ce),this.demWorkerSources[j][O]}}return b.i(self)&&(self.worker=new zi(self)),zi}),x("index",["exports","./shared"],function(b,c){var F="5.8.0";function W(){var m=new c.A(4);return c.A!=Float32Array&&(m[1]=0,m[2]=0),m[0]=1,m[3]=1,m}let se,re;const ce={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(m,e,a){const l=requestAnimationFrame(f=>{h(),e(f)}),{unsubscribe:h}=c.s(m.signal,"abort",()=>{h(),cancelAnimationFrame(l),a(c.c())},!1)},frameAsync(m){return new Promise((e,a)=>{this.frame(m,e,a)})},getImageData(m,e=0){return this.getImageCanvasContext(m).getImageData(-e,-e,m.width+2*e,m.height+2*e)},getImageCanvasContext(m){const e=window.document.createElement("canvas"),a=e.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("failed to create canvas 2d context");return e.width=m.width,e.height=m.height,a.drawImage(m,0,0,m.width,m.height),a},resolveURL:m=>(se||(se=document.createElement("a")),se.href=m,se.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(re==null&&(re=matchMedia("(prefers-reduced-motion: reduce)")),re.matches)}};class K{static testProp(e){if(!K.docStyle)return e[0];for(let a=0;a<e.length;a++)if(e[a]in K.docStyle)return e[a];return e[0]}static create(e,a,l){const h=window.document.createElement(e);return a!==void 0&&(h.className=a),l&&l.appendChild(h),h}static createNS(e,a){return window.document.createElementNS(e,a)}static disableDrag(){K.docStyle&&K.selectProp&&(K.userSelect=K.docStyle[K.selectProp],K.docStyle[K.selectProp]="none")}static enableDrag(){K.docStyle&&K.selectProp&&(K.docStyle[K.selectProp]=K.userSelect)}static setTransform(e,a){e.style[K.transformProp]=a}static addEventListener(e,a,l,h={}){e.addEventListener(a,l,"passive"in h?h:h.capture)}static removeEventListener(e,a,l,h={}){e.removeEventListener(a,l,"passive"in h?h:h.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",K.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",K.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",K.suppressClickInternal,!0)},0)}static getScale(e){const a=e.getBoundingClientRect();return{x:a.width/e.offsetWidth||1,y:a.height/e.offsetHeight||1,boundingClientRect:a}}static getPoint(e,a,l){const h=a.boundingClientRect;return new c.P((l.clientX-h.left)/a.x-e.clientLeft,(l.clientY-h.top)/a.y-e.clientTop)}static mousePos(e,a){const l=K.getScale(e);return K.getPoint(e,l,a)}static touchPos(e,a){const l=[],h=K.getScale(e);for(let f=0;f<a.length;f++)l.push(K.getPoint(e,h,a[f]));return l}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const a=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),l=a.querySelectorAll("script");for(const h of l)h.remove();return K.clean(a),a.innerHTML}static isPossiblyDangerous(e,a){const l=a.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!l.includes("javascript:")&&!l.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const a=e.children;for(const l of a)K.removeAttributes(l),K.clean(l)}static removeAttributes(e){for(const{name:a,value:l}of e.attributes)K.isPossiblyDangerous(a,l)&&e.removeAttribute(a)}}K.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,K.selectProp=K.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),K.transformProp=K.testProp(["transform","WebkitTransform"]);const Ie={supported:!1,testSupport:function(m){!he&&We&&(oe?fe(m):Te=m)}};let Te,We,he=!1,oe=!1;function fe(m){const e=m.createTexture();m.bindTexture(m.TEXTURE_2D,e);try{if(m.texImage2D(m.TEXTURE_2D,0,m.RGBA,m.RGBA,m.UNSIGNED_BYTE,We),m.isContextLost())return;Ie.supported=!0}catch{}m.deleteTexture(e),he=!0}var De;typeof document<"u"&&(We=document.createElement("img"),We.onload=()=>{Te&&fe(Te),Te=null,oe=!0},We.onerror=()=>{he=!0,Te=null},We.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(m){let e,a,l,h;m.resetRequestQueue=()=>{e=[],a=0,l=0,h={}},m.addThrottleControl=I=>{const k=l++;return h[k]=I,k},m.removeThrottleControl=I=>{delete h[I],_()},m.getImage=(I,k,M=!0)=>new Promise((N,z)=>{Ie.supported&&(I.headers||(I.headers={}),I.headers.accept="image/webp,*/*"),c.e(I,{type:"image"}),e.push({abortController:k,requestParameters:I,supportImageRefresh:M,state:"queued",onError:L=>{z(L)},onSuccess:L=>{N(L)}}),_()});const f=I=>c._(this,void 0,void 0,function*(){I.state="running";const{requestParameters:k,supportImageRefresh:M,onError:N,onSuccess:z,abortController:L}=I,U=M===!1&&!c.i(self)&&!c.g(k.url)&&(!k.headers||Object.keys(k.headers).reduce((X,J)=>X&&J==="accept",!0));a++;const q=U?C(k,L):c.m(k,L);try{const X=yield q;delete I.abortController,I.state="completed",X.data instanceof HTMLImageElement||c.b(X.data)?z(X):X.data&&z({data:yield(H=X.data,typeof createImageBitmap=="function"?c.f(H):c.h(H)),cacheControl:X.cacheControl,expires:X.expires})}catch(X){delete I.abortController,N(X)}finally{a--,_()}var H}),_=()=>{const I=(()=>{for(const k of Object.keys(h))if(h[k]())return!0;return!1})()?c.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let k=a;k<I&&e.length>0;k++){const M=e.shift();M.abortController.signal.aborted?k--:f(M)}},C=(I,k)=>new Promise((M,N)=>{const z=new Image,L=I.url,U=I.credentials;U&&U==="include"?z.crossOrigin="use-credentials":(U&&U==="same-origin"||!c.d(L))&&(z.crossOrigin="anonymous"),k.signal.addEventListener("abort",()=>{z.src="",N(c.c())}),z.fetchPriority="high",z.onload=()=>{z.onerror=z.onload=null,M({data:z})},z.onerror=()=>{z.onerror=z.onload=null,k.signal.aborted||N(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},z.src=L})}(De||(De={})),De.resetRequestQueue();class Xe{constructor(e){this._transformRequestFn=e??null}transformRequest(e,a){return this._transformRequestFn&&this._transformRequestFn(e,a)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function tt(m){const e=[];if(typeof m=="string")e.push({id:"default",url:m});else if(m&&m.length>0){const a=[];for(const{id:l,url:h}of m){const f=`${l}${h}`;a.indexOf(f)===-1&&(a.push(f),e.push({id:l,url:h}))}}return e}function et(m,e,a){try{const l=new URL(m);return l.pathname+=`${e}${a}`,l.toString()}catch{throw new Error(`Invalid sprite URL "${m}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function lt(m){const{userImage:e}=m;return!!(e&&e.render&&e.render())&&(m.data.replace(new Uint8Array(e.data.buffer)),!0)}class Lt extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:a,promiseResolve:l}of this.requestors)l(this._getImagesForIds(a));this.requestors=[]}}getImage(e){const a=this.images[e];if(a&&!a.data&&a.spriteData){const l=a.spriteData;a.data=new c.R({width:l.width,height:l.height},l.context.getImageData(l.x,l.y,l.width,l.height).data),a.spriteData=null}return a}addImage(e,a){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,a)&&(this.images[e]=a)}_validate(e,a){let l=!0;const h=a.data||a.spriteData;return this._validateStretch(a.stretchX,h&&h.width)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "stretchX" value`))),l=!1),this._validateStretch(a.stretchY,h&&h.height)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "stretchY" value`))),l=!1),this._validateContent(a.content,a)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "content" value`))),l=!1),l}_validateStretch(e,a){if(!e)return!0;let l=0;for(const h of e){if(h[0]<l||h[1]<h[0]||a<h[1])return!1;l=h[1]}return!0}_validateContent(e,a){if(!e)return!0;if(e.length!==4)return!1;const l=a.spriteData,h=l&&l.width||a.data.width,f=l&&l.height||a.data.height;return!(e[0]<0||h<e[0]||e[1]<0||f<e[1]||e[2]<0||h<e[2]||e[3]<0||f<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,a,l=!0){const h=this.getImage(e);if(l&&(h.data.width!==a.data.width||h.data.height!==a.data.height))throw new Error(`size mismatch between old image (${h.data.width}x${h.data.height}) and new image (${a.data.width}x${a.data.height}).`);a.version=h.version+1,this.images[e]=a,this.updatedImages[e]=!0}removeImage(e){const a=this.images[e];delete this.images[e],delete this.patterns[e],a.userImage&&a.userImage.onRemove&&a.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((a,l)=>{let h=!0;if(!this.isLoaded())for(const f of e)this.images[f]||(h=!1);this.isLoaded()||h?a(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:a})})}_getImagesForIds(e){const a={};for(const l of e){let h=this.getImage(l);h||(this.fire(new c.l("styleimagemissing",{id:l})),h=this.getImage(l)),h?a[l]={data:h.data.clone(),pixelRatio:h.pixelRatio,sdf:h.sdf,version:h.version,stretchX:h.stretchX,stretchY:h.stretchY,content:h.content,textFitWidth:h.textFitWidth,textFitHeight:h.textFitHeight,hasRenderCallback:!!(h.userImage&&h.userImage.render)}:c.w(`Image "${l}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return a}getPixelSize(){const{width:e,height:a}=this.atlasImage;return{width:e,height:a}}getPattern(e){const a=this.patterns[e],l=this.getImage(e);if(!l)return null;if(a&&a.position.version===l.version)return a.position;if(a)a.position.version=l.version;else{const h={w:l.data.width+2,h:l.data.height+2,x:0,y:0},f=new c.I(h,l);this.patterns[e]={bin:h,position:f}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const a=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new c.T(e,this.atlasImage,a.RGBA),this.atlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const f in this.patterns)e.push(this.patterns[f].bin);const{w:a,h:l}=c.p(e),h=this.atlasImage;h.resize({width:a||1,height:l||1});for(const f in this.patterns){const{bin:_}=this.patterns[f],C=_.x+1,I=_.y+1,k=this.getImage(f).data,M=k.width,N=k.height;c.R.copy(k,h,{x:0,y:0},{x:C,y:I},{width:M,height:N}),c.R.copy(k,h,{x:0,y:N-1},{x:C,y:I-1},{width:M,height:1}),c.R.copy(k,h,{x:0,y:0},{x:C,y:I+N},{width:M,height:1}),c.R.copy(k,h,{x:M-1,y:0},{x:C-1,y:I},{width:1,height:N}),c.R.copy(k,h,{x:0,y:0},{x:C+M,y:I},{width:1,height:N})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const a of e){if(this.callbackDispatchedThisFrame[a])continue;this.callbackDispatchedThisFrame[a]=!0;const l=this.getImage(a);l||c.w(`Image with ID: "${a}" was not found`),lt(l)&&this.updateImage(a,l)}}}const mt=1e20;function di(m,e,a,l,h,f,_,C,I){for(let k=e;k<e+l;k++)Mi(m,a*f+k,f,h,_,C,I);for(let k=a;k<a+h;k++)Mi(m,k*f+e,1,l,_,C,I)}function Mi(m,e,a,l,h,f,_){f[0]=0,_[0]=-mt,_[1]=mt,h[0]=m[e];for(let C=1,I=0,k=0;C<l;C++){h[C]=m[e+C*a];const M=C*C;do{const N=f[I];k=(h[C]-h[N]+M-N*N)/(C-N)/2}while(k<=_[I]&&--I>-1);I++,f[I]=C,_[I]=k,_[I+1]=mt}for(let C=0,I=0;C<l;C++){for(;_[I+1]<C;)I++;const k=f[I],M=C-k;m[e+C*a]=h[k]+M*M}}class Bi{constructor(e,a,l){this.requestManager=e,this.localIdeographFontFamily=a,this.entries={},this.lang=l}setURL(e){this.url=e}getGlyphs(e){return c._(this,void 0,void 0,function*(){const a=[];for(const f in e)for(const _ of e[f])a.push(this._getAndCacheGlyphsPromise(f,_));const l=yield Promise.all(a),h={};for(const{stack:f,id:_,glyph:C}of l)h[f]||(h[f]={}),h[f][_]=C&&{id:C.id,bitmap:C.bitmap.clone(),metrics:C.metrics};return h})}_getAndCacheGlyphsPromise(e,a){return c._(this,void 0,void 0,function*(){let l=this.entries[e];l||(l=this.entries[e]={glyphs:{},requests:{},ranges:{}});let h=l.glyphs[a];if(h!==void 0)return{stack:e,id:a,glyph:h};if(h=this._tinySDF(l,e,a),h)return l.glyphs[a]=h,{stack:e,id:a,glyph:h};const f=Math.floor(a/256);if(256*f>65535)throw new Error("glyphs > 65535 not supported");if(l.ranges[f])return{stack:e,id:a,glyph:h};if(!this.url)throw new Error("glyphsUrl is not set");if(!l.requests[f]){const C=Bi.loadGlyphRange(e,f,this.url,this.requestManager);l.requests[f]=C}const _=yield l.requests[f];for(const C in _)this._doesCharSupportLocalGlyph(+C)||(l.glyphs[+C]=_[+C]);return l.ranges[f]=!0,{stack:e,id:a,glyph:_[a]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(/\p{Ideo}|\p{sc=Hang}|\p{sc=Hira}|\p{sc=Kana}/u.test(String.fromCodePoint(e))||c.u["CJK Unified Ideographs"](e)||c.u["Hangul Syllables"](e)||c.u.Hiragana(e)||c.u.Katakana(e)||c.u["CJK Symbols and Punctuation"](e)||c.u["Halfwidth and Fullwidth Forms"](e))}_tinySDF(e,a,l){const h=this.localIdeographFontFamily;if(!h||!this._doesCharSupportLocalGlyph(l))return;let f=e.tinySDF;if(!f){let C="400";/bold/i.test(a)?C="900":/medium/i.test(a)?C="500":/light/i.test(a)&&(C="200"),f=e.tinySDF=new Bi.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,lang:this.lang,fontFamily:h,fontWeight:C})}const _=f.draw(String.fromCharCode(l));return{id:l,bitmap:new c.q({width:_.width||60,height:_.height||60},_.data),metrics:{width:_.glyphWidth/2||24,height:_.glyphHeight/2||24,left:_.glyphLeft/2+.5||0,top:_.glyphTop/2-27.5||-8,advance:_.glyphAdvance/2||24,isDoubleResolution:!0}}}}Bi.loadGlyphRange=function(m,e,a,l){return c._(this,void 0,void 0,function*(){const h=256*e,f=h+255,_=l.transformRequest(a.replace("{fontstack}",m).replace("{range}",`${h}-${f}`),"Glyphs"),C=yield c.n(_,new AbortController);if(!C||!C.data)throw new Error(`Could not load glyph range. range: ${e}, ${h}-${f}`);const I={};for(const k of c.o(C.data))I[k.id]=k;return I})},Bi.TinySDF=class{constructor({fontSize:m=24,buffer:e=3,radius:a=8,cutoff:l=.25,fontFamily:h="sans-serif",fontWeight:f="normal",fontStyle:_="normal",lang:C=null}={}){this.buffer=e,this.cutoff=l,this.radius=a,this.lang=C;const I=this.size=m+4*e,k=this._createCanvas(I),M=this.ctx=k.getContext("2d",{willReadFrequently:!0});M.font=`${_} ${f} ${m}px ${h}`,M.textBaseline="alphabetic",M.textAlign="left",M.fillStyle="black",this.gridOuter=new Float64Array(I*I),this.gridInner=new Float64Array(I*I),this.f=new Float64Array(I),this.z=new Float64Array(I+1),this.v=new Uint16Array(I)}_createCanvas(m){const e=document.createElement("canvas");return e.width=e.height=m,e}draw(m){const{width:e,actualBoundingBoxAscent:a,actualBoundingBoxDescent:l,actualBoundingBoxLeft:h,actualBoundingBoxRight:f}=this.ctx.measureText(m),_=Math.ceil(a),C=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(f-h))),I=Math.min(this.size-this.buffer,_+Math.ceil(l)),k=C+2*this.buffer,M=I+2*this.buffer,N=Math.max(k*M,0),z=new Uint8ClampedArray(N),L={data:z,width:k,height:M,glyphWidth:C,glyphHeight:I,glyphTop:_,glyphLeft:0,glyphAdvance:e};if(C===0||I===0)return L;const{ctx:U,buffer:q,gridInner:H,gridOuter:X}=this;this.lang&&(U.lang=this.lang),U.clearRect(q,q,C,I),U.fillText(m,q,q+_);const J=U.getImageData(q,q,C,I);X.fill(mt,0,N),H.fill(0,0,N);for(let ie=0;ie<I;ie++)for(let Q=0;Q<C;Q++){const ae=J.data[4*(ie*C+Q)+3]/255;if(ae===0)continue;const de=(ie+q)*k+Q+q;if(ae===1)X[de]=0,H[de]=mt;else{const te=.5-ae;X[de]=te>0?te*te:0,H[de]=te<0?te*te:0}}di(X,0,0,k,M,k,this.f,this.v,this.z),di(H,q,q,C,I,k,this.f,this.v,this.z);for(let ie=0;ie<N;ie++){const Q=Math.sqrt(X[ie])-Math.sqrt(H[ie]);z[ie]=Math.round(255-255*(Q/this.radius+this.cutoff))}return L}};class si{constructor(){this.specification=c.v.light.position}possiblyEvaluate(e,a){return c.B(e.expression.evaluate(a))}interpolate(e,a,l){return{x:c.C.number(e.x,a.x,l),y:c.C.number(e.y,a.y,l),z:c.C.number(e.z,a.z,l)}}}let _i;class Gn extends c.E{constructor(e){super(),_i=_i||new c.r({anchor:new c.D(c.v.light.anchor),position:new si,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.t(_i,void 0),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,a={}){if(!this._validate(c.x,e,a))for(const l in e){const h=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),h):this._transitionable.setValue(l,h)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,a,l){return(!l||l.validate!==!1)&&c.y(this,e.call(c.z,{value:a,style:{glyphs:!0,sprite:!0},styleSpec:c.v}))}}const Mn=new c.r({"sky-color":new c.D(c.v.sky["sky-color"]),"horizon-color":new c.D(c.v.sky["horizon-color"]),"fog-color":new c.D(c.v.sky["fog-color"]),"fog-ground-blend":new c.D(c.v.sky["fog-ground-blend"]),"horizon-fog-blend":new c.D(c.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new c.D(c.v.sky["sky-horizon-blend"]),"atmosphere-blend":new c.D(c.v.sky["atmosphere-blend"])});class Qe extends c.E{constructor(e){super(),this._transitionable=new c.t(Mn,void 0),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.F(0))}setSky(e,a={}){if(!this._validate(c.G,e,a)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const l in e){const h=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),h):this._transitionable.setValue(l,h)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,a,l={}){return(l==null?void 0:l.validate)!==!1&&c.y(this,e.call(c.z,c.e({value:a,style:{glyphs:!0,sprite:!0},styleSpec:c.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class He{constructor(e,a){this.width=e,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,a){const l=e.join(",")+String(a);return this.dashEntry[l]||(this.dashEntry[l]=this.addDash(e,a)),this.dashEntry[l]}getDashRanges(e,a,l){const h=[];let f=e.length%2==1?-e[e.length-1]*l:0,_=e[0]*l,C=!0;h.push({left:f,right:_,isDash:C,zeroLength:e[0]===0});let I=e[0];for(let k=1;k<e.length;k++){C=!C;const M=e[k];f=I*l,I+=M,_=I*l,h.push({left:f,right:_,isDash:C,zeroLength:M===0})}return h}addRoundDash(e,a,l){const h=a/2;for(let f=-l;f<=l;f++){const _=this.width*(this.nextRow+l+f);let C=0,I=e[C];for(let k=0;k<this.width;k++){k/I.right>1&&(I=e[++C]);const M=Math.abs(k-I.left),N=Math.abs(k-I.right),z=Math.min(M,N);let L;const U=f/l*(h+1);if(I.isDash){const q=h-Math.abs(U);L=Math.sqrt(z*z+q*q)}else L=h-Math.sqrt(z*z+U*U);this.data[_+k]=Math.max(0,Math.min(255,L+128))}}}addRegularDash(e){for(let C=e.length-1;C>=0;--C){const I=e[C],k=e[C+1];I.zeroLength?e.splice(C,1):k&&k.isDash===I.isDash&&(k.left=I.left,e.splice(C,1))}const a=e[0],l=e[e.length-1];a.isDash===l.isDash&&(a.left=l.left-this.width,l.right=a.right+this.width);const h=this.width*this.nextRow;let f=0,_=e[f];for(let C=0;C<this.width;C++){C/_.right>1&&(_=e[++f]);const I=Math.abs(C-_.left),k=Math.abs(C-_.right),M=Math.min(I,k);this.data[h+C]=Math.max(0,Math.min(255,(_.isDash?M:-M)+128))}}addDash(e,a){const l=a?7:0,h=2*l+1;if(this.nextRow+h>this.height)return c.w("LineAtlas out of space"),null;let f=0;for(let C=0;C<e.length;C++)f+=e[C];if(f!==0){const C=this.width/f,I=this.getDashRanges(e,this.width,C);a?this.addRoundDash(I,C,l):this.addRegularDash(I)}const _={y:this.nextRow+l,height:2*l,width:f};return this.nextRow+=h,this.dirty=!0,_}bind(e){const a=e.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))}}const yt="maplibre_preloaded_worker_pool";class At{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<At.workerCount;)this.workers.push(new Worker(c.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(a=>{a.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[yt]}numActive(){return Object.keys(this.active).length}}const Rt=Math.floor(ce.hardwareConcurrency/2);let qi,pi;function En(){return qi||(qi=new At),qi}At.workerCount=c.H(globalThis)?Math.max(Math.min(Rt,3),1):1;class jt{constructor(e,a){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=a;const l=this.workerPool.acquire(a);for(let h=0;h<l.length;h++){const f=new c.J(l[h],a);f.name=`Worker ${h}`,this.actors.push(f)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,a){const l=[];for(const h of this.actors)l.push(h.sendAsync({type:e,data:a}));return Promise.all(l)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(a=>{a.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,a){for(const l of this.actors)l.registerMessageHandler(e,a)}}function zn(){return pi||(pi=new jt(En(),c.K),pi.registerMessageHandler("GR",(m,e,a)=>c.m(e,a))),pi}function vn(m,e){const a=c.L();return c.M(a,a,[1,1,0]),c.N(a,a,[.5*m.width,.5*m.height,1]),m.calculatePosMatrix?c.O(a,a,m.calculatePosMatrix(e.toUnwrapped())):a}function Nn(m,e,a,l,h,f,_){var C;const I=function(z,L,U){if(z)for(const q of z){const H=L[q];if(H&&H.source===U&&H.type==="fill-extrusion")return!0}else for(const q in L){const H=L[q];if(H.source===U&&H.type==="fill-extrusion")return!0}return!1}((C=h==null?void 0:h.layers)!==null&&C!==void 0?C:null,e,m.id),k=f.maxPitchScaleFactor(),M=m.tilesIn(l,k,I);M.sort(fr);const N=[];for(const z of M)N.push({wrappedTileID:z.tileID.wrapped().key,queryResults:z.tile.queryRenderedFeatures(e,a,m._state,z.queryGeometry,z.cameraQueryGeometry,z.scale,h,f,k,vn(m.transform,z.tileID),_?(L,U)=>_(z.tileID,L,U):void 0)});return function(z,L){for(const U in z)for(const q of z[U])gr(q,L);return z}(function(z){const L={},U={};for(const q of z){const H=q.queryResults,X=q.wrappedTileID,J=U[X]=U[X]||{};for(const ie in H){const Q=H[ie],ae=J[ie]=J[ie]||{},de=L[ie]=L[ie]||[];for(const te of Q)ae[te.featureIndex]||(ae[te.featureIndex]=!0,de.push(te))}}return L}(N),m)}function fr(m,e){const a=m.tileID,l=e.tileID;return a.overscaledZ-l.overscaledZ||a.canonical.y-l.canonical.y||a.wrap-l.wrap||a.canonical.x-l.canonical.x}function gr(m,e){const a=m.feature,l=e.getFeatureState(a.layer["source-layer"],a.id);a.source=a.layer.source,a.layer["source-layer"]&&(a.sourceLayer=a.layer["source-layer"]),a.state=l}function Ei(m,e,a){return c._(this,void 0,void 0,function*(){let l=m;if(m.url?l=(yield c.j(e.transformRequest(m.url,"Source"),a)).data:yield ce.frameAsync(a),!l)return null;const h=c.Q(c.e(l,m),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in l&&l.vector_layers&&(h.vectorLayerIds=l.vector_layers.map(f=>f.id)),h})}class ni{constructor(e,a){e&&(a?this.setSouthWest(e).setNorthEast(a):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof c.S?new c.S(e.lng,e.lat):c.S.convert(e),this}setSouthWest(e){return this._sw=e instanceof c.S?new c.S(e.lng,e.lat):c.S.convert(e),this}extend(e){const a=this._sw,l=this._ne;let h,f;if(e instanceof c.S)h=e,f=e;else{if(!(e instanceof ni))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(ni.convert(e)):this.extend(c.S.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(c.S.convert(e)):this;if(h=e._sw,f=e._ne,!h||!f)return this}return a||l?(a.lng=Math.min(h.lng,a.lng),a.lat=Math.min(h.lat,a.lat),l.lng=Math.max(f.lng,l.lng),l.lat=Math.max(f.lat,l.lat)):(this._sw=new c.S(h.lng,h.lat),this._ne=new c.S(f.lng,f.lat)),this}getCenter(){return new c.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.S(this.getWest(),this.getNorth())}getSouthEast(){return new c.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:a,lat:l}=c.S.convert(e);let h=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&h}static convert(e){return e instanceof ni?e:e&&new ni(e)}static fromLngLat(e,a=0){const l=360*a/40075017,h=l/Math.cos(Math.PI/180*e.lat);return new ni(new c.S(e.lng-h,e.lat-l),new c.S(e.lng+h,e.lat+l))}adjustAntiMeridian(){const e=new c.S(this._sw.lng,this._sw.lat),a=new c.S(this._ne.lng,this._ne.lat);return new ni(e,e.lng>a.lng?new c.S(a.lng+360,a.lat):a)}}class li{constructor(e,a,l){this.bounds=ni.convert(this.validateBounds(e)),this.minzoom=a||0,this.maxzoom=l||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const a=Math.pow(2,e.z),l=Math.floor(c.V(this.bounds.getWest())*a),h=Math.floor(c.U(this.bounds.getNorth())*a),f=Math.ceil(c.V(this.bounds.getEast())*a),_=Math.ceil(c.U(this.bounds.getSouth())*a);return e.x>=l&&e.x<f&&e.y>=h&&e.y<_}}class Dn extends c.E{constructor(e,a,l,h){if(super(),this.id=e,this.dispatcher=l,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.Q(a,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(h)}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield Ei(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(c.e(this,e),e.bounds&&(this.tileBounds=new li(e.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this._loaded=!0,this.fire(new c.k(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(e){return c._(this,void 0,void 0,function*(){const a=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l={request:this.map._requestManager.transformRequest(a,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};l.request.collectResourceTiming=this._collectResourceTiming;let h="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((f,_)=>{e.reloadPromise={resolve:f,reject:_}})}else e.actor=this.dispatcher.getActor(),h="LT";e.abortController=new AbortController;try{const f=yield e.actor.sendAsync({type:h,data:l},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,f)}catch(f){if(delete e.abortController,e.aborted)return;if(f&&f.status!==404)throw f;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,a){if(a&&a.resourceTiming&&(e.resourceTiming=a.resourceTiming),a&&this.map._refreshExpiredTiles&&e.setExpiryData(a),e.loadVectorData(a,this.map.painter),e.reloadPromise){const l=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(l.resolve).catch(l.reject)}}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Wn extends c.E{constructor(e,a,l,h){super(),this.id=e,this.dispatcher=l,this.setEventedParent(h),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},a),c.e(this,c.Q(a,["url","scheme","tileSize"]))}load(){return c._(this,arguments,void 0,function*(e=!1){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const a=yield Ei(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,a&&(c.e(this,a),a.bounds&&(this.tileBounds=new li(a.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(a){this._tileJSONRequest=null,this._loaded=!0,this.fire(new c.k(a))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return c.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return c._(this,void 0,void 0,function*(){const a=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const l=yield De.getImage(this.map._requestManager.transformRequest(a,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(l&&l.data){this.map._refreshExpiredTiles&&(l.cacheControl||l.expires)&&e.setExpiryData({cacheControl:l.cacheControl,expires:l.expires});const h=this.map.painter.context,f=h.gl,_=l.data;e.texture=this.map.painter.getTileTexture(_.width),e.texture?e.texture.update(_,{useMipmap:!0}):(e.texture=new c.T(h,_,f.RGBA,{useMipmap:!0}),e.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE,f.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(l){if(delete e.abortController,e.aborted)e.state="unloaded";else if(l)throw e.state="errored",l}})}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class Ln extends Wn{constructor(e,a,l,h){super(e,a,l,h),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox",this.redFactor=a.redFactor,this.greenFactor=a.greenFactor,this.blueFactor=a.blueFactor,this.baseShift=a.baseShift}loadTile(e){return c._(this,void 0,void 0,function*(){const a=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l=this.map._requestManager.transformRequest(a,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const h=yield De.getImage(l,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(h&&h.data){const f=h.data;this.map._refreshExpiredTiles&&(h.cacheControl||h.expires)&&e.setExpiryData({cacheControl:h.cacheControl,expires:h.expires});const _=c.b(f)&&c.W()?f:yield this.readImageNow(f),C={type:this.type,uid:e.uid,source:this.id,rawImageData:_,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const I=yield e.actor.sendAsync({type:"LDT",data:C});e.dem=I,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(h){if(delete e.abortController,e.aborted)e.state="unloaded";else if(h)throw e.state="errored",h}})}readImageNow(e){return c._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&c.X()){const a=e.width+2,l=e.height+2;try{return new c.R({width:a,height:l},yield c.Y(e,-1,-1,a,l))}catch{}}return ce.getImageData(e,1)})}_getNeighboringTiles(e){const a=e.canonical,l=Math.pow(2,a.z),h=(a.x-1+l)%l,f=a.x===0?e.wrap-1:e.wrap,_=(a.x+1+l)%l,C=a.x+1===l?e.wrap+1:e.wrap,I={};return I[new c.Z(e.overscaledZ,f,a.z,h,a.y).key]={backfilled:!1},I[new c.Z(e.overscaledZ,C,a.z,_,a.y).key]={backfilled:!1},a.y>0&&(I[new c.Z(e.overscaledZ,f,a.z,h,a.y-1).key]={backfilled:!1},I[new c.Z(e.overscaledZ,e.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},I[new c.Z(e.overscaledZ,C,a.z,_,a.y-1).key]={backfilled:!1}),a.y+1<l&&(I[new c.Z(e.overscaledZ,f,a.z,h,a.y+1).key]={backfilled:!1},I[new c.Z(e.overscaledZ,e.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},I[new c.Z(e.overscaledZ,C,a.z,_,a.y+1).key]={backfilled:!1}),I}unloadTile(e){return c._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class Rn extends c.E{constructor(e,a,l,h){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:a.data},this.actor=l.getActor(),this.setEventedParent(h),this._data=a.data,this._options=c.e({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId,a.clusterMaxZoom!==void 0&&this.maxzoom<=a.clusterMaxZoom&&c.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${a.clusterMaxZoom}".`),this.workerOptions=c.e({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(a.buffer!==void 0?a.buffer:128),tolerance:this._pixelsToTileUnits(a.tolerance!==void 0?a.tolerance:.375),extent:c.$,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(a.clusterMaxZoom),minPoints:Math.max(2,a.clusterMinPoints||2),extent:c.$,radius:this._pixelsToTileUnits(a.clusterRadius||50),log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(c.$/this.tileSize)}_getClusterMaxZoom(e){const a=e?Math.round(e):this.maxzoom-1;return Number.isInteger(e)||e===void 0||c.w(`Integer expected for option 'clusterMaxZoom': provided value "${e}" rounded to "${a}"`),a}load(){return c._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._pendingWorkerUpdate={data:e},this._updateWorkerData(),this}updateData(e){return this._pendingWorkerUpdate.diff=c.a0(this._pendingWorkerUpdate.diff,e),this._updateWorkerData(),this}getData(){return c._(this,void 0,void 0,function*(){const e=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}getCoordinatesFromGeometry(e){return e.type==="GeometryCollection"?e.geometries.map(a=>a.coordinates).flat(1/0):e.coordinates.flat(1/0)}getBounds(){return c._(this,void 0,void 0,function*(){const e=new ni,a=yield this.getData();let l;switch(a.type){case"FeatureCollection":l=a.features.map(h=>this.getCoordinatesFromGeometry(h.geometry)).flat(1/0);break;case"Feature":l=this.getCoordinatesFromGeometry(a.geometry);break;default:l=this.getCoordinatesFromGeometry(a)}if(l.length==0)return e;for(let h=0;h<l.length-1;h+=2)e.extend([l[h],l[h+1]]);return e})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(e.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,a,l){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:a,offset:l}})}_updateWorkerData(){return c._(this,void 0,void 0,function*(){if(this._isUpdatingWorker)return;const{data:e,diff:a}=this._pendingWorkerUpdate;if(!e&&!a)return void c.w(`No data or diff provided to GeoJSONSource ${this.id}.`);const l=c.e({type:this.type},this.workerOptions);e?(typeof e=="string"?(l.request=this.map._requestManager.transformRequest(ce.resolveURL(e),"Source"),l.request.collectResourceTiming=this._collectResourceTiming):l.data=JSON.stringify(e),this._pendingWorkerUpdate.data=void 0):a&&(l.dataDiff=a,this._pendingWorkerUpdate.diff=void 0),this._isUpdatingWorker=!0,this.fire(new c.l("dataloading",{dataType:"source"}));try{const h=yield this.actor.sendAsync({type:"LD",data:l});if(this._isUpdatingWorker=!1,this._removed||h.abandoned)return void this.fire(new c.l("dataabort",{dataType:"source"}));this._data=h.data;let f=null;h.resourceTiming&&h.resourceTiming[this.id]&&(f=h.resourceTiming[this.id].slice(0));const _={dataType:"source"};this._collectResourceTiming&&f&&f.length>0&&c.e(_,{resourceTiming:f}),this.fire(new c.l("data",Object.assign(Object.assign({},_),{sourceDataType:"metadata"}))),this.fire(new c.l("data",Object.assign(Object.assign({},_),{sourceDataType:"content"})))}catch(h){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new c.l("dataabort",{dataType:"source"}));this.fire(new c.k(h))}finally{(this._pendingWorkerUpdate.data||this._pendingWorkerUpdate.diff)&&this._updateWorkerData()}})}loaded(){return!this._isUpdatingWorker&&this._pendingWorkerUpdate.data===void 0&&this._pendingWorkerUpdate.diff===void 0}loadTile(e){return c._(this,void 0,void 0,function*(){const a=e.actor?"RT":"LT";e.actor=this.actor;const l={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};e.abortController=new AbortController;const h=yield this.actor.sendAsync({type:a,data:l},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(h,this.map.painter,a==="RT")})}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class xn extends c.E{constructor(e,a,l,h){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=l,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(h),this.options=a}load(e){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const a=yield De.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,a&&a.data&&(this.image=a.data,e&&(this.coordinates=e),this._finishLoading())}catch(a){this._request=null,this._loaded=!0,this.fire(new c.k(a))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const a=e.map(c.a1.fromLngLat);var l;return this.tileID=function(h){const f=c.a2.fromPoints(h),_=f.width(),C=f.height(),I=Math.max(_,C),k=Math.max(0,Math.floor(-Math.log(I)/Math.LN2)),M=Math.pow(2,k);return new c.a4(k,Math.floor((f.minX+f.maxX)/2*M),Math.floor((f.minY+f.maxY)/2*M))}(a),this.terrainTileRanges=this._getOverlappingTileRanges(a),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=a.map(h=>this.tileID.getTilePoint(h)._round()),this.flippedWindingOrder=((l=this.tileCoords)[1].x-l[0].x)*(l[2].y-l[0].y)-(l[1].y-l[0].y)*(l[2].x-l[0].x)<0,this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,a=e.gl;this.texture||(this.texture=new c.T(e,this.image,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let l=!1;for(const h in this.tiles){const f=this.tiles[h];f.state!=="loaded"&&(f.state="loaded",f.texture=this.texture,l=!0)}l&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return c._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(e){const{minX:a,minY:l,maxX:h,maxY:f}=c.a2.fromPoints(e),_={};for(let C=0;C<=c.a3;C++){const I=Math.pow(2,C),k=Math.floor(a*I),M=Math.floor(l*I),N=Math.floor(h*I),z=Math.floor(f*I);_[C]={minTileX:k,minTileY:M,maxTileX:N,maxTileY:z}}return _}}class yr extends xn{constructor(e,a,l,h){super(e,a,l,h),this.roundZoom=!0,this.type="video",this.options=a}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const a of e.urls)this.urls.push(this.map._requestManager.transformRequest(a,"Source").url);try{const a=yield c.a5(this.urls);if(this._loaded=!0,!a)return;this.video=a,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(a){this.fire(new c.k(a))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const a=this.video.seekable;e<a.start(0)||e>a.end(0)?this.fire(new c.k(new c.a6(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,a=e.gl;this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new c.T(e,this.video,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let l=!1;for(const h in this.tiles){const f=this.tiles[h];f.state!=="loaded"&&(f.state="loaded",f.texture=this.texture,l=!0)}l&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Dr extends xn{constructor(e,a,l,h){super(e,a,l,h),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some(f=>!Array.isArray(f)||f.length!==2||f.some(_=>typeof _!="number"))||this.fire(new c.k(new c.a6(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.k(new c.a6(`sources.${e}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new c.k(new c.a6(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof HTMLCanvasElement||this.fire(new c.k(new c.a6(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.k(new c.a6(`sources.${e}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}load(){return c._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const a=this.map.painter.context,l=a.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new c.T(a,this.canvas,l.RGBA,{premultiply:!0});let h=!1;for(const f in this.tiles){const _=this.tiles[f];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture,h=!0)}h&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const Lr={},Rr=m=>{switch(m){case"geojson":return Rn;case"image":return xn;case"raster":return Wn;case"raster-dem":return Ln;case"vector":return Dn;case"video":return yr;case"canvas":return Dr}return Lr[m]},Ye="RTLPluginLoaded";class ht extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=zn()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(a=>{throw this.status="error",a})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return c._(this,arguments,void 0,function*(a,l=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=ce.resolveURL(a),!this.url)throw new Error(`requested url ${a} is invalid`);if(this.status==="unavailable"){if(!l)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return c._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.l(Ye))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Vt=null;function Gt(){return Vt||(Vt=new ht),Vt}class zi{constructor(e,a){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=c.a7(),this.uses=0,this.tileSize=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const a=e+this.timeAdded;a<this.fadeEndTime||(this.fadeEndTime=a)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,a,l){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(h,f){const _={};if(!f)return _;for(const C of h){const I=C.layerIds.map(k=>f.getLayer(k)).filter(Boolean);if(I.length!==0){C.layers=I,C.stateDependentLayerIds&&(C.stateDependentLayers=C.stateDependentLayerIds.map(k=>I.filter(M=>M.id===k)[0]));for(const k of I)_[k.id]=C}}return _}(e.buckets,a==null?void 0:a.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const f=this.buckets[h];if(f instanceof c.a9){if(this.hasSymbolBuckets=!0,!l)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const f=this.buckets[h];if(f instanceof c.a9&&f.hasRTLText){this.hasRTLText=!0,Gt().lazyLoad();break}}this.queryPadding=0;for(const h in this.buckets){const f=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(h).queryRadius(f))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),this.dashPositions=e.dashPositions}else this.collisionBoxArray=new c.a8}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const l in this.buckets){const h=this.buckets[l];h.uploadPending()&&h.upload(e)}const a=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new c.T(e,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new c.T(e,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,a,l,h,f,_,C,I,k,M,N){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:h,cameraQueryGeometry:f,scale:_,tileSize:this.tileSize,pixelPosMatrix:M,transform:I,params:C,queryPadding:this.queryPadding*k,getElevation:N},e,a,l):{}}querySourceFeatures(e,a){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const h=l.loadVTLayers(),f=a&&a.sourceLayer?a.sourceLayer:"",_=h._geojsonTileLayer||h[f];if(!_)return;const C=c.aa(a==null?void 0:a.filter,a==null?void 0:a.globalState),{z:I,x:k,y:M}=this.tileID.canonical,N={z:I,x:k,y:M};for(let z=0;z<_.length;z++){const L=_.feature(z);if(C.needGeometry){const H=c.ab(L,!0);if(!C.filter(new c.F(this.tileID.overscaledZ),H,this.tileID.canonical))continue}else if(!C.filter(new c.F(this.tileID.overscaledZ),L))continue;const U=l.getId(L,f),q=new c.ac(L,I,k,M,U);q.tile=N,e.push(q)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const a=this.expirationTime;if(e.cacheControl){const l=c.ad(e.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const l=Date.now();let h=!1;if(this.expirationTime>l)h=!1;else if(a)if(this.expirationTime<a)h=!0;else{const f=this.expirationTime-a;f?this.expirationTime=l+Math.max(f,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const l=this.latestFeatureIndex.loadVTLayers();for(const h in this.buckets){if(!a.style.hasLayer(h))continue;const f=this.buckets[h],_=f.layers[0].sourceLayer||"_geojsonTileLayer",C=l[_],I=e[_];if(!C||!I||Object.keys(I).length===0)continue;f.update(I,C,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});const k=a&&a.style&&a.style.getLayer(h);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(f)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ce.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=ce.now()+e}setDependencies(e,a){const l={};for(const h of a)l[h]=!0;this.dependencies[e]=l}hasDependency(e,a){for(const l of e){const h=this.dependencies[l];if(h){for(const f of a)if(h[f])return!0}}return!1}}class me{constructor(e,a){this.max=e,this.onRemove=a,this.reset()}reset(){for(const e in this.data)for(const a of this.data[e])a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value);return this.data={},this.order=[],this}add(e,a,l){const h=e.wrapped().key;this.data[h]===void 0&&(this.data[h]=[]);const f={value:a,timeout:void 0};if(l!==void 0&&(f.timeout=setTimeout(()=>{this.remove(e,f)},l)),this.data[h].push(f),this.order.push(h),this.order.length>this.max){const _=this._getAndRemoveByKey(this.order[0]);_&&this.onRemove(_)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const a=this.data[e].shift();return a.timeout&&clearTimeout(a.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),a.value}getByKey(e){const a=this.data[e];return a?a[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,a){if(!this.has(e))return this;const l=e.wrapped().key,h=a===void 0?0:this.data[l].indexOf(a),f=this.data[l][h];return this.data[l].splice(h,1),f.timeout&&clearTimeout(f.timeout),this.data[l].length===0&&delete this.data[l],this.onRemove(f.value),this.order.splice(this.order.indexOf(l),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}filter(e){const a=[];for(const l in this.data)for(const h of this.data[l])e(h.value)||a.push(h);for(const l of a)this.remove(l.value.tileID,l)}}class j{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,a,l){const h=String(a);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][h]=this.stateChanges[e][h]||{},c.e(this.stateChanges[e][h],l),this.deletedStates[e]===null){this.deletedStates[e]={};for(const f in this.state[e])f!==h&&(this.deletedStates[e][f]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][h]===null){this.deletedStates[e][h]={};for(const f in this.state[e][h])l[f]||(this.deletedStates[e][h][f]=null)}else for(const f in l)this.deletedStates[e]&&this.deletedStates[e][h]&&this.deletedStates[e][h][f]===null&&delete this.deletedStates[e][h][f]}removeFeatureState(e,a,l){if(this.deletedStates[e]===null)return;const h=String(a);if(this.deletedStates[e]=this.deletedStates[e]||{},l&&a!==void 0)this.deletedStates[e][h]!==null&&(this.deletedStates[e][h]=this.deletedStates[e][h]||{},this.deletedStates[e][h][l]=null);else if(a!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][h])for(l in this.deletedStates[e][h]={},this.stateChanges[e][h])this.deletedStates[e][h][l]=null;else this.deletedStates[e][h]=null;else this.deletedStates[e]=null}getState(e,a){const l=String(a),h=c.e({},(this.state[e]||{})[l],(this.stateChanges[e]||{})[l]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const f=this.deletedStates[e][a];if(f===null)return{};for(const _ in f)delete h[_]}return h}initializeTileState(e,a){e.setFeatureState(this.state,a)}coalesceChanges(e,a){const l={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const f={};for(const _ in this.stateChanges[h])this.state[h][_]||(this.state[h][_]={}),c.e(this.state[h][_],this.stateChanges[h][_]),f[_]=this.state[h][_];l[h]=f}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const f={};if(this.deletedStates[h]===null)for(const _ in this.state[h])f[_]={},this.state[h][_]={};else for(const _ in this.deletedStates[h]){if(this.deletedStates[h][_]===null)this.state[h][_]={};else for(const C of Object.keys(this.deletedStates[h][_]))delete this.state[h][_][C];f[_]=this.state[h][_]}l[h]=l[h]||{},c.e(l[h],f)}if(this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0)for(const h in e)e[h].setFeatureState(l,a)}}const O=89.25;function Z(m,e){const a=c.ah(e.lat,-c.ai,c.ai);return new c.P(c.V(e.lng)*m,c.U(a)*m)}function ee(m,e){return new c.a1(e.x/m,e.y/m).toLngLat()}function le(m){return m.cameraToCenterDistance*Math.min(.85*Math.tan(c.ae(90-m.pitch)),Math.tan(c.ae(O-m.pitch)))}function ge(m,e){const a=m.canonical,l=e/c.af(a.z),h=a.x+Math.pow(2,a.z)*m.wrap,f=c.ag(new Float64Array(16));return c.M(f,f,[h*l,a.y*l,0]),c.N(f,f,[l/c.$,l/c.$,1]),f}function xe(m,e,a,l,h){const f=c.a1.fromLngLat(m,e),_=h*c.aj(1,m.lat),C=_*Math.cos(c.ae(a)),I=Math.sqrt(_*_-C*C),k=I*Math.sin(c.ae(-l)),M=I*Math.cos(c.ae(-l));return new c.a1(f.x+k,f.y+M,f.z+C)}function ye(m,e,a){const l=e.intersectsFrustum(m);if(!a||l===0)return l;const h=e.intersectsPlane(a);return h===0?0:l===2&&h===2?2:1}function Pe(m,e,a){let l=0;const h=(a-e)/10;for(let f=0;f<10;f++)l+=h*Math.pow(Math.cos(e+(f+.5)/10*(a-e)),m);return l}function Fe(m,e){return function(a,l,h,f,_){const C=2*((m-1)/c.ak(Math.cos(c.ae(O-_))/Math.cos(c.ae(O)))-1),I=Math.acos(h/f),k=2*Pe(C-1,0,c.ae(_/2)),M=Math.min(c.ae(O),I+c.ae(_/2)),N=Pe(C-1,Math.min(M,I-c.ae(_/2)),M),z=Math.atan(l/h),L=Math.hypot(l,h);let U=a;return U+=c.ak(f/L/Math.max(.5,Math.cos(c.ae(_/2)))),U+=C*c.ak(Math.cos(z))/2,U-=c.ak(Math.max(1,N/k/e))/2,U}}const ze=Fe(9.314,3);function it(m,e){const a=(e.roundZoom?Math.round:Math.floor)(m.zoom+c.ak(m.tileSize/e.tileSize));return Math.max(0,a)}function ve(m,e){const a=m.getCameraFrustum(),l=m.getClippingPlane(),h=m.screenPointToMercatorCoordinate(m.getCameraPoint()),f=c.a1.fromLngLat(m.center,m.elevation);h.z=f.z+Math.cos(m.pitchInRadians)*m.cameraToCenterDistance/m.worldSize;const _=m.getCoveringTilesDetailsProvider(),C=_.allowVariableZoom(m,e),I=it(m,e),k=e.minzoom||0,M=e.maxzoom!==void 0?e.maxzoom:m.maxZoom,N=Math.min(Math.max(0,I),M),z=Math.pow(2,N),L=[z*h.x,z*h.y,0],U=[z*f.x,z*f.y,0],q=Math.hypot(f.x-h.x,f.y-h.y),H=Math.abs(f.z-h.z),X=Math.hypot(q,H),J=ae=>({zoom:0,x:0,y:0,wrap:ae,fullyVisible:!1}),ie=[],Q=[];if(m.renderWorldCopies&&_.allowWorldCopies())for(let ae=1;ae<=3;ae++)ie.push(J(-ae)),ie.push(J(ae));for(ie.push(J(0));ie.length>0;){const ae=ie.pop(),de=ae.x,te=ae.y;let pe=ae.fullyVisible;const Ae={x:de,y:te,z:ae.zoom},be=_.getTileBoundingVolume(Ae,ae.wrap,m.elevation,e);if(!pe){const Be=ye(a,be,l);if(Be===0)continue;pe=Be===2}const Ce=_.distanceToTile2d(h.x,h.y,Ae,be);let Se=I;C&&(Se=(e.calculateTileZoom||ze)(m.zoom+c.ak(m.tileSize/e.tileSize),Ce,H,X,m.fov)),Se=(e.roundZoom?Math.round:Math.floor)(Se),Se=Math.max(0,Se);const Oe=Math.min(Se,M);if(ae.wrap=_.getWrap(f,Ae,ae.wrap),ae.zoom>=Oe){if(ae.zoom<k)continue;const Be=N-ae.zoom,Le=L[0]-.5-(de<<Be),Je=L[1]-.5-(te<<Be),wt=e.reparseOverscaled?Math.max(ae.zoom,Se):ae.zoom;Q.push({tileID:new c.Z(ae.zoom===M?wt:ae.zoom,ae.wrap,ae.zoom,de,te),distanceSq:c.al([U[0]-.5-de,U[1]-.5-te]),tileDistanceToCamera:Math.sqrt(Le*Le+Je*Je)})}else for(let Be=0;Be<4;Be++)ie.push({zoom:ae.zoom+1,x:(de<<1)+Be%2,y:(te<<1)+(Be>>1),wrap:ae.wrap,fullyVisible:pe})}return Q.sort((ae,de)=>ae.distanceSq-de.distanceSq).map(ae=>ae.tileID)}const gt=c.a2.fromPoints([new c.P(0,0),new c.P(c.$,c.$)]);class Pt extends c.E{constructor(e,a,l){super(),this.id=e,this.dispatcher=l,this.on("data",h=>this._dataHandler(h)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((h,f,_,C)=>{const I=new(Rr(f.type))(h,f,_,C);if(I.id!==h)throw new Error(`Expected Source id to be ${h} instead of ${I.id}`);return I})(e,a,l,this),this._tiles={},this._cache=new me(0,h=>this._unloadTile(h)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new j,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const a=this._tiles[e];if(a.state!=="loaded"&&a.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,a,l){return c._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,a,l)}catch(h){e.state="errored",h.status!==404?this._source.fire(new c.k(h,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new c.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const a in this._tiles){const l=this._tiles[a];l.upload(e),l.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(st).map(e=>e.key)}getRenderableIds(e){const a=[];for(const l in this._tiles)this._isIdRenderable(l,e)&&a.push(this._tiles[l]);return e?a.sort((l,h)=>{const f=l.tileID,_=h.tileID,C=new c.P(f.canonical.x,f.canonical.y)._rotate(-this.transform.bearingInRadians),I=new c.P(_.canonical.x,_.canonical.y)._rotate(-this.transform.bearingInRadians);return f.overscaledZ-_.overscaledZ||I.y-C.y||I.x-C.x}).map(l=>l.tileID.key):a.map(l=>l.tileID).sort(st).map(l=>l.key)}hasRenderableParent(e){const a=this.findLoadedParent(e,0);return!!a&&this._isIdRenderable(a.tileID.key)}_isIdRenderable(e,a){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(a||!this._tiles[e].holdingForFade())}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const a in this._tiles)e?this._reloadTile(a,"expired"):this._tiles[a].state!=="errored"&&this._reloadTile(a,"reloading")}}_reloadTile(e,a){return c._(this,void 0,void 0,function*(){const l=this._tiles[e];l&&(l.state!=="loading"&&(l.state=a),yield this._loadTile(l,e,a))})}_tileLoaded(e,a,l){e.timeAdded=ce.now(),l==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(a,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new c.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const a=this.getRenderableIds();for(let h=0;h<a.length;h++){const f=a[h];if(e.neighboringTiles&&e.neighboringTiles[f]){const _=this.getTileByID(f);l(e,_),l(_,e)}}function l(h,f){h.needsHillshadePrepare=!0,h.needsTerrainPrepare=!0;let _=f.tileID.canonical.x-h.tileID.canonical.x;const C=f.tileID.canonical.y-h.tileID.canonical.y,I=Math.pow(2,h.tileID.canonical.z),k=f.tileID.key;_===0&&C===0||Math.abs(C)>1||(Math.abs(_)>1&&(Math.abs(_+I)===1?_+=I:Math.abs(_-I)===1&&(_-=I)),f.dem&&h.dem&&(h.dem.backfillBorder(f.dem,_,C),h.neighboringTiles&&h.neighboringTiles[k]&&(h.neighboringTiles[k].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,a){const l=Object.values(e),h=this._getLoadedDescendents(l),f={};for(const _ of l){const C=h[_.key];if(!(C!=null&&C.length)){f[_.key]=_;continue}const I=_.overscaledZ+Pt.maxUnderzooming,k=C.filter(z=>z.tileID.overscaledZ<=I);if(!k.length){f[_.key]=_;continue}const M=Math.min(...k.map(z=>z.tileID.overscaledZ)),N=k.filter(z=>z.tileID.overscaledZ===M).map(z=>z.tileID);for(const z of N)a[z.key]=z;this._areDescendentsComplete(N,M,_.overscaledZ)||(f[_.key]=_)}return f}_getLoadedDescendents(e){var a;const l={};for(const h in this._tiles){const f=this._tiles[h];if(f.hasData())for(const _ of e)f.tileID.isChildOf(_)&&(l[a=_.key]||(l[a]=[])).push(f)}return l}_areDescendentsComplete(e,a,l){return e.length===1&&e[0].isOverscaled()?e[0].overscaledZ===a:Math.pow(4,a-l)===e.length}findLoadedParent(e,a){if(e.key in this._loadedParentTiles){const l=this._loadedParentTiles[e.key];return l&&l.tileID.overscaledZ>=a?l:null}for(let l=e.overscaledZ-1;l>=a;l--){const h=e.scaledTo(l),f=this._getLoadedTile(h);if(f)return f}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const a=this._tiles[e.key];return a&&a.hasData()?a:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const a=Math.ceil(e.width/this._source.tileSize)+1,l=Math.ceil(e.height/this._source.tileSize)+1,h=Math.floor(a*l*(this._maxTileCacheZoomLevels===null?c.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),f=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,h):h;this._cache.setMaxSize(f)}handleWrapJump(e){const a=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,a){const l={};for(const h in this._tiles){const f=this._tiles[h];f.tileID=f.tileID.unwrapTo(f.tileID.wrap+a),l[f.tileID.key]=f}this._tiles=l;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(h,this._tiles[h])}}update(e,a){if(!this._sourceLoaded||this._paused)return;let l;this.transform=e,this.terrain=a,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?l=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(k=>new c.Z(k.canonical.z,k.wrap,k.canonical.z,k.canonical.x,k.canonical.y)):(l=ve(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:a,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(l=l.filter(k=>this._source.hasTile(k)))):l=[],this.usedForTerrain&&(l=this._addTerrainIdealTiles(l));const h=it(e,this._source),f=Math.max(h-Pt.maxOverzooming,this._source.minzoom),_=l.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,_&&this.fire(new c.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const C=this._updateRetainedTiles(l,h);vt(this._source.type)&&!a&&this._updateFadingTiles(C,f);for(const k in C)this._tiles[k].clearFadeHold();const I=c.am(this._tiles,C);for(const k of I){const M=this._tiles[k];M.hasSymbolBuckets&&!M.holdingForFade()?M.setHoldDuration(this.map._fadeDuration):M.hasSymbolBuckets&&!M.symbolFadeFinished()||this._removeTile(k)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}_addTerrainIdealTiles(e){const a=[];for(const l of e)if(l.canonical.z>this._source.minzoom){const h=l.scaledTo(l.canonical.z-1);a.push(h);const f=l.scaledTo(Math.max(this._source.minzoom,Math.min(l.canonical.z,5)));a.push(f)}return e.concat(a)}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,a){var l;const h={},f={},_=Math.max(a-Pt.maxOverzooming,this._source.minzoom);let C={};for(const I of e){const k=this._addTile(I);h[I.key]=I,k.hasData()||(C[I.key]=I)}C=this._retainLoadedChildren(C,h);for(const I in C){const k=C[I];let M=this._tiles[I],N=M==null?void 0:M.wasRequested();for(let z=k.overscaledZ-1;z>=_;--z){const L=k.scaledTo(z);if(f[L.key])break;if(f[L.key]=!0,M=this.getTile(L),!M&&N&&(M=this._addTile(L)),M){const U=M.hasData();if((U||!(!((l=this.map)===null||l===void 0)&&l.cancelPendingTileRequestsWhileZooming)||N)&&(h[L.key]=L),N=M.wasRequested(),U)break}}}return h}_updateFadingTiles(e,a){const l={},h={},f=Object.keys(e),_=ce.now();for(const C of f){const I=e[C],k=this._tiles[C];if(!k||k.fadeEndTime!==0&&k.fadeEndTime<=_)continue;const M=this.findLoadedParent(I,a),N=this.findLoadedSibling(I),z=M||N||null;z&&(this._addTile(z.tileID),l[z.tileID.key]=z.tileID),h[C]=I}this._retainLoadedChildren(h,e);for(const C in l)e[C]||(this._coveredTiles[C]=!0,e[C]=l[C])}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const a=[];let l,h=this._tiles[e].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){l=this._loadedParentTiles[h.key];break}a.push(h.key);const f=h.scaledTo(h.overscaledZ-1);if(l=this._getLoadedTile(f),l)break;h=f}for(const f of a)this._loadedParentTiles[f]=l}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const a=this._tiles[e].tileID,l=this._getLoadedTile(a);this._loadedSiblingTiles[a.key]=l}}_addTile(e){let a=this._tiles[e.key];if(a)return a;a=this._cache.getAndRemove(e),a&&(this._setTileReloadTimer(e.key,a),a.tileID=e,this._state.initializeTileState(a,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,a)));const l=a;return a||(a=new zi(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(a,e.key,a.state)),a.uses++,this._tiles[e.key]=a,l||this._source.fire(new c.l("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a}_setTileReloadTimer(e,a){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const l=a.getExpiryTimeout();l&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},l))}refreshTiles(e){for(const a in this._tiles)(this._isIdRenderable(a)||this._tiles[a].state=="errored")&&e.some(l=>l.equals(this._tiles[a].tileID.canonical))&&this._reloadTile(a,"expired")}_removeTile(e){const a=this._tiles[e];a&&(a.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),a.uses>0||(a.hasData()&&a.state!=="reloading"?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}_dataHandler(e){const a=e.sourceDataType;e.dataType==="source"&&a==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&a==="content"&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,a,l){const h=[],f=this.transform;if(!f)return h;const _=f.getCoveringTilesDetailsProvider().allowWorldCopies(),C=l?f.getCameraQueryGeometry(e):e,I=L=>f.screenPointToMercatorCoordinate(L,this.terrain),k=this.transformBbox(e,I,!_),M=this.transformBbox(C,I,!_),N=this.getIds(),z=c.a2.fromPoints(M);for(let L=0;L<N.length;L++){const U=this._tiles[N[L]];if(U.holdingForFade())continue;const q=_?[U.tileID]:[U.tileID.unwrapTo(-1),U.tileID.unwrapTo(0)],H=Math.pow(2,f.zoom-U.tileID.overscaledZ),X=a*U.queryPadding*c.$/U.tileSize/H;for(const J of q){const ie=z.map(Q=>J.getTilePoint(new c.a1(Q.x,Q.y)));if(ie.expandBy(X),ie.intersects(gt)){const Q=k.map(de=>J.getTilePoint(de)),ae=M.map(de=>J.getTilePoint(de));h.push({tile:U,tileID:_?J:J.unwrapTo(0),queryGeometry:Q,cameraQueryGeometry:ae,scale:H})}}}return h}transformBbox(e,a,l){let h=e.map(a);if(l){const f=c.a2.fromPoints(e);f.shrinkBy(.001*Math.min(f.width(),f.height()));const _=f.map(a);c.a2.fromPoints(h).covers(_)||(h=h.map(C=>C.x>.5?new c.a1(C.x-1,C.y,C.z):C))}return h}getVisibleCoordinates(e){const a=this.getRenderableIds(e).map(l=>this._tiles[l].tileID);return this.transform&&this.transform.populateCache(a),a}hasTransition(){if(this._source.hasTransition())return!0;if(vt(this._source.type)){const e=ce.now();for(const a in this._tiles)if(this._tiles[a].fadeEndTime>=e)return!0}return!1}setFeatureState(e,a,l){this._state.updateState(e=e||"_geojsonTileLayer",a,l)}removeFeatureState(e,a,l){this._state.removeFeatureState(e=e||"_geojsonTileLayer",a,l)}getFeatureState(e,a){return this._state.getState(e=e||"_geojsonTileLayer",a)}setDependencies(e,a,l){const h=this._tiles[e];h&&h.setDependencies(a,l)}reloadTilesForDependencies(e,a){for(const l in this._tiles)this._tiles[l].hasDependency(e,a)&&this._reloadTile(l,"reloading");this._cache.filter(l=>!l.hasDependency(e,a))}}function st(m,e){const a=Math.abs(2*m.wrap)-+(m.wrap<0),l=Math.abs(2*e.wrap)-+(e.wrap<0);return m.overscaledZ-e.overscaledZ||l-a||e.canonical.y-m.canonical.y||e.canonical.x-m.canonical.x}function vt(m){return m==="raster"||m==="image"||m==="video"}Pt.maxOverzooming=10,Pt.maxUnderzooming=3;class Ht{constructor(e,a){this.reset(e,a)}reset(e,a){this.points=e||[],this._distances=[0];for(let l=1;l<this.points.length;l++)this._distances[l]=this._distances[l-1]+this.points[l].dist(this.points[l-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=c.ah(e,0,1);let a=1,l=this._distances[a];const h=e*this.paddedLength+this.padding;for(;l<h&&a<this._distances.length;)l=this._distances[++a];const f=a-1,_=this._distances[f],C=l-_,I=C>0?(h-_)/C:0;return this.points[f].mult(1-I).add(this.points[a].mult(I))}}function wi(m,e){let a=!0;return m==="always"||m!=="never"&&e!=="never"||(a=!1),a}class ji{constructor(e,a,l){const h=this.boxCells=[],f=this.circleCells=[];this.xCellCount=Math.ceil(e/l),this.yCellCount=Math.ceil(a/l);for(let _=0;_<this.xCellCount*this.yCellCount;_++)h.push([]),f.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=a,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,a,l,h,f){this._forEachCell(a,l,h,f,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(a),this.bboxes.push(l),this.bboxes.push(h),this.bboxes.push(f)}insertCircle(e,a,l,h){this._forEachCell(a-h,l-h,a+h,l+h,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(a),this.circles.push(l),this.circles.push(h)}_insertBoxCell(e,a,l,h,f,_){this.boxCells[f].push(_)}_insertCircleCell(e,a,l,h,f,_){this.circleCells[f].push(_)}_query(e,a,l,h,f,_,C){if(l<0||e>this.width||h<0||a>this.height)return[];const I=[];if(e<=0&&a<=0&&this.width<=l&&this.height<=h){if(f)return[{key:null,x1:e,y1:a,x2:l,y2:h}];for(let k=0;k<this.boxKeys.length;k++)I.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(let k=0;k<this.circleKeys.length;k++){const M=this.circles[3*k],N=this.circles[3*k+1],z=this.circles[3*k+2];I.push({key:this.circleKeys[k],x1:M-z,y1:N-z,x2:M+z,y2:N+z})}}else this._forEachCell(e,a,l,h,this._queryCell,I,{hitTest:f,overlapMode:_,seenUids:{box:{},circle:{}}},C);return I}query(e,a,l,h){return this._query(e,a,l,h,!1,null)}hitTest(e,a,l,h,f,_){return this._query(e,a,l,h,!0,f,_).length>0}hitTestCircle(e,a,l,h,f){const _=e-l,C=e+l,I=a-l,k=a+l;if(C<0||_>this.width||k<0||I>this.height)return!1;const M=[];return this._forEachCell(_,I,C,k,this._queryCellCircle,M,{hitTest:!0,overlapMode:h,circle:{x:e,y:a,radius:l},seenUids:{box:{},circle:{}}},f),M.length>0}_queryCell(e,a,l,h,f,_,C,I){const{seenUids:k,hitTest:M,overlapMode:N}=C,z=this.boxCells[f];if(z!==null){const U=this.bboxes;for(const q of z)if(!k.box[q]){k.box[q]=!0;const H=4*q,X=this.boxKeys[q];if(e<=U[H+2]&&a<=U[H+3]&&l>=U[H+0]&&h>=U[H+1]&&(!I||I(X))&&(!M||!wi(N,X.overlapMode))&&(_.push({key:X,x1:U[H],y1:U[H+1],x2:U[H+2],y2:U[H+3]}),M))return!0}}const L=this.circleCells[f];if(L!==null){const U=this.circles;for(const q of L)if(!k.circle[q]){k.circle[q]=!0;const H=3*q,X=this.circleKeys[q];if(this._circleAndRectCollide(U[H],U[H+1],U[H+2],e,a,l,h)&&(!I||I(X))&&(!M||!wi(N,X.overlapMode))){const J=U[H],ie=U[H+1],Q=U[H+2];if(_.push({key:X,x1:J-Q,y1:ie-Q,x2:J+Q,y2:ie+Q}),M)return!0}}}return!1}_queryCellCircle(e,a,l,h,f,_,C,I){const{circle:k,seenUids:M,overlapMode:N}=C,z=this.boxCells[f];if(z!==null){const U=this.bboxes;for(const q of z)if(!M.box[q]){M.box[q]=!0;const H=4*q,X=this.boxKeys[q];if(this._circleAndRectCollide(k.x,k.y,k.radius,U[H+0],U[H+1],U[H+2],U[H+3])&&(!I||I(X))&&!wi(N,X.overlapMode))return _.push(!0),!0}}const L=this.circleCells[f];if(L!==null){const U=this.circles;for(const q of L)if(!M.circle[q]){M.circle[q]=!0;const H=3*q,X=this.circleKeys[q];if(this._circlesCollide(U[H],U[H+1],U[H+2],k.x,k.y,k.radius)&&(!I||I(X))&&!wi(N,X.overlapMode))return _.push(!0),!0}}}_forEachCell(e,a,l,h,f,_,C,I){const k=this._convertToXCellCoord(e),M=this._convertToYCellCoord(a),N=this._convertToXCellCoord(l),z=this._convertToYCellCoord(h);for(let L=k;L<=N;L++)for(let U=M;U<=z;U++)if(f.call(this,e,a,l,h,this.xCellCount*U+L,_,C,I))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,a,l,h,f,_){const C=h-e,I=f-a,k=l+_;return k*k>C*C+I*I}_circleAndRectCollide(e,a,l,h,f,_,C){const I=(_-h)/2,k=Math.abs(e-(h+I));if(k>I+l)return!1;const M=(C-f)/2,N=Math.abs(a-(f+M));if(N>M+l)return!1;if(k<=I||N<=M)return!0;const z=k-I,L=N-M;return z*z+L*L<=l*l}}function Oi(m,e,a){const l=c.L();if(!m){const{vecSouth:N,vecEast:z}=Xt(e),L=W();L[0]=z[0],L[1]=z[1],L[2]=N[0],L[3]=N[1],h=L,(M=(_=(f=L)[0])*(k=f[3])-(I=f[2])*(C=f[1]))&&(h[0]=k*(M=1/M),h[1]=-C*M,h[2]=-I*M,h[3]=_*M),l[0]=L[0],l[1]=L[1],l[4]=L[2],l[5]=L[3]}var h,f,_,C,I,k,M;return c.N(l,l,[1/a,1/a,1]),l}function Vi(m,e,a,l){if(m){const h=c.L();if(!e){const{vecSouth:f,vecEast:_}=Xt(a);h[0]=_[0],h[1]=_[1],h[4]=f[0],h[5]=f[1]}return c.N(h,h,[l,l,1]),h}return a.pixelsToClipSpaceMatrix}function Xt(m){const e=Math.cos(m.rollInRadians),a=Math.sin(m.rollInRadians),l=Math.cos(m.pitchInRadians),h=Math.cos(m.bearingInRadians),f=Math.sin(m.bearingInRadians),_=c.ar();_[0]=-h*l*a-f*e,_[1]=-f*l*a+h*e;const C=c.as(_);C<1e-9?c.at(_):c.au(_,_,1/C);const I=c.ar();I[0]=h*l*e-f*a,I[1]=f*l*e+h*a;const k=c.as(I);return k<1e-9?c.at(I):c.au(I,I,1/k),{vecEast:I,vecSouth:_}}function Ci(m,e,a,l){let h;l?(h=[m,e,l(m,e),1],c.aw(h,h,a)):(h=[m,e,0,1],vo(h,h,a));const f=h[3];return{point:new c.P(h[0]/f,h[1]/f),signedDistanceFromCamera:f,isOccluded:!1}}function Ne(m,e){return .5+m/e*.5}function Ii(m,e){return m.x>=-e[0]&&m.x<=e[0]&&m.y>=-e[1]&&m.y<=e[1]}function qn(m,e,a,l,h,f,_,C,I,k,M,N,z){const L=a?m.textSizeData:m.iconSizeData,U=c.an(L,e.transform.zoom),q=[256/e.width*2+1,256/e.height*2+1],H=a?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;H.clear();const X=m.lineVertexArray,J=a?m.text.placedSymbolArray:m.icon.placedSymbolArray,ie=e.transform.width/e.transform.height;let Q=!1;for(let ae=0;ae<J.length;ae++){const de=J.get(ae);if(de.hidden||de.writingMode===c.ao.vertical&&!Q){Fr(de.numGlyphs,H);continue}Q=!1;const te=new c.P(de.anchorX,de.anchorY),pe={getElevation:z,pitchedLabelPlaneMatrix:l,lineVertexArray:X,pitchWithMap:f,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:te,unwrappedTileID:I,width:k,height:M,translation:N},Ae=ma(de.anchorX,de.anchorY,pe);if(!Ii(Ae.point,q)){Fr(de.numGlyphs,H);continue}const be=Ne(e.transform.cameraToCenterDistance,Ae.signedDistanceFromCamera),Ce=c.ap(L,U,de),Se=f?Ce*e.transform.getPitchedTextCorrection(de.anchorX,de.anchorY,I)/be:Ce*be,Oe=je({projectionContext:pe,pitchedLabelPlaneMatrixInverse:h,symbol:de,fontSize:Se,flip:!1,keepUpright:_,glyphOffsetArray:m.glyphOffsetArray,dynamicLayoutVertexArray:H,aspectRatio:ie,rotateToLine:C});Q=Oe.useVertical,(Oe.notEnoughRoom||Q||Oe.needsFlipping&&je({projectionContext:pe,pitchedLabelPlaneMatrixInverse:h,symbol:de,fontSize:Se,flip:!0,keepUpright:_,glyphOffsetArray:m.glyphOffsetArray,dynamicLayoutVertexArray:H,aspectRatio:ie,rotateToLine:C}).notEnoughRoom)&&Fr(de.numGlyphs,H)}a?m.text.dynamicLayoutVertexBuffer.updateData(H):m.icon.dynamicLayoutVertexBuffer.updateData(H)}function Na(m,e,a,l,h,f,_,C){const I=f.glyphStartIndex+f.numGlyphs,k=f.lineStartIndex,M=f.lineStartIndex+f.lineLength,N=e.getoffsetX(f.glyphStartIndex),z=e.getoffsetX(I-1),L=fa(m*N,a,l,h,f.segment,k,M,C,_);if(!L)return null;const U=fa(m*z,a,l,h,f.segment,k,M,C,_);return U?C.projectionCache.anyProjectionOccluded?null:{first:L,last:U}:null}function hn(m,e,a,l){return m===c.ao.horizontal&&Math.abs(a.y-e.y)>Math.abs(a.x-e.x)*l?{useVertical:!0}:(m===c.ao.vertical?e.y<a.y:e.x>a.x)?{needsFlipping:!0}:null}function je(m){const{projectionContext:e,pitchedLabelPlaneMatrixInverse:a,symbol:l,fontSize:h,flip:f,keepUpright:_,glyphOffsetArray:C,dynamicLayoutVertexArray:I,aspectRatio:k,rotateToLine:M}=m,N=h/24,z=l.lineOffsetX*N,L=l.lineOffsetY*N;let U;if(l.numGlyphs>1){const q=l.glyphStartIndex+l.numGlyphs,H=l.lineStartIndex,X=l.lineStartIndex+l.lineLength,J=Na(N,C,z,L,f,l,M,e);if(!J)return{notEnoughRoom:!0};const ie=Da(J.first.point.x,J.first.point.y,e,a),Q=Da(J.last.point.x,J.last.point.y,e,a);if(_&&!f){const ae=hn(l.writingMode,ie,Q,k);if(ae)return ae}U=[J.first];for(let ae=l.glyphStartIndex+1;ae<q-1;ae++){const de=fa(N*C.getoffsetX(ae),z,L,f,l.segment,H,X,e,M);if(!de)return{notEnoughRoom:!0};U.push(de)}U.push(J.last)}else{if(_&&!f){const H=nn(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,X=l.lineStartIndex+l.segment+1,J=new c.P(e.lineVertexArray.getx(X),e.lineVertexArray.gety(X)),ie=nn(J.x,J.y,e),Q=ie.signedDistanceFromCamera>0?ie.point:xt(e.tileAnchorPoint,J,H,1,e),ae=Da(H.x,H.y,e,a),de=Da(Q.x,Q.y,e,a),te=hn(l.writingMode,ae,de,k);if(te)return te}const q=fa(N*C.getoffsetX(l.glyphStartIndex),z,L,f,l.segment,l.lineStartIndex,l.lineStartIndex+l.lineLength,e,M);if(!q||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};U=[q]}for(const q of U)c.av(I,q.point,q.angle);return{}}function xt(m,e,a,l,h){const f=m.add(m.sub(e)._unit()),_=nn(f.x,f.y,h).point,C=a.sub(_);return a.add(C._mult(l/C.mag()))}function Ct(m,e,a){const l=e.projectionCache;if(l.projections[m])return l.projections[m];const h=new c.P(e.lineVertexArray.getx(m),e.lineVertexArray.gety(m)),f=nn(h.x,h.y,e);if(f.signedDistanceFromCamera>0)return l.projections[m]=f.point,l.anyProjectionOccluded=l.anyProjectionOccluded||f.isOccluded,f.point;const _=m-a.direction;return xt(a.distanceFromAnchor===0?e.tileAnchorPoint:new c.P(e.lineVertexArray.getx(_),e.lineVertexArray.gety(_)),h,a.previousVertex,a.absOffsetX-a.distanceFromAnchor+1,e)}function nn(m,e,a){const l=m+a.translation[0],h=e+a.translation[1];let f;return a.pitchWithMap?(f=Ci(l,h,a.pitchedLabelPlaneMatrix,a.getElevation),f.isOccluded=!1):(f=a.transform.projectTileCoordinates(l,h,a.unwrappedTileID,a.getElevation),f.point.x=(.5*f.point.x+.5)*a.width,f.point.y=(.5*-f.point.y+.5)*a.height),f}function Da(m,e,a,l){if(a.pitchWithMap){const h=[m,e,0,1];return c.aw(h,h,l),a.transform.projectTileCoordinates(h[0]/h[3],h[1]/h[3],a.unwrappedTileID,a.getElevation).point}return{x:m/a.width*2-1,y:1-e/a.height*2}}function ma(m,e,a){return a.transform.projectTileCoordinates(m,e,a.unwrappedTileID,a.getElevation)}function bt(m,e,a){return m._unit()._perp()._mult(e*a)}function cl(m,e,a,l,h,f,_,C,I){if(C.projectionCache.offsets[m])return C.projectionCache.offsets[m];const k=a.add(e);if(m+I.direction<l||m+I.direction>=h)return C.projectionCache.offsets[m]=k,k;const M=Ct(m+I.direction,C,I),N=bt(M.sub(a),_,I.direction),z=a.add(N),L=M.add(N);return C.projectionCache.offsets[m]=c.ax(f,k,z,L)||k,C.projectionCache.offsets[m]}function fa(m,e,a,l,h,f,_,C,I){const k=l?m-e:m+e;let M=k>0?1:-1,N=0;l&&(M*=-1,N=Math.PI),M<0&&(N+=Math.PI);let z,L=M>0?f+h:f+h+1;C.projectionCache.cachedAnchorPoint?z=C.projectionCache.cachedAnchorPoint:(z=nn(C.tileAnchorPoint.x,C.tileAnchorPoint.y,C).point,C.projectionCache.cachedAnchorPoint=z);let U,q,H=z,X=z,J=0,ie=0;const Q=Math.abs(k),ae=[];let de;for(;J+ie<=Q;){if(L+=M,L<f||L>=_)return null;J+=ie,X=H,q=U;const Ae={absOffsetX:Q,direction:M,distanceFromAnchor:J,previousVertex:X};if(H=Ct(L,C,Ae),a===0)ae.push(X),de=H.sub(X);else{let be;const Ce=H.sub(X);be=Ce.mag()===0?bt(Ct(L+M,C,Ae).sub(H),a,M):bt(Ce,a,M),q||(q=X.add(be)),U=cl(L,be,H,f,_,q,a,C,Ae),ae.push(q),de=U.sub(q)}ie=de.mag()}const te=de._mult((Q-J)/ie)._add(q||X),pe=N+Math.atan2(H.y-X.y,H.x-X.x);return ae.push(te),{point:te,angle:I?pe:0,path:ae}}const ul=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Fr(m,e){for(let a=0;a<m;a++){const l=e.length;e.resize(l+4),e.float32.set(ul,3*l)}}function vo(m,e,a){const l=e[0],h=e[1];return m[0]=a[0]*l+a[4]*h+a[12],m[1]=a[1]*l+a[5]*h+a[13],m[3]=a[3]*l+a[7]*h+a[15],m}const vi=100;class hl{constructor(e,a=new ji(e.width+200,e.height+200,25),l=new ji(e.width+200,e.height+200,25)){this.transform=e,this.grid=a,this.ignoredGrid=l,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+vi,this.screenBottomBoundary=e.height+vi,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,a,l,h,f,_,C,I,k,M,N,z){const L=this.projectAndGetPerspectiveRatio(e.anchorPointX+I[0],e.anchorPointY+I[1],f,M,z),U=l*L.perspectiveRatio;let q;if(_||C)q=this._projectCollisionBox(e,U,h,f,_,C,I,L,M,N,z);else{const de=L.x+(N?N.x*U:0),te=L.y+(N?N.y*U:0);q={allPointsOccluded:!1,box:[de+e.x1*U,te+e.y1*U,de+e.x2*U,te+e.y2*U]}}const[H,X,J,ie]=q.box,Q=_?q.allPointsOccluded:L.isOccluded;let ae=Q;return ae||(ae=L.perspectiveRatio<this.perspectiveRatioCutoff),ae||(ae=!this.isInsideGrid(H,X,J,ie)),ae||a!=="always"&&this.grid.hitTest(H,X,J,ie,a,k)?{box:[H,X,J,ie],placeable:!1,offscreen:!1,occluded:Q}:{box:[H,X,J,ie],placeable:!0,offscreen:this.isOffscreen(H,X,J,ie),occluded:Q}}placeCollisionCircles(e,a,l,h,f,_,C,I,k,M,N,z,L,U){const q=[],H=new c.P(a.anchorX,a.anchorY),X=this.getPerspectiveRatio(H.x,H.y,_,U),J=(k?f*this.transform.getPitchedTextCorrection(a.anchorX,a.anchorY,_)/X:f*X)/c.aB,ie={getElevation:U,pitchedLabelPlaneMatrix:C,lineVertexArray:l,pitchWithMap:k,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:H,unwrappedTileID:_,width:this.transform.width,height:this.transform.height,translation:L},Q=Na(J,h,a.lineOffsetX*J,a.lineOffsetY*J,!1,a,!1,ie);let ae=!1,de=!1,te=!0;if(Q){const pe=.5*N*X+z,Ae=new c.P(-100,-100),be=new c.P(this.screenRightBoundary,this.screenBottomBoundary),Ce=new Ht,Se=Q.first,Oe=Q.last;let Be=[];for(let wt=Se.path.length-1;wt>=1;wt--)Be.push(Se.path[wt]);for(let wt=1;wt<Oe.path.length;wt++)Be.push(Oe.path[wt]);const Le=2.5*pe;if(k){const wt=this.projectPathToScreenSpace(Be,ie);Be=wt.some(Ft=>Ft.signedDistanceFromCamera<=0)?[]:wt.map(Ft=>Ft.point)}let Je=[];if(Be.length>0){const wt=Be[0].clone(),Ft=Be[0].clone();for(let Jt=1;Jt<Be.length;Jt++)wt.x=Math.min(wt.x,Be[Jt].x),wt.y=Math.min(wt.y,Be[Jt].y),Ft.x=Math.max(Ft.x,Be[Jt].x),Ft.y=Math.max(Ft.y,Be[Jt].y);Je=wt.x>=Ae.x&&Ft.x<=be.x&&wt.y>=Ae.y&&Ft.y<=be.y?[Be]:Ft.x<Ae.x||wt.x>be.x||Ft.y<Ae.y||wt.y>be.y?[]:c.ay([Be],Ae.x,Ae.y,be.x,be.y)}for(const wt of Je){Ce.reset(wt,.25*pe);let Ft=0;Ft=Ce.length<=.5*pe?1:Math.ceil(Ce.paddedLength/Le)+1;for(let Jt=0;Jt<Ft;Jt++){const Wt=Jt/Math.max(Ft-1,1),ai=Ce.lerp(Wt),Qt=ai.x+vi,Ui=ai.y+vi;q.push(Qt,Ui,pe,0);const ei=Qt-pe,Ut=Ui-pe,ci=Qt+pe,It=Ui+pe;if(te=te&&this.isOffscreen(ei,Ut,ci,It),de=de||this.isInsideGrid(ei,Ut,ci,It),e!=="always"&&this.grid.hitTestCircle(Qt,Ui,pe,e,M)&&(ae=!0,!I))return{circles:[],offscreen:!1,collisionDetected:ae}}}}return{circles:!I&&ae||!de||X<this.perspectiveRatioCutoff?[]:q,offscreen:te,collisionDetected:ae}}projectPathToScreenSpace(e,a){const l=function(h,f){const _=c.L();return c.aq(_,f.pitchedLabelPlaneMatrix),h.map(C=>{const I=Ci(C.x,C.y,_,f.getElevation),k=f.transform.projectTileCoordinates(I.point.x,I.point.y,f.unwrappedTileID,f.getElevation);return k.point.x=(.5*k.point.x+.5)*f.width,k.point.y=(.5*-k.point.y+.5)*f.height,k})}(e,a);return function(h){let f=0,_=0,C=0,I=0;for(let k=0;k<h.length;k++)h[k].isOccluded?(C=k+1,I=0):(I++,I>_&&(_=I,f=C));return h.slice(f,f+_)}(l)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const a=[],l=new c.a2;for(const N of e){const z=new c.P(N.x+vi,N.y+vi);l.extend(z),a.push(z)}const{minX:h,minY:f,maxX:_,maxY:C}=l,I=this.grid.query(h,f,_,C).concat(this.ignoredGrid.query(h,f,_,C)),k={},M={};for(const N of I){const z=N.key;if(k[z.bucketInstanceId]===void 0&&(k[z.bucketInstanceId]={}),k[z.bucketInstanceId][z.featureIndex])continue;const L=[new c.P(N.x1,N.y1),new c.P(N.x2,N.y1),new c.P(N.x2,N.y2),new c.P(N.x1,N.y2)];c.az(a,L)&&(k[z.bucketInstanceId][z.featureIndex]=!0,M[z.bucketInstanceId]===void 0&&(M[z.bucketInstanceId]=[]),M[z.bucketInstanceId].push(z.featureIndex))}return M}insertCollisionBox(e,a,l,h,f,_){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:h,featureIndex:f,collisionGroupID:_,overlapMode:a},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,a,l,h,f,_){const C=l?this.ignoredGrid:this.grid,I={bucketInstanceId:h,featureIndex:f,collisionGroupID:_,overlapMode:a};for(let k=0;k<e.length;k+=4)C.insertCircle(I,e[k],e[k+1],e[k+2])}projectAndGetPerspectiveRatio(e,a,l,h,f){if(f){let _;h?(_=[e,a,h(e,a),1],c.aw(_,_,f)):(_=[e,a,0,1],vo(_,_,f));const C=_[3];return{x:(_[0]/C+1)/2*this.transform.width+vi,y:(-_[1]/C+1)/2*this.transform.height+vi,perspectiveRatio:.5+this.transform.cameraToCenterDistance/C*.5,isOccluded:!1,signedDistanceFromCamera:C}}{const _=this.transform.projectTileCoordinates(e,a,l,h);return{x:(_.point.x+1)/2*this.transform.width+vi,y:(1-_.point.y)/2*this.transform.height+vi,perspectiveRatio:.5+this.transform.cameraToCenterDistance/_.signedDistanceFromCamera*.5,isOccluded:_.isOccluded,signedDistanceFromCamera:_.signedDistanceFromCamera}}}getPerspectiveRatio(e,a,l,h){const f=this.transform.projectTileCoordinates(e,a,l,h);return .5+this.transform.cameraToCenterDistance/f.signedDistanceFromCamera*.5}isOffscreen(e,a,l,h){return l<vi||e>=this.screenRightBoundary||h<vi||a>this.screenBottomBoundary}isInsideGrid(e,a,l,h){return l>=0&&e<this.gridRightBoundary&&h>=0&&a<this.gridBottomBoundary}getViewportMatrix(){const e=c.ag([]);return c.M(e,e,[-100,-100,0]),e}_projectCollisionBox(e,a,l,h,f,_,C,I,k,M,N){let z=1,L=0,U=0,q=1;const H=e.anchorPointX+C[0],X=e.anchorPointY+C[1];if(_&&!f){const Be=this.projectAndGetPerspectiveRatio(H+1,X,h,k,N),Le=Be.x-I.x,Je=Math.atan((Be.y-I.y)/Le)+(Le<0?Math.PI:0),wt=Math.sin(Je),Ft=Math.cos(Je);z=Ft,L=wt,U=-wt,q=Ft}else if(!_&&f){const Be=Xt(this.transform);z=Be.vecEast[0],L=Be.vecEast[1],U=Be.vecSouth[0],q=Be.vecSouth[1]}let J=I.x,ie=I.y,Q=a;f&&(J=H,ie=X,Q=Math.pow(2,-(this.transform.zoom-l.overscaledZ)),Q*=this.transform.getPitchedTextCorrection(H,X,h),M||(Q*=c.ah(.5+I.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),M&&(J+=z*M.x*Q+U*M.y*Q,ie+=L*M.x*Q+q*M.y*Q);const ae=e.x1*Q,de=e.x2*Q,te=(ae+de)/2,pe=e.y1*Q,Ae=e.y2*Q,be=(pe+Ae)/2,Ce=[{offsetX:ae,offsetY:pe},{offsetX:te,offsetY:pe},{offsetX:de,offsetY:pe},{offsetX:de,offsetY:be},{offsetX:de,offsetY:Ae},{offsetX:te,offsetY:Ae},{offsetX:ae,offsetY:Ae},{offsetX:ae,offsetY:be}];let Se=[];for(const{offsetX:Be,offsetY:Le}of Ce)Se.push(new c.P(J+z*Be+U*Le,ie+L*Be+q*Le));let Oe=!1;if(f){const Be=Se.map(Le=>this.projectAndGetPerspectiveRatio(Le.x,Le.y,h,k,N));Oe=Be.some(Le=>!Le.isOccluded),Se=Be.map(Le=>new c.P(Le.x,Le.y))}else Oe=!0;return{box:c.aA(Se),allPointsOccluded:!Oe}}}class Fn{constructor(e,a,l,h){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?a:-a))):h&&l?1:0,this.placed=l}isHidden(){return this.opacity===0&&!this.placed}}class $t{constructor(e,a,l,h,f){this.text=new Fn(e?e.text:null,a,l,f),this.icon=new Fn(e?e.icon:null,a,h,f)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Jh{constructor(e,a,l){this.text=e,this.icon=a,this.skipFade=l}}class ls{constructor(e,a,l,h,f){this.bucketInstanceId=e,this.featureIndex=a,this.sourceLayerIndex=l,this.bucketIndex=h,this.tileID=f}}class Wc{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const a=++this.maxGroupID;this.collisionGroups[e]={ID:a,predicate:l=>l.collisionGroupID===a}}return this.collisionGroups[e]}}function ga(m,e,a,l,h){const{horizontalAlign:f,verticalAlign:_}=c.aH(m);return new c.P(-(f-.5)*e+l[0]*h,-(_-.5)*a+l[1]*h)}class ya{constructor(e,a,l,h,f){this.transform=e.clone(),this.terrain=a,this.collisionIndex=new hl(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new Wc(h),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=f,f&&(f.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const a=this.terrain;return a?(l,h)=>a.getElevation(e,l,h):null}getBucketParts(e,a,l,h){const f=l.getBucket(a),_=l.latestFeatureIndex;if(!f||!_||a.id!==f.layerIds[0])return;const C=l.collisionBoxArray,I=f.layers[0].layout,k=f.layers[0].paint,M=Math.pow(2,this.transform.zoom-l.tileID.overscaledZ),N=l.tileSize/c.$,z=l.tileID.toUnwrapped(),L=I.get("text-rotation-alignment")==="map",U=c.aC(l,1,this.transform.zoom),q=c.aD(this.collisionIndex.transform,l,k.get("text-translate"),k.get("text-translate-anchor")),H=c.aD(this.collisionIndex.transform,l,k.get("icon-translate"),k.get("icon-translate-anchor")),X=Oi(L,this.transform,U);this.retainedQueryData[f.bucketInstanceId]=new ls(f.bucketInstanceId,_,f.sourceLayerIndex,f.index,l.tileID);const J={bucket:f,layout:I,translationText:q,translationIcon:H,unwrappedTileID:z,pitchedLabelPlaneMatrix:X,scale:M,textPixelRatio:N,holdingForFade:l.holdingForFade(),collisionBoxArray:C,partiallyEvaluatedTextSize:c.an(f.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(f.sourceID)};if(h)for(const ie of f.sortKeyRanges){const{sortKey:Q,symbolInstanceStart:ae,symbolInstanceEnd:de}=ie;e.push({sortKey:Q,symbolInstanceStart:ae,symbolInstanceEnd:de,parameters:J})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:f.symbolInstances.length,parameters:J})}attemptAnchorPlacement(e,a,l,h,f,_,C,I,k,M,N,z,L,U,q,H,X,J,ie,Q){const ae=c.aE[e.textAnchor],de=[e.textOffset0,e.textOffset1],te=ga(ae,l,h,de,f),pe=this.collisionIndex.placeCollisionBox(a,z,I,k,M,C,_,H,N.predicate,ie,te,Q);if((!J||this.collisionIndex.placeCollisionBox(J,z,I,k,M,C,_,X,N.predicate,ie,te,Q).placeable)&&pe.placeable){let Ae;if(this.prevPlacement&&this.prevPlacement.variableOffsets[L.crossTileID]&&this.prevPlacement.placements[L.crossTileID]&&this.prevPlacement.placements[L.crossTileID].text&&(Ae=this.prevPlacement.variableOffsets[L.crossTileID].anchor),L.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[L.crossTileID]={textOffset:de,width:l,height:h,anchor:ae,textBoxScale:f,prevAnchor:Ae},this.markUsedJustification(U,ae,L,q),U.allowVerticalPlacement&&(this.markUsedOrientation(U,q,L),this.placedOrientations[L.crossTileID]=q),{shift:te,placedGlyphBoxes:pe}}}placeLayerBucketPart(e,a,l){const{bucket:h,layout:f,translationText:_,translationIcon:C,unwrappedTileID:I,pitchedLabelPlaneMatrix:k,textPixelRatio:M,holdingForFade:N,collisionBoxArray:z,partiallyEvaluatedTextSize:L,collisionGroup:U}=e.parameters,q=f.get("text-optional"),H=f.get("icon-optional"),X=c.aF(f,"text-overlap","text-allow-overlap"),J=X==="always",ie=c.aF(f,"icon-overlap","icon-allow-overlap"),Q=ie==="always",ae=f.get("text-rotation-alignment")==="map",de=f.get("text-pitch-alignment")==="map",te=f.get("icon-text-fit")!=="none",pe=f.get("symbol-z-order")==="viewport-y",Ae=J&&(Q||!h.hasIconData()||H),be=Q&&(J||!h.hasTextData()||q);!h.collisionArrays&&z&&h.deserializeCollisionBoxes(z);const Ce=this.retainedQueryData[h.bucketInstanceId].tileID,Se=this._getTerrainElevationFunc(Ce),Oe=this.transform.getFastPathSimpleProjectionMatrix(Ce),Be=(Le,Je,wt)=>{var Ft,Jt;if(a[Le.crossTileID])return;if(N)return void(this.placements[Le.crossTileID]=new Jh(!1,!1,!1));let Wt=!1,ai=!1,Qt=!0,Ui=null,ei={box:null,placeable:!1,offscreen:null,occluded:!1},Ut={placeable:!1},ci=null,It=null,an=null,Qr=0,io=0,wa=0;Je.textFeatureIndex?Qr=Je.textFeatureIndex:Le.useRuntimeCollisionCircles&&(Qr=Le.featureIndex),Je.verticalTextFeatureIndex&&(io=Je.verticalTextFeatureIndex);const no=Je.textBox;if(no){const Yn=Di=>{let Li=c.ao.horizontal;if(h.allowVerticalPlacement&&!Di&&this.prevPlacement){const An=this.prevPlacement.placedOrientations[Le.crossTileID];An&&(this.placedOrientations[Le.crossTileID]=An,Li=An,this.markUsedOrientation(h,Li,Le))}return Li},Ia=(Di,Li)=>{if(h.allowVerticalPlacement&&Le.numVerticalGlyphVertices>0&&Je.verticalTextBox){for(const An of h.writingModes)if(An===c.ao.vertical?(ei=Li(),Ut=ei):ei=Di(),ei&&ei.placeable)break}else ei=Di()},ea=Le.textAnchorOffsetStartIndex,Aa=Le.textAnchorOffsetEndIndex;if(Aa===ea){const Di=(Li,An)=>{const ti=this.collisionIndex.placeCollisionBox(Li,X,M,Ce,I,de,ae,_,U.predicate,Se,void 0,Oe);return ti&&ti.placeable&&(this.markUsedOrientation(h,An,Le),this.placedOrientations[Le.crossTileID]=An),ti};Ia(()=>Di(no,c.ao.horizontal),()=>{const Li=Je.verticalTextBox;return h.allowVerticalPlacement&&Le.numVerticalGlyphVertices>0&&Li?Di(Li,c.ao.vertical):{box:null,offscreen:null}}),Yn(ei&&ei.placeable)}else{let Di=c.aE[(Jt=(Ft=this.prevPlacement)===null||Ft===void 0?void 0:Ft.variableOffsets[Le.crossTileID])===null||Jt===void 0?void 0:Jt.anchor];const Li=(ti,Xl,Gd)=>{const Wd=ti.x2-ti.x1,cf=ti.y2-ti.y1,Uu=Le.textBoxScale,Rs=te&&ie==="never"?Xl:null;let Jn=null,Ur=X==="never"?1:2,cr="never";Di&&Ur++;for(let ta=0;ta<Ur;ta++){for(let Kl=ea;Kl<Aa;Kl++){const $u=h.textAnchorOffsets.get(Kl);if(Di&&$u.textAnchor!==Di)continue;const Yl=this.attemptAnchorPlacement($u,ti,Wd,cf,Uu,ae,de,M,Ce,I,U,cr,Le,h,Gd,_,C,Rs,Se);if(Yl&&(Jn=Yl.placedGlyphBoxes,Jn&&Jn.placeable))return Wt=!0,Ui=Yl.shift,Jn}Di?Di=null:cr=X}return l&&!Jn&&(Jn={box:this.collisionIndex.placeCollisionBox(no,"always",M,Ce,I,de,ae,_,U.predicate,Se,void 0,Oe).box,offscreen:!1,placeable:!1,occluded:!1}),Jn};Ia(()=>Li(no,Je.iconBox,c.ao.horizontal),()=>{const ti=Je.verticalTextBox;return h.allowVerticalPlacement&&(!ei||!ei.placeable)&&Le.numVerticalGlyphVertices>0&&ti?Li(ti,Je.verticalIconBox,c.ao.vertical):{box:null,occluded:!0,offscreen:null}}),ei&&(Wt=ei.placeable,Qt=ei.offscreen);const An=Yn(ei&&ei.placeable);if(!Wt&&this.prevPlacement){const ti=this.prevPlacement.variableOffsets[Le.crossTileID];ti&&(this.variableOffsets[Le.crossTileID]=ti,this.markUsedJustification(h,ti.anchor,Le,An))}}}if(ci=ei,Wt=ci&&ci.placeable,Qt=ci&&ci.offscreen,Le.useRuntimeCollisionCircles&&Le.centerJustifiedTextSymbolIndex>=0){const Yn=h.text.placedSymbolArray.get(Le.centerJustifiedTextSymbolIndex),Ia=c.ap(h.textSizeData,L,Yn),ea=f.get("text-padding");It=this.collisionIndex.placeCollisionCircles(X,Yn,h.lineVertexArray,h.glyphOffsetArray,Ia,I,k,l,de,U.predicate,Le.collisionCircleDiameter,ea,_,Se),It.circles.length&&It.collisionDetected&&!l&&c.w("Collisions detected, but collision boxes are not shown"),Wt=J||It.circles.length>0&&!It.collisionDetected,Qt=Qt&&It.offscreen}if(Je.iconFeatureIndex&&(wa=Je.iconFeatureIndex),Je.iconBox){const Yn=Ia=>this.collisionIndex.placeCollisionBox(Ia,ie,M,Ce,I,de,ae,C,U.predicate,Se,te&&Ui?Ui:void 0,Oe);Ut&&Ut.placeable&&Je.verticalIconBox?(an=Yn(Je.verticalIconBox),ai=an.placeable):(an=Yn(Je.iconBox),ai=an.placeable),Qt=Qt&&an.offscreen}const Ls=q||Le.numHorizontalGlyphVertices===0&&Le.numVerticalGlyphVertices===0,Ca=H||Le.numIconVertices===0;Ls||Ca?Ca?Ls||(ai=ai&&Wt):Wt=ai&&Wt:ai=Wt=ai&&Wt;const ro=ai&&an.placeable;if(Wt&&ci.placeable&&this.collisionIndex.insertCollisionBox(ci.box,X,f.get("text-ignore-placement"),h.bucketInstanceId,Ut&&Ut.placeable&&io?io:Qr,U.ID),ro&&this.collisionIndex.insertCollisionBox(an.box,ie,f.get("icon-ignore-placement"),h.bucketInstanceId,wa,U.ID),It&&Wt&&this.collisionIndex.insertCollisionCircles(It.circles,X,f.get("text-ignore-placement"),h.bucketInstanceId,Qr,U.ID),l&&this.storeCollisionData(h.bucketInstanceId,wt,Je,ci,an,It),Le.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(h.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Le.crossTileID]=new Jh((Wt||Ae)&&!(ci!=null&&ci.occluded),(ai||be)&&!(an!=null&&an.occluded),Qt||h.justReloaded),a[Le.crossTileID]=!0};if(pe){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Le=h.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Je=Le.length-1;Je>=0;--Je){const wt=Le[Je];Be(h.symbolInstances.get(wt),h.collisionArrays[wt],wt)}}else for(let Le=e.symbolInstanceStart;Le<e.symbolInstanceEnd;Le++)Be(h.symbolInstances.get(Le),h.collisionArrays[Le],Le);h.justReloaded=!1}storeCollisionData(e,a,l,h,f,_){if(l.textBox||l.iconBox){let C,I;this.collisionBoxArrays.has(e)?C=this.collisionBoxArrays.get(e):(C=new Map,this.collisionBoxArrays.set(e,C)),C.has(a)?I=C.get(a):(I={text:null,icon:null},C.set(a,I)),l.textBox&&(I.text=h.box),l.iconBox&&(I.icon=f.box)}if(_){let C=this.collisionCircleArrays[e];C===void 0&&(C=this.collisionCircleArrays[e]=[]);for(let I=0;I<_.circles.length;I+=4)C.push(_.circles[I+0]-vi),C.push(_.circles[I+1]-vi),C.push(_.circles[I+2]),C.push(_.collisionDetected?1:0)}}markUsedJustification(e,a,l,h){let f;f=h===c.ao.vertical?l.verticalPlacedTextSymbolIndex:{left:l.leftJustifiedTextSymbolIndex,center:l.centerJustifiedTextSymbolIndex,right:l.rightJustifiedTextSymbolIndex}[c.aG(a)];const _=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex,l.verticalPlacedTextSymbolIndex];for(const C of _)C>=0&&(e.text.placedSymbolArray.get(C).crossTileID=f>=0&&C!==f?0:l.crossTileID)}markUsedOrientation(e,a,l){const h=a===c.ao.horizontal||a===c.ao.horizontalOnly?a:0,f=a===c.ao.vertical?a:0,_=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex];for(const C of _)e.text.placedSymbolArray.get(C).placedOrientation=h;l.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(l.verticalPlacedTextSymbolIndex).placedOrientation=f)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const a=this.prevPlacement;let l=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;const h=a?a.symbolFadeChange(e):1,f=a?a.opacities:{},_=a?a.variableOffsets:{},C=a?a.placedOrientations:{};for(const I in this.placements){const k=this.placements[I],M=f[I];M?(this.opacities[I]=new $t(M,h,k.text,k.icon),l=l||k.text!==M.text.placed||k.icon!==M.icon.placed):(this.opacities[I]=new $t(null,h,k.text,k.icon,k.skipFade),l=l||k.text||k.icon)}for(const I in f){const k=f[I];if(!this.opacities[I]){const M=new $t(k,h,!1,!1);M.isHidden()||(this.opacities[I]=M,l=l||k.text.placed||k.icon.placed)}}for(const I in _)this.variableOffsets[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.variableOffsets[I]=_[I]);for(const I in C)this.placedOrientations[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.placedOrientations[I]=C[I]);if(a&&a.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");l?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:e)}updateLayerOpacities(e,a){const l={};for(const h of a){const f=h.getBucket(e);f&&h.latestFeatureIndex&&e.id===f.layerIds[0]&&this.updateBucketOpacities(f,h.tileID,l,h.collisionBoxArray)}}updateBucketOpacities(e,a,l,h){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const f=e.layers[0],_=f.layout,C=new $t(null,0,!1,!1,!0),I=_.get("text-allow-overlap"),k=_.get("icon-allow-overlap"),M=f._unevaluatedLayout.hasValue("text-variable-anchor")||f._unevaluatedLayout.hasValue("text-variable-anchor-offset"),N=_.get("text-rotation-alignment")==="map",z=_.get("text-pitch-alignment")==="map",L=_.get("icon-text-fit")!=="none",U=new $t(null,0,I&&(k||!e.hasIconData()||_.get("icon-optional")),k&&(I||!e.hasTextData()||_.get("text-optional")),!0);!e.collisionArrays&&h&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(h);const q=(X,J,ie)=>{for(let Q=0;Q<J/4;Q++)X.opacityVertexArray.emplaceBack(ie);X.hasVisibleVertices=X.hasVisibleVertices||ie!==bo},H=this.collisionBoxArrays.get(e.bucketInstanceId);for(let X=0;X<e.symbolInstances.length;X++){const J=e.symbolInstances.get(X),{numHorizontalGlyphVertices:ie,numVerticalGlyphVertices:Q,crossTileID:ae}=J;let de=this.opacities[ae];l[ae]?de=C:de||(de=U,this.opacities[ae]=de),l[ae]=!0;const te=J.numIconVertices>0,pe=this.placedOrientations[J.crossTileID],Ae=pe===c.ao.vertical,be=pe===c.ao.horizontal||pe===c.ao.horizontalOnly;if(ie>0||Q>0){const Se=Hc(de.text);q(e.text,ie,Ae?bo:Se),q(e.text,Q,be?bo:Se);const Oe=de.text.isHidden();[J.rightJustifiedTextSymbolIndex,J.centerJustifiedTextSymbolIndex,J.leftJustifiedTextSymbolIndex].forEach(Je=>{Je>=0&&(e.text.placedSymbolArray.get(Je).hidden=Oe||Ae?1:0)}),J.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(J.verticalPlacedTextSymbolIndex).hidden=Oe||be?1:0);const Be=this.variableOffsets[J.crossTileID];Be&&this.markUsedJustification(e,Be.anchor,J,pe);const Le=this.placedOrientations[J.crossTileID];Le&&(this.markUsedJustification(e,"left",J,Le),this.markUsedOrientation(e,Le,J))}if(te){const Se=Hc(de.icon),Oe=!(L&&J.verticalPlacedIconSymbolIndex&&Ae);J.placedIconSymbolIndex>=0&&(q(e.icon,J.numIconVertices,Oe?Se:bo),e.icon.placedSymbolArray.get(J.placedIconSymbolIndex).hidden=de.icon.isHidden()),J.verticalPlacedIconSymbolIndex>=0&&(q(e.icon,J.numVerticalIconVertices,Oe?bo:Se),e.icon.placedSymbolArray.get(J.verticalPlacedIconSymbolIndex).hidden=de.icon.isHidden())}const Ce=H&&H.has(X)?H.get(X):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const Se=e.collisionArrays[X];if(Se){let Oe=new c.P(0,0);if(Se.textBox||Se.verticalTextBox){let Be=!0;if(M){const Le=this.variableOffsets[ae];Le?(Oe=ga(Le.anchor,Le.width,Le.height,Le.textOffset,Le.textBoxScale),N&&Oe._rotate(z?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Be=!1}if(Se.textBox||Se.verticalTextBox){let Le;Se.textBox&&(Le=Ae),Se.verticalTextBox&&(Le=be),qc(e.textCollisionBox.collisionVertexArray,de.text.placed,!Be||Le,Ce.text,Oe.x,Oe.y)}}if(Se.iconBox||Se.verticalIconBox){const Be=!!(!be&&Se.verticalIconBox);let Le;Se.iconBox&&(Le=Be),Se.verticalIconBox&&(Le=!Be),qc(e.iconCollisionBox.collisionVertexArray,de.icon.placed,Le,Ce.icon,L?Oe.x:0,L?Oe.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,a){const l=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*l>e}setStale(){this.stale=!0}}function qc(m,e,a,l,h,f){l&&l.length!==0||(l=[0,0,0,0]);const _=l[0]-vi,C=l[1]-vi,I=l[2]-vi,k=l[3]-vi;m.emplaceBack(e?1:0,a?1:0,h||0,f||0,_,C),m.emplaceBack(e?1:0,a?1:0,h||0,f||0,I,C),m.emplaceBack(e?1:0,a?1:0,h||0,f||0,I,k),m.emplaceBack(e?1:0,a?1:0,h||0,f||0,_,k)}const Qh=Math.pow(2,25),ed=Math.pow(2,24),xo=Math.pow(2,17),td=Math.pow(2,16),Rm=Math.pow(2,9),Fm=Math.pow(2,8),Bm=Math.pow(2,1);function Hc(m){if(m.opacity===0&&!m.placed)return 0;if(m.opacity===1&&m.placed)return 4294967295;const e=m.placed?1:0,a=Math.floor(127*m.opacity);return a*Qh+e*ed+a*xo+e*td+a*Rm+e*Fm+a*Bm+e}const bo=0;class Xc{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,a,l,h,f){const _=this._bucketParts;for(;this._currentTileIndex<e.length;)if(a.getBucketParts(_,h,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,f())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,_.sort((C,I)=>C.sortKey-I.sortKey));this._currentPartIndex<_.length;)if(a.placeLayerBucketPart(_[this._currentPartIndex],this._seenCrossTileIDs,l),this._currentPartIndex++,f())return!0;return!1}}class Kc{constructor(e,a,l,h,f,_,C,I){this.placement=new ya(e,a,_,C,I),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=h,this._showCollisionBoxes=f,this._done=!1}isDone(){return this._done}continuePlacement(e,a,l){const h=ce.now(),f=()=>!this._forceFullPlacement&&ce.now()-h>2;for(;this._currentPlacementIndex>=0;){const _=a[e[this._currentPlacementIndex]],C=this.placement.collisionIndex.transform.zoom;if(_.type==="symbol"&&(!_.minzoom||_.minzoom<=C)&&(!_.maxzoom||_.maxzoom>C)){if(this._inProgressLayer||(this._inProgressLayer=new Xc(_)),this._inProgressLayer.continuePlacement(l[_.source],this.placement,this._showCollisionBoxes,_,f))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const wo=512/c.$/2;class Yc{constructor(e,a,l){this.tileID=e,this.bucketInstanceId=l,this._symbolsByKey={};const h=new Map;for(let f=0;f<a.length;f++){const _=a.get(f),C=_.key,I=h.get(C);I?I.push(_):h.set(C,[_])}for(const[f,_]of h){const C={positions:_.map(I=>({x:Math.floor(I.anchorX*wo),y:Math.floor(I.anchorY*wo)})),crossTileIDs:_.map(I=>I.crossTileID)};if(C.positions.length>128){const I=new c.aI(C.positions.length,16,Uint16Array);for(const{x:k,y:M}of C.positions)I.add(k,M);I.finish(),delete C.positions,C.index=I}this._symbolsByKey[f]=C}}getScaledCoordinates(e,a){const{x:l,y:h,z:f}=this.tileID.canonical,{x:_,y:C,z:I}=a.canonical,k=wo/Math.pow(2,I-f),M=(C*c.$+e.anchorY)*k,N=h*c.$*wo;return{x:Math.floor((_*c.$+e.anchorX)*k-l*c.$*wo),y:Math.floor(M-N)}}findMatches(e,a,l){const h=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z);for(let f=0;f<e.length;f++){const _=e.get(f);if(_.crossTileID)continue;const C=this._symbolsByKey[_.key];if(!C)continue;const I=this.getScaledCoordinates(_,a);if(C.index){const k=C.index.range(I.x-h,I.y-h,I.x+h,I.y+h).sort();for(const M of k){const N=C.crossTileIDs[M];if(!l[N]){l[N]=!0,_.crossTileID=N;break}}}else if(C.positions)for(let k=0;k<C.positions.length;k++){const M=C.positions[k],N=C.crossTileIDs[k];if(Math.abs(M.x-I.x)<=h&&Math.abs(M.y-I.y)<=h&&!l[N]){l[N]=!0,_.crossTileID=N;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class Jc{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class jm{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const a=Math.round((e-this.lng)/360);if(a!==0)for(const l in this.indexes){const h=this.indexes[l],f={};for(const _ in h){const C=h[_];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+a),f[C.tileID.key]=C}this.indexes[l]=f}this.lng=e}addBucket(e,a,l){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let f=0;f<a.symbolInstances.length;f++)a.symbolInstances.get(f).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const h=this.usedCrossTileIDs[e.overscaledZ];for(const f in this.indexes){const _=this.indexes[f];if(Number(f)>e.overscaledZ)for(const C in _){const I=_[C];I.tileID.isChildOf(e)&&I.findMatches(a.symbolInstances,e,h)}else{const C=_[e.scaledTo(Number(f)).key];C&&C.findMatches(a.symbolInstances,e,h)}}for(let f=0;f<a.symbolInstances.length;f++){const _=a.symbolInstances.get(f);_.crossTileID||(_.crossTileID=l.generate(),h[_.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Yc(e,a.symbolInstances,a.bucketInstanceId),!0}removeBucketCrossTileIDs(e,a){for(const l of a.getCrossTileIDsLists())for(const h of l)delete this.usedCrossTileIDs[e][h]}removeStaleBuckets(e){let a=!1;for(const l in this.indexes){const h=this.indexes[l];for(const f in h)e[h[f].bucketInstanceId]||(this.removeBucketCrossTileIDs(l,h[f]),delete h[f],a=!0)}return a}}class Co{constructor(){this.layerIndexes={},this.crossTileIDs=new Jc,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,a,l){let h=this.layerIndexes[e.id];h===void 0&&(h=this.layerIndexes[e.id]=new jm);let f=!1;const _={};h.handleWrapJump(l);for(const C of a){const I=C.getBucket(e);I&&e.id===I.layerIds[0]&&(I.bucketInstanceId||(I.bucketInstanceId=++this.maxBucketInstanceId),h.addBucket(C.tileID,I,this.crossTileIDs)&&(f=!0),_[I.bucketInstanceId]=!0)}return h.removeStaleBuckets(_)&&(f=!0),f}pruneUnusedLayers(e){const a={};e.forEach(l=>{a[l]=!0});for(const l in this.layerIndexes)a[l]||delete this.layerIndexes[l]}}var cs="void main() {fragColor=vec4(1.0);}";const _r={prelude:St(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:St("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:St("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:St(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:St(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:St(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:St(cs,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:St(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:St(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:St("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:St("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:St(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:St("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:St(cs,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:St(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:St(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:St(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:St(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:St(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:St(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:St(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:St(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:St(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:St(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:St(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:St(`uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),raster:St(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:St(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:St(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:St(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:St("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:St("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:St("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:St("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:St(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:St("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function St(m,e){const a=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=e.match(/in ([\w]+) ([\w]+)/g),h=m.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),f=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),_=f?f.concat(h):h,C={};return{fragmentSource:m=m.replace(a,(I,k,M,N,z)=>(C[z]=!0,k==="define"?`
#ifndef HAS_UNIFORM_u_${z}
in ${M} ${N} ${z};
#else
uniform ${M} ${N} u_${z};
#endif
`:`
#ifdef HAS_UNIFORM_u_${z}
    ${M} ${N} ${z} = u_${z};
#endif
`)),vertexSource:e=e.replace(a,(I,k,M,N,z)=>{const L=N==="float"?"vec2":"vec4",U=z.match(/color/)?"color":L;return C[z]?k==="define"?`
#ifndef HAS_UNIFORM_u_${z}
uniform lowp float u_${z}_t;
in ${M} ${L} a_${z};
out ${M} ${N} ${z};
#else
uniform ${M} ${N} u_${z};
#endif
`:U==="vec4"?`
#ifndef HAS_UNIFORM_u_${z}
    ${z} = a_${z};
#else
    ${M} ${N} ${z} = u_${z};
#endif
`:`
#ifndef HAS_UNIFORM_u_${z}
    ${z} = unpack_mix_${U}(a_${z}, u_${z}_t);
#else
    ${M} ${N} ${z} = u_${z};
#endif
`:k==="define"?`
#ifndef HAS_UNIFORM_u_${z}
uniform lowp float u_${z}_t;
in ${M} ${L} a_${z};
#else
uniform ${M} ${N} u_${z};
#endif
`:U==="vec4"?`
#ifndef HAS_UNIFORM_u_${z}
    ${M} ${N} ${z} = a_${z};
#else
    ${M} ${N} ${z} = u_${z};
#endif
`:`
#ifndef HAS_UNIFORM_u_${z}
    ${M} ${N} ${z} = unpack_mix_${U}(a_${z}, u_${z}_t);
#else
    ${M} ${N} ${z} = u_${z};
#endif
`}),staticAttributes:l,staticUniforms:_}}class La{constructor(e,a,l){this.vertexBuffer=e,this.indexBuffer=a,this.segments=l}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var _a=c.aJ([{name:"a_pos",type:"Int16",components:2}]);const Xr="#define PROJECTION_MERCATOR",Ra="mercator";class Tt{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Ra}get shaderDefine(){return Xr}get shaderPreludeCode(){return _r.projectionMercator}get vertexShaderPreludeCode(){return _r.projectionMercator.vertexSource}get subdivisionGranularity(){return c.aK.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,a,l,h,f){if(this._cachedMesh)return this._cachedMesh;const _=new c.aL;_.emplaceBack(0,0),_.emplaceBack(c.$,0),_.emplaceBack(0,c.$),_.emplaceBack(c.$,c.$);const C=e.createVertexBuffer(_,_a.members),I=c.aM.simpleSegment(0,0,4,2),k=new c.aN;k.emplaceBack(1,0,2),k.emplaceBack(1,2,3);const M=e.createIndexBuffer(k);return this._cachedMesh=new La(C,M,I),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}class Fa{constructor(e=0,a=0,l=0,h=0){if(isNaN(e)||e<0||isNaN(a)||a<0||isNaN(l)||l<0||isNaN(h)||h<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=a,this.left=l,this.right=h}interpolate(e,a,l){return a.top!=null&&e.top!=null&&(this.top=c.C.number(e.top,a.top,l)),a.bottom!=null&&e.bottom!=null&&(this.bottom=c.C.number(e.bottom,a.bottom,l)),a.left!=null&&e.left!=null&&(this.left=c.C.number(e.left,a.left,l)),a.right!=null&&e.right!=null&&(this.right=c.C.number(e.right,a.right,l)),this}getCenter(e,a){const l=c.ah((this.left+e-this.right)/2,0,e),h=c.ah((this.top+a-this.bottom)/2,0,a);return new c.P(l,h)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new Fa(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function dl(m,e){if(!m.renderWorldCopies||m.lngRange)return;const a=e.lng-m.center.lng;e.lng+=a>180?-360:a<-180?360:0}function pl(m){return Math.max(0,Math.floor(m))}class bn{constructor(e,a,l,h,f,_){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=_===void 0||!!_,this._minZoom=a||0,this._maxZoom=l||22,this._minPitch=h??0,this._maxPitch=f??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new c.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=pl(this._zoom),this._scale=c.af(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Fa,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,a,l){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=pl(this._zoom),this._scale=c.af(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new Fa(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!l&&e.autoCalculateNearFarZ,a&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const a=c.aO(e,-180,180)*Math.PI/180;var l,h,f,_,C,I,k,M,N;this._bearingInRadians!==a&&(this._unmodified=!1,this._bearingInRadians=a,this._calcMatrices(),this._rotationMatrix=W(),l=this._rotationMatrix,f=-this._bearingInRadians,_=(h=this._rotationMatrix)[0],C=h[1],I=h[2],k=h[3],M=Math.sin(f),N=Math.cos(f),l[0]=_*N+I*M,l[1]=C*N+k*M,l[2]=_*-M+I*N,l[3]=C*-M+k*N)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const a=c.ah(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==a&&(this._unmodified=!1,this._pitchInRadians=a,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const a=e/180*Math.PI;this._rollInRadians!==a&&(this._unmodified=!1,this._rollInRadians=a,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return c.aP(this._fovInRadians)}setFov(e){e=c.ah(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=c.ae(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const a=this.getConstrained(this._center,e).zoom;this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this._tileZoom=Math.max(0,Math.floor(a)),this._scale=c.af(a),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,a){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=a,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,a,l){this._unmodified=!1,this._edgeInsets.interpolate(e,a,l),this._constrain(),this._calcMatrices()}resize(e,a,l=!0){this._width=e,this._height=a,l&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new ni([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-c.ai,c.ai])}getConstrained(e,a){return this._callbacks.getConstrained(e,a)}getCameraQueryGeometry(e,a){if(a.length===1)return[a[0],e];{const{minX:l,minY:h,maxX:f,maxY:_}=c.a2.fromPoints(a).extend(e);return[new c.P(l,h),new c.P(f,h),new c.P(f,_),new c.P(l,_),new c.P(l,h)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:a,zoom:l}=this.getConstrained(this.center,this.zoom);this.setCenter(a),this.setZoom(l),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=c.ag(new Float64Array(16));c.N(e,e,[this._width/2,-this._height/2,1]),c.M(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=c.ag(new Float64Array(16)),c.N(e,e,[1,-1,1]),c.M(e,e,[-1,-1,0]),c.N(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,a,l,h){const f=l!==void 0?l:this.bearing,_=h=h!==void 0?h:this.pitch,C=c.a1.fromLngLat(e,a),I=-Math.cos(c.ae(_)),k=Math.sin(c.ae(_)),M=k*Math.sin(c.ae(f)),N=-k*Math.cos(c.ae(f));let z=this.elevation;const L=a-z;let U;I*L>=0||Math.abs(I)<.1?(U=1e4,z=a+U*I):U=-L/I;let q,H,X=c.aQ(1,C.y),J=0;do{if(J+=1,J>10)break;H=U/X,q=new c.a1(C.x+M*H,C.y+N*H),X=1/q.meterInMercatorCoordinateUnits()}while(Math.abs(U-H*X)>1e-12);return{center:q.toLngLat(),elevation:z,zoom:c.ak(this.height/2/Math.tan(this.fovInRadians/2)/H/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const a=c.aj(1,this.center.lat)*this.worldSize,l=this.cameraToCenterDistance/a,h=c.a1.fromLngLat(this.center,this.elevation),f=xe(this.center,this.elevation,this.pitch,this.bearing,l);this._elevation=e;const _=this.calculateCenterFromCameraLngLatAlt(f.toLngLat(),c.aQ(f.z,h.y),this.bearing,this.pitch);this._elevation=_.elevation,this._center=_.center,this.setZoom(_.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=c.aj(1,this.center.lat)*this.worldSize;return xe(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const a=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/a,e.canonical.y/a,1/a/c.$,1/a/c.$]}}class Hi{constructor(e,a){this.min=e,this.max=a,this.center=c.aR([],c.aS([],this.min,this.max),.5)}quadrant(e){const a=[e%2==0,e<2],l=c.aT(this.min),h=c.aT(this.max);for(let f=0;f<a.length;f++)l[f]=a[f]?this.min[f]:this.center[f],h[f]=a[f]?this.center[f]:this.max[f];return h[2]=this.max[2],new Hi(l,h)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let a=!0;for(let l=0;l<e.planes.length;l++){const h=this.intersectsPlane(e.planes[l]);if(h===0)return 0;h===1&&(a=!1)}return a?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let a=e[3],l=e[3];for(let h=0;h<3;h++)e[h]>0?(a+=e[h]*this.min[h],l+=e[h]*this.max[h]):(l+=e[h]*this.min[h],a+=e[h]*this.max[h]);return a>=0?2:l<0?0:1}}class wn{distanceToTile2d(e,a,l,h){const f=h.distanceX([e,a]),_=h.distanceY([e,a]);return Math.hypot(f,_)}getWrap(e,a,l){return l}getTileBoundingVolume(e,a,l,h){var f,_;let C=0,I=0;if(h!=null&&h.terrain){const M=new c.Z(e.z,a,e.z,e.x,e.y),N=h.terrain.getMinMaxElevation(M);C=(f=N.minElevation)!==null&&f!==void 0?f:Math.min(0,l),I=(_=N.maxElevation)!==null&&_!==void 0?_:Math.max(0,l)}const k=1<<e.z;return new Hi([a+e.x/k,e.y/k,C],[a+(e.x+1)/k,(e.y+1)/k,I])}allowVariableZoom(e,a){const l=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,h=c.ah(78.5-l/2,0,60);return!!a.terrain||e.pitch>h}allowWorldCopies(){return!0}prepareNextFrame(){}}class Ni{constructor(e,a,l){this.points=e,this.planes=a,this.aabb=l}static fromInvProjectionMatrix(e,a=1,l=0,h,f){const _=f?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],C=Math.pow(2,l),I=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(z=>function(L,U,q,H){const X=c.aw([],L,U),J=1/X[3]/q*H;return c.aY(X,X,[J,J,1/X[3],J])}(z,e,a,C));h&&function(z,L,U,q){const H=q?4:0,X=q?0:4;let J=0;const ie=[],Q=[];for(let te=0;te<4;te++){const pe=c.aU([],z[te+X],z[te+H]),Ae=c.aZ(pe);c.aR(pe,pe,1/Ae),ie.push(Ae),Q.push(pe)}for(let te=0;te<4;te++){const pe=c.a_(z[te+H],Q[te],U);J=pe!==null&&pe>=0?Math.max(J,pe):Math.max(J,ie[te])}const ae=function(te,pe){const Ae=c.aU([],te[pe[0]],te[pe[1]]),be=c.aU([],te[pe[2]],te[pe[1]]),Ce=[0,0,0,0];return c.aV(Ce,c.aW([],Ae,be)),Ce[3]=-c.aX(Ce,te[pe[0]]),Ce}(z,L),de=function(te,pe){const Ae=c.a$(te),be=c.b0([],te,1/Ae),Ce=c.aU([],pe,c.aR([],be,c.aX(pe,be))),Se=c.a$(Ce);if(Se>0){const Oe=Math.sqrt(1-be[3]*be[3]),Be=c.aR([],be,-be[3]),Le=c.aS([],Be,c.aR([],Ce,Oe/Se));return c.b1(pe,Le)}return null}(U,ae);if(de!==null){const te=de/c.aX(Q[0],ae);J=Math.min(J,te)}for(let te=0;te<4;te++){const pe=Math.min(J,ie[te]);z[te+X]=[z[te+H][0]+Q[te][0]*pe,z[te+H][1]+Q[te][1]*pe,z[te+H][2]+Q[te][2]*pe,1]}}(I,_[0],h,f);const k=_.map(z=>{const L=c.aU([],I[z[0]],I[z[1]]),U=c.aU([],I[z[2]],I[z[1]]),q=c.aV([],c.aW([],L,U)),H=-c.aX(q,I[z[1]]);return q.concat(H)}),M=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],N=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const z of I)for(let L=0;L<3;L++)M[L]=Math.min(M[L],z[L]),N[L]=Math.max(N[L],z[L]);return new Ni(I,k,new Hi(M,N))}}class Zt{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,a,l){return this._helper.interpolatePadding(e,a,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,a,l=!0){this._helper.resize(e,a,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,a){this._helper.overrideNearFarZ(e,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,a){}constructor(e,a,l,h,f){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new bn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(_,C)=>this.getConstrained(_,C)},e,a,l,h,f),this._coveringTilesDetailsProvider=new wn}clone(){const e=new Zt;return e.apply(this),e}apply(e,a,l){this._helper.apply(e,a,l)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const a=[new c.b2(0,e)];if(this._helper._renderWorldCopies){const l=this.screenPointToMercatorCoordinate(new c.P(0,0)),h=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,0)),f=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,this._helper._height)),_=this.screenPointToMercatorCoordinate(new c.P(0,this._helper._height)),C=Math.floor(Math.min(l.x,h.x,f.x,_.x)),I=Math.floor(Math.max(l.x,h.x,f.x,_.x)),k=1;for(let M=C-k;M<=I+k;M++)M!==0&&a.push(new c.b2(M,e))}return a}getCameraFrustum(){return Ni.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const a=this.screenPointToLocation(this.centerPoint,e),l=e?e.getElevationForLngLatZoom(a,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(l)}setLocationAtPoint(e,a){const l=c.aj(this.elevation,this.center.lat),h=this.screenPointToMercatorCoordinateAtZ(a,l),f=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,l),_=c.a1.fromLngLat(e),C=new c.a1(_.x-(h.x-f.x),_.y-(h.y-f.y));this.setCenter(C==null?void 0:C.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,a){return a?this.coordinatePoint(c.a1.fromLngLat(e),a.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(c.a1.fromLngLat(e))}screenPointToLocation(e,a){var l;return(l=this.screenPointToMercatorCoordinate(e,a))===null||l===void 0?void 0:l.toLngLat()}screenPointToMercatorCoordinate(e,a){if(a){const l=a.pointCoordinate(e);if(l!=null)return l}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,a){const l=a||0,h=[e.x,e.y,0,1],f=[e.x,e.y,1,1];c.aw(h,h,this._pixelMatrixInverse),c.aw(f,f,this._pixelMatrixInverse);const _=h[3],C=f[3],I=h[1]/_,k=f[1]/C,M=h[2]/_,N=f[2]/C,z=M===N?0:(l-M)/(N-M);return new c.a1(c.C.number(h[0]/_,f[0]/C,z)/this.worldSize,c.C.number(I,k,z)/this.worldSize,l)}coordinatePoint(e,a=0,l=this._pixelMatrix){const h=[e.x*this.worldSize,e.y*this.worldSize,a,1];return c.aw(h,h,l),new c.P(h[0]/h[3],h[1]/h[3])}getBounds(){const e=Math.max(0,this._helper._height/2-le(this));return new ni().extend(this.screenPointToLocation(new c.P(0,e))).extend(this.screenPointToLocation(new c.P(this._helper._width,e))).extend(this.screenPointToLocation(new c.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new c.P(0,this._helper._height)))}isPointOnMapSurface(e,a){return a?a.pointCoordinate(e)!=null:e.y>this.height/2-le(this)}calculatePosMatrix(e,a=!1,l){var h;const f=(h=e.key)!==null&&h!==void 0?h:c.b3(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),_=a?this._alignedPosMatrixCache:this._posMatrixCache;if(_.has(f)){const k=_.get(f);return l?k.f32:k.f64}const C=ge(e,this.worldSize);c.O(C,a?this._alignedProjMatrix:this._viewProjMatrix,C);const I={f64:C,f32:new Float32Array(C)};return _.set(f,I),l?I.f32:I.f64}calculateFogMatrix(e){const a=e.key,l=this._fogMatrixCacheF32;if(l.has(a))return l.get(a);const h=ge(e,this.worldSize);return c.O(h,this._fogMatrix,h),l.set(a,new Float32Array(h)),l.get(a)}getConstrained(e,a){a=c.ah(+a,this.minZoom,this.maxZoom);const l={center:new c.S(e.lng,e.lat),zoom:a};let h=this._helper._lngRange;if(!this._helper._renderWorldCopies&&h===null){const ie=179.9999999999;h=[-ie,ie]}const f=this.tileSize*c.af(l.zoom);let _=0,C=f,I=0,k=f,M=0,N=0;const{x:z,y:L}=this.size;if(this._helper._latRange){const ie=this._helper._latRange;_=c.U(ie[1])*f,C=c.U(ie[0])*f,C-_<L&&(M=L/(C-_))}h&&(I=c.aO(c.V(h[0])*f,0,f),k=c.aO(c.V(h[1])*f,0,f),k<I&&(k+=f),k-I<z&&(N=z/(k-I)));const{x:U,y:q}=Z(f,e);let H,X;const J=Math.max(N||0,M||0);if(J){const ie=new c.P(N?(k+I)/2:U,M?(C+_)/2:q);return l.center=ee(f,ie).wrap(),l.zoom+=c.ak(J),l}if(this._helper._latRange){const ie=L/2;q-ie<_&&(X=_+ie),q+ie>C&&(X=C-ie)}if(h){const ie=(I+k)/2;let Q=U;this._helper._renderWorldCopies&&(Q=c.aO(U,ie-f/2,ie+f/2));const ae=z/2;Q-ae<I&&(H=I+ae),Q+ae>k&&(H=k-ae)}if(H!==void 0||X!==void 0){const ie=new c.P(H??U,X??q);l.center=ee(f,ie).wrap()}return l}calculateCenterFromCameraLngLatAlt(e,a,l,h){return this._helper.calculateCenterFromCameraLngLatAlt(e,a,l,h)}_calculateNearFarZIfNeeded(e,a,l){if(!this._helper.autoCalculateNearFarZ)return;const h=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),f=e-h*this._helper._pixelPerMeter/Math.cos(a),_=h<0?f:e,C=Math.PI/2+this.pitchInRadians,I=c.ae(this.fov)*(Math.abs(Math.cos(c.ae(this.roll)))*this.height+Math.abs(Math.sin(c.ae(this.roll)))*this.width)/this.height*(.5+l.y/this.height),k=Math.sin(I)*_/Math.sin(c.ah(Math.PI-C-I,.01,Math.PI-.01)),M=le(this),N=Math.atan(M/this._helper.cameraToCenterDistance),z=c.ae(.75),L=N>z?2*N*(.5+l.y/(2*M)):z,U=Math.sin(L)*_/Math.sin(c.ah(Math.PI-C-L,.01,Math.PI-.01)),q=Math.min(k,U);this._helper._farZ=1.01*(Math.cos(Math.PI/2-a)*q+_),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,a=Z(this.worldSize,this.center),l=a.x,h=a.y;this._helper._pixelPerMeter=c.aj(1,this.center.lat)*this.worldSize;const f=c.ae(Math.min(this.pitch,O)),_=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(f));let C;this._calculateNearFarZIfNeeded(_,f,e),C=new Float64Array(16),c.b4(C,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),c.aq(this._invProjMatrix,C),C[8]=2*-e.x/this._helper._width,C[9]=2*e.y/this._helper._height,this._projectionMatrix=c.b5(C),c.N(C,C,[1,-1,1]),c.M(C,C,[0,0,-this._helper.cameraToCenterDistance]),c.b6(C,C,-this.rollInRadians),c.b7(C,C,this.pitchInRadians),c.b6(C,C,-this.bearingInRadians),c.M(C,C,[-l,-h,0]),this._mercatorMatrix=c.N([],C,[this.worldSize,this.worldSize,this.worldSize]),c.N(C,C,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=c.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,C),c.M(C,C,[0,0,-this.elevation]),this._viewProjMatrix=C,this._invViewProjMatrix=c.aq([],C);const I=[0,0,-1,1];c.aw(I,I,this._invViewProjMatrix),this._cameraPosition=[I[0]/I[3],I[1]/I[3],I[2]/I[3]],this._fogMatrix=new Float64Array(16),c.b4(this._fogMatrix,this.fovInRadians,this.width/this.height,_,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,c.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),c.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),c.b6(this._fogMatrix,this._fogMatrix,-this.rollInRadians),c.b7(this._fogMatrix,this._fogMatrix,this.pitchInRadians),c.b6(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),c.M(this._fogMatrix,this._fogMatrix,[-l,-h,0]),c.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),c.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=c.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,C);const k=this._helper._width%2/2,M=this._helper._height%2/2,N=Math.cos(this.bearingInRadians),z=Math.sin(-this.bearingInRadians),L=l-Math.round(l)+N*k+z*M,U=h-Math.round(h)+N*M+z*k,q=new Float64Array(C);if(c.M(q,q,[L>.5?L-1:L,U>.5?U-1:U,0]),this._alignedProjMatrix=q,C=c.aq(new Float64Array(16),this._pixelMatrix),!C)throw new Error("failed to invert matrix");this._pixelMatrixInverse=C,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new c.P(0,0)),a=[e.x*this.worldSize,e.y*this.worldSize,0,1];return c.aw(a,a,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=c.aj(1,this.center.lat)*this.worldSize;return xe(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,a){const l=c.a1.fromLngLat(e),h=[l.x*this.worldSize,l.y*this.worldSize,a,1];return c.aw(h,h,this._viewProjMatrix),h[2]/h[3]}getProjectionData(e){const{overscaledTileID:a,aligned:l,applyTerrainMatrix:h}=e,f=this._helper.getMercatorTileCoordinates(a),_=a?this.calculatePosMatrix(a,l,!0):null;let C;return C=a&&a.terrainRttPosMatrix32f&&h?a.terrainRttPosMatrix32f:_||c.b8(),{mainMatrix:C,tileMercatorCoords:f,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:C}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,a,l){return 1}transformLightDirection(e){return c.aT(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,a,l,h){const f=this.calculatePosMatrix(l);let _;h?(_=[e,a,h(e,a),1],c.aw(_,_,f)):(_=[e,a,0,1],vo(_,_,f));const C=_[3];return{point:new c.P(_[0]/C,_[1]/C),signedDistanceFromCamera:C,isOccluded:!1}}populateCache(e){for(const a of e)this.calculatePosMatrix(a)}getMatrixForModel(e,a){const l=c.a1.fromLngLat(e,a),h=l.meterInMercatorCoordinateUnits(),f=c.b9();return c.M(f,f,[l.x,l.y,l.z]),c.b6(f,f,Math.PI),c.b7(f,f,Math.PI/2),c.N(f,f,[-h,h,h]),f}getProjectionDataForCustomLayer(e=!0){const a=new c.Z(0,0,0,0,0),l=this.getProjectionData({overscaledTileID:a,applyGlobeMatrix:e}),h=ge(a,this.worldSize);c.O(h,this._viewProjMatrix,h),l.tileMercatorCoords=[0,0,1,1];const f=[c.$,c.$,this.worldSize/this._helper.pixelsPerMeter],_=c.ba();return c.N(_,h,f),l.fallbackMatrix=_,l.mainMatrix=_,l}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function id(){c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Cn(m){if(m.useSlerp)if(m.k<1){const e=c.bb(m.startEulerAngles.roll,m.startEulerAngles.pitch,m.startEulerAngles.bearing),a=c.bb(m.endEulerAngles.roll,m.endEulerAngles.pitch,m.endEulerAngles.bearing),l=new Float64Array(4);c.bc(l,e,a,m.k);const h=c.bd(l);m.tr.setRoll(h.roll),m.tr.setPitch(h.pitch),m.tr.setBearing(h.bearing)}else m.tr.setRoll(m.endEulerAngles.roll),m.tr.setPitch(m.endEulerAngles.pitch),m.tr.setBearing(m.endEulerAngles.bearing);else m.tr.setRoll(c.C.number(m.startEulerAngles.roll,m.endEulerAngles.roll,m.k)),m.tr.setPitch(c.C.number(m.startEulerAngles.pitch,m.endEulerAngles.pitch,m.k)),m.tr.setBearing(c.C.number(m.startEulerAngles.bearing,m.endEulerAngles.bearing,m.k))}function Hn(m,e,a,l,h){const f=h.padding,_=Z(h.worldSize,a.getNorthWest()),C=Z(h.worldSize,a.getNorthEast()),I=Z(h.worldSize,a.getSouthEast()),k=Z(h.worldSize,a.getSouthWest()),M=c.ae(-l),N=_.rotate(M),z=C.rotate(M),L=I.rotate(M),U=k.rotate(M),q=new c.P(Math.max(N.x,z.x,U.x,L.x),Math.max(N.y,z.y,U.y,L.y)),H=new c.P(Math.min(N.x,z.x,U.x,L.x),Math.min(N.y,z.y,U.y,L.y)),X=q.sub(H),J=(h.width-(f.left+f.right+e.left+e.right))/X.x,ie=(h.height-(f.top+f.bottom+e.top+e.bottom))/X.y;if(ie<0||J<0)return void id();const Q=Math.min(c.ak(h.scale*Math.min(J,ie)),m.maxZoom),ae=c.P.convert(m.offset),de=new c.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(c.ae(l)),te=ae.add(de).mult(h.scale/c.af(Q));return{center:ee(h.worldSize,_.add(I).div(2).sub(te)),zoom:Q,bearing:l}}class dn{get useGlobeControls(){return!1}handlePanInertia(e,a){const l=e.mag(),h=Math.abs(le(a));return{easingOffset:e.mult(Math.min(.75*h/l,1)),easingCenter:a.center}}handleMapControlsRollPitchBearingZoom(e,a){e.bearingDelta&&a.setBearing(a.bearing+e.bearingDelta),e.pitchDelta&&a.setPitch(a.pitch+e.pitchDelta),e.rollDelta&&a.setRoll(a.roll+e.rollDelta),e.zoomDelta&&a.setZoom(a.zoom+e.zoomDelta)}handleMapControlsPan(e,a,l){e.around.distSqr(a.centerPoint)<.01||a.setLocationAtPoint(l,e.around)}cameraForBoxAndBearing(e,a,l,h,f){return Hn(e,a,l,h,f)}handleJumpToCenterZoom(e,a){e.zoom!==(a.zoom!==void 0?+a.zoom:e.zoom)&&e.setZoom(+a.zoom),a.center!==void 0&&e.setCenter(c.S.convert(a.center))}handleEaseTo(e,a){const l=e.zoom,h=e.padding,f={roll:e.roll,pitch:e.pitch,bearing:e.bearing},_={roll:a.roll===void 0?e.roll:a.roll,pitch:a.pitch===void 0?e.pitch:a.pitch,bearing:a.bearing===void 0?e.bearing:a.bearing},C=a.zoom!==void 0,I=!e.isPaddingEqual(a.padding);let k=!1;const M=C?+a.zoom:e.zoom;let N=e.centerPoint.add(a.offsetAsPoint);const z=e.screenPointToLocation(N),{center:L,zoom:U}=e.getConstrained(c.S.convert(a.center||z),M??l);dl(e,L);const q=Z(e.worldSize,z),H=Z(e.worldSize,L).sub(q),X=c.af(U-l);return k=U!==l,{easeFunc:J=>{if(k&&e.setZoom(c.C.number(l,U,J)),c.be(f,_)||Cn({startEulerAngles:f,endEulerAngles:_,tr:e,k:J,useSlerp:f.roll!=_.roll}),I&&(e.interpolatePadding(h,a.padding,J),N=e.centerPoint.add(a.offsetAsPoint)),a.around)e.setLocationAtPoint(a.around,a.aroundPoint);else{const ie=c.af(e.zoom-l),Q=U>l?Math.min(2,X):Math.max(.5,X),ae=Math.pow(Q,1-J),de=ee(e.worldSize,q.add(H.mult(J*ae)).mult(ie));e.setLocationAtPoint(e.renderWorldCopies?de.wrap():de,N)}},isZooming:k,elevationCenter:L}}handleFlyTo(e,a){const l=a.zoom!==void 0,h=e.zoom,f=e.getConstrained(c.S.convert(a.center||a.locationAtOffset),l?+a.zoom:h),_=f.center,C=f.zoom;dl(e,_);const I=Z(e.worldSize,a.locationAtOffset),k=Z(e.worldSize,_).sub(I),M=k.mag(),N=c.af(C-h);let z;if(a.minZoom!==void 0){const L=Math.min(+a.minZoom,h,C),U=e.getConstrained(_,L).zoom;z=c.af(U-h)}return{easeFunc:(L,U,q,H)=>{e.setZoom(L===1?C:h+c.ak(U));const X=L===1?_:ee(e.worldSize,I.add(k.mult(q)).mult(U));e.setLocationAtPoint(e.renderWorldCopies?X.wrap():X,H)},scaleOfZoom:N,targetCenter:_,scaleOfMinZoom:z,pixelPathLength:M}}}class Kt{constructor(e,a,l){this.blendFunction=e,this.blendColor=a,this.mask=l}}Kt.Replace=[1,0],Kt.disabled=new Kt(Kt.Replace,c.bf.transparent,[!1,!1,!1,!1]),Kt.unblended=new Kt(Kt.Replace,c.bf.transparent,[!0,!0,!0,!0]),Kt.alphaBlended=new Kt([1,771],c.bf.transparent,[!0,!0,!0,!0]);const Ba=2305;class dt{constructor(e,a,l){this.enable=e,this.mode=a,this.frontFace=l}}dt.disabled=new dt(!1,1029,Ba),dt.backCCW=new dt(!0,1029,Ba),dt.frontCCW=new dt(!0,1028,Ba);class _t{constructor(e,a,l){this.func=e,this.mask=a,this.range=l}}_t.ReadOnly=!1,_t.ReadWrite=!0,_t.disabled=new _t(519,_t.ReadOnly,[0,1]);const Kr=7680;class zt{constructor(e,a,l,h,f,_){this.test=e,this.ref=a,this.mask=l,this.fail=h,this.depthFail=f,this.pass=_}}zt.disabled=new zt({func:519,mask:0},0,0,Kr,Kr,Kr);const Xn=new WeakMap;function Br(m){var e;if(Xn.has(m))return Xn.get(m);{const a=(e=m.getParameter(m.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return Xn.set(m,a),a}}class jr{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const a=e.context,l=a.gl;this._texFormat=l.RGBA,this._texType=l.UNSIGNED_BYTE;const h=new c.aL;h.emplaceBack(-1,-1),h.emplaceBack(2,-1),h.emplaceBack(-1,2);const f=new c.aN;f.emplaceBack(0,1,2),this._fullscreenTriangle=new La(a.createVertexBuffer(h,_a.members),a.createIndexBuffer(f),c.aM.simpleSegment(0,0,h.length,f.length)),this._resultBuffer=new Uint8Array(4),a.activeTexture.set(l.TEXTURE1);const _=l.createTexture();l.bindTexture(l.TEXTURE_2D,_),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),l.texImage2D(l.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=a.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(_),Br(l)&&(this._pbo=l.createBuffer(),l.bindBuffer(l.PIXEL_PACK_BUFFER,this._pbo),l.bufferData(l.PIXEL_PACK_BUFFER,4,l.STREAM_READ),l.bindBuffer(l.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,a){const l=this._updateCount;return this._readbackQueue?l>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():l>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,a),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,a=e.gl;e.activeTexture.set(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,a){const l=this._cachedRenderContext.context,h=l.gl;if(this._bindFramebuffer(),l.viewport.set([0,0,this._texWidth,this._texHeight]),l.clear({color:c.bf.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(l,h.TRIANGLES,_t.disabled,zt.disabled,Kt.unblended,dt.disabled,((f,_)=>({u_input:f,u_output_expected:_}))(e,a),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Br(h)){h.bindBuffer(h.PIXEL_PACK_BUFFER,this._pbo),h.readBuffer(h.COLOR_ATTACHMENT0),h.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),h.bindBuffer(h.PIXEL_PACK_BUFFER,null);const f=h.fenceSync(h.SYNC_GPU_COMMANDS_COMPLETE,0);h.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:f}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Br(e)){const a=e.clientWaitSync(this._readbackQueue.sync,0,0);if(a===e.WAIT_FAILED)return c.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(a===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=jr._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let a=0;return a+=e[0]/256,a+=e[1]/65536,a+=e[2]/16777216,e[3]<127&&(a=-a),a/128}}const ml=c.$/128;function Qc(m,e){const a=m.granularity!==void 0?Math.max(m.granularity,1):1,l=a+(m.generateBorders?2:0),h=a+(m.extendToNorthPole||m.generateBorders?1:0)+(m.extendToSouthPole||m.generateBorders?1:0),f=l+1,_=h+1,C=m.generateBorders?-1:0,I=m.generateBorders||m.extendToNorthPole?-1:0,k=a+(m.generateBorders?1:0),M=a+(m.generateBorders||m.extendToSouthPole?1:0),N=f*_,z=l*h*6,L=f*_>65536;if(L&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const U=L||e==="32bit",q=new Int16Array(2*N);let H=0;for(let ie=I;ie<=M;ie++)for(let Q=C;Q<=k;Q++){let ae=Q/a*c.$;Q===-1&&(ae=-ml),Q===a+1&&(ae=c.$+ml);let de=ie/a*c.$;ie===-1&&(de=m.extendToNorthPole?c.bh:-ml),ie===a+1&&(de=m.extendToSouthPole?c.bi:c.$+ml),q[H++]=ae,q[H++]=de}const X=U?new Uint32Array(z):new Uint16Array(z);let J=0;for(let ie=0;ie<h;ie++)for(let Q=0;Q<l;Q++){const ae=Q+1+ie*f,de=Q+(ie+1)*f,te=Q+1+(ie+1)*f;X[J++]=Q+ie*f,X[J++]=de,X[J++]=ae,X[J++]=ae,X[J++]=de,X[J++]=te}return{vertices:q.buffer.slice(0),indices:X.buffer.slice(0),uses32bitIndices:U}}const Io=new c.aK({fill:new c.bj(128,2),line:new c.bj(512,0),tile:new c.bj(128,32),stencil:new c.bj(128,1),circle:3});class us{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return _r.projectionGlobe}get vertexShaderPreludeCode(){return _r.projectionMercator.vertexSource}get subdivisionGranularity(){return Io}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new jr(e));const a=c.U(this._errorQueryLatitudeDegrees),l=2*Math.atan(Math.exp(Math.PI-a*Math.PI*2))-.5*Math.PI,h=this._errorMeasurement.updateErrorLoop(a,l),f=ce.now();h!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=h,this._errorMeasurementLastChangeTime=f);const _=Math.min(Math.max((f-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=c.bk(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,c.bl(_))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,a,l,h,f){const _=(f==="stencil"?Io.stencil:Io.tile).getGranularityForZoomLevel(a.z);return this._getMesh(e,{granularity:_,generateBorders:l,extendToNorthPole:a.y===0&&h,extendToSouthPole:a.y===(1<<a.z)-1&&h})}_getMesh(e,a){const l=this._getMeshKey(a);if(l in this._tileMeshCache)return this._tileMeshCache[l];const h=function(f,_){const C=Qc(_,"16bit"),I=c.aL.deserialize({arrayBuffer:C.vertices,length:C.vertices.byteLength/2/2}),k=c.aN.deserialize({arrayBuffer:C.indices,length:C.indices.byteLength/2/3});return new La(f.createVertexBuffer(I,_a.members),f.createIndexBuffer(k),c.aM.simpleSegment(0,0,I.length,k.length))}(e,a);return this._tileMeshCache[l]=h,h}recalculate(e){}hasTransition(){const e=ce.now();let a=!1;return a=a||(e-this._errorMeasurementLastChangeTime)/1e3<.7,a=a||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,a}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const fl=new c.r({type:new c.D(c.v.projection.type)});class gl extends c.E{constructor(e){super(),this._transitionable=new c.t(fl,void 0),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.F(0)),this._mercatorProjection=new Tt,this._verticalPerspectiveProjection=new us}get transitionState(){const e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof c.bm){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,a,l,h,f){return this.currentProjection.getMeshFromTileID(e,a,l,h,f)}setProjection(e){this._transitionable.setValue("type",(e==null?void 0:e.type)||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function yl(m){const e=Ao(m.worldSize,m.center.lat);return 2*Math.PI*e}function vr(m,e,a,l,h){const f=1/(1<<h),_=e/c.$*f+l*f,C=c.bo((m/c.$*f+a*f)*Math.PI*2+Math.PI,2*Math.PI),I=2*Math.atan(Math.exp(Math.PI-_*Math.PI*2))-.5*Math.PI,k=Math.cos(I),M=new Float64Array(3);return M[0]=Math.sin(C)*k,M[1]=Math.sin(I),M[2]=Math.cos(C)*k,M}function Xi(m){return function(e,a){const l=Math.cos(a),h=new Float64Array(3);return h[0]=Math.sin(e)*l,h[1]=Math.sin(a),h[2]=Math.cos(e)*l,h}(m.lng*Math.PI/180,m.lat*Math.PI/180)}function Ao(m,e){return m/(2*Math.PI)/Math.cos(e*Math.PI/180)}function hs(m){const e=Math.asin(m[1])/Math.PI*180,a=Math.sqrt(m[0]*m[0]+m[2]*m[2]);if(a>1e-6){const l=m[0]/a,h=Math.acos(m[2]/a),f=(l>0?h:-h)/Math.PI*180;return new c.S(c.aO(f,-180,180),e)}return new c.S(0,e)}function ja(m){return Math.cos(m*Math.PI/180)}function xi(m,e){const a=ja(m),l=ja(e);return c.ak(l/a)}function nd(m,e){const a=m.rotate(e.bearingInRadians),l=e.zoom+xi(e.center.lat,0),h=c.bk(1/ja(e.center.lat),1/ja(Math.min(Math.abs(e.center.lat),60)),c.bn(l,7,3,0,1)),f=360/yl({worldSize:e.worldSize,center:{lat:e.center.lat}});return new c.S(e.center.lng-a.x*f*h,c.ah(e.center.lat+a.y*f,-c.ai,c.ai))}function ds(m){const e=.5*m,a=Math.sin(e),l=Math.cos(e);return Math.log(a+l)-Math.log(l-a)}function eu(m,e,a,l){const h=m.lat+a*l;if(Math.abs(a)>1){const f=(Math.sign(m.lat+a)!==Math.sign(m.lat)?-Math.abs(m.lat):Math.abs(m.lat))*Math.PI/180,_=Math.abs(m.lat+a)*Math.PI/180,C=ds(f+l*(_-f)),I=ds(f),k=ds(_);return new c.S(m.lng+e*((C-I)/(k-I)),h)}return new c.S(m.lng+e*l,h)}class Om{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=e}swapBuffers(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(e,a,l,h){const f=`${e.z}_${e.x}_${e.y}_${h!=null&&h.terrain?"t":""}`,_=this._cache.get(f);if(_)return _;const C=this._cachePrevious.get(f);if(C)return this._cache.set(f,C),C;const I=this._boundingVolumeFactory(e,a,l,h);return this._cache.set(f,I),this._hadAnyChanges=!0,I}}class So{constructor(e,a,l,h){this.min=l,this.max=h,this.points=e,this.planes=a}static fromAabb(e,a){const l=[];for(let h=0;h<8;h++)l.push([1&~h?e[0]:a[0],(h>>1&1)==1?a[1]:e[1],(h>>2&1)==1?a[2]:e[2]]);return new So(l,[[-1,0,0,a[0]],[1,0,0,-e[0]],[0,-1,0,a[1]],[0,1,0,-e[1]],[0,0,-1,a[2]],[0,0,1,-e[2]]],e,a)}static fromCenterSizeAngles(e,a,l){const h=c.br([],l[0],l[1],l[2]),f=c.bs([],[a[0],0,0],h),_=c.bs([],[0,a[1],0],h),C=c.bs([],[0,0,a[2]],h),I=[...e],k=[...e];for(let N=0;N<8;N++)for(let z=0;z<3;z++){const L=e[z]+f[z]*(1&~N?-1:1)+_[z]*((N>>1&1)==1?1:-1)+C[z]*((N>>2&1)==1?1:-1);I[z]=Math.min(I[z],L),k[z]=Math.max(k[z],L)}const M=[];for(let N=0;N<8;N++){const z=[...e];c.aS(z,z,c.aR([],f,1&~N?-1:1)),c.aS(z,z,c.aR([],_,(N>>1&1)==1?1:-1)),c.aS(z,z,c.aR([],C,(N>>2&1)==1?1:-1)),M.push(z)}return new So(M,[[...f,-c.aX(f,M[0])],[..._,-c.aX(_,M[0])],[...C,-c.aX(C,M[0])],[-f[0],-f[1],-f[2],-c.aX(f,M[7])],[-_[0],-_[1],-_[2],-c.aX(_,M[7])],[-C[0],-C[1],-C[2],-c.aX(C,M[7])]],I,k)}intersectsFrustum(e){let a=!0;const l=this.points.length,h=this.planes.length,f=e.planes.length,_=e.points.length;for(let C=0;C<f;C++){const I=e.planes[C];let k=0;for(let M=0;M<l;M++){const N=this.points[M];I[0]*N[0]+I[1]*N[1]+I[2]*N[2]+I[3]>=0&&k++}if(k===0)return 0;k<l&&(a=!1)}if(a)return 2;for(let C=0;C<h;C++){const I=this.planes[C];let k=0;for(let M=0;M<_;M++){const N=e.points[M];I[0]*N[0]+I[1]*N[1]+I[2]*N[2]+I[3]>=0&&k++}if(k===0)return 0}return 1}intersectsPlane(e){const a=this.points.length;let l=0;for(let h=0;h<a;h++){const f=this.points[h];e[0]*f[0]+e[1]*f[1]+e[2]*f[2]+e[3]>=0&&l++}return l===a?2:l===0?0:1}}function rn(m,e,a){const l=m-e;return l<0?-l:Math.max(0,l-a)}function ps(m,e,a,l,h){const f=m-a;let _;return _=f<0?Math.min(-f,1+f-h):f>1?Math.min(Math.max(f-h,0),1-f):0,Math.max(_,rn(e,l,h))}class Or{constructor(){this._boundingVolumeCache=new Om(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(e,a,l,h){const f=1<<l.z,_=1/f,C=l.x/f,I=l.y/f;let k=2;return k=Math.min(k,ps(e,a,C,I,_)),k=Math.min(k,ps(e,a,C+.5,-I-_,_)),k=Math.min(k,ps(e,a,C+.5,2-I-_,_)),k}getWrap(e,a,l){const h=1<<a.z,f=1/h,_=a.x/h,C=rn(e.x,_,f),I=rn(e.x,_-1,f),k=rn(e.x,_+1,f),M=Math.min(C,I,k);return M===k?1:M===I?-1:0}allowVariableZoom(e,a){return it(e,a)>4}allowWorldCopies(){return!1}getTileBoundingVolume(e,a,l,h){return this._boundingVolumeCache.getTileBoundingVolume(e,a,l,h)}_computeTileBoundingVolume(e,a,l,h){var f,_;let C=0,I=0;if(h!=null&&h.terrain){const k=new c.Z(e.z,a,e.z,e.x,e.y),M=h.terrain.getMinMaxElevation(k);C=(f=M.minElevation)!==null&&f!==void 0?f:Math.min(0,l),I=(_=M.maxElevation)!==null&&_!==void 0?_:Math.max(0,l)}if(C/=c.bu,I/=c.bu,C+=1,I+=1,e.z<=0)return So.fromAabb([-I,-I,-I],[I,I,I]);if(e.z===1)return So.fromAabb([e.x===0?-I:0,e.y===0?0:-I,-I],[e.x===0?0:I,e.y===0?I:0,I]);{const k=[vr(0,0,e.x,e.y,e.z),vr(c.$,0,e.x,e.y,e.z),vr(c.$,c.$,e.x,e.y,e.z),vr(0,c.$,e.x,e.y,e.z)],M=[];for(const Ce of k)M.push(c.aR([],Ce,I));if(I!==C)for(const Ce of k)M.push(c.aR([],Ce,C));e.y===0&&M.push([0,1,0]),e.y===(1<<e.z)-1&&M.push([0,-1,0]);const N=[1,1,1],z=[-1,-1,-1];for(const Ce of M)for(let Se=0;Se<3;Se++)N[Se]=Math.min(N[Se],Ce[Se]),z[Se]=Math.max(z[Se],Ce[Se]);const L=vr(c.$/2,c.$/2,e.x,e.y,e.z),U=c.aW([],[0,1,0],L);c.aV(U,U);const q=c.aW([],L,U);c.aV(q,q);const H=c.aW([],k[2],k[1]);c.aV(H,H);const X=c.aW([],k[0],k[3]);c.aV(X,X),M.push(c.aR([],L,I)),e.y>=(1<<e.z)/2&&M.push(c.aR([],vr(c.$/2,0,e.x,e.y,e.z),I)),e.y<(1<<e.z)/2&&M.push(c.aR([],vr(c.$/2,c.$,e.x,e.y,e.z),I));const J=ms(L,M),ie=ms(q,M),Q=[-L[0],-L[1],-L[2],J.max],ae=[L[0],L[1],L[2],-J.min],de=[-q[0],-q[1],-q[2],ie.max],te=[q[0],q[1],q[2],-ie.min],pe=[...H,0],Ae=[...X,0],be=[];return e.y===0?be.push(c.bt(Ae,pe,Q),c.bt(Ae,pe,ae)):be.push(c.bt(de,pe,Q),c.bt(de,pe,ae),c.bt(de,Ae,Q),c.bt(de,Ae,ae)),e.y===(1<<e.z)-1?be.push(c.bt(Ae,pe,Q),c.bt(Ae,pe,ae)):be.push(c.bt(te,pe,Q),c.bt(te,pe,ae),c.bt(te,Ae,Q),c.bt(te,Ae,ae)),new So(be,[Q,ae,de,te,pe,Ae],N,z)}}}function ms(m,e){let a=1/0,l=-1/0;for(const h of e){const f=c.aX(m,h);a=Math.min(a,f),l=Math.max(l,f)}return{min:a,max:l}}class fs{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,a,l){return this._helper.interpolatePadding(e,a,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,a){this._helper.resize(e,a)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,a){this._helper.overrideNearFarZ(e,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=c.bv(),this._projectionMatrix=c.b9(),this._globeViewProjMatrix32f=c.b8(),this._globeViewProjMatrixNoCorrection=c.b9(),this._globeViewProjMatrixNoCorrectionInverted=c.b9(),this._globeProjMatrixInverted=c.b9(),this._cameraPosition=c.bp(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new bn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,a)=>this.getConstrained(e,a)}),this._coveringTilesDetailsProvider=new Or}clone(){const e=new fs;return e.apply(this),e}apply(e,a){this._globeLatitudeErrorCorrectionRadians=a||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=c.bp();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:a,applyGlobeMatrix:l}=e,h=this._helper.getMercatorTileCoordinates(a);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:h,clippingPlane:this._cachedClippingPlane,projectionTransition:l?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const a=this.pitchInRadians,l=this.cameraToCenterDistance/e,h=Math.sin(a)*l,f=Math.cos(a)*l+1,_=1/Math.sqrt(h*h+f*f)*1;let C=-h,I=f;const k=Math.sqrt(C*C+I*I);C/=k,I/=k;const M=[0,C,I];c.bw(M,M,[0,0,0],-this.bearingInRadians),c.bx(M,M,[0,0,0],-1*this.center.lat*Math.PI/180),c.by(M,M,[0,0,0],this.center.lng*Math.PI/180);const N=1/c.aZ(M);return c.aR(M,M,N),[...M,-_*N]}isLocationOccluded(e){return!this.isSurfacePointVisible(Xi(e))}transformLightDirection(e){const a=this._helper._center.lng*Math.PI/180,l=this._helper._center.lat*Math.PI/180,h=Math.cos(l),f=[Math.sin(a)*h,Math.sin(l),Math.cos(a)*h],_=[f[2],0,-f[0]],C=[0,0,0];c.aW(C,_,f),c.aV(_,_),c.aV(C,C);const I=[0,0,0];return c.aV(I,[_[0]*e[0]+C[0]*e[1]+f[0]*e[2],_[1]*e[0]+C[1]*e[1]+f[1]*e[2],_[2]*e[0]+C[2]*e[1]+f[2]*e[2]]),I}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,a,l){const h=function(C,I,k){const M=1/(1<<k.z);return new c.a1(C/c.$*M+k.x*M,I/c.$*M+k.y*M)}(e,a,l.canonical),f=(_=h.y,[c.bo(h.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-_*Math.PI*2))-.5*Math.PI]);var _;return this.getCircleRadiusCorrection()/Math.cos(f[1])}projectTileCoordinates(e,a,l,h){const f=l.canonical,_=vr(e,a,f.x,f.y,f.z),C=1+(h?h(e,a):0)/c.bu,I=[_[0]*C,_[1]*C,_[2]*C,1];c.aw(I,I,this._globeViewProjMatrixNoCorrection);const k=this._cachedClippingPlane,M=k[0]*_[0]+k[1]*_[1]+k[2]*_[2]+k[3]<0;return{point:new c.P(I[0]/I[3],I[1]/I[3]),signedDistanceFromCamera:I[3],isOccluded:M}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=Ao(this.worldSize,this.center.lat),a=c.ba(),l=c.ba();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),c.b4(a,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const h=this.centerOffset;a[8]=2*-h.x/this._helper._width,a[9]=2*h.y/this._helper._height,this._projectionMatrix=c.b5(a),this._globeProjMatrixInverted=c.ba(),c.aq(this._globeProjMatrixInverted,a),c.M(a,a,[0,0,-this.cameraToCenterDistance]),c.b6(a,a,this.rollInRadians),c.b7(a,a,-this.pitchInRadians),c.b6(a,a,this.bearingInRadians),c.M(a,a,[0,0,-e]);const f=c.bp();f[0]=e,f[1]=e,f[2]=e,c.b7(l,a,this.center.lat*Math.PI/180),c.bz(l,l,-this.center.lng*Math.PI/180),c.N(l,l,f),this._globeViewProjMatrixNoCorrection=l,c.b7(a,a,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),c.bz(a,a,-this.center.lng*Math.PI/180),c.N(a,a,f),this._globeViewProjMatrix32f=new Float32Array(a),this._globeViewProjMatrixNoCorrectionInverted=c.ba(),c.aq(this._globeViewProjMatrixNoCorrectionInverted,l);const _=c.bp();this._cameraPosition=c.bp(),this._cameraPosition[2]=this.cameraToCenterDistance/e,c.bw(this._cameraPosition,this._cameraPosition,_,-this.rollInRadians),c.bx(this._cameraPosition,this._cameraPosition,_,this.pitchInRadians),c.bw(this._cameraPosition,this._cameraPosition,_,-this.bearingInRadians),c.aS(this._cameraPosition,this._cameraPosition,[0,0,1]),c.bx(this._cameraPosition,this._cameraPosition,_,-this.center.lat*Math.PI/180),c.by(this._cameraPosition,this._cameraPosition,_,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const C=c.b5(this._globeViewProjMatrixNoCorrectionInverted);c.N(C,C,[1,1,-1]),this._cachedFrustum=Ni.fromInvProjectionMatrix(C,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(e){c.w("calculateFogMatrix is not supported on globe projection.");const a=c.ba();return c.ag(a),a}getVisibleUnwrappedCoordinates(e){return[new c.b2(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&c.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,a){if(!this._globeViewProjMatrixNoCorrection)return 1;const l=Xi(e);c.aR(l,l,1+a/c.bu);const h=c.bv();return c.aw(h,[l[0],l[1],l[2],1],this._globeViewProjMatrixNoCorrection),h[2]/h[3]}populateCache(e){}getBounds(){const e=.5*this.width,a=.5*this.height,l=[new c.P(0,0),new c.P(e,0),new c.P(this.width,0),new c.P(this.width,a),new c.P(this.width,this.height),new c.P(e,this.height),new c.P(0,this.height),new c.P(0,a)],h=[];for(const N of l)h.push(this.unprojectScreenPoint(N));let f=0,_=0,C=0,I=0;const k=this.center;for(const N of h){const z=c.bA(k.lng,N.lng),L=c.bA(k.lat,N.lat);z<_&&(_=z),z>f&&(f=z),L<I&&(I=L),L>C&&(C=L)}const M=[k.lng+_,k.lat+I,k.lng+f,k.lat+C];return this.isSurfacePointOnScreen([0,1,0])&&(M[3]=90,M[0]=-180,M[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(M[1]=-90,M[0]=-180,M[2]=180),new ni(M)}getConstrained(e,a){const l=c.ah(e.lat,-c.ai,c.ai),h=c.ah(+a,this.minZoom+xi(0,l),this.maxZoom);return{center:new c.S(e.lng,l),zoom:h}}calculateCenterFromCameraLngLatAlt(e,a,l,h){return this._helper.calculateCenterFromCameraLngLatAlt(e,a,l,h)}setLocationAtPoint(e,a){const l=Xi(this.unprojectScreenPoint(a)),h=Xi(e),f=c.bp();c.bB(f);const _=c.bp();c.by(_,l,f,-this.center.lng*Math.PI/180),c.bx(_,_,f,this.center.lat*Math.PI/180);const C=h[0]*h[0]+h[2]*h[2],I=_[0]*_[0];if(C<I)return;const k=Math.sqrt(C-I),M=-k,N=c.bC(h[0],h[2],_[0],k),z=c.bC(h[0],h[2],_[0],M),L=c.bp();c.by(L,h,f,-N);const U=c.bC(L[1],L[2],_[1],_[2]),q=c.bp();c.by(q,h,f,-z);const H=c.bC(q[1],q[2],_[1],_[2]),X=.5*Math.PI,J=U>=-X&&U<=X,ie=H>=-X&&H<=X;let Q,ae;if(J&&ie){const Ae=this.center.lng*Math.PI/180,be=this.center.lat*Math.PI/180;c.bD(N,Ae)+c.bD(U,be)<c.bD(z,Ae)+c.bD(H,be)?(Q=N,ae=U):(Q=z,ae=H)}else if(J)Q=N,ae=U;else{if(!ie)return;Q=z,ae=H}const de=Q/Math.PI*180,te=ae/Math.PI*180,pe=this.center.lat;this.setCenter(new c.S(de,c.ah(te,-90,90))),this.setZoom(this.zoom+xi(pe,this.center.lat))}locationToScreenPoint(e,a){const l=Xi(e);if(a){const h=a.getElevationForLngLatZoom(e,this._helper._tileZoom);c.aR(l,l,1+h/c.bu)}return this._projectSurfacePointToScreen(l)}_projectSurfacePointToScreen(e){const a=c.bv();return c.aw(a,[...e,1],this._globeViewProjMatrixNoCorrection),a[0]/=a[3],a[1]/=a[3],new c.P((.5*a[0]+.5)*this.width,(.5*-a[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,a){if(a){const l=a.pointCoordinate(e);if(l)return l}return c.a1.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,a){var l;return(l=this.screenPointToMercatorCoordinate(e,a))===null||l===void 0?void 0:l.toLngLat()}isPointOnMapSurface(e,a){const l=this._cameraPosition,h=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(l,h)}getRayDirectionFromPixel(e){const a=c.bv();a[0]=e.x/this.width*2-1,a[1]=-1*(e.y/this.height*2-1),a[2]=1,a[3]=1,c.aw(a,a,this._globeViewProjMatrixNoCorrectionInverted),a[0]/=a[3],a[1]/=a[3],a[2]/=a[3];const l=c.bp();l[0]=a[0]-this._cameraPosition[0],l[1]=a[1]-this._cameraPosition[1],l[2]=a[2]-this._cameraPosition[2];const h=c.bp();return c.aV(h,l),h}isSurfacePointVisible(e){const a=this._cachedClippingPlane;return a[0]*e[0]+a[1]*e[1]+a[2]*e[2]+a[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const a=c.bv();return c.aw(a,[...e,1],this._globeViewProjMatrixNoCorrection),a[0]/=a[3],a[1]/=a[3],a[2]/=a[3],a[0]>-1&&a[0]<1&&a[1]>-1&&a[1]<1&&a[2]>-1&&a[2]<1}rayPlanetIntersection(e,a){const l=c.aX(e,a),h=c.bp(),f=c.bp();c.aR(f,a,l),c.aU(h,e,f);const _=1-c.aX(h,h);if(_<0)return null;const C=c.aX(e,e)-1,I=-l+(l<0?1:-1)*Math.sqrt(_),k=C/I,M=I;return{tMin:Math.min(k,M),tMax:Math.max(k,M)}}unprojectScreenPoint(e){const a=this._cameraPosition,l=this.getRayDirectionFromPixel(e),h=this.rayPlanetIntersection(a,l);if(h){const M=c.bp();c.aS(M,a,[l[0]*h.tMin,l[1]*h.tMin,l[2]*h.tMin]);const N=c.bp();return c.aV(N,M),hs(N)}const f=this._cachedClippingPlane,_=f[0]*l[0]+f[1]*l[1]+f[2]*l[2],C=-c.b1(f,a)/_,I=c.bp();if(C>0)c.aS(I,a,[l[0]*C,l[1]*C,l[2]*C]);else{const M=c.bp();c.aS(M,a,[2*l[0],2*l[1],2*l[2]]);const N=c.b1(this._cachedClippingPlane,M);c.aU(I,M,[this._cachedClippingPlane[0]*N,this._cachedClippingPlane[1]*N,this._cachedClippingPlane[2]*N])}const k=function(M){const N=c.bp();return N[0]=M[0]*-M[3],N[1]=M[1]*-M[3],N[2]=M[2]*-M[3],{center:N,radius:Math.sqrt(1-M[3]*M[3])}}(f);return hs(function(M,N,z){const L=c.bp();c.aU(L,z,M);const U=c.bp();return c.bq(U,M,L,N/c.a$(L)),U}(k.center,k.radius,I))}getMatrixForModel(e,a){const l=c.S.convert(e),h=1/c.bu,f=c.b9();return c.bz(f,f,l.lng/180*Math.PI),c.b7(f,f,-l.lat/180*Math.PI),c.M(f,f,[0,0,1+a/c.bu]),c.b7(f,f,.5*Math.PI),c.N(f,f,[h,h,h]),f}getProjectionDataForCustomLayer(e=!0){const a=this.getProjectionData({overscaledTileID:new c.Z(0,0,0,0,0),applyGlobeMatrix:e});return a.tileMercatorCoords=[0,0,1,1],a}getFastPathSimpleProjectionMatrix(e){}}class gs{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,a,l){return this._helper.interpolatePadding(e,a,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,a,l=!0){this._helper.resize(e,a,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,a){this._helper.overrideNearFarZ(e,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,a){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=a,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new bn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,a)=>this.getConstrained(e,a)}),this._globeness=1,this._mercatorTransform=new Zt,this._verticalPerspectiveTransform=new fs}clone(){const e=new gs;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const a=this._mercatorTransform.getProjectionData(e),l=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?l.mainMatrix:a.mainMatrix,clippingPlane:l.clippingPlane,tileMercatorCoords:l.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:a.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return c.bk(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return c.bk(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,a,l){const h=this._mercatorTransform.getPitchedTextCorrection(e,a,l),f=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,a,l);return c.bk(h,f,this._globeness)}projectTileCoordinates(e,a,l,h){return this.currentTransform.projectTileCoordinates(e,a,l,h)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,a){return this.currentTransform.lngLatToCameraDepth(e,a)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,a){return this.currentTransform.getConstrained(e,a)}calculateCenterFromCameraLngLatAlt(e,a,l,h){return this._helper.calculateCenterFromCameraLngLatAlt(e,a,l,h)}setLocationAtPoint(e,a){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,a),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,a),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,a){return this.currentTransform.locationToScreenPoint(e,a)}screenPointToMercatorCoordinate(e,a){return this.currentTransform.screenPointToMercatorCoordinate(e,a)}screenPointToLocation(e,a){return this.currentTransform.screenPointToLocation(e,a)}isPointOnMapSurface(e,a){return this.currentTransform.isPointOnMapSurface(e,a)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,a){return this.currentTransform.getMatrixForModel(e,a)}getProjectionDataForCustomLayer(e=!0){const a=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return a;const l=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return l.fallbackMatrix=a.mainMatrix,l}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class pn{get useGlobeControls(){return!0}handlePanInertia(e,a){const l=nd(e,a);return Math.abs(l.lng-a.center.lng)>180&&(l.lng=a.center.lng+179.5*Math.sign(l.lng-a.center.lng)),{easingCenter:l,easingOffset:new c.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,a){const l=e.around,h=a.screenPointToLocation(l);e.bearingDelta&&a.setBearing(a.bearing+e.bearingDelta),e.pitchDelta&&a.setPitch(a.pitch+e.pitchDelta),e.rollDelta&&a.setRoll(a.roll+e.rollDelta);const f=a.zoom;e.zoomDelta&&a.setZoom(a.zoom+e.zoomDelta);const _=a.zoom-f;if(_===0)return;const C=c.bA(a.center.lng,h.lng),I=C/(Math.abs(C/180)+1),k=c.bA(a.center.lat,h.lat),M=a.getRayDirectionFromPixel(l),N=a.cameraPosition,z=-1*c.aX(N,M),L=c.bp();c.aS(L,N,[M[0]*z,M[1]*z,M[2]*z]);const U=c.aZ(L)-1,q=Math.exp(.5*-Math.max(U-.3,0)),H=Ao(a.worldSize,a.center.lat)/Math.min(a.width,a.height),X=c.bn(H,.9,.5,1,.25),J=(1-c.af(-_))*Math.min(q,X),ie=a.center.lat,Q=a.zoom,ae=new c.S(a.center.lng+I*J,c.ah(a.center.lat+k*J,-c.ai,c.ai));a.setLocationAtPoint(h,l);const de=a.center,te=c.bn(Math.abs(C),45,85,0,1),pe=c.bn(H,.75,.35,0,1),Ae=Math.pow(Math.max(te,pe),.25),be=c.bA(de.lng,ae.lng),Ce=c.bA(de.lat,ae.lat);a.setCenter(new c.S(de.lng+be*Ae,de.lat+Ce*Ae).wrap()),a.setZoom(Q+xi(ie,a.center.lat))}handleMapControlsPan(e,a,l){if(!e.panDelta)return;const h=a.center.lat,f=a.zoom;a.setCenter(nd(e.panDelta,a).wrap()),a.setZoom(f+xi(h,a.center.lat))}cameraForBoxAndBearing(e,a,l,h,f){const _=Hn(e,a,l,h,f),C=a.left/f.width*2-1,I=(f.width-a.right)/f.width*2-1,k=a.top/f.height*-2+1,M=(f.height-a.bottom)/f.height*-2+1,N=c.bA(l.getWest(),l.getEast())<0,z=N?l.getEast():l.getWest(),L=N?l.getWest():l.getEast(),U=Math.max(l.getNorth(),l.getSouth()),q=Math.min(l.getNorth(),l.getSouth()),H=z+.5*c.bA(z,L),X=U+.5*c.bA(U,q),J=f.clone();J.setCenter(_.center),J.setBearing(_.bearing),J.setPitch(0),J.setRoll(0),J.setZoom(_.zoom);const ie=J.modelViewProjectionMatrix,Q=[Xi(l.getNorthWest()),Xi(l.getNorthEast()),Xi(l.getSouthWest()),Xi(l.getSouthEast()),Xi(new c.S(L,X)),Xi(new c.S(z,X)),Xi(new c.S(H,U)),Xi(new c.S(H,q))],ae=Xi(_.center);let de=Number.POSITIVE_INFINITY;for(const te of Q)C<0&&(de=pn.getLesserNonNegativeNonNull(de,pn.solveVectorScale(te,ae,ie,"x",C))),I>0&&(de=pn.getLesserNonNegativeNonNull(de,pn.solveVectorScale(te,ae,ie,"x",I))),k>0&&(de=pn.getLesserNonNegativeNonNull(de,pn.solveVectorScale(te,ae,ie,"y",k))),M<0&&(de=pn.getLesserNonNegativeNonNull(de,pn.solveVectorScale(te,ae,ie,"y",M)));if(Number.isFinite(de)&&de!==0)return _.zoom=J.zoom+c.ak(de),_;id()}handleJumpToCenterZoom(e,a){const l=e.center.lat,h=e.getConstrained(a.center?c.S.convert(a.center):e.center,e.zoom).center;e.setCenter(h.wrap());const f=a.zoom!==void 0?+a.zoom:e.zoom+xi(l,h.lat);e.zoom!==f&&e.setZoom(f)}handleEaseTo(e,a){const l=e.zoom,h=e.center,f=e.padding,_={roll:e.roll,pitch:e.pitch,bearing:e.bearing},C={roll:a.roll===void 0?e.roll:a.roll,pitch:a.pitch===void 0?e.pitch:a.pitch,bearing:a.bearing===void 0?e.bearing:a.bearing},I=a.zoom!==void 0,k=!e.isPaddingEqual(a.padding);let M=!1;const N=a.center?c.S.convert(a.center):h,z=e.getConstrained(N,l).center;dl(e,z);const L=e.clone();L.setCenter(z),L.setZoom(I?+a.zoom:l+xi(h.lat,N.lat)),L.setBearing(a.bearing);const U=new c.P(c.ah(e.centerPoint.x+a.offsetAsPoint.x,0,e.width),c.ah(e.centerPoint.y+a.offsetAsPoint.y,0,e.height));L.setLocationAtPoint(z,U);const q=(a.offset&&a.offsetAsPoint.mag())>0?L.center:z,H=I?+a.zoom:l+xi(h.lat,q.lat),X=l+xi(h.lat,0),J=H+xi(q.lat,0),ie=c.bA(h.lng,q.lng),Q=c.bA(h.lat,q.lat),ae=c.af(J-X);return M=H!==l,{easeFunc:de=>{if(c.be(_,C)||Cn({startEulerAngles:_,endEulerAngles:C,tr:e,k:de,useSlerp:_.roll!=C.roll}),k&&e.interpolatePadding(f,a.padding,de),a.around)c.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(a.around,a.aroundPoint);else{const te=J>X?Math.min(2,ae):Math.max(.5,ae),pe=Math.pow(te,1-de),Ae=eu(h,ie,Q,de*pe);e.setCenter(Ae.wrap())}if(M){const te=c.C.number(X,J,de)+xi(0,e.center.lat);e.setZoom(te)}},isZooming:M,elevationCenter:q}}handleFlyTo(e,a){const l=a.zoom!==void 0,h=e.center,f=e.zoom,_=e.padding,C=!e.isPaddingEqual(a.padding),I=e.getConstrained(c.S.convert(a.center||a.locationAtOffset),f).center,k=l?+a.zoom:e.zoom+xi(e.center.lat,I.lat),M=e.clone();M.setCenter(I),M.setZoom(k),M.setBearing(a.bearing);const N=new c.P(c.ah(e.centerPoint.x+a.offsetAsPoint.x,0,e.width),c.ah(e.centerPoint.y+a.offsetAsPoint.y,0,e.height));M.setLocationAtPoint(I,N);const z=M.center;dl(e,z);const L=function(Q,ae,de){const te=Xi(ae),pe=Xi(de),Ae=c.aX(te,pe),be=Math.acos(Ae),Ce=yl(Q);return be/(2*Math.PI)*Ce}(e,h,z),U=f+xi(h.lat,0),q=k+xi(z.lat,0),H=c.af(q-U);let X;if(typeof a.minZoom=="number"){const Q=+a.minZoom+xi(z.lat,0),ae=Math.min(Q,U,q)+xi(0,z.lat),de=e.getConstrained(z,ae).zoom+xi(z.lat,0);X=c.af(de-U)}const J=c.bA(h.lng,z.lng),ie=c.bA(h.lat,z.lat);return{easeFunc:(Q,ae,de,te)=>{const pe=eu(h,J,ie,de);C&&e.interpolatePadding(_,a.padding,Q);const Ae=Q===1?z:pe;e.setCenter(Ae.wrap());const be=U+c.ak(ae);e.setZoom(Q===1?k:be+xi(0,Ae.lat))},scaleOfZoom:H,targetCenter:z,scaleOfMinZoom:X,pixelPathLength:L}}static solveVectorScale(e,a,l,h,f){const _=h==="x"?[l[0],l[4],l[8],l[12]]:[l[1],l[5],l[9],l[13]],C=[l[3],l[7],l[11],l[15]],I=e[0]*_[0]+e[1]*_[1]+e[2]*_[2],k=e[0]*C[0]+e[1]*C[1]+e[2]*C[2],M=a[0]*_[0]+a[1]*_[1]+a[2]*_[2],N=a[0]*C[0]+a[1]*C[1]+a[2]*C[2];return M+f*k===I+f*N||C[3]*(I-M)+_[3]*(N-k)+I*N==M*k?null:(M+_[3]-f*N-f*C[3])/(M-I-f*N+f*k)}static getLesserNonNegativeNonNull(e,a){return a!==null&&a>=0&&a<e?a:e}}class rd{constructor(e){this._globe=e,this._mercatorCameraHelper=new dn,this._verticalPerspectiveCameraHelper=new pn}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,a){return this.currentHelper.handlePanInertia(e,a)}handleMapControlsRollPitchBearingZoom(e,a){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,a)}handleMapControlsPan(e,a,l){this.currentHelper.handleMapControlsPan(e,a,l)}cameraForBoxAndBearing(e,a,l,h,f){return this.currentHelper.cameraForBoxAndBearing(e,a,l,h,f)}handleJumpToCenterZoom(e,a){this.currentHelper.handleJumpToCenterZoom(e,a)}handleEaseTo(e,a){return this.currentHelper.handleEaseTo(e,a)}handleFlyTo(e,a){return this.currentHelper.handleFlyTo(e,a)}}const _l=(m,e)=>c.y(m,e&&e.filter(a=>a.identifier!=="source.canvas")),Vm=c.bE();class tu extends c.E{constructor(e,a={}){var l,h;super(),this._rtlPluginLoaded=()=>{for(const _ in this.sourceCaches){const C=this.sourceCaches[_].getSource().type;C!=="vector"&&C!=="geojson"||this.sourceCaches[_].reload()}},this.map=e,this.dispatcher=new jt(En(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(_,C)=>this.getGlyphs(_,C)),this.dispatcher.registerMessageHandler("GI",(_,C)=>this.getImages(_,C)),this.dispatcher.registerMessageHandler("GDA",(_,C)=>this.getDashes(_,C)),this.imageManager=new Lt,this.imageManager.setEventedParent(this);const f=((l=e._container)===null||l===void 0?void 0:l.lang)||typeof document<"u"&&((h=document.documentElement)===null||h===void 0?void 0:h.lang)||void 0;this.glyphManager=new Bi(e._requestManager,a.localIdeographFontFamily,f),this.lineAtlas=new He(256,512),this.crossTileSymbolIndex=new Co,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.bF,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",c.bG()),Gt().on(Ye,this._rtlPluginLoaded),this.on("data",_=>{if(_.dataType!=="source"||_.sourceDataType!=="metadata")return;const C=this.sourceCaches[_.sourceId];if(!C)return;const I=C.getSource();if(I&&I.vectorLayerIds)for(const k in this._layers){const M=this._layers[k];M.source===I.id&&this._validateLayer(M)}})}setGlobalStateProperty(e,a){var l,h,f;this._checkLoaded();const _=a===null?(f=(h=(l=this.stylesheet.state)===null||l===void 0?void 0:l[e])===null||h===void 0?void 0:h.default)!==null&&f!==void 0?f:null:a;if(c.bH(_,this._globalState[e]))return this;this._globalState[e]=_,this._applyGlobalStateChanges([e])}getGlobalState(){return this._globalState}setGlobalState(e){this._checkLoaded();const a=[];for(const l in e)!c.bH(this._globalState[l],e[l].default)&&(a.push(l),this._globalState[l]=e[l].default);this._applyGlobalStateChanges(a)}_applyGlobalStateChanges(e){if(e.length===0)return;const a=new Set,l={};for(const h of e){l[h]=this._globalState[h];for(const f in this._layers){const _=this._layers[f],C=_.getLayoutAffectingGlobalStateRefs(),I=_.getPaintAffectingGlobalStateRefs();if(C.has(h)&&a.add(_.source),I.has(h))for(const{name:k,value:M}of I.get(h))this._updatePaintProperty(_,k,M)}}this.dispatcher.broadcast("UGS",l);for(const h in this.sourceCaches)a.has(h)&&(this._reloadSource(h),this._changed=!0)}loadURL(e,a={},l){this.fire(new c.l("dataloading",{dataType:"style"})),a.validate=typeof a.validate!="boolean"||a.validate;const h=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const f=this._loadStyleRequest;c.j(h,this._loadStyleRequest).then(_=>{this._loadStyleRequest=null,this._load(_.data,a,l)}).catch(_=>{this._loadStyleRequest=null,_&&!f.signal.aborted&&this.fire(new c.k(_))})}loadJSON(e,a={},l){this.fire(new c.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,ce.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,a.validate=a.validate!==!1,this._load(e,a,l)}).catch(()=>{})}loadEmpty(){this.fire(new c.l("dataloading",{dataType:"style"})),this._load(Vm,{validate:!1})}_load(e,a,l){var h,f;let _=a.transformStyle?a.transformStyle(l,e):e;if(!a.validate||!_l(this,c.z(_))){_=Object.assign({},_),this._loaded=!0,this.stylesheet=_;for(const C in _.sources)this.addSource(C,_.sources[C],{validate:!1});_.sprite?this._loadSprite(_.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(_.glyphs),this._createLayers(),this.light=new Gn(this.stylesheet.light),this._setProjectionInternal(((h=this.stylesheet.projection)===null||h===void 0?void 0:h.type)||"mercator"),this.sky=new Qe(this.stylesheet.sky),this.map.setTerrain((f=this.stylesheet.terrain)!==null&&f!==void 0?f:null),this.fire(new c.l("data",{dataType:"style"})),this.fire(new c.l("style.load"))}}_createLayers(){var e;const a=c.bI(this.stylesheet.layers);this.setGlobalState((e=this.stylesheet.state)!==null&&e!==void 0?e:null),this.dispatcher.broadcast("SL",a),this._order=a.map(l=>l.id),this._layers={},this._serializedLayers=null;for(const l of a){const h=c.bJ(l,this._globalState);h.setEventedParent(this,{layer:{id:l.id}}),this._layers[l.id]=h}}_loadSprite(e,a=!1,l=void 0){let h;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(f,_,C,I){return c._(this,void 0,void 0,function*(){const k=tt(f),M=C>1?"@2x":"",N={},z={};for(const{id:L,url:U}of k){const q=_.transformRequest(et(U,M,".json"),"SpriteJSON");N[L]=c.j(q,I);const H=_.transformRequest(et(U,M,".png"),"SpriteImage");z[L]=De.getImage(H,I)}return yield Promise.all([...Object.values(N),...Object.values(z)]),function(L,U){return c._(this,void 0,void 0,function*(){const q={};for(const H in L){q[H]={};const X=ce.getImageCanvasContext((yield U[H]).data),J=(yield L[H]).data;for(const ie in J){const{width:Q,height:ae,x:de,y:te,sdf:pe,pixelRatio:Ae,stretchX:be,stretchY:Ce,content:Se,textFitWidth:Oe,textFitHeight:Be}=J[ie];q[H][ie]={data:null,pixelRatio:Ae,sdf:pe,stretchX:be,stretchY:Ce,content:Se,textFitWidth:Oe,textFitHeight:Be,spriteData:{width:Q,height:ae,x:de,y:te,context:X}}}}return q})}(N,z)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(f=>{if(this._spriteRequest=null,f)for(const _ in f){this._spritesImagesIds[_]=[];const C=this._spritesImagesIds[_]?this._spritesImagesIds[_].filter(I=>!(I in f)):[];for(const I of C)this.imageManager.removeImage(I),this._changedImages[I]=!0;for(const I in f[_]){const k=_==="default"?I:`${_}:${I}`;this._spritesImagesIds[_].push(k),k in this.imageManager.images?this.imageManager.updateImage(k,f[_][I],!1):this.imageManager.addImage(k,f[_][I]),a&&(this._changedImages[k]=!0)}}}).catch(f=>{this._spriteRequest=null,h=f,this.fire(new c.k(h))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),a&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"})),l&&l(h)})}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}_validateLayer(e){const a=this.sourceCaches[e.source];if(!a)return;const l=e.sourceLayer;if(!l)return;const h=a.getSource();(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(l)===-1)&&this.fire(new c.k(new Error(`Source layer "${l}" does not exist on source "${h.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,a=!1){const l=this._serializedAllLayers();if(!e||e.length===0)return Object.values(a?c.bK(l):l);const h=[];for(const f of e)if(l[f]){const _=a?c.bK(l[f]):l[f];h.push(_)}return h}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const a=Object.keys(this._layers);for(const l of a){const h=this._layers[l];h.type!=="custom"&&(e[l]=h.serialize())}return e}hasTransitions(){var e,a,l;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((a=this.sky)===null||a===void 0)&&a.hasTransition()||!((l=this.projection)===null||l===void 0)&&l.hasTransition())return!0;for(const h in this.sourceCaches)if(this.sourceCaches[h].hasTransition())return!0;for(const h in this._layers)if(this._layers[h].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const a=this._changed;if(a){const h=Object.keys(this._updatedLayers),f=Object.keys(this._removedLayers);(h.length||f.length)&&this._updateWorkerLayers(h,f);for(const _ in this._updatedSources){const C=this._updatedSources[_];if(C==="reload")this._reloadSource(_);else{if(C!=="clear")throw new Error(`Invalid action ${C}`);this._clearSource(_)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const _ in this._updatedPaintProps)this._layers[_].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const l={};for(const h in this.sourceCaches){const f=this.sourceCaches[h];l[h]=f.used,f.used=!1}for(const h of this._order){const f=this._layers[h];f.recalculate(e,this._availableImages),!f.isHidden(e.zoom)&&f.source&&(this.sourceCaches[f.source].used=!0)}for(const h in l){const f=this.sourceCaches[h];!!l[h]!=!!f.used&&f.fire(new c.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:h}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,a&&this.fire(new c.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const a in this.sourceCaches)this.sourceCaches[a].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,a){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:a})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,a={}){var l;this._checkLoaded();const h=this.serialize();if(e=a.transformStyle?a.transformStyle(h,e):e,((l=a.validate)===null||l===void 0||l)&&_l(this,c.z(e)))return!1;(e=c.bK(e)).layers=c.bI(e.layers);const f=c.bL(h,e),_=this._getOperationsToPerform(f);if(_.unimplemented.length>0)throw new Error(`Unimplemented: ${_.unimplemented.join(", ")}.`);if(_.operations.length===0)return!1;for(const C of _.operations)C();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const a=[],l=[];for(const h of e)switch(h.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":a.push(()=>this.addLayer.apply(this,h.args));break;case"removeLayer":a.push(()=>this.removeLayer.apply(this,h.args));break;case"setPaintProperty":a.push(()=>this.setPaintProperty.apply(this,h.args));break;case"setLayoutProperty":a.push(()=>this.setLayoutProperty.apply(this,h.args));break;case"setFilter":a.push(()=>this.setFilter.apply(this,h.args));break;case"addSource":a.push(()=>this.addSource.apply(this,h.args));break;case"removeSource":a.push(()=>this.removeSource.apply(this,h.args));break;case"setLayerZoomRange":a.push(()=>this.setLayerZoomRange.apply(this,h.args));break;case"setLight":a.push(()=>this.setLight.apply(this,h.args));break;case"setGeoJSONSourceData":a.push(()=>this.setGeoJSONSourceData.apply(this,h.args));break;case"setGlyphs":a.push(()=>this.setGlyphs.apply(this,h.args));break;case"setSprite":a.push(()=>this.setSprite.apply(this,h.args));break;case"setTerrain":a.push(()=>this.map.setTerrain.apply(this,h.args));break;case"setSky":a.push(()=>this.setSky.apply(this,h.args));break;case"setProjection":this.setProjection.apply(this,h.args);break;case"setGlobalState":a.push(()=>this.setGlobalState.apply(this,h.args));break;case"setTransition":a.push(()=>{});break;default:l.push(h.command)}return{operations:a,unimplemented:l}}addImage(e,a){if(this.getImage(e))return this.fire(new c.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,a),this._afterImageUpdated(e)}updateImage(e,a){this.imageManager.updateImage(e,a)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new c.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,a,l={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!a.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(a).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(a.type)>=0&&this._validate(c.z.source,`sources.${e}`,a,null,l))return;this.map&&this.map._collectResourceTiming&&(a.collectResourceTiming=!0);const h=this.sourceCaches[e]=new Pt(e,a,this.dispatcher);h.style=this,h.setEventedParent(this,()=>({isSourceLoaded:h.loaded(),source:h.serialize(),sourceId:e})),h.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const l in this._layers)if(this._layers[l].source===e)return this.fire(new c.k(new Error(`Source "${e}" cannot be removed while layer "${l}" is using it.`)));const a=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],a.fire(new c.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),a.setEventedParent(null),a.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,a){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const l=this.sourceCaches[e].getSource();if(l.type!=="geojson")throw new Error(`geojsonSource.type is ${l.type}, which is !== 'geojson`);l.setData(a),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,a,l={}){this._checkLoaded();const h=e.id;if(this.getLayer(h))return void this.fire(new c.k(new Error(`Layer "${h}" already exists on this map.`)));let f;if(e.type==="custom"){if(_l(this,c.bM(e)))return;f=c.bJ(e,this._globalState)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(h,e.source),e=c.bK(e),e=c.e(e,{source:h})),this._validate(c.z.layer,`layers.${h}`,e,{arrayIndex:-1},l))return;f=c.bJ(e,this._globalState),this._validateLayer(f),f.setEventedParent(this,{layer:{id:h}})}const _=a?this._order.indexOf(a):this._order.length;if(a&&_===-1)this.fire(new c.k(new Error(`Cannot add layer "${h}" before non-existing layer "${a}".`)));else{if(this._order.splice(_,0,h),this._layerOrderChanged=!0,this._layers[h]=f,this._removedLayers[h]&&f.source&&f.type!=="custom"){const C=this._removedLayers[h];delete this._removedLayers[h],C.type!==f.type?this._updatedSources[f.source]="clear":(this._updatedSources[f.source]="reload",this.sourceCaches[f.source].pause())}this._updateLayer(f),f.onAdd&&f.onAdd(this.map)}}moveLayer(e,a){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new c.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===a)return;const l=this._order.indexOf(e);this._order.splice(l,1);const h=a?this._order.indexOf(a):this._order.length;a&&h===-1?this.fire(new c.k(new Error(`Cannot move layer "${e}" before non-existing layer "${a}".`))):(this._order.splice(h,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const a=this._layers[e];if(!a)return void this.fire(new c.k(new Error(`Cannot remove non-existing layer "${e}".`)));a.setEventedParent(null);const l=this._order.indexOf(e);this._order.splice(l,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=a,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],a.onRemove&&a.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,a,l){this._checkLoaded();const h=this.getLayer(e);h?h.minzoom===a&&h.maxzoom===l||(a!=null&&(h.minzoom=a),l!=null&&(h.maxzoom=l),this._updateLayer(h)):this.fire(new c.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,a,l={}){this._checkLoaded();const h=this.getLayer(e);if(h){if(!c.bH(h.filter,a))return a==null?(h.setFilter(void 0),void this._updateLayer(h)):void(this._validate(c.z.filter,`layers.${h.id}.filter`,a,null,l)||(h.setFilter(c.bK(a)),this._updateLayer(h)))}else this.fire(new c.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return c.bK(this.getLayer(e).filter)}setLayoutProperty(e,a,l,h={}){this._checkLoaded();const f=this.getLayer(e);f?c.bH(f.getLayoutProperty(a),l)||(f.setLayoutProperty(a,l,h),this._updateLayer(f)):this.fire(new c.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,a){const l=this.getLayer(e);if(l)return l.getLayoutProperty(a);this.fire(new c.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,a,l,h={}){this._checkLoaded();const f=this.getLayer(e);f?c.bH(f.getPaintProperty(a),l)||this._updatePaintProperty(f,a,l,h):this.fire(new c.k(new Error(`Cannot style non-existing layer "${e}".`)))}_updatePaintProperty(e,a,l,h={}){e.setPaintProperty(a,l,h)&&this._updateLayer(e),this._changed=!0,this._updatedPaintProps[e.id]=!0,this._serializedLayers=null}getPaintProperty(e,a){return this.getLayer(e).getPaintProperty(a)}setFeatureState(e,a){this._checkLoaded();const l=e.source,h=e.sourceLayer,f=this.sourceCaches[l];if(f===void 0)return void this.fire(new c.k(new Error(`The source '${l}' does not exist in the map's style.`)));const _=f.getSource().type;_==="geojson"&&h?this.fire(new c.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):_!=="vector"||h?(e.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),f.setFeatureState(h,e.id,a)):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,a){this._checkLoaded();const l=e.source,h=this.sourceCaches[l];if(h===void 0)return void this.fire(new c.k(new Error(`The source '${l}' does not exist in the map's style.`)));const f=h.getSource().type,_=f==="vector"?e.sourceLayer:void 0;f!=="vector"||_?a&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new c.k(new Error("A feature id is required to remove its specific state property."))):h.removeFeatureState(_,e.id,a):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const a=e.source,l=e.sourceLayer,h=this.sourceCaches[a];if(h!==void 0)return h.getSource().type!=="vector"||l?(e.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),h.getFeatureState(l,e.id)):void this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.k(new Error(`The source '${a}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=c.bN(this.sourceCaches,f=>f.serialize()),a=this._serializeByIds(this._order,!0),l=this.map.getTerrain()||void 0,h=this.stylesheet;return c.bO({version:h.version,name:h.name,metadata:h.metadata,light:h.light,sky:h.sky,center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch,sprite:h.sprite,glyphs:h.glyphs,transition:h.transition,projection:h.projection,sources:e,layers:a,terrain:l},f=>f!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const a=_=>this._layers[_].type==="fill-extrusion",l={},h=[];for(let _=this._order.length-1;_>=0;_--){const C=this._order[_];if(a(C)){l[C]=_;for(const I of e){const k=I[C];if(k)for(const M of k)h.push(M)}}}h.sort((_,C)=>C.intersectionZ-_.intersectionZ);const f=[];for(let _=this._order.length-1;_>=0;_--){const C=this._order[_];if(a(C))for(let I=h.length-1;I>=0;I--){const k=h[I].feature;if(l[k.layer.id]<_)break;f.push(k),h.pop()}else for(const I of e){const k=I[C];if(k)for(const M of k)f.push(M.feature)}}return f}queryRenderedFeatures(e,a,l){a&&a.filter&&this._validate(c.z.filter,"queryRenderedFeatures.filter",a.filter,null,a);const h={};if(a&&a.layers){if(!(Array.isArray(a.layers)||a.layers instanceof Set))return this.fire(new c.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const k of a.layers){const M=this._layers[k];if(!M)return this.fire(new c.k(new Error(`The layer '${k}' does not exist in the map's style and cannot be queried for features.`))),[];h[M.source]=!0}}const f=[];a.availableImages=this._availableImages;const _=this._serializedAllLayers(),C=a.layers instanceof Set?a.layers:Array.isArray(a.layers)?new Set(a.layers):null,I=Object.assign(Object.assign({},a),{layers:C,globalState:this._globalState});for(const k in this.sourceCaches)a.layers&&!h[k]||f.push(Nn(this.sourceCaches[k],this._layers,_,e,I,l,this.map.terrain?(M,N,z)=>this.map.terrain.getElevation(M,N,z):void 0));return this.placement&&f.push(function(k,M,N,z,L,U,q){const H={},X=U.queryRenderedSymbols(z),J=[];for(const ie of Object.keys(X).map(Number))J.push(q[ie]);J.sort(fr);for(const ie of J){const Q=ie.featureIndex.lookupSymbolFeatures(X[ie.bucketInstanceId],M,ie.bucketIndex,ie.sourceLayerIndex,{filterSpec:L.filter,globalState:L.globalState},L.layers,L.availableImages,k);for(const ae in Q){const de=H[ae]=H[ae]||[],te=Q[ae];te.sort((pe,Ae)=>{const be=ie.featureSortOrder;if(be){const Ce=be.indexOf(pe.featureIndex);return be.indexOf(Ae.featureIndex)-Ce}return Ae.featureIndex-pe.featureIndex});for(const pe of te)de.push(pe)}}return function(ie,Q,ae){for(const de in ie)for(const te of ie[de])gr(te,ae[Q[de].source]);return ie}(H,k,N)}(this._layers,_,this.sourceCaches,e,I,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(f)}querySourceFeatures(e,a){a!=null&&a.filter&&this._validate(c.z.filter,"querySourceFeatures.filter",a.filter,null,a);const l=this.sourceCaches[e];return l?function(h,f){const _=h.getRenderableIds().map(k=>h.getTileByID(k)),C=[],I={};for(let k=0;k<_.length;k++){const M=_[k],N=M.tileID.canonical.key;I[N]||(I[N]=!0,M.querySourceFeatures(C,f))}return C}(l,a?Object.assign(Object.assign({},a),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(e,a={}){this._checkLoaded();const l=this.light.getLight();let h=!1;for(const _ in e)if(!c.bH(e[_],l[_])){h=!0;break}if(!h)return;const f={now:ce.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,a),this.light.updateTransitions(f)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,a={}){this._checkLoaded();const l=this.getSky();let h=!1;if(!e&&!l)return;if(e&&!l)h=!0;else if(!e&&l)h=!0;else for(const _ in e)if(!c.bH(e[_],l[_])){h=!0;break}if(!h)return;const f={now:ce.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,a),this.sky.updateTransitions(f)}_setProjectionInternal(e){const a=function(l){if(Array.isArray(l)){const h=new gl({type:l});return{projection:h,transform:new gs,cameraHelper:new rd(h)}}switch(l){case"mercator":return{projection:new Tt,transform:new Zt,cameraHelper:new dn};case"globe":{const h=new gl({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:h,transform:new gs,cameraHelper:new rd(h)}}case"vertical-perspective":return{projection:new us,transform:new fs,cameraHelper:new pn};default:return c.w(`Unknown projection name: ${l}. Falling back to mercator projection.`),{projection:new Tt,transform:new Zt,cameraHelper:new dn}}}(e);this.projection=a.projection,this.map.migrateProjection(a.transform,a.cameraHelper);for(const l in this.sourceCaches)this.sourceCaches[l].reload()}_validate(e,a,l,h,f={}){return(!f||f.validate!==!1)&&_l(this,e.call(c.z,c.e({key:a,style:this.serialize(),value:l,styleSpec:c.v},h)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Gt().off(Ye,this._rtlPluginLoaded);for(const a in this._layers)this._layers[a].setEventedParent(null);for(const a in this.sourceCaches){const l=this.sourceCaches[a];l.setEventedParent(null),l.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const a in this.sourceCaches)this.sourceCaches[a].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,a,l,h,f=!1){let _=!1,C=!1;const I={};for(const k of this._order){const M=this._layers[k];if(M.type!=="symbol")continue;if(!I[M.source]){const z=this.sourceCaches[M.source];I[M.source]=z.getRenderableIds(!0).map(L=>z.getTileByID(L)).sort((L,U)=>U.tileID.overscaledZ-L.tileID.overscaledZ||(L.tileID.isLessThan(U.tileID)?-1:1))}const N=this.crossTileSymbolIndex.addLayer(M,I[M.source],e.center.lng);_=_||N}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((f=f||this._layerOrderChanged||l===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(ce.now(),e.zoom))&&(this.pauseablePlacement=new Kc(e,this.map.terrain,this._order,f,a,l,h,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,I),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(ce.now()),C=!0),_&&this.pauseablePlacement.placement.setStale()),C||_)for(const k of this._order){const M=this._layers[k];M.type==="symbol"&&this.placement.updateLayerOpacities(M,I[M.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(ce.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,a){return c._(this,void 0,void 0,function*(){const l=yield this.imageManager.getImages(a.icons);this._updateTilesForChangedImages();const h=this.sourceCaches[a.source];return h&&h.setDependencies(a.tileID.key,a.type,a.icons),l})}getGlyphs(e,a){return c._(this,void 0,void 0,function*(){const l=yield this.glyphManager.getGlyphs(a.stacks),h=this.sourceCaches[a.source];return h&&h.setDependencies(a.tileID.key,a.type,[""]),l})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,a={}){this._checkLoaded(),e&&this._validate(c.z.glyphs,"glyphs",e,null,a)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}getDashes(e,a){return c._(this,void 0,void 0,function*(){const l={};for(const[h,f]of Object.entries(a.dashes))l[h]=this.lineAtlas.getDash(f.dasharray,f.round);return l})}addSprite(e,a,l={},h){this._checkLoaded();const f=[{id:e,url:a}],_=[...tt(this.stylesheet.sprite),...f];this._validate(c.z.sprite,"sprite",_,null,l)||(this.stylesheet.sprite=_,this._loadSprite(f,!0,h))}removeSprite(e){this._checkLoaded();const a=tt(this.stylesheet.sprite);if(a.find(l=>l.id===e)){if(this._spritesImagesIds[e])for(const l of this._spritesImagesIds[e])this.imageManager.removeImage(l),this._changedImages[l]=!0;a.splice(a.findIndex(l=>l.id===e),1),this.stylesheet.sprite=a.length>0?a:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}else this.fire(new c.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return tt(this.stylesheet.sprite)}setSprite(e,a={},l){this._checkLoaded(),e&&this._validate(c.z.sprite,"sprite",e,null,a)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,l):(this._unloadSprite(),l&&l(null)))}}var Um=c.aJ([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class $m{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,a,l,h,f,_,C,I,k){this.context=e;let M=this.boundPaintVertexBuffers.length!==h.length;for(let N=0;!M&&N<h.length;N++)this.boundPaintVertexBuffers[N]!==h[N]&&(M=!0);!this.vao||this.boundProgram!==a||this.boundLayoutVertexBuffer!==l||M||this.boundIndexBuffer!==f||this.boundVertexOffset!==_||this.boundDynamicVertexBuffer!==C||this.boundDynamicVertexBuffer2!==I||this.boundDynamicVertexBuffer3!==k?this.freshBind(a,l,h,f,_,C,I,k):(e.bindVertexArray.set(this.vao),C&&C.bind(),f&&f.dynamicDraw&&f.bind(),I&&I.bind(),k&&k.bind())}freshBind(e,a,l,h,f,_,C,I){const k=e.numAttributes,M=this.context,N=M.gl;this.vao&&this.destroy(),this.vao=M.createVertexArray(),M.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=l,this.boundIndexBuffer=h,this.boundVertexOffset=f,this.boundDynamicVertexBuffer=_,this.boundDynamicVertexBuffer2=C,this.boundDynamicVertexBuffer3=I,a.enableAttributes(N,e);for(const z of l)z.enableAttributes(N,e);_&&_.enableAttributes(N,e),C&&C.enableAttributes(N,e),I&&I.enableAttributes(N,e),a.bind(),a.setVertexAttribPointers(N,e,f);for(const z of l)z.bind(),z.setVertexAttribPointers(N,e,f);_&&(_.bind(),_.setVertexAttribPointers(N,e,f)),h&&h.bind(),C&&(C.bind(),C.setVertexAttribPointers(N,e,f)),I&&(I.bind(),I.setVertexAttribPointers(N,e,f)),M.currentNumAttributes=k}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const vl=(m,e,a,l,h)=>({u_texture:0,u_ele_delta:m,u_fog_matrix:e,u_fog_color:a?a.properties.get("fog-color"):c.bf.white,u_fog_ground_blend:a?a.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:h?0:a?a.calculateFogBlendOpacity(l):0,u_horizon_color:a?a.properties.get("horizon-color"):c.bf.white,u_horizon_fog_blend:a?a.properties.get("horizon-fog-blend"):1,u_is_globe_mode:h?1:0}),iu={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Oa(m){const e=[];for(let a=0;a<m.length;a++){if(m[a]===null)continue;const l=m[a].split(" ");e.push(l.pop())}return e}class nu{constructor(e,a,l,h,f,_,C,I,k=[]){const M=e.gl;this.program=M.createProgram();const N=Oa(a.staticAttributes),z=l?l.getBinderAttributes():[],L=N.concat(z),U=_r.prelude.staticUniforms?Oa(_r.prelude.staticUniforms):[],q=C.staticUniforms?Oa(C.staticUniforms):[],H=a.staticUniforms?Oa(a.staticUniforms):[],X=l?l.getBinderUniforms():[],J=U.concat(q).concat(H).concat(X),ie=[];for(const be of J)ie.indexOf(be)<0&&ie.push(be);const Q=l?l.defines():[];Br(M)&&Q.unshift("#version 300 es"),f&&Q.push("#define OVERDRAW_INSPECTOR;"),_&&Q.push("#define TERRAIN3D;"),I&&Q.push(I),k&&Q.push(...k);let ae=Q.concat(_r.prelude.fragmentSource,C.fragmentSource,a.fragmentSource).join(`
`),de=Q.concat(_r.prelude.vertexSource,C.vertexSource,a.vertexSource).join(`
`);Br(M)||(ae=function(be){return be.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(ae),de=function(be){return be.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(de));const te=M.createShader(M.FRAGMENT_SHADER);if(M.isContextLost())return void(this.failedToCreate=!0);if(M.shaderSource(te,ae),M.compileShader(te),!M.getShaderParameter(te,M.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${M.getShaderInfoLog(te)}`);M.attachShader(this.program,te);const pe=M.createShader(M.VERTEX_SHADER);if(M.isContextLost())return void(this.failedToCreate=!0);if(M.shaderSource(pe,de),M.compileShader(pe),!M.getShaderParameter(pe,M.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${M.getShaderInfoLog(pe)}`);M.attachShader(this.program,pe),this.attributes={};const Ae={};this.numAttributes=L.length;for(let be=0;be<this.numAttributes;be++)L[be]&&(M.bindAttribLocation(this.program,be,L[be]),this.attributes[L[be]]=be);if(M.linkProgram(this.program),!M.getProgramParameter(this.program,M.LINK_STATUS))throw new Error(`Program failed to link: ${M.getProgramInfoLog(this.program)}`);M.deleteShader(pe),M.deleteShader(te);for(let be=0;be<ie.length;be++){const Ce=ie[be];if(Ce&&!Ae[Ce]){const Se=M.getUniformLocation(this.program,Ce);Se&&(Ae[Ce]=Se)}}this.fixedUniforms=h(e,Ae),this.terrainUniforms=((be,Ce)=>({u_depth:new c.bP(be,Ce.u_depth),u_terrain:new c.bP(be,Ce.u_terrain),u_terrain_dim:new c.bg(be,Ce.u_terrain_dim),u_terrain_matrix:new c.bR(be,Ce.u_terrain_matrix),u_terrain_unpack:new c.bS(be,Ce.u_terrain_unpack),u_terrain_exaggeration:new c.bg(be,Ce.u_terrain_exaggeration)}))(e,Ae),this.projectionUniforms=((be,Ce)=>({u_projection_matrix:new c.bR(be,Ce.u_projection_matrix),u_projection_tile_mercator_coords:new c.bS(be,Ce.u_projection_tile_mercator_coords),u_projection_clipping_plane:new c.bS(be,Ce.u_projection_clipping_plane),u_projection_transition:new c.bg(be,Ce.u_projection_transition),u_projection_fallback_matrix:new c.bR(be,Ce.u_projection_fallback_matrix)}))(e,Ae),this.binderUniforms=l?l.getUniforms(e,Ae):[]}draw(e,a,l,h,f,_,C,I,k,M,N,z,L,U,q,H,X,J,ie){const Q=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(l),e.setStencilMode(h),e.setColorMode(f),e.setCullFace(_),I){e.activeTexture.set(Q.TEXTURE2),Q.bindTexture(Q.TEXTURE_2D,I.depthTexture),e.activeTexture.set(Q.TEXTURE3),Q.bindTexture(Q.TEXTURE_2D,I.texture);for(const de in this.terrainUniforms)this.terrainUniforms[de].set(I[de])}if(k)for(const de in k)this.projectionUniforms[iu[de]].set(k[de]);if(C)for(const de in this.fixedUniforms)this.fixedUniforms[de].set(C[de]);H&&H.setUniforms(e,this.binderUniforms,U,{zoom:q});let ae=0;switch(a){case Q.LINES:ae=2;break;case Q.TRIANGLES:ae=3;break;case Q.LINE_STRIP:ae=1}for(const de of L.get()){const te=de.vaos||(de.vaos={});(te[M]||(te[M]=new $m)).bind(e,this,N,H?H.getPaintVertexBuffers():[],z,de.vertexOffset,X,J,ie),Q.drawElements(a,de.primitiveLength*ae,Q.UNSIGNED_SHORT,de.primitiveOffset*ae*2)}}}function xl(m,e,a){const l=1/c.aC(a,1,e.transform.tileZoom),h=Math.pow(2,a.tileID.overscaledZ),f=a.tileSize*Math.pow(2,e.transform.tileZoom)/h,_=f*(a.tileID.canonical.x+a.tileID.wrap*h),C=f*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_scale:[l,m.fromScale,m.toScale],u_fade:m.t,u_pixel_coord_upper:[_>>16,C>>16],u_pixel_coord_lower:[65535&_,65535&C]}}const xr=(m,e,a,l)=>{const h=m.style.light,f=h.properties.get("position"),_=[f.x,f.y,f.z],C=c.bV();h.properties.get("anchor")==="viewport"&&c.bW(C,m.transform.bearingInRadians),c.bX(_,_,C);const I=m.transform.transformLightDirection(_),k=h.properties.get("color");return{u_lightpos:_,u_lightpos_globe:I,u_lightintensity:h.properties.get("intensity"),u_lightcolor:[k.r,k.g,k.b],u_vertical_gradient:+e,u_opacity:a,u_fill_translate:l}},Zm=(m,e,a,l,h,f,_)=>c.e(xr(m,e,a,l),xl(f,m,_),{u_height_factor:-Math.pow(2,h.overscaledZ)/_.tileSize/8}),bl=(m,e,a,l)=>c.e(xl(e,m,a),{u_fill_translate:l}),ys=(m,e)=>({u_world:m,u_fill_translate:e}),_s=(m,e,a,l,h)=>c.e(bl(m,e,a,h),{u_world:l}),Gm=(m,e,a,l,h)=>{const f=m.transform;let _,C,I=0;if(a.paint.get("circle-pitch-alignment")==="map"){const k=c.aC(e,1,f.zoom);_=!0,C=[k,k],I=k/(c.$*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*h}else _=!1,C=f.pixelsToGLUnits;return{u_camera_to_center_distance:f.cameraToCenterDistance,u_scale_with_map:+(a.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+_,u_device_pixel_ratio:m.pixelRatio,u_extrude_scale:C,u_globe_extrude_scale:I,u_translate:l}},wl=m=>({u_pixel_extrude_scale:[1/m.width,1/m.height]}),Wm=m=>({u_viewport_size:[m.width,m.height]}),Va=(m,e=1)=>({u_color:m,u_overlay:0,u_overlay_scale:e}),ad=(m,e,a,l)=>{const h=c.aC(m,1,e)/(c.$*Math.pow(2,m.tileID.overscaledZ))*2*Math.PI*l;return{u_extrude_scale:c.aC(m,1,e),u_intensity:a,u_globe_extrude_scale:h}},ru=(m,e,a,l)=>{const h=c.L();c.bY(h,0,m.width,m.height,0,0,1);const f=m.context.gl;return{u_matrix:h,u_world:[f.drawingBufferWidth,f.drawingBufferHeight],u_image:a,u_color_ramp:l,u_opacity:e.paint.get("heatmap-opacity")}},qm=(m,e,a)=>{const l=a.paint.get("hillshade-accent-color");let h;switch(a.paint.get("hillshade-method")){case"basic":h=4;break;case"combined":h=1;break;case"igor":h=2;break;case"multidirectional":h=3;break;default:h=0}const f=a.getIlluminationProperties();for(let _=0;_<f.directionRadians.length;_++)a.paint.get("hillshade-illumination-anchor")==="viewport"&&(f.directionRadians[_]+=m.transform.bearingInRadians);return{u_image:0,u_latrange:au(0,e.tileID),u_exaggeration:a.paint.get("hillshade-exaggeration"),u_altitudes:f.altitudeRadians,u_azimuths:f.directionRadians,u_accent:l,u_method:h,u_highlights:f.highlightColor,u_shadows:f.shadowColor}},od=(m,e)=>{const a=e.stride,l=c.L();return c.bY(l,0,c.$,-c.$,0,0,1),c.M(l,l,[0,-c.$,0]),{u_matrix:l,u_image:1,u_dimension:[a,a],u_zoom:m.overscaledZ,u_unpack:e.getUnpackVector()}};function au(m,e){const a=Math.pow(2,e.canonical.z),l=e.canonical.y;return[new c.a1(0,l/a).toLngLat().lat,new c.a1(0,(l+1)/a).toLngLat().lat]}const sd=(m,e,a=0)=>({u_image:0,u_unpack:e.getUnpackVector(),u_dimension:[e.stride,e.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:a,u_opacity:m.paint.get("color-relief-opacity")}),Cl=(m,e,a,l)=>{const h=m.transform;return{u_translation:su(m,e,a),u_ratio:l/c.aC(e,1,h.zoom),u_device_pixel_ratio:m.pixelRatio,u_units_to_pixels:[1/h.pixelsToGLUnits[0],1/h.pixelsToGLUnits[1]]}},ld=(m,e,a,l,h)=>c.e(Cl(m,e,a,l),{u_image:0,u_image_height:h}),cd=(m,e,a,l,h)=>{const f=m.transform,_=ou(e,f);return{u_translation:su(m,e,a),u_texsize:e.imageAtlasTexture.size,u_ratio:l/c.aC(e,1,f.zoom),u_device_pixel_ratio:m.pixelRatio,u_image:0,u_scale:[_,h.fromScale,h.toScale],u_fade:h.t,u_units_to_pixels:[1/f.pixelsToGLUnits[0],1/f.pixelsToGLUnits[1]]}},Ua=(m,e,a,l,h)=>{const f=ou(e,m.transform);return c.e(Cl(m,e,a,l),{u_tileratio:f,u_crossfade_from:h.fromScale,u_crossfade_to:h.toScale,u_image:0,u_mix:h.t,u_lineatlas_width:m.lineAtlas.width,u_lineatlas_height:m.lineAtlas.height})};function ou(m,e){return 1/c.aC(m,1,e.tileZoom)}function su(m,e,a){return c.aD(m.transform,e,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const vs=(m,e,a,l,h)=>{return{u_tl_parent:m,u_scale_parent:e,u_buffer_scale:1,u_fade_t:a.mix,u_opacity:a.opacity*l.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:l.paint.get("raster-brightness-min"),u_brightness_high:l.paint.get("raster-brightness-max"),u_saturation_factor:(_=l.paint.get("raster-saturation"),_>0?1-1/(1.001-_):-_),u_contrast_factor:(f=l.paint.get("raster-contrast"),f>0?1/(1-f):1+f),u_spin_weights:Hm(l.paint.get("raster-hue-rotate")),u_coords_top:[h[0].x,h[0].y,h[1].x,h[1].y],u_coords_bottom:[h[3].x,h[3].y,h[2].x,h[2].y]};var f,_};function Hm(m){m*=Math.PI/180;const e=Math.sin(m),a=Math.cos(m);return[(2*a+1)/3,(-Math.sqrt(3)*e-a+1)/3,(Math.sqrt(3)*e-a+1)/3]}const xs=(m,e,a,l,h,f,_,C,I,k,M,N,z)=>{const L=_.transform;return{u_is_size_zoom_constant:+(m==="constant"||m==="source"),u_is_size_feature_constant:+(m==="constant"||m==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:L.cameraToCenterDistance,u_pitch:L.pitch/360*2*Math.PI,u_rotate_symbol:+a,u_aspect_ratio:L.width/L.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_label_plane_matrix:C,u_coord_matrix:I,u_is_text:+M,u_pitch_with_map:+l,u_is_along_line:h,u_is_variable_anchor:f,u_texsize:N,u_texture:0,u_translation:k,u_pitched_scale:z}},ud=(m,e,a,l,h,f,_,C,I,k,M,N,z,L)=>{const U=_.transform;return c.e(xs(m,e,a,l,h,f,_,C,I,k,M,N,L),{u_gamma_scale:l?Math.cos(U.pitch*Math.PI/180)*U.cameraToCenterDistance:1,u_device_pixel_ratio:_.pixelRatio,u_is_halo:1})},Xm=(m,e,a,l,h,f,_,C,I,k,M,N,z)=>c.e(ud(m,e,a,l,h,f,_,C,I,k,!0,M,0,z),{u_texsize_icon:N,u_texture_icon:1}),hd=(m,e)=>({u_opacity:m,u_color:e}),dd=(m,e,a,l,h)=>c.e(function(f,_,C,I){const k=C.imageManager.getPattern(f.from.toString()),M=C.imageManager.getPattern(f.to.toString()),{width:N,height:z}=C.imageManager.getPixelSize(),L=Math.pow(2,I.tileID.overscaledZ),U=I.tileSize*Math.pow(2,C.transform.tileZoom)/L,q=U*(I.tileID.canonical.x+I.tileID.wrap*L),H=U*I.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:k.tl,u_pattern_br_a:k.br,u_pattern_tl_b:M.tl,u_pattern_br_b:M.br,u_texsize:[N,z],u_mix:_.t,u_pattern_size_a:k.displaySize,u_pattern_size_b:M.displaySize,u_scale_a:_.fromScale,u_scale_b:_.toScale,u_tile_units_to_pixels:1/c.aC(I,1,C.transform.tileZoom),u_pixel_coord_upper:[q>>16,H>>16],u_pixel_coord_lower:[65535&q,65535&H]}}(a,h,e,l),{u_opacity:m}),lu=(m,e)=>{},cu={fillExtrusion:(m,e)=>({u_lightpos:new c.bT(m,e.u_lightpos),u_lightpos_globe:new c.bT(m,e.u_lightpos_globe),u_lightintensity:new c.bg(m,e.u_lightintensity),u_lightcolor:new c.bT(m,e.u_lightcolor),u_vertical_gradient:new c.bg(m,e.u_vertical_gradient),u_opacity:new c.bg(m,e.u_opacity),u_fill_translate:new c.bU(m,e.u_fill_translate)}),fillExtrusionPattern:(m,e)=>({u_lightpos:new c.bT(m,e.u_lightpos),u_lightpos_globe:new c.bT(m,e.u_lightpos_globe),u_lightintensity:new c.bg(m,e.u_lightintensity),u_lightcolor:new c.bT(m,e.u_lightcolor),u_vertical_gradient:new c.bg(m,e.u_vertical_gradient),u_height_factor:new c.bg(m,e.u_height_factor),u_opacity:new c.bg(m,e.u_opacity),u_fill_translate:new c.bU(m,e.u_fill_translate),u_image:new c.bP(m,e.u_image),u_texsize:new c.bU(m,e.u_texsize),u_pixel_coord_upper:new c.bU(m,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bU(m,e.u_pixel_coord_lower),u_scale:new c.bT(m,e.u_scale),u_fade:new c.bg(m,e.u_fade)}),fill:(m,e)=>({u_fill_translate:new c.bU(m,e.u_fill_translate)}),fillPattern:(m,e)=>({u_image:new c.bP(m,e.u_image),u_texsize:new c.bU(m,e.u_texsize),u_pixel_coord_upper:new c.bU(m,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bU(m,e.u_pixel_coord_lower),u_scale:new c.bT(m,e.u_scale),u_fade:new c.bg(m,e.u_fade),u_fill_translate:new c.bU(m,e.u_fill_translate)}),fillOutline:(m,e)=>({u_world:new c.bU(m,e.u_world),u_fill_translate:new c.bU(m,e.u_fill_translate)}),fillOutlinePattern:(m,e)=>({u_world:new c.bU(m,e.u_world),u_image:new c.bP(m,e.u_image),u_texsize:new c.bU(m,e.u_texsize),u_pixel_coord_upper:new c.bU(m,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bU(m,e.u_pixel_coord_lower),u_scale:new c.bT(m,e.u_scale),u_fade:new c.bg(m,e.u_fade),u_fill_translate:new c.bU(m,e.u_fill_translate)}),circle:(m,e)=>({u_camera_to_center_distance:new c.bg(m,e.u_camera_to_center_distance),u_scale_with_map:new c.bP(m,e.u_scale_with_map),u_pitch_with_map:new c.bP(m,e.u_pitch_with_map),u_extrude_scale:new c.bU(m,e.u_extrude_scale),u_device_pixel_ratio:new c.bg(m,e.u_device_pixel_ratio),u_globe_extrude_scale:new c.bg(m,e.u_globe_extrude_scale),u_translate:new c.bU(m,e.u_translate)}),collisionBox:(m,e)=>({u_pixel_extrude_scale:new c.bU(m,e.u_pixel_extrude_scale)}),collisionCircle:(m,e)=>({u_viewport_size:new c.bU(m,e.u_viewport_size)}),debug:(m,e)=>({u_color:new c.bQ(m,e.u_color),u_overlay:new c.bP(m,e.u_overlay),u_overlay_scale:new c.bg(m,e.u_overlay_scale)}),depth:lu,clippingMask:lu,heatmap:(m,e)=>({u_extrude_scale:new c.bg(m,e.u_extrude_scale),u_intensity:new c.bg(m,e.u_intensity),u_globe_extrude_scale:new c.bg(m,e.u_globe_extrude_scale)}),heatmapTexture:(m,e)=>({u_matrix:new c.bR(m,e.u_matrix),u_world:new c.bU(m,e.u_world),u_image:new c.bP(m,e.u_image),u_color_ramp:new c.bP(m,e.u_color_ramp),u_opacity:new c.bg(m,e.u_opacity)}),hillshade:(m,e)=>({u_image:new c.bP(m,e.u_image),u_latrange:new c.bU(m,e.u_latrange),u_exaggeration:new c.bg(m,e.u_exaggeration),u_altitudes:new c.b_(m,e.u_altitudes),u_azimuths:new c.b_(m,e.u_azimuths),u_accent:new c.bQ(m,e.u_accent),u_method:new c.bP(m,e.u_method),u_shadows:new c.bZ(m,e.u_shadows),u_highlights:new c.bZ(m,e.u_highlights)}),hillshadePrepare:(m,e)=>({u_matrix:new c.bR(m,e.u_matrix),u_image:new c.bP(m,e.u_image),u_dimension:new c.bU(m,e.u_dimension),u_zoom:new c.bg(m,e.u_zoom),u_unpack:new c.bS(m,e.u_unpack)}),colorRelief:(m,e)=>({u_image:new c.bP(m,e.u_image),u_unpack:new c.bS(m,e.u_unpack),u_dimension:new c.bU(m,e.u_dimension),u_elevation_stops:new c.bP(m,e.u_elevation_stops),u_color_stops:new c.bP(m,e.u_color_stops),u_color_ramp_size:new c.bP(m,e.u_color_ramp_size),u_opacity:new c.bg(m,e.u_opacity)}),line:(m,e)=>({u_translation:new c.bU(m,e.u_translation),u_ratio:new c.bg(m,e.u_ratio),u_device_pixel_ratio:new c.bg(m,e.u_device_pixel_ratio),u_units_to_pixels:new c.bU(m,e.u_units_to_pixels)}),lineGradient:(m,e)=>({u_translation:new c.bU(m,e.u_translation),u_ratio:new c.bg(m,e.u_ratio),u_device_pixel_ratio:new c.bg(m,e.u_device_pixel_ratio),u_units_to_pixels:new c.bU(m,e.u_units_to_pixels),u_image:new c.bP(m,e.u_image),u_image_height:new c.bg(m,e.u_image_height)}),linePattern:(m,e)=>({u_translation:new c.bU(m,e.u_translation),u_texsize:new c.bU(m,e.u_texsize),u_ratio:new c.bg(m,e.u_ratio),u_device_pixel_ratio:new c.bg(m,e.u_device_pixel_ratio),u_image:new c.bP(m,e.u_image),u_units_to_pixels:new c.bU(m,e.u_units_to_pixels),u_scale:new c.bT(m,e.u_scale),u_fade:new c.bg(m,e.u_fade)}),lineSDF:(m,e)=>({u_translation:new c.bU(m,e.u_translation),u_ratio:new c.bg(m,e.u_ratio),u_device_pixel_ratio:new c.bg(m,e.u_device_pixel_ratio),u_units_to_pixels:new c.bU(m,e.u_units_to_pixels),u_image:new c.bP(m,e.u_image),u_mix:new c.bg(m,e.u_mix),u_tileratio:new c.bg(m,e.u_tileratio),u_crossfade_from:new c.bg(m,e.u_crossfade_from),u_crossfade_to:new c.bg(m,e.u_crossfade_to),u_lineatlas_width:new c.bg(m,e.u_lineatlas_width),u_lineatlas_height:new c.bg(m,e.u_lineatlas_height)}),raster:(m,e)=>({u_tl_parent:new c.bU(m,e.u_tl_parent),u_scale_parent:new c.bg(m,e.u_scale_parent),u_buffer_scale:new c.bg(m,e.u_buffer_scale),u_fade_t:new c.bg(m,e.u_fade_t),u_opacity:new c.bg(m,e.u_opacity),u_image0:new c.bP(m,e.u_image0),u_image1:new c.bP(m,e.u_image1),u_brightness_low:new c.bg(m,e.u_brightness_low),u_brightness_high:new c.bg(m,e.u_brightness_high),u_saturation_factor:new c.bg(m,e.u_saturation_factor),u_contrast_factor:new c.bg(m,e.u_contrast_factor),u_spin_weights:new c.bT(m,e.u_spin_weights),u_coords_top:new c.bS(m,e.u_coords_top),u_coords_bottom:new c.bS(m,e.u_coords_bottom)}),symbolIcon:(m,e)=>({u_is_size_zoom_constant:new c.bP(m,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bP(m,e.u_is_size_feature_constant),u_size_t:new c.bg(m,e.u_size_t),u_size:new c.bg(m,e.u_size),u_camera_to_center_distance:new c.bg(m,e.u_camera_to_center_distance),u_pitch:new c.bg(m,e.u_pitch),u_rotate_symbol:new c.bP(m,e.u_rotate_symbol),u_aspect_ratio:new c.bg(m,e.u_aspect_ratio),u_fade_change:new c.bg(m,e.u_fade_change),u_label_plane_matrix:new c.bR(m,e.u_label_plane_matrix),u_coord_matrix:new c.bR(m,e.u_coord_matrix),u_is_text:new c.bP(m,e.u_is_text),u_pitch_with_map:new c.bP(m,e.u_pitch_with_map),u_is_along_line:new c.bP(m,e.u_is_along_line),u_is_variable_anchor:new c.bP(m,e.u_is_variable_anchor),u_texsize:new c.bU(m,e.u_texsize),u_texture:new c.bP(m,e.u_texture),u_translation:new c.bU(m,e.u_translation),u_pitched_scale:new c.bg(m,e.u_pitched_scale)}),symbolSDF:(m,e)=>({u_is_size_zoom_constant:new c.bP(m,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bP(m,e.u_is_size_feature_constant),u_size_t:new c.bg(m,e.u_size_t),u_size:new c.bg(m,e.u_size),u_camera_to_center_distance:new c.bg(m,e.u_camera_to_center_distance),u_pitch:new c.bg(m,e.u_pitch),u_rotate_symbol:new c.bP(m,e.u_rotate_symbol),u_aspect_ratio:new c.bg(m,e.u_aspect_ratio),u_fade_change:new c.bg(m,e.u_fade_change),u_label_plane_matrix:new c.bR(m,e.u_label_plane_matrix),u_coord_matrix:new c.bR(m,e.u_coord_matrix),u_is_text:new c.bP(m,e.u_is_text),u_pitch_with_map:new c.bP(m,e.u_pitch_with_map),u_is_along_line:new c.bP(m,e.u_is_along_line),u_is_variable_anchor:new c.bP(m,e.u_is_variable_anchor),u_texsize:new c.bU(m,e.u_texsize),u_texture:new c.bP(m,e.u_texture),u_gamma_scale:new c.bg(m,e.u_gamma_scale),u_device_pixel_ratio:new c.bg(m,e.u_device_pixel_ratio),u_is_halo:new c.bP(m,e.u_is_halo),u_translation:new c.bU(m,e.u_translation),u_pitched_scale:new c.bg(m,e.u_pitched_scale)}),symbolTextAndIcon:(m,e)=>({u_is_size_zoom_constant:new c.bP(m,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bP(m,e.u_is_size_feature_constant),u_size_t:new c.bg(m,e.u_size_t),u_size:new c.bg(m,e.u_size),u_camera_to_center_distance:new c.bg(m,e.u_camera_to_center_distance),u_pitch:new c.bg(m,e.u_pitch),u_rotate_symbol:new c.bP(m,e.u_rotate_symbol),u_aspect_ratio:new c.bg(m,e.u_aspect_ratio),u_fade_change:new c.bg(m,e.u_fade_change),u_label_plane_matrix:new c.bR(m,e.u_label_plane_matrix),u_coord_matrix:new c.bR(m,e.u_coord_matrix),u_is_text:new c.bP(m,e.u_is_text),u_pitch_with_map:new c.bP(m,e.u_pitch_with_map),u_is_along_line:new c.bP(m,e.u_is_along_line),u_is_variable_anchor:new c.bP(m,e.u_is_variable_anchor),u_texsize:new c.bU(m,e.u_texsize),u_texsize_icon:new c.bU(m,e.u_texsize_icon),u_texture:new c.bP(m,e.u_texture),u_texture_icon:new c.bP(m,e.u_texture_icon),u_gamma_scale:new c.bg(m,e.u_gamma_scale),u_device_pixel_ratio:new c.bg(m,e.u_device_pixel_ratio),u_is_halo:new c.bP(m,e.u_is_halo),u_translation:new c.bU(m,e.u_translation),u_pitched_scale:new c.bg(m,e.u_pitched_scale)}),background:(m,e)=>({u_opacity:new c.bg(m,e.u_opacity),u_color:new c.bQ(m,e.u_color)}),backgroundPattern:(m,e)=>({u_opacity:new c.bg(m,e.u_opacity),u_image:new c.bP(m,e.u_image),u_pattern_tl_a:new c.bU(m,e.u_pattern_tl_a),u_pattern_br_a:new c.bU(m,e.u_pattern_br_a),u_pattern_tl_b:new c.bU(m,e.u_pattern_tl_b),u_pattern_br_b:new c.bU(m,e.u_pattern_br_b),u_texsize:new c.bU(m,e.u_texsize),u_mix:new c.bg(m,e.u_mix),u_pattern_size_a:new c.bU(m,e.u_pattern_size_a),u_pattern_size_b:new c.bU(m,e.u_pattern_size_b),u_scale_a:new c.bg(m,e.u_scale_a),u_scale_b:new c.bg(m,e.u_scale_b),u_pixel_coord_upper:new c.bU(m,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bU(m,e.u_pixel_coord_lower),u_tile_units_to_pixels:new c.bg(m,e.u_tile_units_to_pixels)}),terrain:(m,e)=>({u_texture:new c.bP(m,e.u_texture),u_ele_delta:new c.bg(m,e.u_ele_delta),u_fog_matrix:new c.bR(m,e.u_fog_matrix),u_fog_color:new c.bQ(m,e.u_fog_color),u_fog_ground_blend:new c.bg(m,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new c.bg(m,e.u_fog_ground_blend_opacity),u_horizon_color:new c.bQ(m,e.u_horizon_color),u_horizon_fog_blend:new c.bg(m,e.u_horizon_fog_blend),u_is_globe_mode:new c.bg(m,e.u_is_globe_mode)}),terrainDepth:(m,e)=>({u_ele_delta:new c.bg(m,e.u_ele_delta)}),terrainCoords:(m,e)=>({u_texture:new c.bP(m,e.u_texture),u_terrain_coords_id:new c.bg(m,e.u_terrain_coords_id),u_ele_delta:new c.bg(m,e.u_ele_delta)}),projectionErrorMeasurement:(m,e)=>({u_input:new c.bg(m,e.u_input),u_output_expected:new c.bg(m,e.u_output_expected)}),atmosphere:(m,e)=>({u_sun_pos:new c.bT(m,e.u_sun_pos),u_atmosphere_blend:new c.bg(m,e.u_atmosphere_blend),u_globe_position:new c.bT(m,e.u_globe_position),u_globe_radius:new c.bg(m,e.u_globe_radius),u_inv_proj_matrix:new c.bR(m,e.u_inv_proj_matrix)}),sky:(m,e)=>({u_sky_color:new c.bQ(m,e.u_sky_color),u_horizon_color:new c.bQ(m,e.u_horizon_color),u_horizon:new c.bU(m,e.u_horizon),u_horizon_normal:new c.bU(m,e.u_horizon_normal),u_sky_horizon_blend:new c.bg(m,e.u_sky_horizon_blend),u_sky_blend:new c.bg(m,e.u_sky_blend)})};class pd{constructor(e,a,l){this.context=e;const h=e.gl;this.buffer=h.createBuffer(),this.dynamicDraw=!!l,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),h.bufferData(h.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?h.DYNAMIC_DRAW:h.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const a=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Il={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Yr{constructor(e,a,l,h){this.length=a.length,this.attributes=l,this.itemSize=a.bytesPerElement,this.dynamicDraw=h,this.context=e;const f=e.gl;this.buffer=f.createBuffer(),e.bindVertexBuffer.set(this.buffer),f.bufferData(f.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,a){for(let l=0;l<this.attributes.length;l++){const h=a.attributes[this.attributes[l].name];h!==void 0&&e.enableVertexAttribArray(h)}}setVertexAttribPointers(e,a,l){for(let h=0;h<this.attributes.length;h++){const f=this.attributes[h],_=a.attributes[f.name];_!==void 0&&e.vertexAttribPointer(_,f.components,e[Il[f.type]],!1,this.itemSize,f.offset+this.itemSize*(l||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Dt{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class uu extends Dt{getDefault(){return c.bf.transparent}set(e){const a=this.current;(e.r!==a.r||e.g!==a.g||e.b!==a.b||e.a!==a.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class hu extends Dt{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class md extends Dt{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class du extends Dt{getDefault(){return[!0,!0,!0,!0]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||e[2]!==a[2]||e[3]!==a[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class $a extends Dt{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class pu extends Dt{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class Km extends Dt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const a=this.current;(e.func!==a.func||e.ref!==a.ref||e.mask!==a.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class Ym extends Dt{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||e[2]!==a[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class Jm extends Dt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;e?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this.current=e,this.dirty=!1}}class Qm extends Dt{getDefault(){return[0,1]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class fd extends Dt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;e?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this.current=e,this.dirty=!1}}class ef extends Dt{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class gd extends Dt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;e?a.enable(a.BLEND):a.disable(a.BLEND),this.current=e,this.dirty=!1}}class Al extends Dt{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class Sl extends Dt{getDefault(){return c.bf.transparent}set(e){const a=this.current;(e.r!==a.r||e.g!==a.g||e.b!==a.b||e.a!==a.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Tl extends Dt{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class mu extends Dt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;e?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this.current=e,this.dirty=!1}}class Za extends Dt{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class bs extends Dt{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class To extends Dt{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class or extends Dt{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class yd extends Dt{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||e[2]!==a[2]||e[3]!==a[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class _d extends Dt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class fu extends Dt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.bindRenderbuffer(a.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Ga extends Dt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.bindTexture(a.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class Pl extends Dt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class kl extends Dt{getDefault(){return null}set(e){const a=this.gl;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class ws extends Dt{getDefault(){return null}set(e){var a;if(e===this.current&&!this.dirty)return;const l=this.gl;Br(l)?l.bindVertexArray(e):(a=l.getExtension("OES_vertex_array_object"))===null||a===void 0||a.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class Ml extends Dt{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class vd extends Dt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class Po extends Dt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class va extends Dt{constructor(e,a){super(e),this.context=e,this.parent=a}getDefault(){return null}}class xd extends va{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class gu extends va{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class kt extends va{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const Cs="Framebuffer is not complete";class tf{constructor(e,a,l,h,f){this.context=e,this.width=a,this.height=l;const _=e.gl,C=this.framebuffer=_.createFramebuffer();if(this.colorAttachment=new xd(e,C),h)this.depthAttachment=f?new kt(e,C):new gu(e,C);else if(f)throw new Error("Stencil cannot be set without depth");if(_.checkFramebufferStatus(_.FRAMEBUFFER)!==_.FRAMEBUFFER_COMPLETE)throw new Error(Cs)}destroy(){const e=this.context.gl,a=this.colorAttachment.get();if(a&&e.deleteTexture(a),this.depthAttachment){const l=this.depthAttachment.get();l&&e.deleteRenderbuffer(l)}e.deleteFramebuffer(this.framebuffer)}}class bd{constructor(e){var a,l;if(this.gl=e,this.clearColor=new uu(this),this.clearDepth=new hu(this),this.clearStencil=new md(this),this.colorMask=new du(this),this.depthMask=new $a(this),this.stencilMask=new pu(this),this.stencilFunc=new Km(this),this.stencilOp=new Ym(this),this.stencilTest=new Jm(this),this.depthRange=new Qm(this),this.depthTest=new fd(this),this.depthFunc=new ef(this),this.blend=new gd(this),this.blendFunc=new Al(this),this.blendColor=new Sl(this),this.blendEquation=new Tl(this),this.cullFace=new mu(this),this.cullFaceSide=new Za(this),this.frontFace=new bs(this),this.program=new To(this),this.activeTexture=new or(this),this.viewport=new yd(this),this.bindFramebuffer=new _d(this),this.bindRenderbuffer=new fu(this),this.bindTexture=new Ga(this),this.bindVertexBuffer=new Pl(this),this.bindElementBuffer=new kl(this),this.bindVertexArray=new ws(this),this.pixelStoreUnpack=new Ml(this),this.pixelStoreUnpackPremultiplyAlpha=new vd(this),this.pixelStoreUnpackFlipY=new Po(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),Br(e)){this.HALF_FLOAT=e.HALF_FLOAT;const h=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(a=e.RGBA16F)!==null&&a!==void 0?a:h==null?void 0:h.RGBA16F_EXT,this.RGB16F=(l=e.RGB16F)!==null&&l!==void 0?l:h==null?void 0:h.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const h=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=h==null?void 0:h.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,a){return new pd(this,e,a)}createVertexBuffer(e,a,l){return new Yr(this,e,a,l)}createRenderbuffer(e,a,l){const h=this.gl,f=h.createRenderbuffer();return this.bindRenderbuffer.set(f),h.renderbufferStorage(h.RENDERBUFFER,e,a,l),this.bindRenderbuffer.set(null),f}createFramebuffer(e,a,l,h){return new tf(this,e,a,l,h)}clear({color:e,depth:a,stencil:l}){const h=this.gl;let f=0;e&&(f|=h.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),a!==void 0&&(f|=h.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),l!==void 0&&(f|=h.STENCIL_BUFFER_BIT,this.clearStencil.set(l),this.stencilMask.set(255)),h.clear(f)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){c.bH(e.blendFunction,Kt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return Br(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var a;return Br(this.gl)?this.gl.deleteVertexArray(e):(a=this.gl.getExtension("OES_vertex_array_object"))===null||a===void 0?void 0:a.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let xa;function wd(m,e,a,l,h){const f=m.context,_=m.transform,C=f.gl,I=m.useProgram("collisionBox"),k=[];let M=0,N=0;for(let X=0;X<l.length;X++){const J=l[X],ie=e.getTile(J).getBucket(a);if(!ie)continue;const Q=h?ie.textCollisionBox:ie.iconCollisionBox,ae=ie.collisionCircleArray;ae.length>0&&(k.push({circleArray:ae,circleOffset:N,coord:J}),M+=ae.length/4,N=M),Q&&I.draw(f,C.LINES,_t.disabled,zt.disabled,m.colorModeForRenderPass(),dt.disabled,wl(m.transform),m.style.map.terrain&&m.style.map.terrain.getTerrainData(J),_.getProjectionData({overscaledTileID:J,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),a.id,Q.layoutVertexBuffer,Q.indexBuffer,Q.segments,null,m.transform.zoom,null,null,Q.collisionVertexBuffer)}if(!h||!k.length)return;const z=m.useProgram("collisionCircle"),L=new c.b$;L.resize(4*M),L._trim();let U=0;for(const X of k)for(let J=0;J<X.circleArray.length/4;J++){const ie=4*J,Q=X.circleArray[ie+0],ae=X.circleArray[ie+1],de=X.circleArray[ie+2],te=X.circleArray[ie+3];L.emplace(U++,Q,ae,de,te,0),L.emplace(U++,Q,ae,de,te,1),L.emplace(U++,Q,ae,de,te,2),L.emplace(U++,Q,ae,de,te,3)}(!xa||xa.length<2*M)&&(xa=function(X){const J=2*X,ie=new c.c1;ie.resize(J),ie._trim();for(let Q=0;Q<J;Q++){const ae=6*Q;ie.uint16[ae+0]=4*Q+0,ie.uint16[ae+1]=4*Q+1,ie.uint16[ae+2]=4*Q+2,ie.uint16[ae+3]=4*Q+2,ie.uint16[ae+4]=4*Q+3,ie.uint16[ae+5]=4*Q+0}return ie}(M));const q=f.createIndexBuffer(xa,!0),H=f.createVertexBuffer(L,c.c0.members,!0);for(const X of k){const J=Wm(m.transform);z.draw(f,C.TRIANGLES,_t.disabled,zt.disabled,m.colorModeForRenderPass(),dt.disabled,J,m.style.map.terrain&&m.style.map.terrain.getTerrainData(X.coord),null,a.id,H,q,c.aM.simpleSegment(0,2*X.circleOffset,X.circleArray.length,X.circleArray.length/2),null,m.transform.zoom,null,null,null)}H.destroy(),q.destroy()}const nf=c.ag(new Float32Array(16));function Cd(m,e,a,l,h,f){const{horizontalAlign:_,verticalAlign:C}=c.aH(m);return new c.P((-(_-.5)*e/h+l[0])*f,(-(C-.5)*a/h+l[1])*f)}function rf(m,e,a,l,h,f){const _=e.tileAnchorPoint.add(new c.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let C=l.mult(f);a||(C=C.rotate(-h));const I=_.add(C);return Ci(I.x,I.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(a){const C=nn(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(m),I=Math.atan(C.y/C.x)+(C.x<0?Math.PI:0);return m.add(l.rotate(I))}return m.add(l)}function yu(m,e,a,l,h,f,_,C,I,k,M,N){const z=m.text.placedSymbolArray,L=m.text.dynamicLayoutVertexArray,U=m.icon.dynamicLayoutVertexArray,q={};L.clear();for(let H=0;H<z.length;H++){const X=z.get(H),J=X.hidden||!X.crossTileID||m.allowVerticalPlacement&&!X.placedOrientation?null:l[X.crossTileID];if(J){const ie=new c.P(X.anchorX,X.anchorY),Q={getElevation:N,width:h.width,height:h.height,pitchedLabelPlaneMatrix:f,pitchWithMap:a,transform:h,tileAnchorPoint:ie,translation:k,unwrappedTileID:M},ae=a?ma(ie.x,ie.y,Q):nn(ie.x,ie.y,Q),de=Ne(h.cameraToCenterDistance,ae.signedDistanceFromCamera);let te=c.ap(m.textSizeData,C,X)*de/c.aB;a&&(te*=m.tilePixelRatio/_);const{width:pe,height:Ae,anchor:be,textOffset:Ce,textBoxScale:Se}=J,Oe=Cd(be,pe,Ae,Ce,Se,te),Be=h.getPitchedTextCorrection(ie.x+k[0],ie.y+k[1],M),Le=rf(ae.point,Q,e,Oe,-h.bearingInRadians,Be),Je=m.allowVerticalPlacement&&X.placedOrientation===c.ao.vertical?Math.PI/2:0;for(let wt=0;wt<X.numGlyphs;wt++)c.av(L,Le,Je);I&&X.associatedIconIndex>=0&&(q[X.associatedIconIndex]={shiftedAnchor:Le,angle:Je})}else Fr(X.numGlyphs,L)}if(I){U.clear();const H=m.icon.placedSymbolArray;for(let X=0;X<H.length;X++){const J=H.get(X);if(J.hidden)Fr(J.numGlyphs,U);else{const ie=q[X];if(ie)for(let Q=0;Q<J.numGlyphs;Q++)c.av(U,ie.shiftedAnchor,ie.angle);else Fr(J.numGlyphs,U)}}m.icon.dynamicLayoutVertexBuffer.updateData(U)}m.text.dynamicLayoutVertexBuffer.updateData(L)}function El(m,e,a){return a.iconsInText&&e?"symbolTextAndIcon":m?"symbolSDF":"symbolIcon"}function Is(m,e,a,l,h,f,_,C,I,k,M,N,z){const L=m.context,U=L.gl,q=m.transform,H=C==="map",X=I==="map",J=C!=="viewport"&&a.layout.get("symbol-placement")!=="point",ie=H&&!X&&!J,Q=!a.layout.get("symbol-sort-key").isConstant();let ae=!1;const de=m.getDepthModeForSublayer(0,_t.ReadOnly),te=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),pe=[],Ae=q.getCircleRadiusCorrection();for(const be of l){const Ce=e.getTile(be),Se=Ce.getBucket(a);if(!Se)continue;const Oe=h?Se.text:Se.icon;if(!Oe||!Oe.segments.get().length||!Oe.hasVisibleVertices)continue;const Be=Oe.programConfigurations.get(a.id),Le=h||Se.sdfIcons,Je=h?Se.textSizeData:Se.iconSizeData,wt=X||q.pitch!==0,Ft=m.useProgram(El(Le,h,Se),Be),Jt=c.an(Je,q.zoom),Wt=m.style.map.terrain&&m.style.map.terrain.getTerrainData(be);let ai,Qt,Ui,ei,Ut=[0,0],ci=null;if(h)Qt=Ce.glyphAtlasTexture,Ui=U.LINEAR,ai=Ce.glyphAtlasTexture.size,Se.iconsInText&&(Ut=Ce.imageAtlasTexture.size,ci=Ce.imageAtlasTexture,ei=wt||m.options.rotating||m.options.zooming||Je.kind==="composite"||Je.kind==="camera"?U.LINEAR:U.NEAREST);else{const Di=a.layout.get("icon-size").constantOr(0)!==1||Se.iconsNeedLinear;Qt=Ce.imageAtlasTexture,Ui=Le||m.options.rotating||m.options.zooming||Di||wt?U.LINEAR:U.NEAREST,ai=Ce.imageAtlasTexture.size}const It=c.aC(Ce,1,m.transform.zoom),an=Oi(H,m.transform,It),Qr=c.L();c.aq(Qr,an);const io=Vi(X,H,m.transform,It),wa=c.aD(q,Ce,f,_),no=q.getProjectionData({overscaledTileID:be,applyGlobeMatrix:!z,applyTerrainMatrix:!0}),Ls=te&&Se.hasTextData(),Ca=a.layout.get("icon-text-fit")!=="none"&&Ls&&Se.hasIconData();if(J){const Di=m.style.map.terrain?(An,ti)=>m.style.map.terrain.getElevation(be,An,ti):null,Li=a.layout.get("text-rotation-alignment")==="map";qn(Se,m,h,an,Qr,X,k,Li,be.toUnwrapped(),q.width,q.height,wa,Di)}const ro=h&&te||Ca,Yn=J||ro?nf:X?an:m.transform.clipSpaceToPixelsMatrix,Ia=Le&&a.paint.get(h?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let ea;ea=Le?Se.iconsInText?Xm(Je.kind,Jt,ie,X,J,ro,m,Yn,io,wa,ai,Ut,Ae):ud(Je.kind,Jt,ie,X,J,ro,m,Yn,io,wa,h,ai,0,Ae):xs(Je.kind,Jt,ie,X,J,ro,m,Yn,io,wa,h,ai,Ae);const Aa={program:Ft,buffers:Oe,uniformValues:ea,projectionData:no,atlasTexture:Qt,atlasTextureIcon:ci,atlasInterpolation:Ui,atlasInterpolationIcon:ei,isSDF:Le,hasHalo:Ia};if(Q&&Se.canOverlap){ae=!0;const Di=Oe.segments.get();for(const Li of Di)pe.push({segments:new c.aM([Li]),sortKey:Li.sortKey,state:Aa,terrainData:Wt})}else pe.push({segments:Oe.segments,sortKey:0,state:Aa,terrainData:Wt})}ae&&pe.sort((be,Ce)=>be.sortKey-Ce.sortKey);for(const be of pe){const Ce=be.state;if(L.activeTexture.set(U.TEXTURE0),Ce.atlasTexture.bind(Ce.atlasInterpolation,U.CLAMP_TO_EDGE),Ce.atlasTextureIcon&&(L.activeTexture.set(U.TEXTURE1),Ce.atlasTextureIcon&&Ce.atlasTextureIcon.bind(Ce.atlasInterpolationIcon,U.CLAMP_TO_EDGE)),Ce.isSDF){const Se=Ce.uniformValues;Ce.hasHalo&&(Se.u_is_halo=1,As(Ce.buffers,be.segments,a,m,Ce.program,de,M,N,Se,Ce.projectionData,be.terrainData)),Se.u_is_halo=0}As(Ce.buffers,be.segments,a,m,Ce.program,de,M,N,Ce.uniformValues,Ce.projectionData,be.terrainData)}}function As(m,e,a,l,h,f,_,C,I,k,M){const N=l.context;h.draw(N,N.gl.TRIANGLES,f,_,C,dt.backCCW,I,M,k,a.id,m.layoutVertexBuffer,m.indexBuffer,e,a.paint,l.transform.zoom,m.programConfigurations.get(a.id),m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer)}function _u(m,e,a,l,h){const f=m.context,_=f.gl,C=zt.disabled,I=new Kt([_.ONE,_.ONE],c.bf.transparent,[!0,!0,!0,!0]),k=e.getBucket(a);if(!k)return;const M=l.key;let N=a.heatmapFbos.get(M);N||(N=Ss(f,e.tileSize,e.tileSize),a.heatmapFbos.set(M,N)),f.bindFramebuffer.set(N.framebuffer),f.viewport.set([0,0,e.tileSize,e.tileSize]),f.clear({color:c.bf.transparent});const z=k.programConfigurations.get(a.id),L=m.useProgram("heatmap",z,!h),U=m.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),q=m.style.map.terrain.getTerrainData(l);L.draw(f,_.TRIANGLES,_t.disabled,C,I,dt.disabled,ad(e,m.transform.zoom,a.paint.get("heatmap-intensity"),1),q,U,a.id,k.layoutVertexBuffer,k.indexBuffer,k.segments,a.paint,m.transform.zoom,z)}function Id(m,e,a,l,h){const f=m.context,_=f.gl,C=m.transform;f.setColorMode(m.colorModeForRenderPass());const I=Ts(f,e),k=a.key,M=e.heatmapFbos.get(k);if(!M)return;f.activeTexture.set(_.TEXTURE0),_.bindTexture(_.TEXTURE_2D,M.colorAttachment.get()),f.activeTexture.set(_.TEXTURE1),I.bind(_.LINEAR,_.CLAMP_TO_EDGE);const N=C.getProjectionData({overscaledTileID:a,applyTerrainMatrix:h,applyGlobeMatrix:!l});m.useProgram("heatmapTexture").draw(f,_.TRIANGLES,_t.disabled,zt.disabled,m.colorModeForRenderPass(),dt.disabled,ru(m,e,0,1),null,N,e.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments,e.paint,C.zoom),M.destroy(),e.heatmapFbos.delete(k)}function Ss(m,e,a){var l,h;const f=m.gl,_=f.createTexture();f.bindTexture(f.TEXTURE_2D,_),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.LINEAR);const C=(l=m.HALF_FLOAT)!==null&&l!==void 0?l:f.UNSIGNED_BYTE,I=(h=m.RGBA16F)!==null&&h!==void 0?h:f.RGBA;f.texImage2D(f.TEXTURE_2D,0,I,e,a,0,f.RGBA,C,null);const k=m.createFramebuffer(e,a,!1,!1);return k.colorAttachment.set(_),k}function Ts(m,e){return e.colorRampTexture||(e.colorRampTexture=new c.T(m,e.colorRamp,m.gl.RGBA)),e.colorRampTexture}function Ps(m,e,a,l,h){if(!a||!l||!l.imageAtlas)return;const f=l.imageAtlas.patternPositions;let _=f[a.to.toString()],C=f[a.from.toString()];if(!_&&C&&(_=C),!C&&_&&(C=_),!_||!C){const I=h.getPaintProperty(e);_=f[I],C=f[I]}_&&C&&m.setConstantPatternPositions(_,C)}function Wa(m,e,a,l,h,f,_,C){const I=m.context.gl,k="fill-pattern",M=a.paint.get(k),N=M&&M.constantOr(1),z=a.getCrossfadeParameters();let L,U,q,H,X;const J=m.transform,ie=a.paint.get("fill-translate"),Q=a.paint.get("fill-translate-anchor");_?(U=N&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",L=I.LINES):(U=N?"fillPattern":"fill",L=I.TRIANGLES);const ae=M.constantOr(null);for(const de of l){const te=e.getTile(de);if(N&&!te.patternsLoaded())continue;const pe=te.getBucket(a);if(!pe)continue;const Ae=pe.programConfigurations.get(a.id),be=m.useProgram(U,Ae),Ce=m.style.map.terrain&&m.style.map.terrain.getTerrainData(de);N&&(m.context.activeTexture.set(I.TEXTURE0),te.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),Ae.updatePaintBuffers(z)),Ps(Ae,k,ae,te,a);const Se=J.getProjectionData({overscaledTileID:de,applyGlobeMatrix:!C,applyTerrainMatrix:!0}),Oe=c.aD(J,te,ie,Q);if(_){H=pe.indexBuffer2,X=pe.segments2;const Le=[I.drawingBufferWidth,I.drawingBufferHeight];q=U==="fillOutlinePattern"&&N?_s(m,z,te,Le,Oe):ys(Le,Oe)}else H=pe.indexBuffer,X=pe.segments,q=N?bl(m,z,te,Oe):{u_fill_translate:Oe};const Be=m.stencilModeForClipping(de);be.draw(m.context,L,h,Be,f,dt.backCCW,q,Ce,Se,a.id,pe.layoutVertexBuffer,H,X,a.paint,m.transform.zoom,Ae)}}function ks(m,e,a,l,h,f,_,C){const I=m.context,k=I.gl,M="fill-extrusion-pattern",N=a.paint.get(M),z=N.constantOr(1),L=a.getCrossfadeParameters(),U=a.paint.get("fill-extrusion-opacity"),q=N.constantOr(null),H=m.transform;for(const X of l){const J=e.getTile(X),ie=J.getBucket(a);if(!ie)continue;const Q=m.style.map.terrain&&m.style.map.terrain.getTerrainData(X),ae=ie.programConfigurations.get(a.id),de=m.useProgram(z?"fillExtrusionPattern":"fillExtrusion",ae);z&&(m.context.activeTexture.set(k.TEXTURE0),J.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),ae.updatePaintBuffers(L));const te=H.getProjectionData({overscaledTileID:X,applyGlobeMatrix:!C,applyTerrainMatrix:!0});Ps(ae,M,q,J,a);const pe=c.aD(H,J,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),Ae=a.paint.get("fill-extrusion-vertical-gradient"),be=z?Zm(m,Ae,U,pe,X,L,J):xr(m,Ae,U,pe);de.draw(I,I.gl.TRIANGLES,h,f,_,dt.backCCW,be,Q,te,a.id,ie.layoutVertexBuffer,ie.indexBuffer,ie.segments,a.paint,m.transform.zoom,ae,m.style.map.terrain&&ie.centroidVertexBuffer)}}function vu(m,e,a,l,h,f,_,C,I){var k;const M=m.style.projection,N=m.context,z=m.transform,L=N.gl,U=[`#define NUM_ILLUMINATION_SOURCES ${a.paint.get("hillshade-highlight-color").values.length}`],q=m.useProgram("hillshade",null,!1,U),H=!m.options.moving;for(const X of l){const J=e.getTile(X),ie=J.fbo;if(!ie)continue;const Q=M.getMeshFromTileID(N,X.canonical,C,!0,"raster"),ae=(k=m.style.map.terrain)===null||k===void 0?void 0:k.getTerrainData(X);N.activeTexture.set(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,ie.colorAttachment.get());const de=z.getProjectionData({overscaledTileID:X,aligned:H,applyGlobeMatrix:!I,applyTerrainMatrix:!0});q.draw(N,L.TRIANGLES,f,h[X.overscaledZ],_,dt.backCCW,qm(m,J,a),ae,de,a.id,Q.vertexBuffer,Q.indexBuffer,Q.segments)}}function qa(m,e,a,l,h,f,_,C,I){var k;const M=m.style.projection,N=m.context,z=m.transform,L=N.gl,U=m.useProgram("colorRelief"),q=!m.options.moving;let H=!0,X=0;for(const J of l){const ie=e.getTile(J),Q=ie.dem;if(H){const be=L.getParameter(L.MAX_TEXTURE_SIZE),{elevationTexture:Ce,colorTexture:Se}=a.getColorRampTextures(N,be,Q.getUnpackVector());N.activeTexture.set(L.TEXTURE1),Ce.bind(L.NEAREST,L.CLAMP_TO_EDGE),N.activeTexture.set(L.TEXTURE4),Se.bind(L.LINEAR,L.CLAMP_TO_EDGE),H=!1,X=Ce.size[0]}if(!Q||!Q.data)continue;const ae=Q.stride,de=Q.getPixels();if(N.activeTexture.set(L.TEXTURE0),N.pixelStoreUnpackPremultiplyAlpha.set(!1),ie.demTexture=ie.demTexture||m.getTileTexture(ae),ie.demTexture){const be=ie.demTexture;be.update(de,{premultiply:!1}),be.bind(L.LINEAR,L.CLAMP_TO_EDGE)}else ie.demTexture=new c.T(N,de,L.RGBA,{premultiply:!1}),ie.demTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE);const te=M.getMeshFromTileID(N,J.canonical,C,!0,"raster"),pe=(k=m.style.map.terrain)===null||k===void 0?void 0:k.getTerrainData(J),Ae=z.getProjectionData({overscaledTileID:J,aligned:q,applyGlobeMatrix:!I,applyTerrainMatrix:!0});U.draw(N,L.TRIANGLES,f,h[J.overscaledZ],_,dt.backCCW,sd(a,ie.dem,X),pe,Ae,a.id,te.vertexBuffer,te.indexBuffer,te.segments)}}const xu=[new c.P(0,0),new c.P(c.$,0),new c.P(c.$,c.$),new c.P(0,c.$)];function Ms(m,e,a,l,h,f,_,C,I=!1,k=!1){const M=l[l.length-1].overscaledZ,N=m.context,z=N.gl,L=m.useProgram("raster"),U=m.transform,q=m.style.projection,H=m.colorModeForRenderPass(),X=!m.options.moving;for(const J of l){const ie=m.getDepthModeForSublayer(J.overscaledZ-M,a.paint.get("raster-opacity")===1?_t.ReadWrite:_t.ReadOnly,z.LESS),Q=e.getTile(J);Q.registerFadeDuration(a.paint.get("raster-fade-duration"));const ae=e.findLoadedParent(J,0),de=e.findLoadedSibling(J),te=zl(Q,ae||de||null,e,a,m.transform,m.style.map.terrain);let pe,Ae;const be=a.paint.get("raster-resampling")==="nearest"?z.NEAREST:z.LINEAR;N.activeTexture.set(z.TEXTURE0),Q.texture.bind(be,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST),N.activeTexture.set(z.TEXTURE1),ae?(ae.texture.bind(be,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST),pe=Math.pow(2,ae.tileID.overscaledZ-Q.tileID.overscaledZ),Ae=[Q.tileID.canonical.x*pe%1,Q.tileID.canonical.y*pe%1]):Q.texture.bind(be,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST),Q.texture.useMipmap&&N.extTextureFilterAnisotropic&&m.transform.pitch>20&&z.texParameterf(z.TEXTURE_2D,N.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,N.extTextureFilterAnisotropicMax);const Ce=m.style.map.terrain&&m.style.map.terrain.getTerrainData(J),Se=U.getProjectionData({overscaledTileID:J,aligned:X,applyGlobeMatrix:!k,applyTerrainMatrix:!0}),Oe=vs(Ae||[0,0],pe||1,te,a,C),Be=q.getMeshFromTileID(N,J.canonical,f,_,"raster");L.draw(N,z.TRIANGLES,ie,h?h[J.overscaledZ]:zt.disabled,H,I?dt.frontCCW:dt.backCCW,Oe,Ce,Se,a.id,Be.vertexBuffer,Be.indexBuffer,Be.segments)}}function zl(m,e,a,l,h,f){const _=l.paint.get("raster-fade-duration");if(!f&&_>0){const C=ce.now(),I=(C-m.timeAdded)/_,k=e?(C-e.timeAdded)/_:-1,M=a.getSource(),N=it(h,{tileSize:M.tileSize,roundZoom:M.roundZoom}),z=!e||Math.abs(e.tileID.overscaledZ-N)>Math.abs(m.tileID.overscaledZ-N),L=z&&m.refreshedUponExpiration?1:c.ah(z?I:1-k,0,1);return m.refreshedUponExpiration&&I>=1&&(m.refreshedUponExpiration=!1),e?{opacity:1,mix:1-L}:{opacity:L,mix:0}}return{opacity:1,mix:0}}const bu=new c.bf(1,0,0,1),Ad=new c.bf(0,1,0,1),Sd=new c.bf(0,0,1,1),Nl=new c.bf(1,0,1,1),wu=new c.bf(0,1,1,1);function Td(m,e,a,l){ri(m,0,e+a/2,m.transform.width,a,l)}function Cu(m,e,a,l){ri(m,e-a/2,0,a,m.transform.height,l)}function ri(m,e,a,l,h,f){const _=m.context,C=_.gl;C.enable(C.SCISSOR_TEST),C.scissor(e*m.pixelRatio,a*m.pixelRatio,l*m.pixelRatio,h*m.pixelRatio),_.clear({color:f}),C.disable(C.SCISSOR_TEST)}function Ha(m,e,a){const l=m.context,h=l.gl,f=m.useProgram("debug"),_=_t.disabled,C=zt.disabled,I=m.colorModeForRenderPass(),k="$debug",M=m.style.map.terrain&&m.style.map.terrain.getTerrainData(a);l.activeTexture.set(h.TEXTURE0);const N=e.getTileByID(a.key).latestRawTileData,z=Math.floor((N&&N.byteLength||0)/1024),L=e.getTile(a).tileSize,U=512/Math.min(L,512)*(a.overscaledZ/m.transform.zoom)*.5;let q=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(q+=` => ${a.overscaledZ}`),function(X,J){X.initDebugOverlayCanvas();const ie=X.debugOverlayCanvas,Q=X.context.gl,ae=X.debugOverlayCanvas.getContext("2d");ae.clearRect(0,0,ie.width,ie.height),ae.shadowColor="white",ae.shadowBlur=2,ae.lineWidth=1.5,ae.strokeStyle="white",ae.textBaseline="top",ae.font="bold 36px Open Sans, sans-serif",ae.fillText(J,5,5),ae.strokeText(J,5,5),X.debugOverlayTexture.update(ie),X.debugOverlayTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE)}(m,`${q} ${z}kB`);const H=m.transform.getProjectionData({overscaledTileID:a,applyGlobeMatrix:!0,applyTerrainMatrix:!0});f.draw(l,h.TRIANGLES,_,C,Kt.alphaBlended,dt.disabled,Va(c.bf.transparent,U),null,H,k,m.debugBuffer,m.quadTriangleIndexBuffer,m.debugSegments),f.draw(l,h.LINE_STRIP,_,C,I,dt.disabled,Va(c.bf.red),M,H,k,m.debugBuffer,m.tileBorderIndexBuffer,m.debugSegments)}function Kn(m,e,a,l){const{isRenderingGlobe:h}=l,f=m.context,_=f.gl,C=m.transform,I=m.colorModeForRenderPass(),k=m.getDepthModeFor3D(),M=m.useProgram("terrain");f.bindFramebuffer.set(null),f.viewport.set([0,0,m.width,m.height]);for(const N of a){const z=e.getTerrainMesh(N.tileID),L=m.renderToTexture.getTexture(N),U=e.getTerrainData(N.tileID);f.activeTexture.set(_.TEXTURE0),_.bindTexture(_.TEXTURE_2D,L.texture);const q=e.getMeshFrameDelta(C.zoom),H=C.calculateFogMatrix(N.tileID.toUnwrapped()),X=vl(q,H,m.style.sky,C.pitch,h),J=C.getProjectionData({overscaledTileID:N.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});M.draw(f,_.TRIANGLES,k,zt.disabled,I,dt.backCCW,X,U,J,"terrain",z.vertexBuffer,z.indexBuffer,z.segments)}}function Dl(m,e){if(!e.mesh){const a=new c.aL;a.emplaceBack(-1,-1),a.emplaceBack(1,-1),a.emplaceBack(1,1),a.emplaceBack(-1,1);const l=new c.aN;l.emplaceBack(0,1,2),l.emplaceBack(0,2,3),e.mesh=new La(m.createVertexBuffer(a,_a.members),m.createIndexBuffer(l),c.aM.simpleSegment(0,0,a.length,l.length))}return e.mesh}class Ll{constructor(e,a){this.context=new bd(e),this.transform=a,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.ag(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Pt.maxUnderzooming+Pt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Co}resize(e,a,l){if(this.width=Math.floor(e*l),this.height=Math.floor(a*l),this.pixelRatio=l,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const h of this.style._order)this.style._layers[h].resize()}setup(){const e=this.context,a=new c.aL;a.emplaceBack(0,0),a.emplaceBack(c.$,0),a.emplaceBack(0,c.$),a.emplaceBack(c.$,c.$),this.tileExtentBuffer=e.createVertexBuffer(a,_a.members),this.tileExtentSegments=c.aM.simpleSegment(0,0,4,2);const l=new c.aL;l.emplaceBack(0,0),l.emplaceBack(c.$,0),l.emplaceBack(0,c.$),l.emplaceBack(c.$,c.$),this.debugBuffer=e.createVertexBuffer(l,_a.members),this.debugSegments=c.aM.simpleSegment(0,0,4,5);const h=new c.c6;h.emplaceBack(0,0,0,0),h.emplaceBack(c.$,0,c.$,0),h.emplaceBack(0,c.$,0,c.$),h.emplaceBack(c.$,c.$,c.$,c.$),this.rasterBoundsBuffer=e.createVertexBuffer(h,Um.members),this.rasterBoundsSegments=c.aM.simpleSegment(0,0,4,2);const f=new c.aL;f.emplaceBack(0,0),f.emplaceBack(c.$,0),f.emplaceBack(0,c.$),f.emplaceBack(c.$,c.$),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(f,_a.members),this.rasterBoundsSegmentsPosOnly=c.aM.simpleSegment(0,0,4,5);const _=new c.aL;_.emplaceBack(0,0),_.emplaceBack(1,0),_.emplaceBack(0,1),_.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(_,_a.members),this.viewportSegments=c.aM.simpleSegment(0,0,4,2);const C=new c.c7;C.emplaceBack(0),C.emplaceBack(1),C.emplaceBack(3),C.emplaceBack(2),C.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(C);const I=new c.aN;I.emplaceBack(1,0,2),I.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(I);const k=this.context.gl;this.stencilClearMode=new zt({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO),this.tileExtentMesh=new La(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,a=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const l=c.L();c.bY(l,0,this.width,this.height,0,0,1),c.N(l,l,[a.drawingBufferWidth,a.drawingBufferHeight,0]);const h={mainMatrix:l,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:l};this.useProgram("clippingMask",null,!0).draw(e,a.TRIANGLES,_t.disabled,this.stencilClearMode,Kt.disabled,dt.disabled,null,null,h,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,a,l){if(this.currentStencilSource===e.source||!e.isTileClipped()||!a||!a.length)return;this.currentStencilSource=e.source,this.nextStencilID+a.length>256&&this.clearStencil();const h=this.context;h.setColorMode(Kt.disabled),h.setDepthMode(_t.disabled);const f={};for(const _ of a)f[_.key]=this.nextStencilID++;this._renderTileMasks(f,a,l,!0),this._renderTileMasks(f,a,l,!1),this._tileClippingMaskIDs=f}_renderTileMasks(e,a,l,h){const f=this.context,_=f.gl,C=this.style.projection,I=this.transform,k=this.useProgram("clippingMask");for(const M of a){const N=e[M.key],z=this.style.map.terrain&&this.style.map.terrain.getTerrainData(M),L=C.getMeshFromTileID(this.context,M.canonical,h,!0,"stencil"),U=I.getProjectionData({overscaledTileID:M,applyGlobeMatrix:!l,applyTerrainMatrix:!0});k.draw(f,_.TRIANGLES,_t.disabled,new zt({func:_.ALWAYS,mask:0},N,255,_.KEEP,_.KEEP,_.REPLACE),Kt.disabled,l?dt.disabled:dt.backCCW,null,z,U,"$clipping",L.vertexBuffer,L.indexBuffer,L.segments)}}_renderTilesDepthBuffer(){const e=this.context,a=e.gl,l=this.style.projection,h=this.transform,f=this.useProgram("depth"),_=this.getDepthModeFor3D(),C=ve(h,{tileSize:h.tileSize});for(const I of C){const k=this.style.map.terrain&&this.style.map.terrain.getTerrainData(I),M=l.getMeshFromTileID(this.context,I.canonical,!0,!0,"raster"),N=h.getProjectionData({overscaledTileID:I,applyGlobeMatrix:!0,applyTerrainMatrix:!0});f.draw(e,a.TRIANGLES,_,zt.disabled,Kt.disabled,dt.backCCW,null,k,N,"$clipping",M.vertexBuffer,M.indexBuffer,M.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,a=this.context.gl;return new zt({func:a.NOTEQUAL,mask:255},e,255,a.KEEP,a.KEEP,a.REPLACE)}stencilModeForClipping(e){const a=this.context.gl;return new zt({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,a.KEEP,a.KEEP,a.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const a=this.context.gl,l=e.sort((_,C)=>C.overscaledZ-_.overscaledZ),h=l[l.length-1].overscaledZ,f=l[0].overscaledZ-h+1;if(f>1){this.currentStencilSource=void 0,this.nextStencilID+f>256&&this.clearStencil();const _={};for(let C=0;C<f;C++)_[C+h]=new zt({func:a.GEQUAL,mask:255},C+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=f,[_,l]}return[{[h]:zt.disabled},l]}stencilConfigForOverlapTwoPass(e){const a=this.context.gl,l=e.sort((_,C)=>C.overscaledZ-_.overscaledZ),h=l[l.length-1].overscaledZ,f=l[0].overscaledZ-h+1;if(this.clearStencil(),f>1){const _={},C={};for(let I=0;I<f;I++)_[I+h]=new zt({func:a.GREATER,mask:255},f+1+I,255,a.KEEP,a.KEEP,a.REPLACE),C[I+h]=new zt({func:a.GREATER,mask:255},1+I,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID=2*f+1,[_,C,l]}return this.nextStencilID=3,[{[h]:new zt({func:a.GREATER,mask:255},2,255,a.KEEP,a.KEEP,a.REPLACE)},{[h]:new zt({func:a.GREATER,mask:255},1,255,a.KEEP,a.KEEP,a.REPLACE)},l]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new Kt([e.CONSTANT_COLOR,e.ONE],new c.bf(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Kt.unblended:Kt.alphaBlended}getDepthModeForSublayer(e,a,l){if(!this.opaquePassEnabledForLayer())return _t.disabled;const h=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new _t(l||this.context.gl.LEQUAL,a,[h,h])}getDepthModeFor3D(){return new _t(this.context.gl.LEQUAL,_t.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,a){var l,h;this.style=e,this.options=a,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(ce.now()),this.imageManager.beginFrame();const f=this.style._order,_=this.style.sourceCaches,C={},I={},k={},M={isRenderingToTexture:!1,isRenderingGlobe:((l=e.projection)===null||l===void 0?void 0:l.transitionState)>0};for(const z in _){const L=_[z];L.used&&L.prepare(this.context),C[z]=L.getVisibleCoordinates(!1),I[z]=C[z].slice().reverse(),k[z]=L.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let z=0;z<f.length;z++)if(this.style._layers[f[z]].is3D()){this.opaquePassCutoff=z;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const z of f){const L=this.style._layers[z];if(!L.hasOffscreenPass()||L.isHidden(this.transform.zoom))continue;const U=I[L.source];(L.type==="custom"||U.length)&&this.renderLayer(this,_[L.source],L,U,M)}if((h=this.style.projection)===null||h===void 0||h.updateGPUdependent({context:this.context,useProgram:z=>this.useProgram(z)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?c.bf.black:c.bf.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(z,L){const U=z.context,q=U.gl,H=((de,te,pe)=>{const Ae=Math.cos(te.rollInRadians),be=Math.sin(te.rollInRadians),Ce=le(te),Se=te.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:de.properties.get("sky-color"),u_horizon_color:de.properties.get("horizon-color"),u_horizon:[(te.width/2-Ce*be)*pe,(te.height/2+Ce*Ae)*pe],u_horizon_normal:[-be,Ae],u_sky_horizon_blend:de.properties.get("sky-horizon-blend")*te.height/2*pe,u_sky_blend:Se}})(L,z.style.map.transform,z.pixelRatio),X=new _t(q.LEQUAL,_t.ReadWrite,[0,1]),J=zt.disabled,ie=z.colorModeForRenderPass(),Q=z.useProgram("sky"),ae=Dl(U,L);Q.draw(U,q.TRIANGLES,X,J,ie,dt.disabled,H,null,void 0,"sky",ae.vertexBuffer,ae.indexBuffer,ae.segments)}(this,this.style.sky),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=f.length-1;this.currentLayer>=0;this.currentLayer--){const z=this.style._layers[f[this.currentLayer]],L=_[z.source],U=C[z.source];this._renderTileClippingMasks(z,U,!1),this.renderLayer(this,L,z,U,M)}this.renderPass="translucent";let N=!1;for(this.currentLayer=0;this.currentLayer<f.length;this.currentLayer++){const z=this.style._layers[f[this.currentLayer]],L=_[z.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(z,M))continue;this.opaquePassEnabledForLayer()||N||(N=!0,M.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const U=(z.type==="symbol"?k:I)[z.source];this._renderTileClippingMasks(z,C[z.source],!!this.renderToTexture),this.renderLayer(this,L,z,U,M)}if(M.isRenderingGlobe&&function(z,L,U){const q=z.context,H=q.gl,X=z.useProgram("atmosphere"),J=new _t(H.LEQUAL,_t.ReadOnly,[0,1]),ie=z.transform,Q=function(Se,Oe){const Be=Se.properties.get("position"),Le=[-Be.x,-Be.y,-Be.z],Je=c.ag(new Float64Array(16));return Se.properties.get("anchor")==="map"&&(c.b6(Je,Je,Oe.rollInRadians),c.b7(Je,Je,-Oe.pitchInRadians),c.b6(Je,Je,Oe.bearingInRadians),c.b7(Je,Je,Oe.center.lat*Math.PI/180),c.bz(Je,Je,-Oe.center.lng*Math.PI/180)),c.c5(Le,Le,Je),Le}(U,z.transform),ae=ie.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),de=L.properties.get("atmosphere-blend")*ae.projectionTransition;if(de===0)return;const te=Ao(ie.worldSize,ie.center.lat),pe=ie.inverseProjectionMatrix,Ae=new Float64Array(4);Ae[3]=1,c.aw(Ae,Ae,ie.modelViewProjectionMatrix),Ae[0]/=Ae[3],Ae[1]/=Ae[3],Ae[2]/=Ae[3],Ae[3]=1,c.aw(Ae,Ae,pe),Ae[0]/=Ae[3],Ae[1]/=Ae[3],Ae[2]/=Ae[3],Ae[3]=1;const be=((Se,Oe,Be,Le,Je)=>({u_sun_pos:Se,u_atmosphere_blend:Oe,u_globe_position:Be,u_globe_radius:Le,u_inv_proj_matrix:Je}))(Q,de,[Ae[0],Ae[1],Ae[2]],te,pe),Ce=Dl(q,L);X.draw(q,H.TRIANGLES,J,zt.disabled,Kt.alphaBlended,dt.disabled,be,null,null,"atmosphere",Ce.vertexBuffer,Ce.indexBuffer,Ce.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const z=function(L,U){let q=null;const H=Object.values(L._layers).flatMap(Q=>Q.source&&!Q.isHidden(U)?[L.sourceCaches[Q.source]]:[]),X=H.filter(Q=>Q.getSource().type==="vector"),J=H.filter(Q=>Q.getSource().type!=="vector"),ie=Q=>{(!q||q.getSource().maxzoom<Q.getSource().maxzoom)&&(q=Q)};return X.forEach(Q=>ie(Q)),q||J.forEach(Q=>ie(Q)),q}(this.style,this.transform.zoom);z&&function(L,U,q){for(let H=0;H<q.length;H++)Ha(L,U,q[H])}(this,z,z.getVisibleCoordinates())}this.options.showPadding&&function(z){const L=z.transform.padding;Td(z,z.transform.height-(L.top||0),3,bu),Td(z,L.bottom||0,3,Ad),Cu(z,L.left||0,3,Sd),Cu(z,z.transform.width-(L.right||0),3,Nl);const U=z.transform.centerPoint;(function(q,H,X,J){ri(q,H-1,X-10,2,20,J),ri(q,H-10,X-1,20,2,J)})(z,U.x,z.transform.height-U.y,wu)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const a=this.terrainFacilitator.matrix,l=this.transform.modelViewProjectionMatrix;let h=this.terrainFacilitator.dirty;h||(h=e?!c.c8(a,l):!c.c9(a,l)),h||(h=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),h&&(c.ca(a,l),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(f,_){const C=f.context,I=C.gl,k=f.transform,M=Kt.unblended,N=new _t(I.LEQUAL,_t.ReadWrite,[0,1]),z=_.sourceCache.getRenderableTiles(),L=f.useProgram("terrainDepth");C.bindFramebuffer.set(_.getFramebuffer("depth").framebuffer),C.viewport.set([0,0,f.width/devicePixelRatio,f.height/devicePixelRatio]),C.clear({color:c.bf.transparent,depth:1});for(const U of z){const q=_.getTerrainMesh(U.tileID),H=_.getTerrainData(U.tileID),X=k.getProjectionData({overscaledTileID:U.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),J={u_ele_delta:_.getMeshFrameDelta(k.zoom)};L.draw(C,I.TRIANGLES,N,zt.disabled,M,dt.backCCW,J,H,X,"terrain",q.vertexBuffer,q.indexBuffer,q.segments)}C.bindFramebuffer.set(null),C.viewport.set([0,0,f.width,f.height])}(this,this.style.map.terrain),function(f,_){const C=f.context,I=C.gl,k=f.transform,M=Kt.unblended,N=new _t(I.LEQUAL,_t.ReadWrite,[0,1]),z=_.getCoordsTexture(),L=_.sourceCache.getRenderableTiles(),U=f.useProgram("terrainCoords");C.bindFramebuffer.set(_.getFramebuffer("coords").framebuffer),C.viewport.set([0,0,f.width/devicePixelRatio,f.height/devicePixelRatio]),C.clear({color:c.bf.transparent,depth:1}),_.coordsIndex=[];for(const q of L){const H=_.getTerrainMesh(q.tileID),X=_.getTerrainData(q.tileID);C.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,z.texture);const J={u_terrain_coords_id:(255-_.coordsIndex.length)/255,u_texture:0,u_ele_delta:_.getMeshFrameDelta(k.zoom)},ie=k.getProjectionData({overscaledTileID:q.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});U.draw(C,I.TRIANGLES,N,zt.disabled,M,dt.backCCW,J,X,ie,"terrain",H.vertexBuffer,H.indexBuffer,H.segments),_.coordsIndex.push(q.tileID.key)}C.bindFramebuffer.set(null),C.viewport.set([0,0,f.width,f.height])}(this,this.style.map.terrain))}renderLayer(e,a,l,h,f){l.isHidden(this.transform.zoom)||(l.type==="background"||l.type==="custom"||(h||[]).length)&&(this.id=l.id,c.cb(l)?function(_,C,I,k,M,N){if(_.renderPass!=="translucent")return;const{isRenderingToTexture:z}=N,L=zt.disabled,U=_.colorModeForRenderPass();(I._unevaluatedLayout.hasValue("text-variable-anchor")||I._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(q,H,X,J,ie,Q,ae,de,te){const pe=H.transform,Ae=H.style.map.terrain,be=ie==="map",Ce=Q==="map";for(const Se of q){const Oe=J.getTile(Se),Be=Oe.getBucket(X);if(!Be||!Be.text||!Be.text.segments.get().length)continue;const Le=c.an(Be.textSizeData,pe.zoom),Je=c.aC(Oe,1,H.transform.zoom),wt=Oi(be,H.transform,Je),Ft=X.layout.get("icon-text-fit")!=="none"&&Be.hasIconData();if(Le){const Jt=Math.pow(2,pe.zoom-Oe.tileID.overscaledZ),Wt=Ae?(ai,Qt)=>Ae.getElevation(Se,ai,Qt):null;yu(Be,be,Ce,te,pe,wt,Jt,Le,Ft,c.aD(pe,Oe,ae,de),Se.toUnwrapped(),Wt)}}}(k,_,I,C,I.layout.get("text-rotation-alignment"),I.layout.get("text-pitch-alignment"),I.paint.get("text-translate"),I.paint.get("text-translate-anchor"),M),I.paint.get("icon-opacity").constantOr(1)!==0&&Is(_,C,I,k,!1,I.paint.get("icon-translate"),I.paint.get("icon-translate-anchor"),I.layout.get("icon-rotation-alignment"),I.layout.get("icon-pitch-alignment"),I.layout.get("icon-keep-upright"),L,U,z),I.paint.get("text-opacity").constantOr(1)!==0&&Is(_,C,I,k,!0,I.paint.get("text-translate"),I.paint.get("text-translate-anchor"),I.layout.get("text-rotation-alignment"),I.layout.get("text-pitch-alignment"),I.layout.get("text-keep-upright"),L,U,z),C.map.showCollisionBoxes&&(wd(_,C,I,k,!0),wd(_,C,I,k,!1))}(e,a,l,h,this.style.placement.variableOffsets,f):c.cc(l)?function(_,C,I,k,M){if(_.renderPass!=="translucent")return;const{isRenderingToTexture:N}=M,z=I.paint.get("circle-opacity"),L=I.paint.get("circle-stroke-width"),U=I.paint.get("circle-stroke-opacity"),q=!I.layout.get("circle-sort-key").isConstant();if(z.constantOr(1)===0&&(L.constantOr(1)===0||U.constantOr(1)===0))return;const H=_.context,X=H.gl,J=_.transform,ie=_.getDepthModeForSublayer(0,_t.ReadOnly),Q=zt.disabled,ae=_.colorModeForRenderPass(),de=[],te=J.getCircleRadiusCorrection();for(let pe=0;pe<k.length;pe++){const Ae=k[pe],be=C.getTile(Ae),Ce=be.getBucket(I);if(!Ce)continue;const Se=I.paint.get("circle-translate"),Oe=I.paint.get("circle-translate-anchor"),Be=c.aD(J,be,Se,Oe),Le=Ce.programConfigurations.get(I.id),Je=_.useProgram("circle",Le),wt=Ce.layoutVertexBuffer,Ft=Ce.indexBuffer,Jt=_.style.map.terrain&&_.style.map.terrain.getTerrainData(Ae),Wt={programConfiguration:Le,program:Je,layoutVertexBuffer:wt,indexBuffer:Ft,uniformValues:Gm(_,be,I,Be,te),terrainData:Jt,projectionData:J.getProjectionData({overscaledTileID:Ae,applyGlobeMatrix:!N,applyTerrainMatrix:!0})};if(q){const ai=Ce.segments.get();for(const Qt of ai)de.push({segments:new c.aM([Qt]),sortKey:Qt.sortKey,state:Wt})}else de.push({segments:Ce.segments,sortKey:0,state:Wt})}q&&de.sort((pe,Ae)=>pe.sortKey-Ae.sortKey);for(const pe of de){const{programConfiguration:Ae,program:be,layoutVertexBuffer:Ce,indexBuffer:Se,uniformValues:Oe,terrainData:Be,projectionData:Le}=pe.state;be.draw(H,X.TRIANGLES,ie,Q,ae,dt.backCCW,Oe,Be,Le,I.id,Ce,Se,pe.segments,I.paint,_.transform.zoom,Ae)}}(e,a,l,h,f):c.cd(l)?function(_,C,I,k,M){if(I.paint.get("heatmap-opacity")===0)return;const N=_.context,{isRenderingToTexture:z,isRenderingGlobe:L}=M;if(_.style.map.terrain){for(const U of k){const q=C.getTile(U);C.hasRenderableParent(U)||(_.renderPass==="offscreen"?_u(_,q,I,U,L):_.renderPass==="translucent"&&Id(_,I,U,z,L))}N.viewport.set([0,0,_.width,_.height])}else _.renderPass==="offscreen"?function(U,q,H,X){const J=U.context,ie=J.gl,Q=U.transform,ae=zt.disabled,de=new Kt([ie.ONE,ie.ONE],c.bf.transparent,[!0,!0,!0,!0]);(function(te,pe,Ae){const be=te.gl;te.activeTexture.set(be.TEXTURE1),te.viewport.set([0,0,pe.width/4,pe.height/4]);let Ce=Ae.heatmapFbos.get(c.c2);Ce?(be.bindTexture(be.TEXTURE_2D,Ce.colorAttachment.get()),te.bindFramebuffer.set(Ce.framebuffer)):(Ce=Ss(te,pe.width/4,pe.height/4),Ae.heatmapFbos.set(c.c2,Ce))})(J,U,H),J.clear({color:c.bf.transparent});for(let te=0;te<X.length;te++){const pe=X[te];if(q.hasRenderableParent(pe))continue;const Ae=q.getTile(pe),be=Ae.getBucket(H);if(!be)continue;const Ce=be.programConfigurations.get(H.id),Se=U.useProgram("heatmap",Ce),Oe=Q.getProjectionData({overscaledTileID:pe,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Be=Q.getCircleRadiusCorrection();Se.draw(J,ie.TRIANGLES,_t.disabled,ae,de,dt.backCCW,ad(Ae,Q.zoom,H.paint.get("heatmap-intensity"),Be),null,Oe,H.id,be.layoutVertexBuffer,be.indexBuffer,be.segments,H.paint,Q.zoom,Ce)}J.viewport.set([0,0,U.width,U.height])}(_,C,I,k):_.renderPass==="translucent"&&function(U,q){const H=U.context,X=H.gl;H.setColorMode(U.colorModeForRenderPass());const J=q.heatmapFbos.get(c.c2);J&&(H.activeTexture.set(X.TEXTURE0),X.bindTexture(X.TEXTURE_2D,J.colorAttachment.get()),H.activeTexture.set(X.TEXTURE1),Ts(H,q).bind(X.LINEAR,X.CLAMP_TO_EDGE),U.useProgram("heatmapTexture").draw(H,X.TRIANGLES,_t.disabled,zt.disabled,U.colorModeForRenderPass(),dt.disabled,ru(U,q,0,1),null,null,q.id,U.viewportBuffer,U.quadTriangleIndexBuffer,U.viewportSegments,q.paint,U.transform.zoom))}(_,I)}(e,a,l,h,f):c.ce(l)?function(_,C,I,k,M){if(_.renderPass!=="translucent")return;const{isRenderingToTexture:N}=M,z=I.paint.get("line-opacity"),L=I.paint.get("line-width");if(z.constantOr(1)===0||L.constantOr(1)===0)return;const U=_.getDepthModeForSublayer(0,_t.ReadOnly),q=_.colorModeForRenderPass(),H=I.paint.get("line-dasharray"),X=H.constantOr(1),J=I.paint.get("line-pattern"),ie=J.constantOr(1),Q=I.paint.get("line-gradient"),ae=I.getCrossfadeParameters(),de=ie?"linePattern":X?"lineSDF":Q?"lineGradient":"line",te=_.context,pe=te.gl,Ae=_.transform;let be=!0;for(const Ce of k){const Se=C.getTile(Ce);if(ie&&!Se.patternsLoaded())continue;const Oe=Se.getBucket(I);if(!Oe)continue;const Be=Oe.programConfigurations.get(I.id),Le=_.context.program.get(),Je=_.useProgram(de,Be),wt=be||Je.program!==Le,Ft=_.style.map.terrain&&_.style.map.terrain.getTerrainData(Ce),Jt=J.constantOr(null),Wt=H&&H.constantOr(null);if(Jt&&Se.imageAtlas){const Ut=Se.imageAtlas,ci=Ut.patternPositions[Jt.to.toString()],It=Ut.patternPositions[Jt.from.toString()];ci&&It&&Be.setConstantPatternPositions(ci,It)}else if(Wt){const Ut=I.layout.get("line-cap")==="round",ci=_.lineAtlas.getDash(Wt.to,Ut),It=_.lineAtlas.getDash(Wt.from,Ut);Be.setConstantDashPositions(ci,It)}const ai=Ae.getProjectionData({overscaledTileID:Ce,applyGlobeMatrix:!N,applyTerrainMatrix:!0}),Qt=Ae.getPixelScale(),Ui=ie?cd(_,Se,I,Qt,ae):X?Ua(_,Se,I,Qt,ae):Q?ld(_,Se,I,Qt,Oe.lineClipsArray.length):Cl(_,Se,I,Qt);if(ie)te.activeTexture.set(pe.TEXTURE0),Se.imageAtlasTexture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE),Be.updatePaintBuffers(ae);else if(X)(wt||_.lineAtlas.dirty)&&(te.activeTexture.set(pe.TEXTURE0),_.lineAtlas.bind(te)),Be.updatePaintBuffers(ae);else if(Q){const Ut=Oe.gradients[I.id];let ci=Ut.texture;if(I.gradientVersion!==Ut.version){let It=256;if(I.stepInterpolant){const an=C.getSource().maxzoom,Qr=Ce.canonical.z===an?Math.ceil(1<<_.transform.maxZoom-Ce.canonical.z):1;It=c.ah(c.c3(Oe.maxLineLength/c.$*1024*Qr),256,te.maxTextureSize)}Ut.gradient=c.c4({expression:I.gradientExpression(),evaluationKey:"lineProgress",resolution:It,image:Ut.gradient||void 0,clips:Oe.lineClipsArray}),Ut.texture?Ut.texture.update(Ut.gradient):Ut.texture=new c.T(te,Ut.gradient,pe.RGBA),Ut.version=I.gradientVersion,ci=Ut.texture}te.activeTexture.set(pe.TEXTURE0),ci.bind(I.stepInterpolant?pe.NEAREST:pe.LINEAR,pe.CLAMP_TO_EDGE)}const ei=_.stencilModeForClipping(Ce);Je.draw(te,pe.TRIANGLES,U,ei,q,dt.disabled,Ui,Ft,ai,I.id,Oe.layoutVertexBuffer,Oe.indexBuffer,Oe.segments,I.paint,_.transform.zoom,Be,Oe.layoutVertexBuffer2),be=!1}}(e,a,l,h,f):c.cf(l)?function(_,C,I,k,M){const N=I.paint.get("fill-color"),z=I.paint.get("fill-opacity");if(z.constantOr(1)===0)return;const{isRenderingToTexture:L}=M,U=_.colorModeForRenderPass(),q=I.paint.get("fill-pattern"),H=_.opaquePassEnabledForLayer()&&!q.constantOr(1)&&N.constantOr(c.bf.transparent).a===1&&z.constantOr(0)===1?"opaque":"translucent";if(_.renderPass===H){const X=_.getDepthModeForSublayer(1,_.renderPass==="opaque"?_t.ReadWrite:_t.ReadOnly);Wa(_,C,I,k,X,U,!1,L)}if(_.renderPass==="translucent"&&I.paint.get("fill-antialias")){const X=_.getDepthModeForSublayer(I.getPaintProperty("fill-outline-color")?2:0,_t.ReadOnly);Wa(_,C,I,k,X,U,!0,L)}}(e,a,l,h,f):c.cg(l)?function(_,C,I,k,M){const N=I.paint.get("fill-extrusion-opacity");if(N===0)return;const{isRenderingToTexture:z}=M;if(_.renderPass==="translucent"){const L=new _t(_.context.gl.LEQUAL,_t.ReadWrite,_.depthRangeFor3D);if(N!==1||I.paint.get("fill-extrusion-pattern").constantOr(1))ks(_,C,I,k,L,zt.disabled,Kt.disabled,z),ks(_,C,I,k,L,_.stencilModeFor3D(),_.colorModeForRenderPass(),z);else{const U=_.colorModeForRenderPass();ks(_,C,I,k,L,zt.disabled,U,z)}}}(e,a,l,h,f):c.ch(l)?function(_,C,I,k,M){if(_.renderPass!=="offscreen"&&_.renderPass!=="translucent")return;const{isRenderingToTexture:N}=M,z=_.context,L=_.style.projection.useSubdivision,U=_.getDepthModeForSublayer(0,_t.ReadOnly),q=_.colorModeForRenderPass();if(_.renderPass==="offscreen")(function(H,X,J,ie,Q,ae,de){const te=H.context,pe=te.gl;for(const Ae of J){const be=X.getTile(Ae),Ce=be.dem;if(!Ce||!Ce.data||!be.needsHillshadePrepare)continue;const Se=Ce.dim,Oe=Ce.stride,Be=Ce.getPixels();if(te.activeTexture.set(pe.TEXTURE1),te.pixelStoreUnpackPremultiplyAlpha.set(!1),be.demTexture=be.demTexture||H.getTileTexture(Oe),be.demTexture){const Je=be.demTexture;Je.update(Be,{premultiply:!1}),Je.bind(pe.NEAREST,pe.CLAMP_TO_EDGE)}else be.demTexture=new c.T(te,Be,pe.RGBA,{premultiply:!1}),be.demTexture.bind(pe.NEAREST,pe.CLAMP_TO_EDGE);te.activeTexture.set(pe.TEXTURE0);let Le=be.fbo;if(!Le){const Je=new c.T(te,{width:Se,height:Se,data:null},pe.RGBA);Je.bind(pe.LINEAR,pe.CLAMP_TO_EDGE),Le=be.fbo=te.createFramebuffer(Se,Se,!0,!1),Le.colorAttachment.set(Je.texture)}te.bindFramebuffer.set(Le.framebuffer),te.viewport.set([0,0,Se,Se]),H.useProgram("hillshadePrepare").draw(te,pe.TRIANGLES,Q,ae,de,dt.disabled,od(be.tileID,Ce),null,null,ie.id,H.rasterBoundsBuffer,H.quadTriangleIndexBuffer,H.rasterBoundsSegments),be.needsHillshadePrepare=!1}})(_,C,k,I,U,zt.disabled,q),z.viewport.set([0,0,_.width,_.height]);else if(_.renderPass==="translucent")if(L){const[H,X,J]=_.stencilConfigForOverlapTwoPass(k);vu(_,C,I,J,H,U,q,!1,N),vu(_,C,I,J,X,U,q,!0,N)}else{const[H,X]=_.getStencilConfigForOverlapAndUpdateStencilID(k);vu(_,C,I,X,H,U,q,!1,N)}}(e,a,l,h,f):c.ci(l)?function(_,C,I,k,M){if(_.renderPass!=="translucent"||!k.length)return;const{isRenderingToTexture:N}=M,z=_.style.projection.useSubdivision,L=_.getDepthModeForSublayer(0,_t.ReadOnly),U=_.colorModeForRenderPass();if(z){const[q,H,X]=_.stencilConfigForOverlapTwoPass(k);qa(_,C,I,X,q,L,U,!1,N),qa(_,C,I,X,H,L,U,!0,N)}else{const[q,H]=_.getStencilConfigForOverlapAndUpdateStencilID(k);qa(_,C,I,H,q,L,U,!1,N)}}(e,a,l,h,f):c.cj(l)?function(_,C,I,k,M){if(_.renderPass!=="translucent"||I.paint.get("raster-opacity")===0||!k.length)return;const{isRenderingToTexture:N}=M,z=C.getSource(),L=_.style.projection.useSubdivision;if(z instanceof xn)Ms(_,C,I,k,null,!1,!1,z.tileCoords,z.flippedWindingOrder,N);else if(L){const[U,q,H]=_.stencilConfigForOverlapTwoPass(k);Ms(_,C,I,H,U,!1,!0,xu,!1,N),Ms(_,C,I,H,q,!0,!0,xu,!1,N)}else{const[U,q]=_.getStencilConfigForOverlapAndUpdateStencilID(k);Ms(_,C,I,q,U,!1,!0,xu,!1,N)}}(e,a,l,h,f):c.ck(l)?function(_,C,I,k,M){const N=I.paint.get("background-color"),z=I.paint.get("background-opacity");if(z===0)return;const{isRenderingToTexture:L}=M,U=_.context,q=U.gl,H=_.style.projection,X=_.transform,J=X.tileSize,ie=I.paint.get("background-pattern");if(_.isPatternMissing(ie))return;const Q=!ie&&N.a===1&&z===1&&_.opaquePassEnabledForLayer()?"opaque":"translucent";if(_.renderPass!==Q)return;const ae=zt.disabled,de=_.getDepthModeForSublayer(0,Q==="opaque"?_t.ReadWrite:_t.ReadOnly),te=_.colorModeForRenderPass(),pe=_.useProgram(ie?"backgroundPattern":"background"),Ae=k||ve(X,{tileSize:J,terrain:_.style.map.terrain});ie&&(U.activeTexture.set(q.TEXTURE0),_.imageManager.bind(_.context));const be=I.getCrossfadeParameters();for(const Ce of Ae){const Se=X.getProjectionData({overscaledTileID:Ce,applyGlobeMatrix:!L,applyTerrainMatrix:!0}),Oe=ie?dd(z,_,ie,{tileID:Ce,tileSize:J},be):hd(z,N),Be=_.style.map.terrain&&_.style.map.terrain.getTerrainData(Ce),Le=H.getMeshFromTileID(U,Ce.canonical,!1,!0,"raster");pe.draw(U,q.TRIANGLES,de,ae,te,dt.backCCW,Oe,Be,Se,I.id,Le.vertexBuffer,Le.indexBuffer,Le.segments)}}(e,0,l,h,f):c.cl(l)&&function(_,C,I,k){const{isRenderingGlobe:M}=k,N=_.context,z=I.implementation,L=_.style.projection,U=_.transform,q=U.getProjectionDataForCustomLayer(M),H={farZ:U.farZ,nearZ:U.nearZ,fov:U.fov*Math.PI/180,modelViewProjectionMatrix:U.modelViewProjectionMatrix,projectionMatrix:U.projectionMatrix,shaderData:{variantName:L.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${L.shaderPreludeCode.vertexSource}`,define:L.shaderDefine},defaultProjectionData:q},X=z.renderingMode?z.renderingMode:"2d";if(_.renderPass==="offscreen"){const J=z.prerender;J&&(_.setCustomLayerDefaults(),N.setColorMode(_.colorModeForRenderPass()),J.call(z,N.gl,H),N.setDirty(),_.setBaseState())}else if(_.renderPass==="translucent"){_.setCustomLayerDefaults(),N.setColorMode(_.colorModeForRenderPass()),N.setStencilMode(zt.disabled);const J=X==="3d"?_.getDepthModeFor3D():_.getDepthModeForSublayer(0,_t.ReadOnly);N.setDepthMode(J),z.render(N.gl,H),N.setDirty(),_.setBaseState(),N.bindFramebuffer.set(null)}}(e,0,l,f))}saveTileTexture(e){const a=this._tileTextures[e.size[0]];a?a.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const a=this._tileTextures[e];return a&&a.length>0?a.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const a=this.imageManager.getPattern(e.from.toString()),l=this.imageManager.getPattern(e.to.toString());return!a||!l}useProgram(e,a,l=!1,h=[]){this.cache=this.cache||{};const f=!!this.style.map.terrain,_=this.style.projection,C=l?_r.projectionMercator:_.shaderPreludeCode,I=l?Xr:_.shaderDefine,k=e+(a?a.cacheKey:"")+`/${l?Ra:_.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(f?"/terrain":"")+(h?`/${h.join("/")}`:"");return this.cache[k]||(this.cache[k]=new nu(this.context,_r[e],a,cu[e],this._showOverdrawInspector,f,C,I,h)),this.cache[k]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new c.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:a}=this.context.gl;return this.width!==e||this.height!==a}}function Iu(m,e){let a,l=!1,h=null,f=null;const _=()=>{h=null,l&&(m.apply(f,a),h=setTimeout(_,e),l=!1)};return(...C)=>(l=!0,f=this,a=C,h||_(),h)}class Xa{constructor(e){this._getCurrentHash=()=>{const a=window.location.hash.replace("#","");if(this._hashName){let l;return a.split("&").map(h=>h.split("=")).forEach(h=>{h[0]===this._hashName&&(l=h)}),(l&&l[1]||"").split("/")}return a.split("/")},this._onHashChange=()=>{const a=this._getCurrentHash();if(!this._isValidHash(a))return!1;const l=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(a[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:l,pitch:+(a[4]||0)}),!0},this._updateHashUnthrottled=()=>{const a=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,a)},this._removeHash=()=>{const a=this._getCurrentHash();if(a.length===0)return;const l=a.join("/");let h=l;h.split("&").length>0&&(h=h.split("&")[0]),this._hashName&&(h=`${this._hashName}=${l}`);let f=window.location.hash.replace(h,"");f.startsWith("#&")?f=f.slice(0,1)+f.slice(2):f==="#"&&(f="");let _=window.location.href.replace(/(#.+)?$/,f);_=_.replace("&&","&"),window.history.replaceState(window.history.state,null,_)},this._updateHash=Iu(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const a=this._map.getCenter(),l=Math.round(100*this._map.getZoom())/100,h=Math.ceil((l*Math.LN2+Math.log(512/360/.5))/Math.LN10),f=Math.pow(10,h),_=Math.round(a.lng*f)/f,C=Math.round(a.lat*f)/f,I=this._map.getBearing(),k=this._map.getPitch();let M="";if(M+=e?`/${_}/${C}/${l}`:`${l}/${C}/${_}`,(I||k)&&(M+="/"+Math.round(10*I)/10),k&&(M+=`/${Math.round(k)}`),this._hashName){const N=this._hashName;let z=!1;const L=window.location.hash.slice(1).split("&").map(U=>{const q=U.split("=")[0];return q===N?(z=!0,`${q}=${M}`):U}).filter(U=>U);return z||L.push(`${N}=${M}`),`#${L.join("&")}`}return`#${M}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new c.S(+e[2],+e[1])}catch{return!1}const a=+e[0],l=+(e[3]||0),h=+(e[4]||0);return a>=this._map.getMinZoom()&&a<=this._map.getMaxZoom()&&l>=-180&&l<=180&&h>=this._map.getMinPitch()&&h<=this._map.getMaxPitch()}}const Ka={linearity:.3,easing:c.cm(0,0,.3,1)},Es=c.e({deceleration:2500,maxSpeed:1400},Ka),Au=c.e({deceleration:20,maxSpeed:1400},Ka),Pd=c.e({deceleration:1e3,maxSpeed:360},Ka),kd=c.e({deceleration:1e3,maxSpeed:90},Ka),Md=c.e({deceleration:1e3,maxSpeed:360},Ka);class Ed{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:ce.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,a=ce.now();for(;e.length>0&&a-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const a={zoom:0,bearing:0,pitch:0,roll:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:f}of this._inertiaBuffer)a.zoom+=f.zoomDelta||0,a.bearing+=f.bearingDelta||0,a.pitch+=f.pitchDelta||0,a.roll+=f.rollDelta||0,f.panDelta&&a.pan._add(f.panDelta),f.around&&(a.around=f.around),f.pinchAround&&(a.pinchAround=f.pinchAround);const l=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,h={};if(a.pan.mag()){const f=br(a.pan.mag(),l,c.e({},Es,e||{})),_=a.pan.mult(f.amount/a.pan.mag()),C=this._map.cameraHelper.handlePanInertia(_,this._map.transform);h.center=C.easingCenter,h.offset=C.easingOffset,ko(h,f)}if(a.zoom){const f=br(a.zoom,l,Au);h.zoom=this._map.transform.zoom+f.amount,ko(h,f)}if(a.bearing){const f=br(a.bearing,l,Pd);h.bearing=this._map.transform.bearing+c.ah(f.amount,-179,179),ko(h,f)}if(a.pitch){const f=br(a.pitch,l,kd);h.pitch=this._map.transform.pitch+f.amount,ko(h,f)}if(a.roll){const f=br(a.roll,l,Md);h.roll=this._map.transform.roll+c.ah(f.amount,-179,179),ko(h,f)}if(h.zoom||h.bearing){const f=a.pinchAround===void 0?a.around:a.pinchAround;h.around=f?this._map.unproject(f):this._map.getCenter()}return this.clear(),c.e(h,{noMoveStart:!0})}}function ko(m,e){(!m.duration||m.duration<e.duration)&&(m.duration=e.duration,m.easing=e.easing)}function br(m,e,a){const{maxSpeed:l,linearity:h,deceleration:f}=a,_=c.ah(m*h/(e/1e3),-l,l),C=Math.abs(_)/(f*h);return{easing:a.easing,duration:1e3*C,amount:_*(C/2)}}class Bn extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,a,l,h={}){l=l instanceof MouseEvent?l:new MouseEvent(e,l);const f=K.mousePos(a.getCanvas(),l),_=a.unproject(f);super(e,c.e({point:f,lngLat:_,originalEvent:l},h)),this._defaultPrevented=!1,this.target=a}}class Mo extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,a,l){const h=e==="touchend"?l.changedTouches:l.touches,f=K.touchPos(a.getCanvasContainer(),h),_=f.map(I=>a.unproject(I)),C=f.reduce((I,k,M,N)=>I.add(k.div(N.length)),new c.P(0,0));super(e,{points:f,point:C,lngLats:_,lngLat:a.unproject(C),originalEvent:l}),this._defaultPrevented=!1}}class Su extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,a,l){super(e,{originalEvent:l}),this._defaultPrevented=!1}}class zd{constructor(e,a){this._map=e,this._clickTolerance=a.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new Su(e.type,this._map,e))}mousedown(e,a){return this._mousedownPos=a,this._firePreventable(new Bn(e.type,this._map,e))}mouseup(e){this._map.fire(new Bn(e.type,this._map,e))}click(e,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new Bn(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Bn(e.type,this._map,e))}mouseover(e){this._map.fire(new Bn(e.type,this._map,e))}mouseout(e){this._map.fire(new Bn(e.type,this._map,e))}touchstart(e){return this._firePreventable(new Mo(e.type,this._map,e))}touchmove(e){this._map.fire(new Mo(e.type,this._map,e))}touchend(e){this._map.fire(new Mo(e.type,this._map,e))}touchcancel(e){this._map.fire(new Mo(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Nd{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Bn(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Bn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Bn(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Eo{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(c.P.convert(e),this._map.terrain)}}class Tu{constructor(e,a){this._map=e,this._tr=new Eo(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=a.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,a){this.isEnabled()&&e.shiftKey&&e.button===0&&(K.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)}mousemoveWindow(e,a){if(!this._active)return;const l=a;if(this._lastPos.equals(l)||!this._box&&l.dist(this._startPos)<this._clickTolerance)return;const h=this._startPos;this._lastPos=l,this._box||(this._box=K.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const f=Math.min(h.x,l.x),_=Math.max(h.x,l.x),C=Math.min(h.y,l.y),I=Math.max(h.y,l.y);K.setTransform(this._box,`translate(${f}px,${C}px)`),this._box.style.width=_-f+"px",this._box.style.height=I-C+"px"}mouseupWindow(e,a){if(!this._active||e.button!==0)return;const l=this._startPos,h=a;if(this.reset(),K.suppressClick(),l.x!==h.x||l.y!==h.y)return this._map.fire(new c.l("boxzoomend",{originalEvent:e})),{cameraAnimation:f=>f.fitScreenCoordinates(l,h,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(K.remove(this._box),this._box=null),K.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,a){return this._map.fire(new c.l(e,{originalEvent:a}))}}function Rl(m,e){if(m.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${m.length}, points ${e.length}`);const a={};for(let l=0;l<m.length;l++)a[m[l].identifier]=e[l];return a}class Fl{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,a,l){(this.centroid||l.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),l.length===this.numTouches&&(this.centroid=function(h){const f=new c.P(0,0);for(const _ of h)f._add(_);return f.div(h.length)}(a),this.touches=Rl(l,a)))}touchmove(e,a,l){if(this.aborted||!this.centroid)return;const h=Rl(l,a);for(const f in this.touches){const _=h[f];(!_||_.dist(this.touches[f])>30)&&(this.aborted=!0)}}touchend(e,a,l){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),l.length===0){const h=!this.aborted&&this.centroid;if(this.reset(),h)return h}}}class Bl{constructor(e){this.singleTap=new Fl(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,a,l){this.singleTap.touchstart(e,a,l)}touchmove(e,a,l){this.singleTap.touchmove(e,a,l)}touchend(e,a,l){const h=this.singleTap.touchend(e,a,l);if(h){const f=e.timeStamp-this.lastTime<500,_=!this.lastTap||this.lastTap.dist(h)<30;if(f&&_||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=h,this.count===this.numTaps)return this.reset(),h}}}class sr{constructor(e){this._tr=new Eo(e),this._zoomIn=new Bl({numTouches:1,numTaps:2}),this._zoomOut=new Bl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,a,l){this._zoomIn.touchstart(e,a,l),this._zoomOut.touchstart(e,a,l)}touchmove(e,a,l){this._zoomIn.touchmove(e,a,l),this._zoomOut.touchmove(e,a,l)}touchend(e,a,l){const h=this._zoomIn.touchend(e,a,l),f=this._zoomOut.touchend(e,a,l),_=this._tr;return h?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:_.zoom+1,around:_.unproject(h)},{originalEvent:e})}):f?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:_.zoom-1,around:_.unproject(f)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class In{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const a=this._moveFunction(...e);if(a.bearingDelta||a.pitchDelta||a.rollDelta||a.around||a.panDelta)return this._active=!0,a}dragStart(e,a){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(a)?a[0]:a,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,a){if(!this.isEnabled())return;const l=this._lastPoint;if(!l)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const h=Array.isArray(a)?a[0]:a;return!this._moved&&h.dist(l)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=h,this._move(l,h))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&K.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Dd=0,wr=2,zo={[Dd]:1,[wr]:2};class zs{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const a=K.mouseButton(e);this._eventButton=a}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(a,l){const h=zo[l];return a.buttons===void 0||(a.buttons&h)!==h}(e,this._eventButton)}isValidEndEvent(e){return K.mouseButton(e)===this._eventButton}}class af{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class of{constructor(e=new zs({checkCorrectEvent:()=>!0}),a=new af){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=a}_executeRelevantHandler(e,a,l){return e instanceof MouseEvent?a(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?l(e):void 0}startMove(e){this._executeRelevantHandler(e,a=>this.mouseMoveStateManager.startMove(a),a=>this.oneFingerTouchMoveStateManager.startMove(a))}endMove(e){this._executeRelevantHandler(e,a=>this.mouseMoveStateManager.endMove(a),a=>this.oneFingerTouchMoveStateManager.endMove(a))}isValidStartEvent(e){return this._executeRelevantHandler(e,a=>this.mouseMoveStateManager.isValidStartEvent(a),a=>this.oneFingerTouchMoveStateManager.isValidStartEvent(a))}isValidMoveEvent(e){return this._executeRelevantHandler(e,a=>this.mouseMoveStateManager.isValidMoveEvent(a),a=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(a))}isValidEndEvent(e){return this._executeRelevantHandler(e,a=>this.mouseMoveStateManager.isValidEndEvent(a),a=>this.oneFingerTouchMoveStateManager.isValidEndEvent(a))}}const jl=m=>{m.mousedown=m.dragStart,m.mousemoveWindow=m.dragMove,m.mouseup=m.dragEnd,m.contextmenu=e=>{e.preventDefault()}};class Ld{constructor(e,a){this._clickTolerance=e.clickTolerance||1,this._map=a,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,a,l){return this._calculateTransform(e,a,l)}touchmove(e,a,l){if(this._active){if(!this._shouldBePrevented(l.length))return e.preventDefault(),this._calculateTransform(e,a,l);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,a,l){this._calculateTransform(e,a,l),this._active&&this._shouldBePrevented(l.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,a,l){l.length>0&&(this._active=!0);const h=Rl(l,a),f=new c.P(0,0),_=new c.P(0,0);let C=0;for(const k in h){const M=h[k],N=this._touches[k];N&&(f._add(M),_._add(M.sub(N)),C++,h[k]=M)}if(this._touches=h,this._shouldBePrevented(C)||!_.mag())return;const I=_.div(C);return this._sum._add(I),this._sum.mag()<this._clickTolerance?void 0:{around:f.div(C),panDelta:I}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ya{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,a,l){this._firstTwoTouches||l.length<2||(this._firstTwoTouches=[l[0].identifier,l[1].identifier],this._start([a[0],a[1]]))}touchmove(e,a,l){if(!this._firstTwoTouches)return;e.preventDefault();const[h,f]=this._firstTwoTouches,_=lr(l,a,h),C=lr(l,a,f);if(!_||!C)return;const I=this._aroundCenter?null:_.add(C).div(2);return this._move([_,C],I,e)}touchend(e,a,l){if(!this._firstTwoTouches)return;const[h,f]=this._firstTwoTouches,_=lr(l,a,h),C=lr(l,a,f);_&&C||(this._active&&K.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function lr(m,e,a){for(let l=0;l<m.length;l++)if(m[l].identifier===a)return e[l]}function Ke(m,e){return Math.log(m/e)/Math.LN2}class Pu extends Ya{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,a){const l=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Ke(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ke(this._distance,l),pinchAround:a}}}function Ol(m,e){return 180*m.angleWith(e)/Math.PI}class ku extends Ya{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,a,l){const h=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ol(this._vector,h),pinchAround:a}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const a=25/(Math.PI*this._minDiameter)*360,l=Ol(e,this._startVector);return Math.abs(l)<a}}function Ja(m){return Math.abs(m.y)>Math.abs(m.x)}class No extends Ya{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,a,l){super.touchstart(e,a,l),this._currentTouchCount=l.length}_start(e){this._lastPoints=e,Ja(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,a,l){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const h=e[0].sub(this._lastPoints[0]),f=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(h,f,l.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(h.y+f.y)/2*-.5}):void 0}gestureBeginsVertically(e,a,l){if(this._valid!==void 0)return this._valid;const h=e.mag()>=2,f=a.mag()>=2;if(!h&&!f)return;if(!h||!f)return this._firstMove===void 0&&(this._firstMove=l),l-this._firstMove<100&&void 0;const _=e.y>0==a.y>0;return Ja(e)&&Ja(a)&&_}}const Mu={panStep:100,bearingStep:15,pitchStep:10};class Mt{constructor(e){this._tr=new Eo(e);const a=Mu;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let a=0,l=0,h=0,f=0,_=0;switch(e.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:e.shiftKey?l=-1:(e.preventDefault(),f=-1);break;case 39:e.shiftKey?l=1:(e.preventDefault(),f=1);break;case 38:e.shiftKey?h=1:(e.preventDefault(),_=-1);break;case 40:e.shiftKey?h=-1:(e.preventDefault(),_=1);break;default:return}return this._rotationDisabled&&(l=0,h=0),{cameraAnimation:C=>{const I=this._tr;C.easeTo({duration:300,easeId:"keyboardHandler",easing:Eu,zoom:a?Math.round(I.zoom)+a*(e.shiftKey?2:1):I.zoom,bearing:I.bearing+l*this._bearingStep,pitch:I.pitch+h*this._pitchStep,offset:[-f*this._panStep,-_*this._panStep],center:I.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Eu(m){return m*(2-m)}const Rd=4.000244140625,zu=1/450;class Fd{constructor(e,a){this._onTimeout=l=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)},this._map=e,this._tr=new Eo(e),this._triggerRenderFrame=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=zu}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let a=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const l=ce.now(),h=l-(this._lastWheelEventTime||0);this._lastWheelEventTime=l,a!==0&&a%Rd==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":h>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(h*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),e.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=e,this._delta-=a,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const a=K.mousePos(this._map.getCanvas(),e),l=this._tr;this._aroundPoint=this._aroundCenter?l.transform.locationToScreenPoint(c.S.convert(l.center)):a,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const C=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=C),typeof this._targetZoom=="number"&&(this._targetZoom+=C)}if(this._delta!==0){const C=this._type==="wheel"&&Math.abs(this._delta)>Rd?this._wheelZoomRate:this._defaultZoomRate;let I=2/(1+Math.exp(-Math.abs(this._delta*C)));this._delta<0&&I!==0&&(I=1/I);const k=typeof this._targetZoom!="number"?e.scale:c.af(this._targetZoom);this._targetZoom=e.getConstrained(e.getCameraLngLat(),c.ak(k*I)).zoom,this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const a=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,l=this._startZoom,h=this._easing;let f,_=!1;if(this._type==="wheel"&&l&&h){const C=ce.now()-this._lastWheelEventTime,I=Math.min((C+5)/200,1),k=h(I);f=c.C.number(l,a,k),I<1?this._frameId||(this._frameId=!0):_=!0}else f=a,_=!0;return this._active=!0,_&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=f,{noInertia:!0,needsRenderFrame:!_,zoomDelta:f-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let a=c.co;if(this._prevEase){const l=this._prevEase,h=(ce.now()-l.start)/l.duration,f=l.easing(h+.01)-l.easing(h),_=.27/Math.sqrt(f*f+1e-4)*.01,C=Math.sqrt(.0729-_*_);a=c.cm(_,C,.25,1)}return this._prevEase={start:ce.now(),duration:e,easing:a},a}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Bd{constructor(e,a){this._clickZoom=e,this._tapZoom=a}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class jd{constructor(e){this._tr=new Eo(e),this.reset()}reset(){this._active=!1}dblclick(e,a){return e.preventDefault(),{cameraAnimation:l=>{l.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(a)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Nu{constructor(){this._tap=new Bl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,a,l){if(!this._swipePoint)if(this._tapTime){const h=a[0],f=e.timeStamp-this._tapTime<500,_=this._tapPoint.dist(h)<30;f&&_?l.length>0&&(this._swipePoint=h,this._swipeTouch=l[0].identifier):this.reset()}else this._tap.touchstart(e,a,l)}touchmove(e,a,l){if(this._tapTime){if(this._swipePoint){if(l[0].identifier!==this._swipeTouch)return;const h=a[0],f=h.y-this._swipePoint.y;return this._swipePoint=h,e.preventDefault(),this._active=!0,{zoomDelta:f/128}}}else this._tap.touchmove(e,a,l)}touchend(e,a,l){if(this._tapTime)this._swipePoint&&l.length===0&&this.reset();else{const h=this._tap.touchend(e,a,l);h&&(this._tapTime=e.timeStamp,this._tapPoint=h)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Du{constructor(e,a,l){this._el=e,this._mousePan=a,this._touchPan=l}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Od{constructor(e,a,l,h){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=a,this._mousePitch=l,this._mouseRoll=h}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Lu{constructor(e,a,l,h){this._el=e,this._touchZoom=a,this._touchRotate=l,this._tapDragZoom=h,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Vd{constructor(e,a){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=a,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=K.create("div","maplibregl-cooperative-gesture-screen",e);let a=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(a=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const l=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),h=document.createElement("div");h.className="maplibregl-desktop-message",h.textContent=a,this._container.appendChild(h);const f=document.createElement("div");f.className="maplibregl-mobile-message",f.textContent=l,this._container.appendChild(f),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(K.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,a){this._enabled&&(this._map.fire(new c.l("cooperativegestureprevented",{gestureType:e,originalEvent:a})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Vl=m=>m.zoom||m.drag||m.roll||m.pitch||m.rotate;class ba extends c.l{}function Ot(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta||m.rollDelta}class sf{constructor(e,a){this.handleWindowEvent=h=>{this.handleEvent(h,`${h.type}Window`)},this.handleEvent=(h,f)=>{if(h.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const _=h.type==="renderFrame"?void 0:h,C={needsRenderFrame:!1},I={},k={};for(const{handlerName:z,handler:L,allowed:U}of this._handlers){if(!L.isEnabled())continue;let q;if(this._blockedByActive(k,U,z))L.reset();else if(L[f||h.type]){if(c.cp(h,f||h.type)){const H=K.mousePos(this._map.getCanvas(),h);q=L[f||h.type](h,H)}else if(c.cq(h,f||h.type)){const H=this._getMapTouches(h.touches),X=K.touchPos(this._map.getCanvas(),H);q=L[f||h.type](h,X,H)}else c.cr(f||h.type)||(q=L[f||h.type](h));this.mergeHandlerResult(C,I,q,z,_),q&&q.needsRenderFrame&&this._triggerRenderFrame()}(q||L.isActive())&&(k[z]=L)}const M={};for(const z in this._previousActiveHandlers)k[z]||(M[z]=_);this._previousActiveHandlers=k,(Object.keys(M).length||Ot(C))&&(this._changes.push([C,I,M]),this._triggerRenderFrame()),(Object.keys(k).length||Ot(C))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:N}=C;N&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],N(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ed(e),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a);const l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[window,"blur",void 0]];for(const[h,f,_]of this._listeners)K.addEventListener(h,f,h===document?this.handleWindowEvent:this.handleEvent,_)}destroy(){for(const[e,a,l]of this._listeners)K.removeEventListener(e,a,e===document?this.handleWindowEvent:this.handleEvent,l)}_addDefaultHandlers(e){const a=this._map,l=a.getCanvasContainer();this._add("mapEvent",new zd(a,e));const h=a.boxZoom=new Tu(a,e);this._add("boxZoom",h),e.interactive&&e.boxZoom&&h.enable();const f=a.cooperativeGestures=new Vd(a,e.cooperativeGestures);this._add("cooperativeGestures",f),e.cooperativeGestures&&f.enable();const _=new sr(a),C=new jd(a);a.doubleClickZoom=new Bd(C,_),this._add("tapZoom",_),this._add("clickZoom",C),e.interactive&&e.doubleClickZoom&&a.doubleClickZoom.enable();const I=new Nu;this._add("tapDragZoom",I);const k=a.touchPitch=new No(a);this._add("touchPitch",k),e.interactive&&e.touchPitch&&a.touchPitch.enable(e.touchPitch);const M=()=>a.project(a.getCenter()),N=function({enable:Q,clickTolerance:ae,aroundCenter:de=!0,minPixelCenterThreshold:te=100,rotateDegreesPerPixelMoved:pe=.8},Ae){const be=new zs({checkCorrectEvent:Ce=>K.mouseButton(Ce)===0&&Ce.ctrlKey||K.mouseButton(Ce)===2&&!Ce.ctrlKey});return new In({clickTolerance:ae,move:(Ce,Se)=>{const Oe=Ae();if(de&&Math.abs(Oe.y-Ce.y)>te)return{bearingDelta:c.cn(new c.P(Ce.x,Se.y),Se,Oe)};let Be=(Se.x-Ce.x)*pe;return de&&Se.y<Oe.y&&(Be=-Be),{bearingDelta:Be}},moveStateManager:be,enable:Q,assignEvents:jl})}(e,M),z=function({enable:Q,clickTolerance:ae,pitchDegreesPerPixelMoved:de=-.5}){const te=new zs({checkCorrectEvent:pe=>K.mouseButton(pe)===0&&pe.ctrlKey||K.mouseButton(pe)===2});return new In({clickTolerance:ae,move:(pe,Ae)=>({pitchDelta:(Ae.y-pe.y)*de}),moveStateManager:te,enable:Q,assignEvents:jl})}(e),L=function({enable:Q,clickTolerance:ae,rollDegreesPerPixelMoved:de=.3},te){const pe=new zs({checkCorrectEvent:Ae=>K.mouseButton(Ae)===2&&Ae.ctrlKey});return new In({clickTolerance:ae,move:(Ae,be)=>{const Ce=te();let Se=(be.x-Ae.x)*de;return be.y<Ce.y&&(Se=-Se),{rollDelta:Se}},moveStateManager:pe,enable:Q,assignEvents:jl})}(e,M);a.dragRotate=new Od(e,N,z,L),this._add("mouseRotate",N,["mousePitch"]),this._add("mousePitch",z,["mouseRotate","mouseRoll"]),this._add("mouseRoll",L,["mousePitch"]),e.interactive&&e.dragRotate&&a.dragRotate.enable();const U=function({enable:Q,clickTolerance:ae}){const de=new zs({checkCorrectEvent:te=>K.mouseButton(te)===0&&!te.ctrlKey});return new In({clickTolerance:ae,move:(te,pe)=>({around:pe,panDelta:pe.sub(te)}),activateOnStart:!0,moveStateManager:de,enable:Q,assignEvents:jl})}(e),q=new Ld(e,a);a.dragPan=new Du(l,U,q),this._add("mousePan",U),this._add("touchPan",q,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&a.dragPan.enable(e.dragPan);const H=new ku,X=new Pu;a.touchZoomRotate=new Lu(l,X,H,I),this._add("touchRotate",H,["touchPan","touchZoom"]),this._add("touchZoom",X,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&a.touchZoomRotate.enable(e.touchZoomRotate);const J=a.scrollZoom=new Fd(a,()=>this._triggerRenderFrame());this._add("scrollZoom",J,["mousePan"]),e.interactive&&e.scrollZoom&&a.scrollZoom.enable(e.scrollZoom);const ie=a.keyboard=new Mt(a);this._add("keyboard",ie),e.interactive&&e.keyboard&&a.keyboard.enable(),this._add("blockableMapEvent",new Nd(a))}_add(e,a,l){this._handlers.push({handlerName:e,handler:a,allowed:l}),this._handlersById[e]=a}stop(e){if(!this._updatingCamera){for(const{handler:a}of this._handlers)a.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Vl(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,a,l){for(const h in e)if(h!==l&&(!a||a.indexOf(h)<0))return!0;return!1}_getMapTouches(e){const a=[];for(const l of e)this._el.contains(l.target)&&a.push(l);return a}mergeHandlerResult(e,a,l,h,f){if(!l)return;c.e(e,l);const _={handlerName:h,originalEvent:l.originalEvent||f};l.zoomDelta!==void 0&&(a.zoom=_),l.panDelta!==void 0&&(a.drag=_),l.rollDelta!==void 0&&(a.roll=_),l.pitchDelta!==void 0&&(a.pitch=_),l.bearingDelta!==void 0&&(a.rotate=_)}_applyChanges(){const e={},a={},l={};for(const[h,f,_]of this._changes)h.panDelta&&(e.panDelta=(e.panDelta||new c.P(0,0))._add(h.panDelta)),h.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+h.zoomDelta),h.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+h.bearingDelta),h.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+h.pitchDelta),h.rollDelta&&(e.rollDelta=(e.rollDelta||0)+h.rollDelta),h.around!==void 0&&(e.around=h.around),h.pinchAround!==void 0&&(e.pinchAround=h.pinchAround),h.noInertia&&(e.noInertia=h.noInertia),c.e(a,f),c.e(l,_);this._updateMapTransform(e,a,l),this._changes=[]}_updateMapTransform(e,a,l){const h=this._map,f=h._getTransformForUpdate(),_=h.terrain;if(!(Ot(e)||_&&this._terrainMovement))return this._fireEvents(a,l,!0);h._stop(!0);let{panDelta:C,zoomDelta:I,bearingDelta:k,pitchDelta:M,rollDelta:N,around:z,pinchAround:L}=e;L!==void 0&&(z=L),z=z||h.transform.centerPoint,_&&!f.isPointOnMapSurface(z)&&(z=f.centerPoint);const U={panDelta:C,zoomDelta:I,rollDelta:N,pitchDelta:M,bearingDelta:k,around:z};this._map.cameraHelper.useGlobeControls&&!f.isPointOnMapSurface(z)&&(z=f.centerPoint);const q=z.distSqr(f.centerPoint)<.01?f.center:f.screenPointToLocation(C?z.sub(C):z);this._handleMapControls({terrain:_,tr:f,deltasForHelper:U,preZoomAroundLoc:q,combinedEventsInProgress:a,panDelta:C}),h._applyUpdatedTransform(f),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(a,l,!0)}_handleMapControls({terrain:e,tr:a,deltasForHelper:l,preZoomAroundLoc:h,combinedEventsInProgress:f,panDelta:_}){const C=this._map.cameraHelper;if(C.handleMapControlsRollPitchBearingZoom(l,a),e)return C.useGlobeControls?(this._terrainMovement||!f.drag&&!f.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void C.handleMapControlsPan(l,a,h)):this._terrainMovement||!f.drag&&!f.zoom?void(f.drag&&this._terrainMovement&&_?a.setCenter(a.screenPointToLocation(a.centerPoint.sub(_))):C.handleMapControlsPan(l,a,h)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void C.handleMapControlsPan(l,a,h));C.handleMapControlsPan(l,a,h)}_fireEvents(e,a,l){const h=Vl(this._eventsInProgress),f=Vl(e),_={};for(const N in e){const{originalEvent:z}=e[N];this._eventsInProgress[N]||(_[`${N}start`]=z),this._eventsInProgress[N]=e[N]}!h&&f&&this._fireEvent("movestart",f.originalEvent);for(const N in _)this._fireEvent(N,_[N]);f&&this._fireEvent("move",f.originalEvent);for(const N in e){const{originalEvent:z}=e[N];this._fireEvent(N,z)}const C={};let I;for(const N in this._eventsInProgress){const{handlerName:z,originalEvent:L}=this._eventsInProgress[N];this._handlersById[z].isActive()||(delete this._eventsInProgress[N],I=a[z]||L,C[`${N}end`]=I)}for(const N in C)this._fireEvent(N,C[N]);const k=Vl(this._eventsInProgress),M=(h||f)&&!k;if(M&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const N=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&N.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(N)}if(l&&M){this._updatingCamera=!0;const N=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),z=L=>L!==0&&-this._bearingSnap<L&&L<this._bearingSnap;!N||!N.essential&&ce.prefersReducedMotion?(this._map.fire(new c.l("moveend",{originalEvent:I})),z(this._map.getBearing())&&this._map.resetNorth()):(z(N.bearing||this._map.getBearing())&&(N.bearing=0),N.freezeElevation=!0,this._map.easeTo(N,{originalEvent:I})),this._updatingCamera=!1}}_fireEvent(e,a){this._map.fire(new c.l(e,a?{originalEvent:a}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new ba("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Ul extends c.E{constructor(e,a,l){super(),this._renderFrameCallback=()=>{const h=Math.min((ce.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(h)),h<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=l.bearingSnap,this.cameraHelper=a,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(e,a){e.apply(this.transform),this.transform=e,this.cameraHelper=a}getCenter(){return new c.S(this.transform.center.lng,this.transform.center.lat)}setCenter(e,a){return this.jumpTo({center:e},a)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,a){return this.jumpTo({elevation:e},a),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,a,l){return e=c.P.convert(e).mult(-1),this.panTo(this.transform.center,c.e({offset:e},a),l)}panTo(e,a,l){return this.easeTo(c.e({center:e},a),l)}getZoom(){return this.transform.zoom}setZoom(e,a){return this.jumpTo({zoom:e},a),this}zoomTo(e,a,l){return this.easeTo(c.e({zoom:e},a),l)}zoomIn(e,a){return this.zoomTo(this.getZoom()+1,e,a),this}zoomOut(e,a){return this.zoomTo(this.getZoom()-1,e,a),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,a){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new c.l("movestart",a)).fire(new c.l("move",a)).fire(new c.l("moveend",a))),this}getBearing(){return this.transform.bearing}setBearing(e,a){return this.jumpTo({bearing:e},a),this}getPadding(){return this.transform.padding}setPadding(e,a){return this.jumpTo({padding:e},a),this}rotateTo(e,a,l){return this.easeTo(c.e({bearing:e},a),l)}resetNorth(e,a){return this.rotateTo(0,c.e({duration:1e3},e),a),this}resetNorthPitch(e,a){return this.easeTo(c.e({bearing:0,pitch:0,roll:0,duration:1e3},e),a),this}snapToNorth(e,a){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,a):this}getPitch(){return this.transform.pitch}setPitch(e,a){return this.jumpTo({pitch:e},a),this}getRoll(){return this.transform.roll}setRoll(e,a){return this.jumpTo({roll:e},a),this}cameraForBounds(e,a){e=ni.convert(e).adjustAntiMeridian();const l=a&&a.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),l,a)}_cameraForBoxAndBearing(e,a,l,h){const f={top:0,bottom:0,right:0,left:0};if(typeof(h=c.e({padding:f,offset:[0,0],maxZoom:this.transform.maxZoom},h)).padding=="number"){const k=h.padding;h.padding={top:k,bottom:k,right:k,left:k}}const _=c.e(f,h.padding);h.padding=_;const C=this.transform,I=new ni(e,a);return this.cameraHelper.cameraForBoxAndBearing(h,_,I,l,C)}fitBounds(e,a,l){return this._fitInternal(this.cameraForBounds(e,a),a,l)}fitScreenCoordinates(e,a,l,h,f){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(c.P.convert(e)),this.transform.screenPointToLocation(c.P.convert(a)),l,h),h,f)}_fitInternal(e,a,l){return e?(delete(a=c.e(e,a)).padding,a.linear?this.easeTo(a,l):this.flyTo(a,l)):this}jumpTo(e,a){this.stop();const l=this._getTransformForUpdate();let h=!1,f=!1,_=!1;const C=l.zoom;this.cameraHelper.handleJumpToCenterZoom(l,e);const I=l.zoom!==C;return"elevation"in e&&l.elevation!==+e.elevation&&l.setElevation(+e.elevation),"bearing"in e&&l.bearing!==+e.bearing&&(h=!0,l.setBearing(+e.bearing)),"pitch"in e&&l.pitch!==+e.pitch&&(f=!0,l.setPitch(+e.pitch)),"roll"in e&&l.roll!==+e.roll&&(_=!0,l.setRoll(+e.roll)),e.padding==null||l.isPaddingEqual(e.padding)||l.setPadding(e.padding),this._applyUpdatedTransform(l),this.fire(new c.l("movestart",a)).fire(new c.l("move",a)),I&&this.fire(new c.l("zoomstart",a)).fire(new c.l("zoom",a)).fire(new c.l("zoomend",a)),h&&this.fire(new c.l("rotatestart",a)).fire(new c.l("rotate",a)).fire(new c.l("rotateend",a)),f&&this.fire(new c.l("pitchstart",a)).fire(new c.l("pitch",a)).fire(new c.l("pitchend",a)),_&&this.fire(new c.l("rollstart",a)).fire(new c.l("roll",a)).fire(new c.l("rollend",a)),this.fire(new c.l("moveend",a))}calculateCameraOptionsFromTo(e,a,l,h=0){const f=c.a1.fromLngLat(e,a),_=c.a1.fromLngLat(l,h),C=_.x-f.x,I=_.y-f.y,k=_.z-f.z,M=Math.hypot(C,I,k);if(M===0)throw new Error("Can't calculate camera options with same From and To");const N=Math.hypot(C,I),z=c.ak(this.transform.cameraToCenterDistance/M/this.transform.tileSize),L=180*Math.atan2(C,-I)/Math.PI;let U=180*Math.acos(N/M)/Math.PI;return U=k<0?90-U:90+U,{center:_.toLngLat(),elevation:h,zoom:z,pitch:U,bearing:L}}calculateCameraOptionsFromCameraLngLatAltRotation(e,a,l,h,f){const _=this.transform.calculateCenterFromCameraLngLatAlt(e,a,l,h);return{center:_.center,elevation:_.elevation,zoom:_.zoom,bearing:l,pitch:h,roll:f}}easeTo(e,a){this._stop(!1,e.easeId),((e=c.e({offset:[0,0],duration:500,easing:c.co},e)).animate===!1||!e.essential&&ce.prefersReducedMotion)&&(e.duration=0);const l=this._getTransformForUpdate(),h=this.getBearing(),f=l.pitch,_=l.roll,C="bearing"in e?this._normalizeBearing(e.bearing,h):h,I="pitch"in e?+e.pitch:f,k="roll"in e?this._normalizeBearing(e.roll,_):_,M="padding"in e?e.padding:l.padding,N=c.P.convert(e.offset);let z,L;e.around&&(z=c.S.convert(e.around),L=l.locationToScreenPoint(z));const U={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},q=this.cameraHelper.handleEaseTo(l,{bearing:C,pitch:I,roll:k,padding:M,around:z,aroundPoint:L,offsetAsPoint:N,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||h!==C,this._pitching=this._pitching||I!==f,this._rolling=this._rolling||k!==_,this._padding=!l.isPaddingEqual(M),this._zooming=this._zooming||q.isZooming,this._easeId=e.easeId,this._prepareEase(a,e.noMoveStart,U),this.terrain&&this._prepareElevation(q.elevationCenter),this._ease(H=>{q.easeFunc(H),this.terrain&&!e.freezeElevation&&this._updateElevation(H),this._applyUpdatedTransform(l),this._fireMoveEvents(a)},H=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(a,H)},e),this}_prepareEase(e,a,l={}){this._moving=!0,a||l.moving||this.fire(new c.l("movestart",e)),this._zooming&&!l.zooming&&this.fire(new c.l("zoomstart",e)),this._rotating&&!l.rotating&&this.fire(new c.l("rotatestart",e)),this._pitching&&!l.pitching&&this.fire(new c.l("pitchstart",e)),this._rolling&&!l.rolling&&this.fire(new c.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const a=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&a!==this._elevationTarget){const l=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(l-(a-(l*e+this._elevationStart))/(1-e)),this._elevationTarget=a}this.transform.setElevation(c.C.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const a=e.getCameraLngLat(),l=e.getCameraAltitude(),h=this.terrain?this.terrain.getElevationForLngLatZoom(a,e.zoom):0;if(l<h){const f=this.calculateCameraOptionsFromTo(a,h,e.center,e.elevation);return{pitch:f.pitch,zoom:f.zoom}}return{}}_applyUpdatedTransform(e){const a=[];if(a.push(h=>this._elevateCameraIfInsideTerrain(h)),this.transformCameraUpdate&&a.push(h=>this.transformCameraUpdate(h)),!a.length)return;const l=e.clone();for(const h of a){const f=l.clone(),{center:_,zoom:C,roll:I,pitch:k,bearing:M,elevation:N}=h(f);_&&f.setCenter(_),N!==void 0&&f.setElevation(N),C!==void 0&&f.setZoom(C),I!==void 0&&f.setRoll(I),k!==void 0&&f.setPitch(k),M!==void 0&&f.setBearing(M),l.apply(f)}this.transform.apply(l)}_fireMoveEvents(e){this.fire(new c.l("move",e)),this._zooming&&this.fire(new c.l("zoom",e)),this._rotating&&this.fire(new c.l("rotate",e)),this._pitching&&this.fire(new c.l("pitch",e)),this._rolling&&this.fire(new c.l("roll",e))}_afterEase(e,a){if(this._easeId&&a&&this._easeId===a)return;delete this._easeId;const l=this._zooming,h=this._rotating,f=this._pitching,_=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,l&&this.fire(new c.l("zoomend",e)),h&&this.fire(new c.l("rotateend",e)),f&&this.fire(new c.l("pitchend",e)),_&&this.fire(new c.l("rollend",e)),this.fire(new c.l("moveend",e))}flyTo(e,a){if(!e.essential&&ce.prefersReducedMotion){const Se=c.Q(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(Se,a)}this.stop(),e=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.co},e);const l=this._getTransformForUpdate(),h=l.bearing,f=l.pitch,_=l.roll,C=l.padding,I="bearing"in e?this._normalizeBearing(e.bearing,h):h,k="pitch"in e?+e.pitch:f,M="roll"in e?this._normalizeBearing(e.roll,_):_,N="padding"in e?e.padding:l.padding,z=c.P.convert(e.offset);let L=l.centerPoint.add(z);const U=l.screenPointToLocation(L),q=this.cameraHelper.handleFlyTo(l,{bearing:I,pitch:k,roll:M,padding:N,locationAtOffset:U,offsetAsPoint:z,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let H=e.curve;const X=Math.max(l.width,l.height),J=X/q.scaleOfZoom,ie=q.pixelPathLength;typeof q.scaleOfMinZoom=="number"&&(H=Math.sqrt(X/q.scaleOfMinZoom/ie*2));const Q=H*H;function ae(Se){const Oe=(J*J-X*X+(Se?-1:1)*Q*Q*ie*ie)/(2*(Se?J:X)*Q*ie);return Math.log(Math.sqrt(Oe*Oe+1)-Oe)}function de(Se){return(Math.exp(Se)-Math.exp(-Se))/2}function te(Se){return(Math.exp(Se)+Math.exp(-Se))/2}const pe=ae(!1);let Ae=function(Se){return te(pe)/te(pe+H*Se)},be=function(Se){return X*((te(pe)*(de(Oe=pe+H*Se)/te(Oe))-de(pe))/Q)/ie;var Oe},Ce=(ae(!0)-pe)/H;if(Math.abs(ie)<2e-6||!isFinite(Ce)){if(Math.abs(X-J)<1e-6)return this.easeTo(e,a);const Se=J<X?-1:1;Ce=Math.abs(Math.log(J/X))/H,be=()=>0,Ae=Oe=>Math.exp(Se*H*Oe)}return e.duration="duration"in e?+e.duration:1e3*Ce/("screenSpeed"in e?+e.screenSpeed/H:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=h!==I,this._pitching=k!==f,this._rolling=M!==_,this._padding=!l.isPaddingEqual(N),this._prepareEase(a,!1),this.terrain&&this._prepareElevation(q.targetCenter),this._ease(Se=>{const Oe=Se*Ce,Be=1/Ae(Oe),Le=be(Oe);this._rotating&&l.setBearing(c.C.number(h,I,Se)),this._pitching&&l.setPitch(c.C.number(f,k,Se)),this._rolling&&l.setRoll(c.C.number(_,M,Se)),this._padding&&(l.interpolatePadding(C,N,Se),L=l.centerPoint.add(z)),q.easeFunc(Se,Be,Le,L),this.terrain&&!e.freezeElevation&&this._updateElevation(Se),this._applyUpdatedTransform(l),this._fireMoveEvents(a)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(a)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,a){var l;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const h=this._onEaseEnd;delete this._onEaseEnd,h.call(this,a)}return e||(l=this.handlers)===null||l===void 0||l.stop(!1),this}_ease(e,a,l){l.animate===!1||l.duration===0?(e(1),a()):(this._easeStart=ce.now(),this._easeOptions=l,this._onEaseFrame=e,this._onEaseEnd=a,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,a){e=c.aO(e,-180,180);const l=Math.abs(e-a);return Math.abs(e-360-a)<l&&(e-=360),Math.abs(e+360-a)<l&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(c.S.convert(e),this.transform.tileZoom):null}}const $l={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Ru{constructor(e=$l){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=a=>{!a||a.sourceDataType!=="metadata"&&a.sourceDataType!=="visibility"&&a.dataType!=="style"&&a.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=K.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=K.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=K.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){K.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,a){const l=this._map._getUIString(`AttributionControl.${a}`);e.title=l,e.setAttribute("aria-label",l)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(h=>typeof h!="string"?"":h)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const h=this._map.style.stylesheet;this.styleOwner=h.owner,this.styleId=h.id}const a=this._map.style.sourceCaches;for(const h in a){const f=a[h];if(f.used||f.usedForTerrain){const _=f.getSource();_.attribution&&e.indexOf(_.attribution)<0&&e.push(_.attribution)}}e=e.filter(h=>String(h).trim()),e.sort((h,f)=>h.length-f.length),e=e.filter((h,f)=>{for(let _=f+1;_<e.length;_++)if(e[_].indexOf(h)>=0)return!1;return!0});const l=e.join(" | ");l!==this._attribHTML&&(this._attribHTML=l,e.length?(this._innerContainer.innerHTML=K.sanitize(l),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Fu{constructor(e={}){this._updateCompact=()=>{const a=this._container.children;if(a.length){const l=a[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&l.classList.add("maplibregl-compact"):l.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=K.create("div","maplibregl-ctrl");const a=K.create("a","maplibregl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://maplibre.org/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){K.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Ud{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const a=++this._id;return this._queue.push({callback:e,id:a,cancelled:!1}),a}remove(e){const a=this._currentlyRunning,l=a?this._queue.concat(a):this._queue;for(const h of l)if(h.id===e)return void(h.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const a=this._currentlyRunning=this._queue;this._queue=[];for(const l of a)if(!l.cancelled&&(l.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var lf=c.aJ([{name:"a_pos3d",type:"Int16",components:3}]);class Vr extends c.E{constructor(e){super(),this._lastTilesetChange=ce.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,a){this.sourceCache.update(e,a),this._renderableTilesKeys=[];const l={};for(const h of ve(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:a,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))l[h.key]=!0,this._renderableTilesKeys.push(h.key),this._tiles[h.key]||(h.terrainRttPosMatrix32f=new Float64Array(16),c.bY(h.terrainRttPosMatrix32f,0,c.$,c.$,0,0,1),this._tiles[h.key]=new zi(h,this.tileSize),this._lastTilesetChange=ce.now());for(const h in this._tiles)l[h]||delete this._tiles[h]}freeRtt(e){for(const a in this._tiles){const l=this._tiles[a];(!e||l.tileID.equals(e)||l.tileID.isChildOf(e)||e.isChildOf(l.tileID))&&(l.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e,a){return a?this._getTerrainCoordsForTileRanges(e,a):this._getTerrainCoordsForRegularTile(e)}_getTerrainCoordsForRegularTile(e){const a={};for(const l of this._renderableTilesKeys){const h=this._tiles[l].tileID,f=e.clone(),_=c.ba();if(h.canonical.equals(e.canonical))c.bY(_,0,c.$,c.$,0,0,1);else if(h.canonical.isChildOf(e.canonical)){const C=h.canonical.z-e.canonical.z,I=h.canonical.x-(h.canonical.x>>C<<C),k=h.canonical.y-(h.canonical.y>>C<<C),M=c.$>>C;c.bY(_,0,M,M,0,0,1),c.M(_,_,[-I*M,-k*M,0])}else{if(!e.canonical.isChildOf(h.canonical))continue;{const C=e.canonical.z-h.canonical.z,I=e.canonical.x-(e.canonical.x>>C<<C),k=e.canonical.y-(e.canonical.y>>C<<C),M=c.$>>C;c.bY(_,0,c.$,c.$,0,0,1),c.M(_,_,[I*M,k*M,0]),c.N(_,_,[1/2**C,1/2**C,0])}}f.terrainRttPosMatrix32f=new Float32Array(_),a[l]=f}return a}_getTerrainCoordsForTileRanges(e,a){const l={};for(const h of this._renderableTilesKeys){const f=this._tiles[h].tileID;if(!this._isWithinTileRanges(f,a))continue;const _=e.clone(),C=c.ba();if(f.canonical.z===e.canonical.z){const I=e.canonical.x-f.canonical.x,k=e.canonical.y-f.canonical.y;c.bY(C,0,c.$,c.$,0,0,1),c.M(C,C,[I*c.$,k*c.$,0])}else if(f.canonical.z>e.canonical.z){const I=f.canonical.z-e.canonical.z,k=f.canonical.x-(f.canonical.x>>I<<I),M=f.canonical.y-(f.canonical.y>>I<<I),N=e.canonical.x-(f.canonical.x>>I),z=e.canonical.y-(f.canonical.y>>I),L=c.$>>I;c.bY(C,0,L,L,0,0,1),c.M(C,C,[-k*L+N*c.$,-M*L+z*c.$,0])}else{const I=e.canonical.z-f.canonical.z,k=e.canonical.x-(e.canonical.x>>I<<I),M=e.canonical.y-(e.canonical.y>>I<<I),N=(e.canonical.x>>I)-f.canonical.x,z=(e.canonical.y>>I)-f.canonical.y,L=c.$<<I;c.bY(C,0,L,L,0,0,1),c.M(C,C,[k*c.$+N*L,M*c.$+z*L,0])}_.terrainRttPosMatrix32f=new Float32Array(C),l[h]=_}return l}getSourceTile(e,a){const l=this.sourceCache._source;let h=e.overscaledZ-this.deltaZoom;if(h>l.maxzoom&&(h=l.maxzoom),h<l.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(h).key);let f=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!f||!f.dem)&&a)for(;h>=l.minzoom&&(!f||!f.dem);)f=this.sourceCache.getTileByID(e.scaledTo(h--).key);return f}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}_isWithinTileRanges(e,a){return a[e.canonical.z]&&e.canonical.x>=a[e.canonical.z].minTileX&&e.canonical.x<=a[e.canonical.z].maxTileX&&e.canonical.y>=a[e.canonical.z].minTileY&&e.canonical.y<=a[e.canonical.z].maxTileY}}class Zl{constructor(e,a,l){this._meshCache={},this.painter=e,this.sourceCache=new Vr(a),this.options=l,this.exaggeration=typeof l.exaggeration=="number"?l.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,a,l,h=c.$){var f;if(!(a>=0&&a<h&&l>=0&&l<h))return 0;const _=this.getTerrainData(e),C=(f=_.tile)===null||f===void 0?void 0:f.dem;if(!C)return 0;const I=c.cs([],[a/h*c.$,l/h*c.$],_.u_terrain_matrix),k=[I[0]*C.dim,I[1]*C.dim],M=Math.floor(k[0]),N=Math.floor(k[1]),z=k[0]-M,L=k[1]-N;return C.get(M,N)*(1-z)*(1-L)+C.get(M+1,N)*z*(1-L)+C.get(M,N+1)*(1-z)*L+C.get(M+1,N+1)*z*L}getElevationForLngLatZoom(e,a){if(!c.ct(a,e.wrap()))return 0;const{tileID:l,mercatorX:h,mercatorY:f}=this._getOverscaledTileIDFromLngLatZoom(e,a);return this.getElevation(l,h%c.$,f%c.$,c.$)}getElevation(e,a,l,h=c.$){return this.getDEMElevation(e,a,l,h)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const h=this.painter.context,f=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new c.T(h,f,h.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new c.T(h,new c.R({width:1,height:1}),h.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.ag([])}const a=this.sourceCache.getSourceTile(e,!0);if(a&&a.dem&&(!a.demTexture||a.needsTerrainPrepare)){const h=this.painter.context;a.demTexture=this.painter.getTileTexture(a.dem.stride),a.demTexture?a.demTexture.update(a.dem.getPixels(),{premultiply:!1}):a.demTexture=new c.T(h,a.dem.getPixels(),h.gl.RGBA,{premultiply:!1}),a.demTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),a.needsTerrainPrepare=!1}const l=a&&a+a.tileID.key+e.key;if(l&&!this._demMatrixCache[l]){const h=this.sourceCache.sourceCache._source.maxzoom;let f=e.canonical.z-a.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=h?f=e.canonical.z-h:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const _=e.canonical.x-(e.canonical.x>>f<<f),C=e.canonical.y-(e.canonical.y>>f<<f),I=c.cu(new Float64Array(16),[1/(c.$<<f),1/(c.$<<f),0]);c.M(I,I,[_*c.$,C*c.$,0]),this._demMatrixCache[e.key]={matrix:I,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:a&&a.dem&&a.dem.dim||1,u_terrain_matrix:l?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:a&&a.dem&&a.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(a&&a.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:a}}getFramebuffer(e){const a=this.painter,l=a.width/devicePixelRatio,h=a.height/devicePixelRatio;return!this._fbo||this._fbo.width===l&&this._fbo.height===h||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new c.T(a.context,{width:l,height:h,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new c.T(a.context,{width:l,height:h,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=a.context.createFramebuffer(l,h,!0,!1),this._fbo.depthAttachment.set(a.context.createRenderbuffer(a.context.gl.DEPTH_COMPONENT16,l,h))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const a=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let f=0,_=0;f<this._coordsTextureSize;f++)for(let C=0;C<this._coordsTextureSize;C++,_+=4)a[_+0]=255&C,a[_+1]=255&f,a[_+2]=C>>8<<4|f>>8,a[_+3]=0;const l=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(a.buffer)),h=new c.T(e,l,e.gl.RGBA,{premultiply:!1});return h.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=h,h}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const a=new Uint8Array(4),l=this.painter.context,h=l.gl,f=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),_=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),C=Math.round(this.painter.height/devicePixelRatio);l.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),h.readPixels(f,C-_-1,1,1,h.RGBA,h.UNSIGNED_BYTE,a),l.bindFramebuffer.set(null);const I=a[0]+(a[2]>>4<<8),k=a[1]+((15&a[2])<<8),M=this.coordsIndex[255-a[3]],N=M&&this.sourceCache.getTileByID(M);if(!N)return null;const z=this._coordsTextureSize,L=(1<<N.tileID.canonical.z)*z;return new c.a1((N.tileID.canonical.x*z+I)/L+N.tileID.wrap,(N.tileID.canonical.y*z+k)/L,this.getElevation(N.tileID,I,k,z))}depthAtPoint(e){const a=new Uint8Array(4),l=this.painter.context,h=l.gl;return l.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),h.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,h.RGBA,h.UNSIGNED_BYTE,a),l.bindFramebuffer.set(null),(a[0]/16777216+a[1]/65536+a[2]/256+a[3])/256}getTerrainMesh(e){var a;const l=((a=this.painter.style.projection)===null||a===void 0?void 0:a.transitionState)>0,h=l&&e.canonical.y===0,f=l&&e.canonical.y===(1<<e.canonical.z)-1,_=`m_${h?"n":""}_${f?"s":""}`;if(this._meshCache[_])return this._meshCache[_];const C=this.painter.context,I=new c.cv,k=new c.aN,M=this.meshSize,N=c.$/M,z=M*M;for(let te=0;te<=M;te++)for(let pe=0;pe<=M;pe++)I.emplaceBack(pe*N,te*N,0);for(let te=0;te<z;te+=M+1)for(let pe=0;pe<M;pe++)k.emplaceBack(pe+te,M+pe+te+1,M+pe+te+2),k.emplaceBack(pe+te,M+pe+te+2,pe+te+1);const L=I.length,U=L+(M+1),q=(M+1)*M,H=h?c.bh:0,X=h?0:1,J=f?c.bi:c.$,ie=f?0:1;for(let te=0;te<=M;te++)I.emplaceBack(te*N,H,X);for(let te=0;te<=M;te++)I.emplaceBack(te*N,J,ie);for(let te=0;te<M;te++)k.emplaceBack(q+te,U+te,U+te+1),k.emplaceBack(q+te,U+te+1,q+te+1),k.emplaceBack(0+te,L+te+1,L+te),k.emplaceBack(0+te,0+te+1,L+te+1);const Q=I.length,ae=Q+2*(M+1);for(const te of[0,1])for(let pe=0;pe<=M;pe++)for(const Ae of[0,1])I.emplaceBack(te*c.$,pe*N,Ae);for(let te=0;te<2*M;te+=2)k.emplaceBack(Q+te,Q+te+1,Q+te+3),k.emplaceBack(Q+te,Q+te+3,Q+te+2),k.emplaceBack(ae+te,ae+te+3,ae+te+1),k.emplaceBack(ae+te,ae+te+2,ae+te+3);const de=new La(C.createVertexBuffer(I,lf.members),C.createIndexBuffer(k),c.aM.simpleSegment(0,0,I.length,k.length));return this._meshCache[_]=de,de}getMeshFrameDelta(e){return 2*Math.PI*c.bu/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,a){var l;const{tileID:h}=this._getOverscaledTileIDFromLngLatZoom(e,a);return(l=this.getMinMaxElevation(h).minElevation)!==null&&l!==void 0?l:0}getMinMaxElevation(e){const a=this.getTerrainData(e).tile,l={minElevation:null,maxElevation:null};return a&&a.dem&&(l.minElevation=a.dem.min*this.exaggeration,l.maxElevation=a.dem.max*this.exaggeration),l}_getOverscaledTileIDFromLngLatZoom(e,a){const l=c.a1.fromLngLat(e.wrap()),h=(1<<a)*c.$,f=l.x*h,_=l.y*h,C=Math.floor(f/c.$),I=Math.floor(_/c.$);return{tileID:new c.Z(a,0,a,C,I),mercatorX:f,mercatorY:_}}}class rt{constructor(e,a,l){this._context=e,this._size=a,this._tileSize=l,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const a=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),l=new c.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return l.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),a.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),a.colorAttachment.set(l.texture),{id:e,fbo:a,texture:l,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(a=>e.id!==a),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const a of this._recentlyUsed)if(!this._objects[a].inUse)return this._objects[a];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}const ct={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class Ns{constructor(e,a){this.painter=e,this.terrain=a,this.pool=new rt(e.context,30,a.sourceCache.tileSize*a.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,a){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(l=>!e._layers[l].isHidden(a)),this._coordsAscending={};for(const l in e.sourceCaches){this._coordsAscending[l]={};const h=e.sourceCaches[l].getVisibleCoordinates(),f=e.sourceCaches[l].getSource(),_=f instanceof xn?f.terrainTileRanges:null;for(const C of h){const I=this.terrain.sourceCache.getTerrainCoords(C,_);for(const k in I)this._coordsAscending[l][k]||(this._coordsAscending[l][k]=[]),this._coordsAscending[l][k].push(I[k])}}this._coordsAscendingStr={};for(const l of e._order){const h=e._layers[l],f=h.source;if(ct[h.type]&&!this._coordsAscendingStr[f]){this._coordsAscendingStr[f]={};for(const _ in this._coordsAscending[f])this._coordsAscendingStr[f][_]=this._coordsAscending[f][_].map(C=>C.key).sort().join()}}for(const l of this._renderableTiles)for(const h in this._coordsAscendingStr){const f=this._coordsAscendingStr[h][l.tileID.key];f&&f!==l.rttCoords[h]&&(l.rtt=[])}}renderLayer(e,a){if(e.isHidden(this.painter.transform.zoom))return!1;const l=Object.assign(Object.assign({},a),{isRenderingToTexture:!0}),h=e.type,f=this.painter,_=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(ct[h]&&(this._prevType&&ct[this._prevType]||this._stacks.push([]),this._prevType=h,this._stacks[this._stacks.length-1].push(e.id),!_))return!0;if(ct[this._prevType]||ct[h]&&_){this._prevType=h;const C=this._stacks.length-1,I=this._stacks[C]||[];for(const k of this._renderableTiles){if(this.pool.isFull()&&(Kn(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(k),k.rtt[C]){const N=this.pool.getObjectForId(k.rtt[C].id);if(N.stamp===k.rtt[C].stamp){this.pool.useObject(N);continue}}const M=this.pool.getOrCreateFreeObject();this.pool.useObject(M),this.pool.stampObject(M),k.rtt[C]={id:M.id,stamp:M.stamp},f.context.bindFramebuffer.set(M.fbo.framebuffer),f.context.clear({color:c.bf.transparent,stencil:0}),f.currentStencilSource=void 0;for(let N=0;N<I.length;N++){const z=f.style._layers[I[N]],L=z.source?this._coordsAscending[z.source][k.tileID.key]:[k.tileID];f.context.viewport.set([0,0,M.fbo.width,M.fbo.height]),f._renderTileClippingMasks(z,L,!0),f.renderLayer(f,f.style.sourceCaches[z.source],z,L,l),z.source&&(k.rttCoords[z.source]=this._coordsAscendingStr[z.source][k.tileID.key])}}return Kn(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects(),ct[h]}return!1}}const $d={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Gl=F,mn={hash:!1,interactive:!0,bearingSnap:7,attributionControl:$l,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},Zd={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Cr{constructor(e,a,l=!1){this.mousedown=f=>{this.startMove(f,K.mousePos(this.element,f)),K.addEventListener(window,"mousemove",this.mousemove),K.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=f=>{this.move(f,K.mousePos(this.element,f))},this.mouseup=f=>{this._rotatePitchHandler.dragEnd(f),this.offTemp()},this.touchstart=f=>{f.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=K.touchPos(this.element,f.targetTouches)[0],this.startMove(f,this._startPos),K.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),K.addEventListener(window,"touchend",this.touchend))},this.touchmove=f=>{f.targetTouches.length!==1?this.reset():(this._lastPos=K.touchPos(this.element,f.targetTouches)[0],this.move(f,this._lastPos))},this.touchend=f=>{f.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=a;const h=new of;this._rotatePitchHandler=new In({clickTolerance:3,move:(f,_)=>{const C=a.getBoundingClientRect(),I=new c.P((C.bottom-C.top)/2,(C.right-C.left)/2);return{bearingDelta:c.cn(new c.P(f.x,_.y),_,I),pitchDelta:l?-.5*(_.y-f.y):void 0}},moveStateManager:h,enable:!0,assignEvents:()=>{}}),this.map=e,K.addEventListener(a,"mousedown",this.mousedown),K.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),K.addEventListener(a,"touchcancel",this.reset)}startMove(e,a){this._rotatePitchHandler.dragStart(e,a),K.disableDrag()}move(e,a){const l=this.map,{bearingDelta:h,pitchDelta:f}=this._rotatePitchHandler.dragMove(e,a)||{};h&&l.setBearing(l.getBearing()+h),f&&l.setPitch(l.getPitch()+f)}off(){const e=this.element;K.removeEventListener(e,"mousedown",this.mousedown),K.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),K.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),K.removeEventListener(window,"touchend",this.touchend),K.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){K.enableDrag(),K.removeEventListener(window,"mousemove",this.mousemove),K.removeEventListener(window,"mouseup",this.mouseup),K.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),K.removeEventListener(window,"touchend",this.touchend)}}let Qa;function Do(m,e,a,l=!1){if(l||!a.getCoveringTilesDetailsProvider().allowWorldCopies())return m==null?void 0:m.wrap();const h=new c.S(m.lng,m.lat);if(m=new c.S(m.lng,m.lat),e){const f=new c.S(m.lng-360,m.lat),_=new c.S(m.lng+360,m.lat),C=a.locationToScreenPoint(m).distSqr(e);a.locationToScreenPoint(f).distSqr(e)<C?m=f:a.locationToScreenPoint(_).distSqr(e)<C&&(m=_)}for(;Math.abs(m.lng-a.center.lng)>180;){const f=a.locationToScreenPoint(m);if(f.x>=0&&f.y>=0&&f.x<=a.width&&f.y<=a.height)break;m.lng>a.center.lng?m.lng-=360:m.lng+=360}return m.lng!==h.lng&&a.isPointOnMapSurface(a.locationToScreenPoint(m))?m:h}const Yt={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function mi(m,e,a){const l=m.classList;for(const h in Yt)l.remove(`maplibregl-${a}-anchor-${h}`);l.add(`maplibregl-${a}-anchor-${e}`)}class Wl extends c.E{constructor(e){if(super(),this._onKeyPress=a=>{const l=a.code,h=a.charCode||a.keyCode;l!=="Space"&&l!=="Enter"&&h!==32&&h!==13||this.togglePopup()},this._onMapClick=a=>{const l=a.originalEvent.target,h=this._element;this._popup&&(l===h||h.contains(l))&&this.togglePopup()},this._update=a=>{if(!this._map)return;const l=this._map.loaded()&&!this._map.isMoving();((a==null?void 0:a.type)==="terrain"||(a==null?void 0:a.type)==="render"&&!l)&&this._map.once("render",this._update),this._lngLat=Do(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let h="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?h=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(h=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let f="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?f="rotateX(0deg)":this._pitchAlignment==="map"&&(f=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||a&&a.type!=="moveend"||(this._pos=this._pos.round()),K.setTransform(this._element,`${Yt[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${f} ${h}`),ce.frameAsync(new AbortController).then(()=>{this._updateOpacity(a&&a.type==="moveend")}).catch(()=>{})},this._onMove=a=>{if(!this._isDragging){const l=this._clickTolerance||this._map._clickTolerance;this._isDragging=a.point.dist(this._pointerdownPos)>=l}this._isDragging&&(this._pos=a.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.l("dragstart"))),this.fire(new c.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.l("dragend")),this._state="inactive"},this._addDragHandler=a=>{this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._pointerdownPos=a.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=c.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=K.create("div");const a=K.createNS("http://www.w3.org/2000/svg","svg"),l=41,h=27;a.setAttributeNS(null,"display","block"),a.setAttributeNS(null,"height",`${l}px`),a.setAttributeNS(null,"width",`${h}px`),a.setAttributeNS(null,"viewBox",`0 0 ${h} ${l}`);const f=K.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"stroke","none"),f.setAttributeNS(null,"stroke-width","1"),f.setAttributeNS(null,"fill","none"),f.setAttributeNS(null,"fill-rule","evenodd");const _=K.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"fill-rule","nonzero");const C=K.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"transform","translate(3.0, 29.0)"),C.setAttributeNS(null,"fill","#000000");const I=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const X of I){const J=K.createNS("http://www.w3.org/2000/svg","ellipse");J.setAttributeNS(null,"opacity","0.04"),J.setAttributeNS(null,"cx","10.5"),J.setAttributeNS(null,"cy","5.80029008"),J.setAttributeNS(null,"rx",X.rx),J.setAttributeNS(null,"ry",X.ry),C.appendChild(J)}const k=K.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"fill",this._color);const M=K.createNS("http://www.w3.org/2000/svg","path");M.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),k.appendChild(M);const N=K.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"opacity","0.25"),N.setAttributeNS(null,"fill","#000000");const z=K.createNS("http://www.w3.org/2000/svg","path");z.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),N.appendChild(z);const L=K.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"transform","translate(6.0, 7.0)"),L.setAttributeNS(null,"fill","#FFFFFF");const U=K.createNS("http://www.w3.org/2000/svg","g");U.setAttributeNS(null,"transform","translate(8.0, 8.0)");const q=K.createNS("http://www.w3.org/2000/svg","circle");q.setAttributeNS(null,"fill","#000000"),q.setAttributeNS(null,"opacity","0.25"),q.setAttributeNS(null,"cx","5.5"),q.setAttributeNS(null,"cy","5.5"),q.setAttributeNS(null,"r","5.4999962");const H=K.createNS("http://www.w3.org/2000/svg","circle");H.setAttributeNS(null,"fill","#FFFFFF"),H.setAttributeNS(null,"cx","5.5"),H.setAttributeNS(null,"cy","5.5"),H.setAttributeNS(null,"r","5.4999962"),U.appendChild(q),U.appendChild(H),_.appendChild(C),_.appendChild(k),_.appendChild(N),_.appendChild(L),_.appendChild(U),a.appendChild(_),a.setAttributeNS(null,"height",l*this._scale+"px"),a.setAttributeNS(null,"width",h*this._scale+"px"),this._element.appendChild(a),this._offset=c.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",a=>{a.preventDefault()}),this._element.addEventListener("mousedown",a=>{a.preventDefault()}),mi(this._element,this._anchor,"marker"),e&&e.className)for(const a of e.className.split(" "))this._element.classList.add(a);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),K.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=c.S.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const h=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[h,-1*(38.1-13.5+h)],"bottom-right":[-h,-1*(38.1-13.5+h)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var a,l;const h=(a=this._map)===null||a===void 0?void 0:a.terrain,f=this._map.transform.isLocationOccluded(this._lngLat);if(!h||f){const L=f?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==L&&(this._element.style.opacity=L))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const _=this._map,C=_.terrain.depthAtPoint(this._pos),I=_.terrain.getElevationForLngLatZoom(this._lngLat,_.transform.tileZoom);if(_.transform.lngLatToCameraDepth(this._lngLat,I)-C<.006)return void(this._element.style.opacity=this._opacity);const k=-this._offset.y/_.transform.pixelsPerMeter,M=Math.sin(_.getPitch()*Math.PI/180)*k,N=_.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),z=_.transform.lngLatToCameraDepth(this._lngLat,I+M)-N>.006;!((l=this._popup)===null||l===void 0)&&l.isOpen()&&z&&this._popup.remove(),this._element.style.opacity=z?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=c.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,a){return(this._opacity===void 0||e===void 0&&a===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),a!==void 0&&(this._opacityWhenCovered=a),this._map&&this._updateOpacity(!0),this}}const Ds={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let eo=0,to=!1;const Bu={maxWidth:100,unit:"metric"};function ql(m,e,a){const l=a&&a.maxWidth||100,h=m._container.clientHeight/2,f=m._container.clientWidth/2,_=m.unproject([f-l/2,h]),C=m.unproject([f+l/2,h]),I=Math.round(m.project(C).x-m.project(_).x),k=Math.min(l,I,m._container.clientWidth),M=_.distanceTo(C);if(a&&a.unit==="imperial"){const N=3.2808*M;N>5280?Jr(e,k,N/5280,m._getUIString("ScaleControl.Miles")):Jr(e,k,N,m._getUIString("ScaleControl.Feet"))}else a&&a.unit==="nautical"?Jr(e,k,M/1852,m._getUIString("ScaleControl.NauticalMiles")):M>=1e3?Jr(e,k,M/1e3,m._getUIString("ScaleControl.Kilometers")):Jr(e,k,M,m._getUIString("ScaleControl.Meters"))}function Jr(m,e,a,l){const h=function(f){const _=Math.pow(10,`${Math.floor(f)}`.length-1);let C=f/_;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:C>=1?1:function(I){const k=Math.pow(10,Math.ceil(-Math.log(I)/Math.LN10));return Math.round(I*k)/k}(C),_*C}(a);m.style.width=e*(h/a)+"px",m.innerHTML=`${h}&nbsp;${l}`}const ju={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Ou=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Hl(m){if(m){if(typeof m=="number"){const e=Math.round(Math.abs(m)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,m),"top-left":new c.P(e,e),"top-right":new c.P(-e,e),bottom:new c.P(0,-m),"bottom-left":new c.P(e,-e),"bottom-right":new c.P(-e,-e),left:new c.P(m,0),right:new c.P(-m,0)}}if(m instanceof c.P||Array.isArray(m)){const e=c.P.convert(m);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:c.P.convert(m.center||[0,0]),top:c.P.convert(m.top||[0,0]),"top-left":c.P.convert(m["top-left"]||[0,0]),"top-right":c.P.convert(m["top-right"]||[0,0]),bottom:c.P.convert(m.bottom||[0,0]),"bottom-left":c.P.convert(m["bottom-left"]||[0,0]),"bottom-right":c.P.convert(m["bottom-right"]||[0,0]),left:c.P.convert(m.left||[0,0]),right:c.P.convert(m.right||[0,0])}}return Hl(new c.P(0,0))}const Vu=F;b.AJAXError=c.cz,b.Event=c.l,b.Evented=c.E,b.LngLat=c.S,b.MercatorCoordinate=c.a1,b.Point=c.P,b.addProtocol=c.cA,b.config=c.a,b.removeProtocol=c.cB,b.AttributionControl=Ru,b.BoxZoomHandler=Tu,b.CanvasSource=Dr,b.CooperativeGesturesHandler=Vd,b.DoubleClickZoomHandler=Bd,b.DragPanHandler=Du,b.DragRotateHandler=Od,b.EdgeInsets=Fa,b.FullscreenControl=class extends c.E{constructor(m={}){super(),this._onFullscreenChange=()=>{var e;let a=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=a==null?void 0:a.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)a=a.shadowRoot.fullscreenElement;a===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,m&&m.container&&(m.container instanceof HTMLElement?this._container=m.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=K.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){K.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const m=this._fullscreenButton=K.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);K.create("span","maplibregl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.title=m}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},b.GeoJSONSource=Rn,b.GeolocateControl=class extends c.E{constructor(m){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new c.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{const a=new c.S(e.coords.longitude,e.coords.latitude),l=e.coords.accuracy,h=this._map.getBearing(),f=c.e({bearing:h},this.options.fitBoundsOptions),_=ni.fromLngLat(a,l);this._map.fitBounds(_,f,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const a=new c.S(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=e.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=e=>{if(this._map){if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&to)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=K.create("button","maplibregl-ctrl-geolocate",this._container),K.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=K.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Wl({element:this._dotElement}),this._circleElement=K.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Wl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",a=>{const l=(a==null?void 0:a[0])instanceof ResizeObserverEntry;a.geolocateSource||this._watchState!=="ACTIVE_LOCK"||l||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.l("trackuserlocationend")),this.fire(new c.l("userlocationlostfocus")))})}},this.options=c.e({},Ds,m)}onAdd(m){return this._map=m,this._container=K.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return c._(this,arguments,void 0,function*(e=!1){if(Qa!==void 0&&!e)return Qa;if(window.navigator.permissions===void 0)return Qa=!!window.navigator.geolocation,Qa;try{Qa=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Qa=!!window.navigator.geolocation}return Qa})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),K.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,eo=0,to=!1}_isOutOfMapMaxBounds(m){const e=this._map.getMaxBounds(),a=m.coords;return e&&(a.longitude<e.getWest()||a.longitude>e.getEast()||a.latitude<e.getSouth()||a.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const m=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&m))return;const e=this._map.project(m),a=this._map.unproject([e.x+100,e.y]),l=m.distanceTo(a)/100,h=2*this._accuracy/l;this._circleElement.style.width=`${h.toFixed(2)}px`,this._circleElement.style.height=`${h.toFixed(2)}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":eo--,to=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.l("trackuserlocationstart")),this.fire(new c.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let m;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),eo++,eo>1?(m={maximumAge:6e5,timeout:0},to=!0):(m=this.options.positionOptions,to=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,m)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},b.GlobeControl=class{constructor(){this._toggleProjection=()=>{var m;const e=(m=this._map.getProjection())===null||m===void 0?void 0:m.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var m;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((m=this._map.getProjection())===null||m===void 0?void 0:m.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(m){return this._map=m,this._container=K.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=K.create("button","maplibregl-ctrl-globe",this._container),K.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){K.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},b.Hash=Xa,b.ImageSource=xn,b.KeyboardHandler=Mt,b.LngLatBounds=ni,b.LogoControl=Fu,b.Map=class extends Ul{constructor(m){var e,a;c.cw.mark(c.cx.create);const l=Object.assign(Object.assign(Object.assign({},mn),m),{canvasContextAttributes:Object.assign(Object.assign({},mn.canvasContextAttributes),m.canvasContextAttributes)});if(l.minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const h=new Zt,f=new dn;if(l.minZoom!==void 0&&h.setMinZoom(l.minZoom),l.maxZoom!==void 0&&h.setMaxZoom(l.maxZoom),l.minPitch!==void 0&&h.setMinPitch(l.minPitch),l.maxPitch!==void 0&&h.setMaxPitch(l.maxPitch),l.renderWorldCopies!==void 0&&h.setRenderWorldCopies(l.renderWorldCopies),super(h,f,{bearingSnap:l.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Ud,this._controls=[],this._mapId=c.a7(),this._contextLost=C=>{C.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new c.l("webglcontextlost",{originalEvent:C}))},this._contextRestored=C=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.l("webglcontextrestored",{originalEvent:C}))},this._onMapScroll=C=>{if(C.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=l.interactive,this._maxTileCacheSize=l.maxTileCacheSize,this._maxTileCacheZoomLevels=l.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},l.canvasContextAttributes),this._trackResize=l.trackResize===!0,this._bearingSnap=l.bearingSnap,this._centerClampedToGround=l.centerClampedToGround,this._refreshExpiredTiles=l.refreshExpiredTiles===!0,this._fadeDuration=l.fadeDuration,this._crossSourceCollisions=l.crossSourceCollisions===!0,this._collectResourceTiming=l.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},$d),l.locale),this._clickTolerance=l.clickTolerance,this._overridePixelRatio=l.pixelRatio,this._maxCanvasSize=l.maxCanvasSize,this.transformCameraUpdate=l.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=l.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=De.addThrottleControl(()=>this.isMoving()),this._requestManager=new Xe(l.transformRequest),typeof l.container=="string"){if(this._container=document.getElementById(l.container),!this._container)throw new Error(`Container '${l.container}' not found.`)}else{if(!(l.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(l.maxBounds&&this.setMaxBounds(l.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let C=!1;const I=Iu(k=>{this._trackResize&&!this._removed&&(this.resize(k),this.redraw())},50);this._resizeObserver=new ResizeObserver(k=>{C?I(k):C=!0}),this._resizeObserver.observe(this._container)}this.handlers=new sf(this,l),this._hash=l.hash&&new Xa(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,elevation:l.elevation,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch,roll:l.roll}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,c.e({},l.fitBoundsOptions,{duration:0}))));const _=typeof l.style=="string"||((a=(e=l.style)===null||e===void 0?void 0:e.projection)===null||a===void 0?void 0:a.type)!=="globe";this.resize(null,_),this._localIdeographFontFamily=l.localIdeographFontFamily,this._validateStyle=l.validateStyle,l.style&&this.setStyle(l.style,{localIdeographFontFamily:l.localIdeographFontFamily}),l.attributionControl&&this.addControl(new Ru(typeof l.attributionControl=="boolean"?void 0:l.attributionControl)),l.maplibreLogo&&this.addControl(new Fu,l.logoPosition),this.on("style.load",()=>{if(_||this._resizeTransform(),this.transform.unmodified){const C=c.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(C)}}),this.on("data",C=>{this._update(C.dataType==="style"),this.fire(new c.l(`${C.dataType}data`,C))}),this.on("dataloading",C=>{this.fire(new c.l(`${C.dataType}dataloading`,C))}),this.on("dataabort",C=>{this.fire(new c.l("sourcedataabort",C))})}_getMapId(){return this._mapId}setGlobalStateProperty(m,e){return this.style.setGlobalStateProperty(m,e),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(m,e){if(e===void 0&&(e=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new c.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const a=m.onAdd(this);this._controls.push(m);const l=this._controlPositions[e];return e.indexOf("bottom")!==-1?l.insertBefore(a,l.firstChild):l.appendChild(a),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new c.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(m);return e>-1&&this._controls.splice(e,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}coveringTiles(m){return ve(this.transform,m)}calculateCameraOptionsFromTo(m,e,a,l){return l==null&&this.terrain&&(l=this.terrain.getElevationForLngLatZoom(a,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(m,e,a,l)}resize(m,e=!0){const[a,l]=this._containerDimensions(),h=this._getClampedPixelRatio(a,l);if(this._resizeCanvas(a,l,h),this.painter.resize(a,l,h),this.painter.overLimit()){const _=this.painter.context.gl;this._maxCanvasSize=[_.drawingBufferWidth,_.drawingBufferHeight];const C=this._getClampedPixelRatio(a,l);this._resizeCanvas(a,l,C),this.painter.resize(a,l,C)}this._resizeTransform(e);const f=!this._moving;return f&&(this.stop(),this.fire(new c.l("movestart",m)).fire(new c.l("move",m))),this.fire(new c.l("resize",m)),f&&this.fire(new c.l("moveend",m)),this}_resizeTransform(m=!0){var e;const[a,l]=this._containerDimensions();this.transform.resize(a,l,m),(e=this._requestedCameraState)===null||e===void 0||e.resize(a,l,m)}_getClampedPixelRatio(m,e){const{0:a,1:l}=this._maxCanvasSize,h=this.getPixelRatio(),f=m*h,_=e*h;return Math.min(f>a?a/f:1,_>l?l/_:1)*h}getPixelRatio(){var m;return(m=this._overridePixelRatio)!==null&&m!==void 0?m:devicePixelRatio}setPixelRatio(m){this._overridePixelRatio=m,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(m){return this.transform.setMaxBounds(ni.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.setMinZoom(m),this._update(),this.getZoom()<m&&this.setZoom(m),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.setMaxZoom(m),this._update(),this.getZoom()>m&&this.setZoom(m),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.setMinPitch(m),this._update(),this.getPitch()<m&&this.setPitch(m),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(m>=this.transform.minPitch)return this.transform.setMaxPitch(m),this._update(),this.getPitch()>m&&this.setPitch(m),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.setRenderWorldCopies(m),this._update()}project(m){return this.transform.locationToScreenPoint(c.S.convert(m),this.style&&this.terrain)}unproject(m){return this.transform.screenPointToLocation(c.P.convert(m),this.terrain)}isMoving(){var m;return this._moving||((m=this.handlers)===null||m===void 0?void 0:m.isMoving())}isZooming(){var m;return this._zooming||((m=this.handlers)===null||m===void 0?void 0:m.isZooming())}isRotating(){var m;return this._rotating||((m=this.handlers)===null||m===void 0?void 0:m.isRotating())}_createDelegatedListener(m,e,a){if(m==="mouseenter"||m==="mouseover"){let l=!1;return{layers:e,listener:a,delegates:{mousemove:f=>{const _=e.filter(I=>this.getLayer(I)),C=_.length!==0?this.queryRenderedFeatures(f.point,{layers:_}):[];C.length?l||(l=!0,a.call(this,new Bn(m,this,f.originalEvent,{features:C}))):l=!1},mouseout:()=>{l=!1}}}}if(m==="mouseleave"||m==="mouseout"){let l=!1;return{layers:e,listener:a,delegates:{mousemove:_=>{const C=e.filter(I=>this.getLayer(I));(C.length!==0?this.queryRenderedFeatures(_.point,{layers:C}):[]).length?l=!0:l&&(l=!1,a.call(this,new Bn(m,this,_.originalEvent)))},mouseout:_=>{l&&(l=!1,a.call(this,new Bn(m,this,_.originalEvent)))}}}}{const l=h=>{const f=e.filter(C=>this.getLayer(C)),_=f.length!==0?this.queryRenderedFeatures(h.point,{layers:f}):[];_.length&&(h.features=_,a.call(this,h),delete h.features)};return{layers:e,listener:a,delegates:{[m]:l}}}}_saveDelegatedListener(m,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(e)}_removeDelegatedListener(m,e,a){if(!this._delegatedListeners||!this._delegatedListeners[m])return;const l=this._delegatedListeners[m];for(let h=0;h<l.length;h++){const f=l[h];if(f.listener===a&&f.layers.length===e.length&&f.layers.every(_=>e.includes(_))){for(const _ in f.delegates)this.off(_,f.delegates[_]);return void l.splice(h,1)}}}on(m,e,a){if(a===void 0)return super.on(m,e);const l=typeof e=="string"?[e]:e,h=this._createDelegatedListener(m,l,a);this._saveDelegatedListener(m,h);for(const f in h.delegates)this.on(f,h.delegates[f]);return{unsubscribe:()=>{this._removeDelegatedListener(m,l,a)}}}once(m,e,a){if(a===void 0)return super.once(m,e);const l=typeof e=="string"?[e]:e,h=this._createDelegatedListener(m,l,a);for(const f in h.delegates){const _=h.delegates[f];h.delegates[f]=(...C)=>{this._removeDelegatedListener(m,l,a),_(...C)}}this._saveDelegatedListener(m,h);for(const f in h.delegates)this.once(f,h.delegates[f]);return this}off(m,e,a){return a===void 0?super.off(m,e):(this._removeDelegatedListener(m,typeof e=="string"?[e]:e,a),this)}queryRenderedFeatures(m,e){if(!this.style)return[];let a;const l=m instanceof c.P||Array.isArray(m),h=l?m:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(l?{}:m)||{},h instanceof c.P||typeof h[0]=="number")a=[c.P.convert(h)];else{const f=c.P.convert(h[0]),_=c.P.convert(h[1]);a=[f,new c.P(_.x,f.y),_,new c.P(f.x,_.y),f]}return this.style.queryRenderedFeatures(a,e,this.transform)}querySourceFeatures(m,e){return this.style.querySourceFeatures(m,e)}setStyle(m,e){return(e=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&m?(this._diffStyle(m,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(m,e))}setTransformRequest(m){return this._requestManager.setTransformRequest(m),this}_getUIString(m){const e=this._locale[m];if(e==null)throw new Error(`Missing UI string '${m}'`);return e}_updateStyle(m,e){var a,l;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(m,e));const h=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!m)),m?(this.style=new tu(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof m=="string"?this.style.loadURL(m,e,h):this.style.loadJSON(m,e,h),this):((l=(a=this.style)===null||a===void 0?void 0:a.projection)===null||l===void 0||l.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new tu(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(m,e){if(typeof m=="string"){const a=this._requestManager.transformRequest(m,"Style");c.j(a,new AbortController).then(l=>{this._updateDiff(l.data,e)}).catch(l=>{l&&this.fire(new c.k(l))})}else typeof m=="object"&&this._updateDiff(m,e)}_updateDiff(m,e){try{this.style.setState(m,e)&&this._update(!0)}catch(a){c.w(`Unable to perform style diff: ${a.message||a.error||a}.  Rebuilding the style from scratch.`),this._updateStyle(m,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(m,e){return this._lazyInitEmptyStyle(),this.style.addSource(m,e),this._update(!0)}isSourceLoaded(m){const e=this.style&&this.style.sourceCaches[m];if(e!==void 0)return e.loaded();this.fire(new c.k(new Error(`There is no source with ID '${m}'`)))}setTerrain(m){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),m){const e=this.style.sourceCaches[m.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${m.source}`);this.terrain===null&&e.reload();for(const a in this.style._layers){const l=this.style._layers[a];l.type==="hillshade"&&l.source===m.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),l.type==="color-relief"&&l.source===m.source&&c.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Zl(this.painter,e,m),this.painter.renderToTexture=new Ns(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=a=>{var l;a.dataType==="style"?this.terrain.sourceCache.freeRtt():a.dataType==="source"&&a.tile&&(a.sourceId!==m.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((l=a.source)===null||l===void 0?void 0:l.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(a.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new c.l("terrain",{terrain:m})),this}getTerrain(){var m,e;return(e=(m=this.terrain)===null||m===void 0?void 0:m.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const m=this.style&&this.style.sourceCaches;for(const e in m){const a=m[e]._tiles;for(const l in a){const h=a[l];if(h.state!=="loaded"&&h.state!=="errored")return!1}}return!0}removeSource(m){return this.style.removeSource(m),this._update(!0)}getSource(m){return this.style.getSource(m)}setSourceTileLodParams(m,e,a){if(a){const l=this.getSource(a);if(!l)throw new Error(`There is no source with ID "${a}", cannot set LOD parameters`);l.calculateTileZoom=Fe(Math.max(1,m),Math.max(1,e))}else for(const l in this.style.sourceCaches)this.style.sourceCaches[l].getSource().calculateTileZoom=Fe(Math.max(1,m),Math.max(1,e));return this._update(!0),this}refreshTiles(m,e){const a=this.style.sourceCaches[m];if(!a)throw new Error(`There is no source cache with ID "${m}", cannot refresh tile`);e===void 0?a.reload(!0):a.refreshTiles(e.map(l=>new c.a4(l.z,l.x,l.y)))}addImage(m,e,a={}){const{pixelRatio:l=1,sdf:h=!1,stretchX:f,stretchY:_,content:C,textFitWidth:I,textFitHeight:k}=a;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||c.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:M,height:N,data:z}=e,L=e;return this.style.addImage(m,{data:new c.R({width:M,height:N},new Uint8Array(z)),pixelRatio:l,stretchX:f,stretchY:_,content:C,textFitWidth:I,textFitHeight:k,sdf:h,version:0,userImage:L}),L.onAdd&&L.onAdd(this,m),this}}{const{width:M,height:N,data:z}=ce.getImageData(e);this.style.addImage(m,{data:new c.R({width:M,height:N},z),pixelRatio:l,stretchX:f,stretchY:_,content:C,textFitWidth:I,textFitHeight:k,sdf:h,version:0})}}updateImage(m,e){const a=this.style.getImage(m);if(!a)return this.fire(new c.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const l=e instanceof HTMLImageElement||c.b(e)?ce.getImageData(e):e,{width:h,height:f,data:_}=l;if(h===void 0||f===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(h!==a.data.width||f!==a.data.height)return this.fire(new c.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const C=!(e instanceof HTMLImageElement||c.b(e));return a.data.replace(_,C),this.style.updateImage(m,a),this}getImage(m){return this.style.getImage(m)}hasImage(m){return m?!!this.style.getImage(m):(this.fire(new c.k(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m){return De.getImage(this._requestManager.transformRequest(m,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(m,e){return this._lazyInitEmptyStyle(),this.style.addLayer(m,e),this._update(!0)}moveLayer(m,e){return this.style.moveLayer(m,e),this._update(!0)}removeLayer(m){return this.style.removeLayer(m),this._update(!0)}getLayer(m){return this.style.getLayer(m)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(m,e,a){return this.style.setLayerZoomRange(m,e,a),this._update(!0)}setFilter(m,e,a={}){return this.style.setFilter(m,e,a),this._update(!0)}getFilter(m){return this.style.getFilter(m)}setPaintProperty(m,e,a,l={}){return this.style.setPaintProperty(m,e,a,l),this._update(!0)}getPaintProperty(m,e){return this.style.getPaintProperty(m,e)}setLayoutProperty(m,e,a,l={}){return this.style.setLayoutProperty(m,e,a,l),this._update(!0)}getLayoutProperty(m,e){return this.style.getLayoutProperty(m,e)}setGlyphs(m,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(m,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(m,e,a={}){return this._lazyInitEmptyStyle(),this.style.addSprite(m,e,a,l=>{l||this._update(!0)}),this}removeSprite(m){return this._lazyInitEmptyStyle(),this.style.removeSprite(m),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(m,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(m,e,a=>{a||this._update(!0)}),this}setLight(m,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(m,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(m,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(m,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(m,e){return this.style.setFeatureState(m,e),this._update()}removeFeatureState(m,e){return this.style.removeFeatureState(m,e),this._update()}getFeatureState(m){return this.style.getFeatureState(m)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let m=0,e=0;return this._container&&(m=this._container.clientWidth||400,e=this._container.clientHeight||300),[m,e]}_setupContainer(){const m=this._container;m.classList.add("maplibregl-map");const e=this._canvasContainer=K.create("div","maplibregl-canvas-container",m);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=K.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const a=this._containerDimensions(),l=this._getClampedPixelRatio(a[0],a[1]);this._resizeCanvas(a[0],a[1],l);const h=this._controlContainer=K.create("div","maplibregl-control-container",m),f=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(_=>{f[_]=K.create("div",`maplibregl-ctrl-${_} `,h)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,e,a){this._canvas.width=Math.floor(a*m),this._canvas.height=Math.floor(a*e),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const m=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",l=>{e={requestedAttributes:m},l&&(e.statusMessage=l.statusMessage,e.type=l.type)},{once:!0});let a=null;if(a=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,m):this._canvas.getContext("webgl2",m)||this._canvas.getContext("webgl",m),!a){const l="Failed to initialize WebGL";throw e?(e.message=l,new Error(JSON.stringify(e))):new Error(l)}this.painter=new Ll(a,this.transform),Ie.testSupport(a)}migrateProjection(m,e){super.migrateProjection(m,e),this.painter.transform=m,this.fire(new c.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(m){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_render(m){var e,a,l,h,f;const _=this._idleTriggered?this._fadeDuration:0,C=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(m),this._removed)return;let I=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const N=this.transform.zoom,z=ce.now();this.style.zoomHistory.update(N,z);const L=new c.F(N,{now:z,fadeDuration:_,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),U=L.crossFadingFactor();U===1&&U===this._crossFadingFactor||(I=!0,this._crossFadingFactor=U),this.style.update(L)}const k=((a=this.style.projection)===null||a===void 0?void 0:a.transitionState)>0!==C;(l=this.style.projection)===null||l===void 0||l.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((h=this.style.projection)===null||h===void 0?void 0:h.transitionState,(f=this.style.projection)===null||f===void 0?void 0:f.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||k)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,_,this._crossSourceCollisions,k),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:_,showPadding:this.showPadding}),this.fire(new c.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.cw.mark(c.cx.load),this.fire(new c.l("load"))),this.style&&(this.style.hasTransitions()||I)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const M=this._sourcesDirty||this._styleDirty||this._placementDirty;return M||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.l("idle")),!this._loaded||this._fullyLoaded||M||(this._fullyLoaded=!0,c.cw.mark(c.cx.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var m;this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),De.removeThrottleControl(this._imageQueueHandle),(m=this._resizeObserver)===null||m===void 0||m.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e!=null&&e.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),K.remove(this._canvasContainer),K.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),c.cw.clearMetrics(),this._removed=!0,this.fire(new c.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,ce.frame(this._frameRequest,m=>{c.cw.frame(m),this._frameRequest=null;try{this._render(m)}catch(e){if(!c.cy(e)&&!function(a){return a.message===Cs}(e))throw e}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get version(){return Gl}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(m){return this._lazyInitEmptyStyle(),this.style.setProjection(m),this._update(!0)}},b.MapMouseEvent=Bn,b.MapTouchEvent=Mo,b.MapWheelEvent=Su,b.Marker=Wl,b.NavigationControl=class{constructor(m){this._updateZoomButtons=()=>{const e=this._map.getZoom(),a=e===this._map.getMaxZoom(),l=e===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=l,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",l.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,a)=>{const l=this._map._getUIString(`NavigationControl.${a}`);e.title=l,e.setAttribute("aria-label",l)},this.options=c.e({},Zd,m),this._container=K.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),K.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),K.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=K.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Cr(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){K.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(m,e){const a=K.create("button",m,this._container);return a.type="button",a.addEventListener("click",e),a}},b.Popup=class extends c.E{constructor(m){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&K.remove(this._content),this._container&&(K.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=K.create("div","maplibregl-popup",this._map.getContainer()),this._tip=K.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const _ of this.options.className.split(" "))this._container.classList.add(_);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=Do(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!e)return;const a=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let l=this.options.anchor;const h=Hl(this.options.offset);if(!l){const _=this._container.offsetWidth,C=this._container.offsetHeight;let I;I=a.y+h.bottom.y<C?["top"]:a.y>this._map.transform.height-C?["bottom"]:[],a.x<_/2?I.push("left"):a.x>this._map.transform.width-_/2&&I.push("right"),l=I.length===0?"bottom":I.join("-")}let f=a.add(h[l]);this.options.subpixelPositioning||(f=f.round()),K.setTransform(this._container,`${Yt[l]} translate(${f.x}px,${f.y}px)`),mi(this._container,l,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(ju),m)}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(m){return this._lngLat=c.S.convert(m),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(document.createTextNode(m))}setHTML(m){const e=document.createDocumentFragment(),a=document.createElement("body");let l;for(a.innerHTML=m;l=a.firstChild,l;)e.appendChild(l);return this.setDOMContent(e)}getMaxWidth(){var m;return(m=this._container)===null||m===void 0?void 0:m.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=K.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(m),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(m){return this._container&&this._container.classList.add(m),this}removeClassName(m){return this._container&&this._container.classList.remove(m),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){if(this._container)return this._container.classList.toggle(m)}setSubpixelPositioning(m){this.options.subpixelPositioning=m}_createCloseButton(){this.options.closeButton&&(this._closeButton=K.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(Ou);m&&m.focus()}},b.RasterDEMTileSource=Ln,b.RasterTileSource=Wn,b.ScaleControl=class{constructor(m){this._onMove=()=>{ql(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,ql(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Bu),m)}getDefaultPosition(){return"bottom-left"}onAdd(m){return this._map=m,this._container=K.create("div","maplibregl-ctrl maplibregl-ctrl-scale",m.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){K.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},b.ScrollZoomHandler=Fd,b.Style=tu,b.TerrainControl=class{constructor(m){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=m}onAdd(m){return this._map=m,this._container=K.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=K.create("button","maplibregl-ctrl-terrain",this._container),K.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){K.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},b.TwoFingersTouchPitchHandler=No,b.TwoFingersTouchRotateHandler=ku,b.TwoFingersTouchZoomHandler=Pu,b.TwoFingersTouchZoomRotateHandler=Lu,b.VectorTileSource=Dn,b.VideoSource=yr,b.addSourceType=(m,e)=>c._(void 0,void 0,void 0,function*(){if(Rr(m))throw new Error(`A source type called "${m}" already exists.`);((a,l)=>{Lr[a]=l})(m,e)}),b.clearPrewarmedResources=function(){const m=qi;m&&(m.isPreloaded()&&m.numActive()===1?(m.release(yt),qi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},b.createTileMesh=Qc,b.getMaxParallelImageRequests=function(){return c.a.MAX_PARALLEL_IMAGE_REQUESTS},b.getRTLTextPluginStatus=function(){return Gt().getRTLTextPluginStatus()},b.getVersion=function(){return Vu},b.getWorkerCount=function(){return At.workerCount},b.getWorkerUrl=function(){return c.a.WORKER_URL},b.importScriptInWorkers=function(m){return zn().broadcast("IS",m)},b.prewarm=function(){En().acquire(yt)},b.setMaxParallelImageRequests=function(m){c.a.MAX_PARALLEL_IMAGE_REQUESTS=m},b.setRTLTextPlugin=function(m,e){return Gt().setRTLTextPlugin(m,e)},b.setWorkerCount=function(m){At.workerCount=m},b.setWorkerUrl=function(m){c.a.WORKER_URL=m}});var S=d;return S})})(aw);var tT=aw.exports;const Pp=S0(tT);const iT=()=>$("div",{className:"absolute bottom-4 left-4 bg-white rounded-lg shadow-lg p-4 w-64 z-10",children:[A("h3",{className:"font-bold text-lg mb-3",children:"Map Legend"}),A("div",{className:"space-y-2",children:[{color:"bg-green-500",label:"Approved Claims",opacity:"opacity-50"},{color:"bg-yellow-500",label:"Pending Claims",opacity:"opacity-50"},{color:"bg-purple-500",label:"Farm Plots",opacity:"opacity-40"},{color:"bg-green-700",label:"Forest Areas",opacity:"opacity-60"},{color:"bg-blue-500",label:"Water Bodies",opacity:"opacity-70"},{color:"bg-red-500",label:"Wells",opacity:"opacity-100"},{color:"bg-orange-500",label:"Homesteads",opacity:"opacity-100"},{color:"bg-gray-500",label:"Roads",opacity:"opacity-100"},{color:"bg-blue-500 border-2 border-dashed",label:"Streams",opacity:"opacity-100"},{color:"bg-blue-500 border-2 border-dotted",label:"Village Boundaries",opacity:"opacity-100"}].map((o,d)=>$("div",{className:"flex items-center",children:[A("div",{className:`w-4 h-4 ${o.color} ${o.opacity} mr-2`}),A("span",{className:"text-sm text-gray-700",children:o.label})]},d))}),$("div",{className:"mt-4 pt-3 border-t border-gray-200",children:[A("h4",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2",children:"Status Indicators"}),$("div",{className:"flex space-x-2",children:[A("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Approved/Granted"}),A("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"Pending"})]})]}),A("div",{className:"mt-3 text-xs text-gray-500",children:A("p",{children:"Click on features to view details"})})]}),nT=({map:i})=>{const[o,d]=Me.useState([{id:"claims",name:"Forest Claims",visible:!0,opacity:1,layerIds:["patta-boundaries-approved","patta-boundaries-pending","patta-b-boundaries-approved","patta-c-boundaries-approved","patta-c-boundaries-pending","patta-boundaries-outline","patta-b-boundaries-outline","patta-c-boundaries-outline"]},{id:"boundaries",name:"Village Boundaries",visible:!0,opacity:1,layerIds:["village-boundaries","village-b-boundaries","village-c-boundaries"]},{id:"farms",name:"Farm Plots",visible:!0,opacity:1,layerIds:["farm-plots","farm-c-plots"]},{id:"forests",name:"Forest Areas",visible:!0,opacity:1,layerIds:["forest-areas"]},{id:"water",name:"Water Bodies",visible:!0,opacity:1,layerIds:["water-bodies","water-c-bodies"]},{id:"infrastructure",name:"Infrastructure",visible:!0,opacity:1,layerIds:["wells","wells-c","homesteads","streams","roads"]}]);Me.useEffect(()=>{i&&o.forEach(S=>{S.layerIds.forEach(b=>{var c,F,W;try{i.getLayer(b)&&(i.setLayoutProperty(b,"visibility",S.visible?"visible":"none"),((c=i.getLayer(b))==null?void 0:c.type)==="fill"?i.setPaintProperty(b,"fill-opacity",S.visible?S.opacity*(b.includes("boundaries")?1:.5):0):((F=i.getLayer(b))==null?void 0:F.type)==="line"?i.setPaintProperty(b,"line-opacity",S.visible?S.opacity:0):((W=i.getLayer(b))==null?void 0:W.type)==="circle"&&i.setPaintProperty(b,"circle-opacity",S.visible?S.opacity:0))}catch(se){console.warn(`Could not update layer ${b}:`,se)}})})},[o,i]);const y=S=>{d(o.map(b=>b.id===S?{...b,visible:!b.visible}:b))},x=(S,b)=>{d(o.map(c=>c.id===S?{...c,opacity:b}:c))};return i?$("div",{className:"absolute top-4 left-4 bg-white rounded-lg shadow-lg p-4 w-64 z-10",children:[A("h3",{className:"font-bold text-lg mb-3",children:"Map Layers"}),A("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:o.map(S=>$("div",{className:"border-b pb-2 last:border-b-0",children:[A("div",{className:"flex items-center justify-between",children:$("label",{className:"flex items-center space-x-2",children:[A("input",{type:"checkbox",checked:S.visible,onChange:()=>y(S.id),className:"rounded text-indigo-600 focus:ring-indigo-500"}),A("span",{className:"text-sm font-medium text-gray-700",children:S.name})]})}),S.visible&&$("div",{className:"mt-2 flex items-center space-x-2",children:[A("span",{className:"text-xs text-gray-500",children:"Opacity:"}),A("input",{type:"range",min:"0",max:"1",step:"0.1",value:S.opacity,onChange:b=>x(S.id,parseFloat(b.target.value)),className:"w-full"}),$("span",{className:"text-xs text-gray-500 w-8",children:[Math.round(S.opacity*100),"%"]})]})]},S.id))})]}):null},rT="data:application/geo+json;base64,ew0KICAidHlwZSI6ICJGZWF0dXJlQ29sbGVjdGlvbiIsDQogICJmZWF0dXJlcyI6IFsNCiAgICB7DQogICAgICAidHlwZSI6ICJGZWF0dXJlIiwNCiAgICAgICJwcm9wZXJ0aWVzIjogew0KICAgICAgICAiaWQiOiAiYm91bmRhcnktYSIsDQogICAgICAgICJuYW1lIjogIlZpbGxhZ2UgQSBCb3VuZGFyeSIsDQogICAgICAgICJ0eXBlIjogImFkbWluaXN0cmF0aXZlX2JvdW5kYXJ5Ig0KICAgICAgfSwNCiAgICAgICJnZW9tZXRyeSI6IHsNCiAgICAgICAgInR5cGUiOiAiUG9seWdvbiIsDQogICAgICAgICJjb29yZGluYXRlcyI6IFtbDQogICAgICAgICAgWzc4LjQ1LCAxNy4xMl0sDQogICAgICAgICAgWzc4LjQ3LCAxNy4xMl0sDQogICAgICAgICAgWzc4LjQ3LCAxNy4xNF0sDQogICAgICAgICAgWzc4LjQ1LCAxNy4xNF0sDQogICAgICAgICAgWzc4LjQ1LCAxNy4xMl0NCiAgICAgICAgXV0NCiAgICAgIH0NCiAgICB9LA0KICAgIHsNCiAgICAgICJ0eXBlIjogIkZlYXR1cmUiLA0KICAgICAgInByb3BlcnRpZXMiOiB7DQogICAgICAgICJpZCI6ICJwYXR0YS0wMDEiLA0KICAgICAgICAibmFtZSI6ICJQYXR0YSAwMDEiLA0KICAgICAgICAiaG9sZGVyX25hbWUiOiAiUmFtIFByYXNhZCIsDQogICAgICAgICJob2xkZXJfdHlwZSI6ICJpbmRpdmlkdWFsIiwNCiAgICAgICAgInN0YXR1cyI6ICJncmFudGVkIiwNCiAgICAgICAgImNsYWltZWRfZGF0ZSI6ICIyMDIzLTAxLTE1IiwNCiAgICAgICAgImdyYW50ZWRfZGF0ZSI6ICIyMDIzLTAzLTIyIiwNCiAgICAgICAgInJlbGF0ZWRfZG9jcyI6IFsiZG9jLTEucGRmIiwgIm1hcC0xLnNocCJdDQogICAgICB9LA0KICAgICAgImdlb21ldHJ5Ijogew0KICAgICAgICAidHlwZSI6ICJQb2x5Z29uIiwNCiAgICAgICAgImNvb3JkaW5hdGVzIjogW1sNCiAgICAgICAgICBbNzguNDUyLCAxNy4xMjJdLA0KICAgICAgICAgIFs3OC40NTgsIDE3LjEyMl0sDQogICAgICAgICAgWzc4LjQ1OCwgMTcuMTI4XSwNCiAgICAgICAgICBbNzguNDUyLCAxNy4xMjhdLA0KICAgICAgICAgIFs3OC40NTIsIDE3LjEyMl0NCiAgICAgICAgXV0NCiAgICAgIH0NCiAgICB9LA0KICAgIHsNCiAgICAgICJ0eXBlIjogIkZlYXR1cmUiLA0KICAgICAgInByb3BlcnRpZXMiOiB7DQogICAgICAgICJpZCI6ICJwYXR0YS0wMDIiLA0KICAgICAgICAibmFtZSI6ICJQYXR0YSAwMDIiLA0KICAgICAgICAiaG9sZGVyX25hbWUiOiAiU2l0YSBEZXZpIiwNCiAgICAgICAgImhvbGRlcl90eXBlIjogImluZGl2aWR1YWwiLA0KICAgICAgICAic3RhdHVzIjogInBlbmRpbmciLA0KICAgICAgICAiY2xhaW1lZF9kYXRlIjogIjIwMjMtMDItMTAiLA0KICAgICAgICAiZ3JhbnRlZF9kYXRlIjogbnVsbCwNCiAgICAgICAgInJlbGF0ZWRfZG9jcyI6IFsiZG9jLTIucGRmIl0NCiAgICAgIH0sDQogICAgICAiZ2VvbWV0cnkiOiB7DQogICAgICAgICJ0eXBlIjogIlBvbHlnb24iLA0KICAgICAgICAiY29vcmRpbmF0ZXMiOiBbWw0KICAgICAgICAgIFs3OC40NjIsIDE3LjEzMl0sDQogICAgICAgICAgWzc4LjQ2OCwgMTcuMTMyXSwNCiAgICAgICAgICBbNzguNDY4LCAxNy4xMzhdLA0KICAgICAgICAgIFs3OC40NjIsIDE3LjEzOF0sDQogICAgICAgICAgWzc4LjQ2MiwgMTcuMTMyXQ0KICAgICAgICBdXQ0KICAgICAgfQ0KICAgIH0sDQogICAgew0KICAgICAgInR5cGUiOiAiRmVhdHVyZSIsDQogICAgICAicHJvcGVydGllcyI6IHsNCiAgICAgICAgImlkIjogImZhcm0tMDAxIiwNCiAgICAgICAgIm5hbWUiOiAiRmFybSBQbG90IEEiLA0KICAgICAgICAibGFuZF9pZCI6ICJmYXJtLWEiLA0KICAgICAgICAib3duZXJfcGF0dGEiOiAicGF0dGEtMDAxIiwNCiAgICAgICAgImFyZWFfaGEiOiAyLjMsDQogICAgICAgICJjcm9wX3R5cGUiOiAicmljZSIsDQogICAgICAgICJuZHZpIjogMC43NSwNCiAgICAgICAgImlycmlnYXRpb24iOiAiYm9yZXdlbGwiDQogICAgICB9LA0KICAgICAgImdlb21ldHJ5Ijogew0KICAgICAgICAidHlwZSI6ICJQb2x5Z29uIiwNCiAgICAgICAgImNvb3JkaW5hdGVzIjogW1sNCiAgICAgICAgICBbNzguNDUzLCAxNy4xMjNdLA0KICAgICAgICAgIFs3OC40NTcsIDE3LjEyM10sDQogICAgICAgICAgWzc4LjQ1NywgMTcuMTI3XSwNCiAgICAgICAgICBbNzguNDUzLCAxNy4xMjddLA0KICAgICAgICAgIFs3OC40NTMsIDE3LjEyM10NCiAgICAgICAgXV0NCiAgICAgIH0NCiAgICB9LA0KICAgIHsNCiAgICAgICJ0eXBlIjogIkZlYXR1cmUiLA0KICAgICAgInByb3BlcnRpZXMiOiB7DQogICAgICAgICJpZCI6ICJwb25kLTAwMSIsDQogICAgICAgICJuYW1lIjogIkNvbW11bml0eSBQb25kIiwNCiAgICAgICAgInBvbmRfaWQiOiAicG9uZC1hIiwNCiAgICAgICAgImF2Z19kZXB0aF9tIjogMy4yLA0KICAgICAgICAiYXJlYV9oYSI6IDAuNSwNCiAgICAgICAgIndhdGVyX2luZGV4IjogMC44NQ0KICAgICAgfSwNCiAgICAgICJnZW9tZXRyeSI6IHsNCiAgICAgICAgInR5cGUiOiAiUG9seWdvbiIsDQogICAgICAgICJjb29yZGluYXRlcyI6IFtbDQogICAgICAgICAgWzc4LjQ2MywgMTcuMTMzXSwNCiAgICAgICAgICBbNzguNDY1LCAxNy4xMzNdLA0KICAgICAgICAgIFs3OC40NjUsIDE3LjEzNV0sDQogICAgICAgICAgWzc4LjQ2MywgMTcuMTM1XSwNCiAgICAgICAgICBbNzguNDYzLCAxNy4xMzNdDQogICAgICAgIF1dDQogICAgICB9DQogICAgfSwNCiAgICB7DQogICAgICAidHlwZSI6ICJGZWF0dXJlIiwNCiAgICAgICJwcm9wZXJ0aWVzIjogew0KICAgICAgICAiaWQiOiAid2VsbC0wMDEiLA0KICAgICAgICAibmFtZSI6ICJCb3Jld2VsbCAjMTIzIiwNCiAgICAgICAgIndlbGxfaWQiOiAid2VsbC0xMjMiLA0KICAgICAgICAiZGVwdGhfbSI6IDQ1LA0KICAgICAgICAibGFzdF9yZXBhaXJlZF9kYXRlIjogIjIwMjItMTEtMTUiDQogICAgICB9LA0KICAgICAgImdlb21ldHJ5Ijogew0KICAgICAgICAidHlwZSI6ICJQb2ludCIsDQogICAgICAgICJjb29yZGluYXRlcyI6IFs3OC40NTUsIDE3LjEyNV0NCiAgICAgIH0NCiAgICB9DQogIF0NCn0=",aT="data:application/geo+json;base64,ew0KICAidHlwZSI6ICJGZWF0dXJlQ29sbGVjdGlvbiIsDQogICJmZWF0dXJlcyI6IFsNCiAgICB7DQogICAgICAidHlwZSI6ICJGZWF0dXJlIiwNCiAgICAgICJwcm9wZXJ0aWVzIjogew0KICAgICAgICAiaWQiOiAiYm91bmRhcnktYiIsDQogICAgICAgICJuYW1lIjogIlZpbGxhZ2UgQiBCb3VuZGFyeSIsDQogICAgICAgICJ0eXBlIjogImFkbWluaXN0cmF0aXZlX2JvdW5kYXJ5Ig0KICAgICAgfSwNCiAgICAgICJnZW9tZXRyeSI6IHsNCiAgICAgICAgInR5cGUiOiAiUG9seWdvbiIsDQogICAgICAgICJjb29yZGluYXRlcyI6IFtbDQogICAgICAgICAgWzc4LjU1LCAxNy4yMl0sDQogICAgICAgICAgWzc4LjU3LCAxNy4yMl0sDQogICAgICAgICAgWzc4LjU3LCAxNy4yNF0sDQogICAgICAgICAgWzc4LjU1LCAxNy4yNF0sDQogICAgICAgICAgWzc4LjU1LCAxNy4yMl0NCiAgICAgICAgXV0NCiAgICAgIH0NCiAgICB9LA0KICAgIHsNCiAgICAgICJ0eXBlIjogIkZlYXR1cmUiLA0KICAgICAgInByb3BlcnRpZXMiOiB7DQogICAgICAgICJpZCI6ICJwYXR0YS0wMDMiLA0KICAgICAgICAibmFtZSI6ICJQYXR0YSAwMDMiLA0KICAgICAgICAiaG9sZGVyX25hbWUiOiAiQ29tbXVuaXR5IENvdW5jaWwiLA0KICAgICAgICAiaG9sZGVyX3R5cGUiOiAiY29tbXVuaXR5IiwNCiAgICAgICAgInN0YXR1cyI6ICJncmFudGVkIiwNCiAgICAgICAgImNsYWltZWRfZGF0ZSI6ICIyMDIyLTExLTA1IiwNCiAgICAgICAgImdyYW50ZWRfZGF0ZSI6ICIyMDIzLTAyLTE4IiwNCiAgICAgICAgInJlbGF0ZWRfZG9jcyI6IFsiZG9jLTMucGRmIiwgIm1hcC0yLnNocCJdDQogICAgICB9LA0KICAgICAgImdlb21ldHJ5Ijogew0KICAgICAgICAidHlwZSI6ICJQb2x5Z29uIiwNCiAgICAgICAgImNvb3JkaW5hdGVzIjogW1sNCiAgICAgICAgICBbNzguNTUyLCAxNy4yMjJdLA0KICAgICAgICAgIFs3OC41NjgsIDE3LjIyMl0sDQogICAgICAgICAgWzc4LjU2OCwgMTcuMjM4XSwNCiAgICAgICAgICBbNzguNTUyLCAxNy4yMzhdLA0KICAgICAgICAgIFs3OC41NTIsIDE3LjIyMl0NCiAgICAgICAgXV0NCiAgICAgIH0NCiAgICB9LA0KICAgIHsNCiAgICAgICJ0eXBlIjogIkZlYXR1cmUiLA0KICAgICAgInByb3BlcnRpZXMiOiB7DQogICAgICAgICJpZCI6ICJmb3Jlc3QtMDAxIiwNCiAgICAgICAgIm5hbWUiOiAiRGVjaWR1b3VzIEZvcmVzdCIsDQogICAgICAgICJmb3Jlc3RfaWQiOiAiZm9yZXN0LWIiLA0KICAgICAgICAiY2Fub3B5X3BjdCI6IDc4LA0KICAgICAgICAic3BlY2llc19zdW1tYXJ5IjogIlRlYWssIEJhbWJvbywgTmVlbSINCiAgICAgIH0sDQogICAgICAiZ2VvbWV0cnkiOiB7DQogICAgICAgICJ0eXBlIjogIlBvbHlnb24iLA0KICAgICAgICAiY29vcmRpbmF0ZXMiOiBbWw0KICAgICAgICAgIFs3OC41NTUsIDE3LjIyNV0sDQogICAgICAgICAgWzc4LjU2NSwgMTcuMjI1XSwNCiAgICAgICAgICBbNzguNTY1LCAxNy4yMzVdLA0KICAgICAgICAgIFs3OC41NTUsIDE3LjIzNV0sDQogICAgICAgICAgWzc4LjU1NSwgMTcuMjI1XQ0KICAgICAgICBdXQ0KICAgICAgfQ0KICAgIH0sDQogICAgew0KICAgICAgInR5cGUiOiAiRmVhdHVyZSIsDQogICAgICAicHJvcGVydGllcyI6IHsNCiAgICAgICAgImlkIjogInN0cmVhbS0wMDEiLA0KICAgICAgICAibmFtZSI6ICJTZWFzb25hbCBTdHJlYW0iLA0KICAgICAgICAic3RyZWFtX2lkIjogInN0cmVhbS1iIiwNCiAgICAgICAgInBlcmVubmlhbF9ib29sZWFuIjogZmFsc2UNCiAgICAgIH0sDQogICAgICAiZ2VvbWV0cnkiOiB7DQogICAgICAgICJ0eXBlIjogIkxpbmVTdHJpbmciLA0KICAgICAgICAiY29vcmRpbmF0ZXMiOiBbDQogICAgICAgICAgWzc4LjU1MiwgMTcuMjI4XSwNCiAgICAgICAgICBbNzguNTU4LCAxNy4yMzJdLA0KICAgICAgICAgIFs3OC41NjQsIDE3LjIzNl0NCiAgICAgICAgXQ0KICAgICAgfQ0KICAgIH0sDQogICAgew0KICAgICAgInR5cGUiOiAiRmVhdHVyZSIsDQogICAgICAicHJvcGVydGllcyI6IHsNCiAgICAgICAgImlkIjogInJvYWQtMDAxIiwNCiAgICAgICAgIm5hbWUiOiAiVmlsbGFnZSBSb2FkIiwNCiAgICAgICAgInJvYWRfaWQiOiAicm9hZC1iIiwNCiAgICAgICAgImNsYXNzIjogInZpbGxhZ2UiDQogICAgICB9LA0KICAgICAgImdlb21ldHJ5Ijogew0KICAgICAgICAidHlwZSI6ICJMaW5lU3RyaW5nIiwNCiAgICAgICAgImNvb3JkaW5hdGVzIjogWw0KICAgICAgICAgIFs3OC41NTUsIDE3LjIyMl0sDQogICAgICAgICAgWzc4LjU1NSwgMTcuMjM4XQ0KICAgICAgICBdDQogICAgICB9DQogICAgfSwNCiAgICB7DQogICAgICAidHlwZSI6ICJGZWF0dXJlIiwNCiAgICAgICJwcm9wZXJ0aWVzIjogew0KICAgICAgICAiaWQiOiAiaG9tZXN0ZWFkLTAwMSIsDQogICAgICAgICJuYW1lIjogIkhvbWVzdGVhZCAxIiwNCiAgICAgICAgImhoX2lkIjogImhoLTAwMSIsDQogICAgICAgICJob3VzZWhvbGRfY291bnQiOiA1LA0KICAgICAgICAic2FuaXRhdGlvbl9zdGF0dXMiOiAiaW1wcm92ZWQiDQogICAgICB9LA0KICAgICAgImdlb21ldHJ5Ijogew0KICAgICAgICAidHlwZSI6ICJQb2ludCIsDQogICAgICAgICJjb29yZGluYXRlcyI6IFs3OC41NTgsIDE3LjIzMF0NCiAgICAgIH0NCiAgICB9DQogIF0NCn0=",oT="data:application/geo+json;base64,ew0KICAidHlwZSI6ICJGZWF0dXJlQ29sbGVjdGlvbiIsDQogICJmZWF0dXJlcyI6IFsNCiAgICB7DQogICAgICAidHlwZSI6ICJGZWF0dXJlIiwNCiAgICAgICJwcm9wZXJ0aWVzIjogew0KICAgICAgICAiaWQiOiAiYm91bmRhcnktYyIsDQogICAgICAgICJuYW1lIjogIlZpbGxhZ2UgQyBCb3VuZGFyeSIsDQogICAgICAgICJ0eXBlIjogImFkbWluaXN0cmF0aXZlX2JvdW5kYXJ5Ig0KICAgICAgfSwNCiAgICAgICJnZW9tZXRyeSI6IHsNCiAgICAgICAgInR5cGUiOiAiUG9seWdvbiIsDQogICAgICAgICJjb29yZGluYXRlcyI6IFtbDQogICAgICAgICAgWzc4LjY1LCAxNy4zMl0sDQogICAgICAgICAgWzc4LjY3LCAxNy4zMl0sDQogICAgICAgICAgWzc4LjY3LCAxNy4zNF0sDQogICAgICAgICAgWzc4LjY1LCAxNy4zNF0sDQogICAgICAgICAgWzc4LjY1LCAxNy4zMl0NCiAgICAgICAgXV0NCiAgICAgIH0NCiAgICB9LA0KICAgIHsNCiAgICAgICJ0eXBlIjogIkZlYXR1cmUiLA0KICAgICAgInByb3BlcnRpZXMiOiB7DQogICAgICAgICJpZCI6ICJwYXR0YS0wMDQiLA0KICAgICAgICAibmFtZSI6ICJQYXR0YSAwMDQiLA0KICAgICAgICAiaG9sZGVyX25hbWUiOiAiSm9obiBLdW1hciIsDQogICAgICAgICJob2xkZXJfdHlwZSI6ICJpbmRpdmlkdWFsIiwNCiAgICAgICAgInN0YXR1cyI6ICJhcHByb3ZlZCIsDQogICAgICAgICJjbGFpbWVkX2RhdGUiOiAiMjAyMy0wMy0xMiIsDQogICAgICAgICJncmFudGVkX2RhdGUiOiAiMjAyMy0wNS0wMSIsDQogICAgICAgICJyZWxhdGVkX2RvY3MiOiBbImRvYy00LnBkZiJdDQogICAgICB9LA0KICAgICAgImdlb21ldHJ5Ijogew0KICAgICAgICAidHlwZSI6ICJQb2x5Z29uIiwNCiAgICAgICAgImNvb3JkaW5hdGVzIjogW1sNCiAgICAgICAgICBbNzguNjUyLCAxNy4zMjJdLA0KICAgICAgICAgIFs3OC42NjIsIDE3LjMyMl0sDQogICAgICAgICAgWzc4LjY2MiwgMTcuMzMyXSwNCiAgICAgICAgICBbNzguNjUyLCAxNy4zMzJdLA0KICAgICAgICAgIFs3OC42NTIsIDE3LjMyMl0NCiAgICAgICAgXV0NCiAgICAgIH0NCiAgICB9LA0KICAgIHsNCiAgICAgICJ0eXBlIjogIkZlYXR1cmUiLA0KICAgICAgInByb3BlcnRpZXMiOiB7DQogICAgICAgICJpZCI6ICJwYXR0YS0wMDUiLA0KICAgICAgICAibmFtZSI6ICJQYXR0YSAwMDUiLA0KICAgICAgICAiaG9sZGVyX25hbWUiOiAiRm9yZXN0IFByb3RlY3Rpb24gQ29tbWl0dGVlIiwNCiAgICAgICAgImhvbGRlcl90eXBlIjogImNvbW11bml0eSIsDQogICAgICAgICJzdGF0dXMiOiAicGVuZGluZyIsDQogICAgICAgICJjbGFpbWVkX2RhdGUiOiAiMjAyMy0wNC0wNSIsDQogICAgICAgICJncmFudGVkX2RhdGUiOiBudWxsLA0KICAgICAgICAicmVsYXRlZF9kb2NzIjogWyJkb2MtNS5wZGYiLCAibWFwLTMuc2hwIl0NCiAgICAgIH0sDQogICAgICAiZ2VvbWV0cnkiOiB7DQogICAgICAgICJ0eXBlIjogIlBvbHlnb24iLA0KICAgICAgICAiY29vcmRpbmF0ZXMiOiBbWw0KICAgICAgICAgIFs3OC42NTgsIDE3LjMyOF0sDQogICAgICAgICAgWzc4LjY2OCwgMTcuMzI4XSwNCiAgICAgICAgICBbNzguNjY4LCAxNy4zMzhdLA0KICAgICAgICAgIFs3OC42NTgsIDE3LjMzOF0sDQogICAgICAgICAgWzc4LjY1OCwgMTcuMzI4XQ0KICAgICAgICBdXQ0KICAgICAgfQ0KICAgIH0sDQogICAgew0KICAgICAgInR5cGUiOiAiRmVhdHVyZSIsDQogICAgICAicHJvcGVydGllcyI6IHsNCiAgICAgICAgImlkIjogImZhcm0tMDAyIiwNCiAgICAgICAgIm5hbWUiOiAiRmFybSBQbG90IEIiLA0KICAgICAgICAibGFuZF9pZCI6ICJmYXJtLWIiLA0KICAgICAgICAib3duZXJfcGF0dGEiOiAicGF0dGEtMDA0IiwNCiAgICAgICAgImFyZWFfaGEiOiAxLjgsDQogICAgICAgICJjcm9wX3R5cGUiOiAid2hlYXQiLA0KICAgICAgICAibmR2aSI6IDAuNjgsDQogICAgICAgICJpcnJpZ2F0aW9uIjogImNhbmFsIg0KICAgICAgfSwNCiAgICAgICJnZW9tZXRyeSI6IHsNCiAgICAgICAgInR5cGUiOiAiUG9seWdvbiIsDQogICAgICAgICJjb29yZGluYXRlcyI6IFtbDQogICAgICAgICAgWzc4LjY1NCwgMTcuMzI0XSwNCiAgICAgICAgICBbNzguNjYwLCAxNy4zMjRdLA0KICAgICAgICAgIFs3OC42NjAsIDE3LjMzMF0sDQogICAgICAgICAgWzc4LjY1NCwgMTcuMzMwXSwNCiAgICAgICAgICBbNzguNjU0LCAxNy4zMjRdDQogICAgICAgIF1dDQogICAgICB9DQogICAgfSwNCiAgICB7DQogICAgICAidHlwZSI6ICJGZWF0dXJlIiwNCiAgICAgICJwcm9wZXJ0aWVzIjogew0KICAgICAgICAiaWQiOiAicG9uZC0wMDIiLA0KICAgICAgICAibmFtZSI6ICJJcnJpZ2F0aW9uIFBvbmQiLA0KICAgICAgICAicG9uZF9pZCI6ICJwb25kLWIiLA0KICAgICAgICAiYXZnX2RlcHRoX20iOiAyLjgsDQogICAgICAgICJhcmVhX2hhIjogMC4zLA0KICAgICAgICAid2F0ZXJfaW5kZXgiOiAwLjcyDQogICAgICB9LA0KICAgICAgImdlb21ldHJ5Ijogew0KICAgICAgICAidHlwZSI6ICJQb2x5Z29uIiwNCiAgICAgICAgImNvb3JkaW5hdGVzIjogW1sNCiAgICAgICAgICBbNzguNjY0LCAxNy4zMzRdLA0KICAgICAgICAgIFs3OC42NjYsIDE3LjMzNF0sDQogICAgICAgICAgWzc4LjY2NiwgMTcuMzM2XSwNCiAgICAgICAgICBbNzguNjY0LCAxNy4zMzZdLA0KICAgICAgICAgIFs3OC42NjQsIDE3LjMzNF0NCiAgICAgICAgXV0NCiAgICAgIH0NCiAgICB9LA0KICAgIHsNCiAgICAgICJ0eXBlIjogIkZlYXR1cmUiLA0KICAgICAgInByb3BlcnRpZXMiOiB7DQogICAgICAgICJpZCI6ICJ3ZWxsLTAwMiIsDQogICAgICAgICJuYW1lIjogIkNvbW11bml0eSBXZWxsIiwNCiAgICAgICAgIndlbGxfaWQiOiAid2VsbC00NTYiLA0KICAgICAgICAiZGVwdGhfbSI6IDM4LA0KICAgICAgICAibGFzdF9yZXBhaXJlZF9kYXRlIjogIjIwMjMtMDEtMjAiDQogICAgICB9LA0KICAgICAgImdlb21ldHJ5Ijogew0KICAgICAgICAidHlwZSI6ICJQb2ludCIsDQogICAgICAgICJjb29yZGluYXRlcyI6IFs3OC42NTksIDE3LjMzMV0NCiAgICAgIH0NCiAgICB9DQogIF0NCn0=",sT=()=>{const i=Me.useRef(null),o=Me.useRef(null),d=Me.useRef(null),[y,x]=Me.useState(!1),[S,b]=Me.useState(null),c={version:8,sources:{osm:{type:"raster",tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256,attribution:" OpenStreetMap contributors"}},layers:[{id:"osm",type:"raster",source:"osm"}]};Me.useEffect(()=>{if(i.current&&!o.current)try{console.log("Initializing map...");const re=setTimeout(()=>{try{const ce=new Pp.Map({container:i.current,style:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json",center:[78.55,17.25],zoom:11,attributionControl:!1});return ce.addControl(new Pp.NavigationControl,"top-right"),ce.addControl(new Pp.AttributionControl({compact:!0}),"bottom-right"),ce.on("load",()=>{console.log("Map loaded successfully"),x(!0),o.current=ce,setTimeout(()=>{try{F(ce),W(ce)}catch(K){console.error("Error adding demo data:",K)}},100)}),ce.on("error",K=>{var Ie;console.error("Map error:",K),K.error&&(K.error.message.includes("style")||K.error.status)?(console.log("Trying fallback style..."),ce.setStyle(c)):b("Map loading failed: "+(((Ie=K.error)==null?void 0:Ie.message)||K.message||"Unknown error"))}),ce.on("style.load",()=>{console.log("Map style loaded")}),ce.on("styledataloading",()=>{console.log("Map style data loading...")}),()=>{d.current&&d.current.remove(),o.current&&o.current.remove()}}catch(ce){console.error("Map initialization error:",ce),b("Map initialization failed: "+ce.message)}},100);return()=>clearTimeout(re)}catch(se){console.error("Map setup error:",se),b("Map setup failed: "+se.message)}},[]);const F=se=>{console.log("Adding demo data layers");try{if(!se.isStyleLoaded()){console.warn("Map style not yet loaded, waiting..."),se.once("style.load",()=>{console.log("Map style loaded, adding layers now"),F(se)});return}se.addSource("village-a",{type:"geojson",data:rT}),se.addSource("village-b",{type:"geojson",data:aT}),se.addSource("village-c",{type:"geojson",data:oT}),se.addLayer({id:"village-boundaries",type:"line",source:"village-a",filter:["==","type","administrative_boundary"],paint:{"line-color":"#3b82f6","line-width":3,"line-dasharray":[2,2]}}),se.addLayer({id:"village-b-boundaries",type:"line",source:"village-b",filter:["==","type","administrative_boundary"],paint:{"line-color":"#3b82f6","line-width":3,"line-dasharray":[2,2]}}),se.addLayer({id:"village-c-boundaries",type:"line",source:"village-c",filter:["==","type","administrative_boundary"],paint:{"line-color":"#3b82f6","line-width":3,"line-dasharray":[2,2]}}),se.addLayer({id:"patta-boundaries-approved",type:"fill",source:"village-a",filter:["all",["==","holder_type","individual"],["==","status","granted"]],paint:{"fill-color":"#10b981","fill-opacity":.5,"fill-outline-color":"#047857"}}),se.addLayer({id:"patta-boundaries-pending",type:"fill",source:"village-a",filter:["all",["==","holder_type","individual"],["==","status","pending"]],paint:{"fill-color":"#f59e0b","fill-opacity":.5,"fill-outline-color":"#d97706"}}),se.addLayer({id:"patta-b-boundaries-approved",type:"fill",source:"village-b",filter:["all",["==","holder_type","community"],["==","status","granted"]],paint:{"fill-color":"#10b981","fill-opacity":.5,"fill-outline-color":"#047857"}}),se.addLayer({id:"patta-c-boundaries-approved",type:"fill",source:"village-c",filter:["all",["==","holder_type","individual"],["==","status","approved"]],paint:{"fill-color":"#10b981","fill-opacity":.5,"fill-outline-color":"#047857"}}),se.addLayer({id:"patta-c-boundaries-pending",type:"fill",source:"village-c",filter:["all",["==","holder_type","community"],["==","status","pending"]],paint:{"fill-color":"#f59e0b","fill-opacity":.5,"fill-outline-color":"#d97706"}}),se.addLayer({id:"patta-boundaries-outline",type:"line",source:"village-a",filter:["==","holder_type","individual"],paint:{"line-color":"#047857","line-width":1,"line-dasharray":[1,1]}}),se.addLayer({id:"patta-b-boundaries-outline",type:"line",source:"village-b",filter:["==","holder_type","community"],paint:{"line-color":"#047857","line-width":1,"line-dasharray":[1,1]}}),se.addLayer({id:"patta-c-boundaries-outline",type:"line",source:"village-c",paint:{"line-color":"#047857","line-width":1,"line-dasharray":[1,1]}}),se.addLayer({id:"farm-plots",type:"fill",source:"village-a",filter:["==","$type","Polygon"],paint:{"fill-color":"#8b5cf6","fill-opacity":.4,"fill-outline-color":"#7c3aed"}}),se.addLayer({id:"farm-c-plots",type:"fill",source:"village-c",filter:["==","$type","Polygon"],paint:{"fill-color":"#8b5cf6","fill-opacity":.4,"fill-outline-color":"#7c3aed"}}),se.addLayer({id:"forest-areas",type:"fill",source:"village-b",filter:["==","$type","Polygon"],paint:{"fill-color":"#16a34a","fill-opacity":.6,"fill-outline-color":"#15803d"}}),se.addLayer({id:"water-bodies",type:"fill",source:"village-a",filter:["==","$type","Polygon"],paint:{"fill-color":"#3b82f6","fill-opacity":.7,"fill-outline-color":"#1d4ed8"}}),se.addLayer({id:"water-c-bodies",type:"fill",source:"village-c",filter:["==","$type","Polygon"],paint:{"fill-color":"#3b82f6","fill-opacity":.7,"fill-outline-color":"#1d4ed8"}}),se.addLayer({id:"wells",type:"circle",source:"village-a",filter:["==","$type","Point"],paint:{"circle-radius":6,"circle-color":"#ef4444","circle-stroke-width":2,"circle-stroke-color":"#b91c1c"}}),se.addLayer({id:"wells-c",type:"circle",source:"village-c",filter:["==","$type","Point"],paint:{"circle-radius":6,"circle-color":"#ef4444","circle-stroke-width":2,"circle-stroke-color":"#b91c1c"}}),se.addLayer({id:"homesteads",type:"circle",source:"village-b",filter:["==","$type","Point"],paint:{"circle-radius":5,"circle-color":"#f97316","circle-stroke-width":1,"circle-stroke-color":"#ea580c"}}),se.addLayer({id:"streams",type:"line",source:"village-b",filter:["==","$type","LineString"],paint:{"line-color":"#3b82f6","line-width":2,"line-dasharray":[1,1]}}),se.addLayer({id:"roads",type:"line",source:"village-b",filter:["==","$type","LineString"],paint:{"line-color":"#6b7280","line-width":3}}),console.log("Demo data layers added successfully")}catch(re){console.error("Error in addDemoDataLayers:",re)}},W=se=>{console.log("Adding interactivity");try{se.on("click",ce=>{const K=se.queryRenderedFeatures(ce.point);if(K.length>0){const Ie=K[0];d.current||(d.current=new Pp.Popup({closeButton:!0,closeOnClick:!1}));const Te=Ie.properties||{};let We="";Te.status&&(We=`<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Te.status==="granted"||Te.status==="approved"?"bg-green-100 text-green-800":Te.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}">
              ${Te.status}
            </span>`);const he=`
            <div class="p-2">
              <h3 class="font-bold text-lg">${Te.name||"Unnamed Feature"}</h3>
              ${Te.id?`<p class="text-sm"><strong>ID:</strong> ${Te.id}</p>`:""}
              ${Te.type?`<p class="text-sm"><strong>Type:</strong> ${Te.type}</p>`:""}
              ${Te.holder_name?`<p class="text-sm"><strong>Holder:</strong> ${Te.holder_name}</p>`:""}
              ${Te.holder_type?`<p class="text-sm"><strong>Holder Type:</strong> ${Te.holder_type}</p>`:""}
              ${We}
              ${Te.area_ha?`<p class="text-sm"><strong>Area:</strong> ${Te.area_ha} ha</p>`:""}
              ${Te.crop_type?`<p class="text-sm"><strong>Crop:</strong> ${Te.crop_type}</p>`:""}
              ${Te.species_summary?`<p class="text-sm"><strong>Species:</strong> ${Te.species_summary}</p>`:""}
            </div>
          `;d.current.setLngLat(ce.lngLat).setHTML(he).addTo(se)}else d.current&&(d.current.remove(),d.current=null)}),["village-boundaries","village-b-boundaries","village-c-boundaries","patta-boundaries-approved","patta-boundaries-pending","patta-b-boundaries-approved","patta-c-boundaries-approved","patta-c-boundaries-pending","farm-plots","farm-c-plots","forest-areas","water-bodies","water-c-bodies","wells","wells-c","homesteads","streams","roads"].forEach(ce=>{se.on("mouseenter",ce,()=>{se.getCanvas().style.cursor="pointer"}),se.on("mouseleave",ce,()=>{se.getCanvas().style.cursor=""})}),console.log("Interactivity added successfully")}catch(re){console.error("Error adding interactivity:",re)}};return S?A("div",{className:"h-full w-full flex items-center justify-center bg-red-50",children:$("div",{className:"text-center p-4 bg-white rounded-lg shadow-lg max-w-md",children:[A("h3",{className:"text-lg font-medium text-red-800",children:"Map Loading Error"}),A("p",{className:"mt-2 text-sm text-red-600",children:S}),A("p",{className:"mt-2 text-xs text-gray-500",children:"Check browser console for more details"}),A("button",{className:"mt-4 px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700",onClick:()=>window.location.reload(),children:"Reload Map"})]})}):$("div",{className:"relative h-full w-full",children:[A("div",{ref:i,className:"absolute inset-0 bg-gray-100"}),!y&&A("div",{className:"absolute inset-0 flex items-center justify-center bg-white bg-opacity-80",children:$("div",{className:"text-center",children:[A("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),A("p",{className:"mt-2 text-gray-600",children:"Loading map..."}),A("p",{className:"mt-1 text-xs text-gray-500",children:"If this takes too long, check network connectivity"})]})}),y&&$(zp,{children:[A(iT,{}),A(nT,{map:o.current})]})]})},lT=()=>$("div",{className:"h-screen flex flex-col",children:[A("div",{className:"bg-white shadow",children:A("div",{className:"max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8",children:A("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:$("div",{children:[A("h1",{className:"text-2xl font-bold text-gray-900",children:"FRA Atlas Map"}),A("p",{className:"mt-1 text-sm text-gray-500",children:"Interactive map showing forest rights claims and related data"})]})})})}),A("div",{className:"flex-1 relative",children:A(sT,{})})]}),cT=()=>{const[i,o]=Me.useState(""),[d,y]=Me.useState("all"),S=[{id:"CR-2023-001",type:"Community Rights",village:"Village A",status:"Pending",date:"2023-05-15",claimant:"Community Council"},{id:"IFR-2023-002",type:"Individual Forest Rights",village:"Village B",status:"Approved",date:"2023-05-10",claimant:"John Doe"},{id:"CFR-2023-003",type:"Community Forest Rights",village:"Village C",status:"Under Review",date:"2023-05-05",claimant:"Forest Committee"},{id:"CR-2023-004",type:"Community Rights",village:"Village D",status:"Rejected",date:"2023-04-28",claimant:"Local Panchayat"},{id:"IFR-2023-005",type:"Individual Forest Rights",village:"Village E",status:"Pending",date:"2023-04-20",claimant:"Jane Smith"}].filter(b=>{const c=b.id.toLowerCase().includes(i.toLowerCase())||b.village.toLowerCase().includes(i.toLowerCase())||b.claimant.toLowerCase().includes(i.toLowerCase()),F=d==="all"||b.status.toLowerCase()===d.toLowerCase();return c&&F});return $("div",{className:"min-h-screen bg-gray-50",children:[A("div",{className:"bg-white shadow",children:$("div",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:[A("h1",{className:"text-3xl font-bold text-gray-900",children:"Forest Rights Claims"}),A("p",{className:"mt-1 text-sm text-gray-500",children:"Manage and review forest rights claims"})]})}),A("div",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:$("div",{className:"px-4 py-6 sm:px-0",children:[$("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6",children:[A("div",{className:"flex-1",children:$("div",{className:"relative rounded-md shadow-sm",children:[A("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:A("svg",{className:"h-5 w-5 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:A("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})})}),A("input",{type:"text",className:"focus:ring-indigo-500 focus:border-indigo-500 block w-full pl-10 pr-12 sm:text-sm border-gray-300 rounded-md",placeholder:"Search claims...",value:i,onChange:b=>o(b.target.value)})]})}),A("div",{className:"mt-4 md:mt-0 md:ml-4",children:$("select",{className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",value:d,onChange:b=>y(b.target.value),children:[A("option",{value:"all",children:"All Statuses"}),A("option",{value:"pending",children:"Pending"}),A("option",{value:"approved",children:"Approved"}),A("option",{value:"under review",children:"Under Review"}),A("option",{value:"rejected",children:"Rejected"})]})}),A("div",{className:"mt-4 md:mt-0 md:ml-4",children:$(pa,{to:"/digitize",className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[A("svg",{className:"-ml-1 mr-2 h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"New Claim"]})})]}),A("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:A("ul",{className:"divide-y divide-gray-200",children:S.map(b=>A("li",{children:A(pa,{to:`/claim/${b.id}`,className:"block hover:bg-gray-50",children:$("div",{className:"px-4 py-4 sm:px-6",children:[$("div",{className:"flex items-center justify-between",children:[$("p",{className:"text-sm font-medium text-indigo-600 truncate",children:[b.id," - ",b.type]}),A("div",{className:"ml-2 flex-shrink-0 flex",children:A("p",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${b.status==="Approved"?"bg-green-100 text-green-800":b.status==="Pending"?"bg-yellow-100 text-yellow-800":b.status==="Under Review"?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:b.status})})]}),$("div",{className:"mt-2 sm:flex sm:justify-between",children:[$("div",{className:"sm:flex",children:[$("p",{className:"flex items-center text-sm text-gray-500",children:[A("svg",{className:"flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:A("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})}),b.village]}),$("p",{className:"mt-2 flex items-center text-sm text-gray-500 sm:mt-0 sm:ml-6",children:[A("svg",{className:"flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:A("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})}),b.claimant]})]}),$("div",{className:"mt-2 flex items-center text-sm text-gray-500 sm:mt-0",children:[A("svg",{className:"flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:A("path",{fillRule:"evenodd",d:"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z",clipRule:"evenodd"})}),$("p",{children:["Filed on ",A("time",{dateTime:b.date,children:b.date})]})]})]})]})})},b.id))})})]})})]})},uT=()=>{const{id:i}=wS(),[o,d]=Me.useState("details"),y={id:i||"CR-2023-001",type:"Community Rights",status:"Pending",village:"Village A",district:"District X",state:"State Y",claimant:"Community Council",filedDate:"2023-05-15",claimedArea:"12.5 hectares",grantedArea:"10.2 hectares",relatedDocs:[{id:"doc-1",name:"Community Resolution.pdf",type:"PDF",size:"2.4 MB"},{id:"doc-2",name:"Survey Map.shp",type:"Shapefile",size:"5.1 MB"},{id:"doc-3",name:"Witness Statements.pdf",type:"PDF",size:"1.8 MB"}],geometry:{type:"Polygon",coordinates:[[[78.5,20.2],[78.6,20.2],[78.6,20.3],[78.5,20.3],[78.5,20.2]]]}};return $("div",{className:"min-h-screen bg-gray-50",children:[A("div",{className:"bg-white shadow",children:A("div",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:$("div",{className:"flex items-center",children:[A(pa,{to:"/claims",className:"text-indigo-600 hover:text-indigo-900",children:A("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:A("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})})}),$("h1",{className:"ml-4 text-3xl font-bold text-gray-900",children:["Claim Details: ",y.id]})]})})}),A("div",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:$("div",{className:"px-4 py-6 sm:px-0",children:[A("div",{className:"rounded-md p-4 mb-6 bg-yellow-50",children:$("div",{className:"flex",children:[A("div",{className:"flex-shrink-0",children:A("svg",{className:"h-5 w-5 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:A("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),A("div",{className:"ml-3",children:$("h3",{className:"text-sm font-medium text-yellow-800",children:["Status: ",y.status]})})]})}),A("div",{className:"border-b border-gray-200 mb-6",children:$("nav",{className:"-mb-px flex space-x-8",children:[A("button",{onClick:()=>d("details"),className:`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ${o==="details"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Claim Details"}),A("button",{onClick:()=>d("documents"),className:`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ${o==="documents"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Documents"}),A("button",{onClick:()=>d("map"),className:`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ${o==="map"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Map View"})]})}),o==="details"&&$("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:[$("div",{className:"px-4 py-5 sm:px-6",children:[A("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Claim Information"}),A("p",{className:"mt-1 max-w-2xl text-sm text-gray-500",children:"Details and metadata for this claim."})]}),A("div",{className:"border-t border-gray-200",children:$("dl",{children:[$("div",{className:"bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[A("dt",{className:"text-sm font-medium text-gray-500",children:"Claim ID"}),A("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:y.id})]}),$("div",{className:"bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[A("dt",{className:"text-sm font-medium text-gray-500",children:"Claim Type"}),A("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:y.type})]}),$("div",{className:"bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[A("dt",{className:"text-sm font-medium text-gray-500",children:"Village"}),A("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:y.village})]}),$("div",{className:"bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[A("dt",{className:"text-sm font-medium text-gray-500",children:"District"}),A("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:y.district})]}),$("div",{className:"bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[A("dt",{className:"text-sm font-medium text-gray-500",children:"State"}),A("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:y.state})]}),$("div",{className:"bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[A("dt",{className:"text-sm font-medium text-gray-500",children:"Claimant"}),A("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:y.claimant})]}),$("div",{className:"bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[A("dt",{className:"text-sm font-medium text-gray-500",children:"Filed Date"}),A("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:y.filedDate})]}),$("div",{className:"bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[A("dt",{className:"text-sm font-medium text-gray-500",children:"Claimed Area"}),A("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:y.claimedArea})]}),$("div",{className:"bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[A("dt",{className:"text-sm font-medium text-gray-500",children:"Granted Area"}),A("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:y.grantedArea})]})]})})]}),o==="documents"&&$("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:[$("div",{className:"px-4 py-5 sm:px-6",children:[A("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Related Documents"}),A("p",{className:"mt-1 max-w-2xl text-sm text-gray-500",children:"Documents associated with this claim."})]}),A("ul",{className:"divide-y divide-gray-200",children:y.relatedDocs.map(x=>A("li",{children:$("div",{className:"px-4 py-4 flex items-center sm:px-6",children:[A("div",{className:"min-w-0 flex-1 sm:flex sm:items-center sm:justify-between",children:$("div",{className:"truncate",children:[$("div",{className:"flex text-sm",children:[A("p",{className:"font-medium text-indigo-600 truncate",children:x.name}),$("p",{className:"ml-1 flex-shrink-0 font-normal text-gray-500",children:["(",x.type,")"]})]}),A("div",{className:"mt-2 flex",children:$("div",{className:"flex items-center text-sm text-gray-500",children:[A("svg",{className:"flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:A("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),A("p",{children:x.size})]})})]})}),A("div",{className:"ml-5 flex-shrink-0",children:A("svg",{className:"h-5 w-5 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:A("path",{fillRule:"evenodd",d:"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z",clipRule:"evenodd"})})})]})},x.id))}),A("div",{className:"px-4 py-4 sm:px-6",children:$("button",{type:"button",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[A("svg",{className:"-ml-1 mr-2 h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Upload Document"]})})]}),o==="map"&&$("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:[$("div",{className:"px-4 py-5 sm:px-6",children:[A("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Claim Boundary"}),A("p",{className:"mt-1 max-w-2xl text-sm text-gray-500",children:"Geospatial representation of the claim area."})]}),A("div",{className:"border-t border-gray-200",children:A("div",{className:"h-96 bg-gray-100 flex items-center justify-center",children:$("div",{className:"text-center",children:[A("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),A("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Map View"}),A("p",{className:"mt-1 text-sm text-gray-500",children:"Interactive map showing the claim boundary would be displayed here."})]})})})]})]})})]})};var sw={exports:{}},hT="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",dT=hT,pT=dT;function lw(){}function cw(){}cw.resetWarningCache=lw;var mT=function(){function i(y,x,S,b,c,F){if(F!==pT){var W=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw W.name="Invariant Violation",W}}i.isRequired=i;function o(){return i}var d={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:o,element:i,elementType:i,instanceOf:o,node:i,objectOf:o,oneOf:o,oneOfType:o,shape:o,exact:o,checkPropTypes:cw,resetWarningCache:lw};return d.PropTypes=d,d};sw.exports=mT();var fT=sw.exports;const oi=S0(fT);function ll(i,o,d,y){function x(S){return S instanceof d?S:new d(function(b){b(S)})}return new(d||(d=Promise))(function(S,b){function c(se){try{W(y.next(se))}catch(re){b(re)}}function F(se){try{W(y.throw(se))}catch(re){b(re)}}function W(se){se.done?S(se.value):x(se.value).then(c,F)}W((y=y.apply(i,o||[])).next())})}const gT=new Map([["1km","application/vnd.1000minds.decision-model+xml"],["3dml","text/vnd.in3d.3dml"],["3ds","image/x-3ds"],["3g2","video/3gpp2"],["3gp","video/3gp"],["3gpp","video/3gpp"],["3mf","model/3mf"],["7z","application/x-7z-compressed"],["7zip","application/x-7z-compressed"],["123","application/vnd.lotus-1-2-3"],["aab","application/x-authorware-bin"],["aac","audio/x-acc"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abw","application/x-abiword"],["ac","application/vnd.nokia.n-gage.ac+xml"],["ac3","audio/ac3"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acu","application/vnd.acucobol"],["acutc","application/vnd.acucorp"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afm","application/x-font-type1"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/pdf"],["aif","audio/x-aiff"],["aifc","audio/x-aiff"],["aiff","audio/x-aiff"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["amr","audio/amr"],["apk","application/vnd.android.package-archive"],["apng","image/apng"],["appcache","text/cache-manifest"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["arc","application/x-freearc"],["arj","application/x-arj"],["asc","application/pgp-signature"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asx","video/x-ms-asf"],["atc","application/vnd.acucorp"],["atom","application/atom+xml"],["atomcat","application/atomcat+xml"],["atomdeleted","application/atomdeleted+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au","audio/x-au"],["avi","video/x-msvideo"],["avif","image/avif"],["aw","application/applixware"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azv","image/vnd.airzip.accelerator.azv"],["azw","application/vnd.amazon.ebook"],["b16","image/vnd.pco.b16"],["bat","application/x-msdownload"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bdoc","application/x-bdoc"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin","application/octet-stream"],["blb","application/x-blorb"],["blorb","application/x-blorb"],["bmi","application/vnd.bmi"],["bmml","application/vnd.balsamiq.bmml+xml"],["bmp","image/bmp"],["book","application/vnd.framemaker"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bpk","application/octet-stream"],["bpmn","application/octet-stream"],["bsp","model/vnd.valve.source.compiled-map"],["btif","image/prs.btif"],["buffer","application/octet-stream"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c","text/x-c"],["c4d","application/vnd.clonk.c4group"],["c4f","application/vnd.clonk.c4group"],["c4g","application/vnd.clonk.c4group"],["c4p","application/vnd.clonk.c4group"],["c4u","application/vnd.clonk.c4group"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["cab","application/vnd.ms-cab-compressed"],["caf","audio/x-caf"],["cap","application/vnd.tcpdump.pcap"],["car","application/vnd.curl.car"],["cat","application/vnd.ms-pki.seccat"],["cb7","application/x-cbr"],["cba","application/x-cbr"],["cbr","application/x-cbr"],["cbt","application/x-cbr"],["cbz","application/x-cbr"],["cc","text/x-c"],["cco","application/x-cocoa"],["cct","application/x-director"],["ccxml","application/ccxml+xml"],["cdbcmsg","application/vnd.contact.cmsg"],["cda","application/x-cdf"],["cdf","application/x-netcdf"],["cdfx","application/cdfx+xml"],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdr","application/cdr"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer","application/pkix-cert"],["cfs","application/x-cfs-compressed"],["cgm","image/cgm"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cjs","application/node"],["cla","application/vnd.claymore"],["class","application/octet-stream"],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod","application/vnd.rim.cod"],["coffee","text/coffeescript"],["com","application/x-msdownload"],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt","application/mac-compactpro"],["crd","application/x-mscardfile"],["crl","application/pkix-crl"],["crt","application/x-x509-ca-cert"],["crx","application/x-chrome-extension"],["cryptonote","application/vnd.rig.cryptonote"],["csh","application/x-csh"],["csl","application/vnd.citationstyles.style+xml"],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["csr","application/octet-stream"],["css","text/css"],["cst","application/x-director"],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxt","application/x-director"],["cxx","text/x-c"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["dart","application/vnd.dart"],["dataless","application/vnd.fdsn.seed"],["davmount","application/davmount+xml"],["dbf","application/vnd.dbf"],["dbk","application/docbook+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["ddf","application/vnd.syncml.dmddf+xml"],["dds","image/vnd.ms-dds"],["deb","application/x-debian-package"],["def","text/plain"],["deploy","application/octet-stream"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dgc","application/x-dgc-compressed"],["dic","text/x-c"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["disposition-notification","message/disposition-notification"],["dist","application/octet-stream"],["distz","application/octet-stream"],["djv","image/vnd.djvu"],["djvu","image/vnd.djvu"],["dll","application/octet-stream"],["dmg","application/x-apple-diskimage"],["dmn","application/octet-stream"],["dmp","application/vnd.tcpdump.pcap"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.template.macroEnabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroEnabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp","application/vnd.osgi.dp"],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drle","image/dicom-rle"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dvb","video/vnd.dvb.file"],["dvi","application/x-dvi"],["dwd","application/atsc-dwd+xml"],["dwf","model/vnd.dwf"],["dwg","image/vnd.dwg"],["dxf","image/vnd.dxf"],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ear","application/java-archive"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["ecma","application/ecmascript"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["elc","application/octet-stream"],["emf","image/emf"],["eml","message/rfc822"],["emma","application/emma+xml"],["emotionml","application/emotionml+xml"],["emz","application/x-msmetafile"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es","application/ecmascript"],["es3","application/vnd.eszigno3+xml"],["esa","application/vnd.osgi.subsystem"],["esf","application/vnd.epson.esf"],["et3","application/vnd.eszigno3+xml"],["etx","text/x-setext"],["eva","application/x-eva"],["evy","application/x-envoy"],["exe","application/octet-stream"],["exi","application/exi"],["exp","application/express"],["exr","image/aces"],["ext","application/vnd.novadigm.ext"],["ez","application/andrew-inset"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f","text/x-fortran"],["f4v","video/mp4"],["f77","text/x-fortran"],["f90","text/x-fortran"],["fbs","image/vnd.fastbidsheet"],["fcdt","application/vnd.adobe.formscentral.fcdt"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fdt","application/fdt+xml"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fgd","application/x-director"],["fh","image/x-freehand"],["fh4","image/x-freehand"],["fh5","image/x-freehand"],["fh7","image/x-freehand"],["fhc","image/x-freehand"],["fig","application/x-xfig"],["fits","image/fits"],["flac","audio/x-flac"],["fli","video/x-fli"],["flo","application/vnd.micrografx.flo"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fnc","application/vnd.frogans.fnc"],["fo","application/vnd.software602.filler.form+xml"],["for","text/x-fortran"],["fpx","image/vnd.fpx"],["frame","application/vnd.framemaker"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fxpl","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gam","application/x-tads"],["gbr","application/rpki-ghostbusters"],["gca","application/x-gca-compressed"],["gdl","model/vnd.gdl"],["gdoc","application/vnd.google-apps.document"],["geo","application/vnd.dynageo"],["geojson","application/geo+json"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["glb","model/gltf-binary"],["gltf","model/gltf+json"],["gml","application/gml+xml"],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gpg","application/gpg-keys"],["gph","application/vnd.flographit"],["gpx","application/gpx+xml"],["gqf","application/vnd.grafeq"],["gqs","application/vnd.grafeq"],["gram","application/srgs"],["gramps","application/x-gramps-xml"],["gre","application/vnd.geometry-explorer"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsf","application/x-font-ghostscript"],["gsheet","application/vnd.google-apps.spreadsheet"],["gslides","application/vnd.google-apps.presentation"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxf","application/gxf"],["gxt","application/vnd.geonext"],["gz","application/gzip"],["gzip","application/gzip"],["h","text/x-c"],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hbs","text/x-handlebars-template"],["hdd","application/x-virtualbox-hdd"],["hdf","application/x-hdf"],["heic","image/heic"],["heics","image/heic-sequence"],["heif","image/heif"],["heifs","image/heif-sequence"],["hej2","image/hej2k"],["held","application/atsc-held+xml"],["hh","text/x-c"],["hjson","application/hjson"],["hlp","application/winhlp"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx","application/mac-binhex40"],["hsj2","image/hsj2"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["icm","application/vnd.iccprofile"],["ico","image/x-icon"],["ics","text/calendar"],["ief","image/ief"],["ifb","text/calendar"],["ifm","application/vnd.shana.informed.formdata"],["iges","model/iges"],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs","model/iges"],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["img","application/octet-stream"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["in","text/plain"],["ini","text/plain"],["ink","application/inkml+xml"],["inkml","application/inkml+xml"],["install","application/x-install-instructions"],["iota","application/vnd.astraea-software.iota"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["iso","application/x-iso9660-image"],["itp","application/vnd.shana.informed.formtemplate"],["its","application/its+xml"],["ivp","application/vnd.immervision-ivp"],["ivu","application/vnd.immervision-ivu"],["jad","text/vnd.sun.j2me.app-descriptor"],["jade","text/jade"],["jam","application/vnd.jam"],["jar","application/java-archive"],["jardiff","application/x-java-archive-diff"],["java","text/x-java-source"],["jhc","image/jphc"],["jisp","application/vnd.jisp"],["jls","image/jls"],["jlt","application/vnd.hp-jlyt"],["jng","image/x-jng"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jp2","image/jp2"],["jpe","image/jpeg"],["jpeg","image/jpeg"],["jpf","image/jpx"],["jpg","image/jpeg"],["jpg2","image/jp2"],["jpgm","video/jpm"],["jpgv","video/jpeg"],["jph","image/jph"],["jpm","video/jpm"],["jpx","image/jpx"],["js","application/javascript"],["json","application/json"],["json5","application/json5"],["jsonld","application/ld+json"],["jsonl","application/jsonl"],["jsonml","application/jsonml+json"],["jsx","text/jsx"],["jxr","image/jxr"],["jxra","image/jxra"],["jxrs","image/jxrs"],["jxs","image/jxs"],["jxsc","image/jxsc"],["jxsi","image/jxsi"],["jxss","image/jxss"],["kar","audio/midi"],["karbon","application/vnd.kde.karbon"],["kdb","application/octet-stream"],["kdbx","application/x-keepass2"],["key","application/x-iwork-keynote-sffkey"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["knp","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["kpt","application/vnd.kde.kpresenter"],["kpxx","application/vnd.ds-keypoint"],["ksp","application/vnd.kde.kspread"],["ktr","application/vnd.kahootz"],["ktx","image/ktx"],["ktx2","image/ktx2"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["kwt","application/vnd.kde.kword"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["less","text/less"],["lgr","application/lgr+xml"],["lha","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["list3820","application/vnd.ibm.modcap"],["listafp","application/vnd.ibm.modcap"],["litcoffee","text/coffeescript"],["lnk","application/x-ms-shortcut"],["log","text/plain"],["lostxml","application/lost+xml"],["lrf","application/octet-stream"],["lrm","application/vnd.ms-lrm"],["ltf","application/vnd.frogans.ltf"],["lua","text/x-lua"],["luac","application/x-lua-bytecode"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh","application/octet-stream"],["m1v","video/mpeg"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3a","audio/mpeg"],["m3u","text/plain"],["m3u8","application/vnd.apple.mpegurl"],["m4a","audio/x-m4a"],["m4p","application/mp4"],["m4s","video/iso.segment"],["m4u","application/vnd.mpegurl"],["m4v","video/x-m4v"],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m21","application/mp21"],["ma","application/mathematica"],["mads","application/mads+xml"],["maei","application/mmt-aei+xml"],["mag","application/vnd.ecowin.chart"],["maker","application/vnd.framemaker"],["man","text/troff"],["manifest","text/cache-manifest"],["map","application/json"],["mar","application/octet-stream"],["markdown","text/markdown"],["mathml","application/mathml+xml"],["mb","application/mathematica"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc1","application/vnd.medcalcdata"],["mcd","application/vnd.mcd"],["mcurl","text/vnd.curl.mcurl"],["md","text/markdown"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["mdx","text/mdx"],["me","text/troff"],["mesh","model/mesh"],["meta4","application/metalink4+xml"],["metalink","application/metalink+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mft","application/rpki-manifest"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mid","audio/midi"],["midi","audio/midi"],["mie","application/x-mie"],["mif","application/vnd.mif"],["mime","message/rfc822"],["mj2","video/mj2"],["mjp2","video/mj2"],["mjs","application/javascript"],["mk3d","video/x-matroska"],["mka","audio/x-matroska"],["mkd","text/x-markdown"],["mks","video/x-matroska"],["mkv","video/x-matroska"],["mlp","application/vnd.dolby.mlp"],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mmf","application/vnd.smaf"],["mml","text/mathml"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mng","video/x-mng"],["mny","application/x-msmoney"],["mobi","application/x-mobipocket-ebook"],["mods","application/mods+xml"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2","audio/mpeg"],["mp2a","audio/mpeg"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mp4a","audio/mp4"],["mp4s","application/mp4"],["mp4v","video/mp4"],["mp21","application/mp21"],["mpc","application/vnd.mophun.certificate"],["mpd","application/dash+xml"],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg","video/mpeg"],["mpg4","video/mp4"],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/vnd.ms-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","text/troff"],["mscml","application/mediaservercontrol+xml"],["mseed","application/vnd.fdsn.mseed"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msi","application/x-msdownload"],["msl","application/vnd.mobius.msl"],["msm","application/octet-stream"],["msp","application/octet-stream"],["msty","application/vnd.muvee.style"],["mtl","model/mtl"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musd","application/mmt-usd+xml"],["musicxml","application/vnd.recordare.musicxml+xml"],["mvb","application/x-msmediaview"],["mvt","application/vnd.mapbox-vector-tile"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxmf","audio/mobile-xmf"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nb","application/mathematica"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncx","application/x-dtbncx+xml"],["nfo","text/x-nfo"],["ngdat","application/vnd.nokia.n-gage.data"],["nitf","application/vnd.nitf"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nq","application/n-quads"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nt","application/n-triples"],["ntf","application/vnd.nitf"],["numbers","application/x-iwork-numbers-sffnumbers"],["nzb","application/x-nzb"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["obgx","application/vnd.openblox.game+xml"],["obj","model/obj"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogex","model/vnd.opengex"],["ogg","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omdoc","application/omdoc+xml"],["onepkg","application/onenote"],["onetmp","application/onenote"],["onetoc","application/onenote"],["onetoc2","application/onenote"],["opf","application/oebps-package+xml"],["opml","text/x-opml"],["oprc","application/vnd.palm"],["opus","audio/ogg"],["org","text/x-org"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["osm","application/vnd.openstreetmap.data+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","font/otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["ova","application/x-virtualbox-ova"],["ovf","application/x-virtualbox-ovf"],["owl","application/rdf+xml"],["oxps","application/oxps"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c","application/pkcs7-mime"],["p7m","application/pkcs7-mime"],["p7r","application/x-pkcs7-certreqresp"],["p7s","application/pkcs7-signature"],["p8","application/pkcs8"],["p10","application/x-pkcs10"],["p12","application/x-pkcs12"],["pac","application/x-ns-proxy-autoconfig"],["pages","application/x-iwork-pages-sffpages"],["pas","text/x-pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcap","application/vnd.tcpdump.pcap"],["pcf","application/x-font-pcf"],["pcl","application/vnd.hp-pcl"],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb","application/x-pilot"],["pde","text/x-processing"],["pdf","application/pdf"],["pem","application/x-x509-user-cert"],["pfa","application/x-font-type1"],["pfb","application/x-font-type1"],["pfm","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfx","application/x-pkcs12"],["pgm","image/x-portable-graymap"],["pgn","application/x-chess-pgn"],["pgp","application/pgp"],["php","application/x-httpd-php"],["php3","application/x-httpd-php"],["php4","application/x-httpd-php"],["phps","application/x-httpd-php-source"],["phtml","application/x-httpd-php"],["pic","image/x-pict"],["pkg","application/octet-stream"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pkpass","application/vnd.apple.pkpass"],["pl","application/x-perl"],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["pm","application/x-perl"],["pml","application/vnd.ctc-posml"],["png","image/png"],["pnm","image/x-portable-anymap"],["portpkg","application/vnd.macports.portpkg"],["pot","application/vnd.ms-powerpoint"],["potm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroEnabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps","application/vnd.ms-powerpoint"],["ppsm","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt","application/powerpoint"],["pptm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["pqa","application/vnd.palm"],["prc","application/x-pilot"],["pre","application/vnd.lotus-freelance"],["prf","application/pics-rules"],["provx","application/provenance+xml"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd","application/x-photoshop"],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["pti","image/prs.pti"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pwn","application/vnd.3m.post-it-notes"],["pya","audio/vnd.ms-playready.media.pya"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qfx","application/vnd.intu.qfx"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qwd","application/vnd.quark.quarkxpress"],["qwt","application/vnd.quark.quarkxpress"],["qxb","application/vnd.quark.quarkxpress"],["qxd","application/vnd.quark.quarkxpress"],["qxl","application/vnd.quark.quarkxpress"],["qxt","application/vnd.quark.quarkxpress"],["ra","audio/x-realaudio"],["ram","audio/x-pn-realaudio"],["raml","application/raml+yaml"],["rapd","application/route-apd+xml"],["rar","application/x-rar"],["ras","image/x-cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["relo","application/p2p-overlay+xml"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["ris","application/x-research-info-systems"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm","audio/x-pn-realaudio"],["rmi","audio/midi"],["rmp","audio/x-pn-realaudio-plugin"],["rms","application/vnd.jcp.javame.midlet-rms"],["rmvb","application/vnd.rn-realmedia-vbr"],["rnc","application/relax-ng-compact-syntax"],["rng","application/xml"],["roa","application/rpki-roa"],["roff","text/troff"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsa","application/x-pkcs7"],["rsat","application/atsc-rsat+xml"],["rsd","application/rsd+xml"],["rsheet","application/urc-ressheet+xml"],["rss","application/rss+xml"],["rtf","text/rtf"],["rtx","text/richtext"],["run","application/x-makeself"],["rusd","application/route-usd+xml"],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["sass","text/x-sass"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm","application/vnd.lotus-screencam"],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["scss","text/x-scss"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkd","application/vnd.solent.sdkm+xml"],["sdkm","application/vnd.solent.sdkm+xml"],["sdp","application/sdp"],["sdw","application/vnd.stardivision.writer"],["sea","application/octet-stream"],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["senmlx","application/senml+xml"],["sensmlx","application/sensml+xml"],["ser","application/java-serialized-object"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sfv","text/x-sfv"],["sgi","image/sgi"],["sgl","application/vnd.stardivision.writer-global"],["sgm","text/sgml"],["sgml","text/sgml"],["sh","application/x-sh"],["shar","application/x-shar"],["shex","text/shex"],["shf","application/shf+xml"],["shtml","text/html"],["sid","image/x-mrsid-image"],["sieve","application/sieve"],["sig","application/pgp-signature"],["sil","audio/silk"],["silo","model/mesh"],["sis","application/vnd.symbian.install"],["sisx","application/vnd.symbian.install"],["sit","application/x-stuffit"],["sitx","application/x-stuffitx"],["siv","application/sieve"],["skd","application/vnd.koan"],["skm","application/vnd.koan"],["skp","application/vnd.koan"],["skt","application/vnd.koan"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slim","text/slim"],["slm","text/slim"],["sls","application/route-s-tsid+xml"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi","application/smil"],["smil","application/smil"],["smv","video/x-smv"],["smzip","application/vnd.stepmania.package"],["snd","audio/basic"],["snf","application/x-font-snf"],["so","application/octet-stream"],["spc","application/x-pkcs7-certificates"],["spdx","text/spdx"],["spf","application/vnd.yamaha.smaf-phrase"],["spl","application/x-futuresplash"],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spx","audio/ogg"],["sql","application/x-sql"],["src","application/x-wais-source"],["srt","application/x-subrip"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["ssdl","application/ssdl+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssml","application/ssml+xml"],["sst","application/octet-stream"],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl","model/stl"],["stpx","model/step+xml"],["stpxz","model/step-xml+zip"],["stpz","model/step+zip"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["styl","text/stylus"],["stylus","text/stylus"],["sub","text/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["susp","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svg","image/svg+xml"],["svgz","image/svg+xml"],["swa","application/x-director"],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["swidtag","application/swid+xml"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t","text/troff"],["t3","application/x-t3vm-image"],["t38","image/t38"],["taglet","application/vnd.mynfc"],["tao","application/vnd.tao.intent-module-archive"],["tap","image/vnd.tencent.tap"],["tar","application/x-tar"],["tcap","application/vnd.3gpp2.tcap"],["tcl","application/x-tcl"],["td","application/urc-targetdesc+xml"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["teicorpus","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text","text/plain"],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tfx","image/tiff-fx"],["tga","image/x-tga"],["tgz","application/x-tar"],["thmx","application/vnd.ms-officetheme"],["tif","image/tiff"],["tiff","image/tiff"],["tk","application/x-tcl"],["tmo","application/vnd.tmobile-livetv"],["toml","application/toml"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","text/troff"],["tra","application/vnd.trueapp"],["trig","application/trig"],["trm","application/x-msterminal"],["ts","video/mp2t"],["tsd","application/timestamped-data"],["tsv","text/tab-separated-values"],["ttc","font/collection"],["ttf","font/ttf"],["ttl","text/turtle"],["ttml","application/ttml+xml"],["twd","application/vnd.simtech-mindmapper"],["twds","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["u8dsn","message/global-delivery-status"],["u8hdr","message/global-headers"],["u8mdn","message/global-disposition-notification"],["u8msg","message/global"],["u32","application/x-authorware-bin"],["ubj","application/ubjson"],["udeb","application/x-debian-package"],["ufd","application/vnd.ufdl"],["ufdl","application/vnd.ufdl"],["ulx","application/x-glulx"],["umj","application/vnd.umajin"],["unityweb","application/vnd.unity"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["urls","text/uri-list"],["usdz","model/vnd.usdz+zip"],["ustar","application/x-ustar"],["utz","application/vnd.uiq.theme"],["uu","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvd","application/vnd.dece.data"],["uvf","application/vnd.dece.data"],["uvg","image/vnd.dece.graphic"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvt","application/vnd.dece.ttml+xml"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["uvva","audio/vnd.dece.audio"],["uvvd","application/vnd.dece.data"],["uvvf","application/vnd.dece.data"],["uvvg","image/vnd.dece.graphic"],["uvvh","video/vnd.dece.hd"],["uvvi","image/vnd.dece.graphic"],["uvvm","video/vnd.dece.mobile"],["uvvp","video/vnd.dece.pd"],["uvvs","video/vnd.dece.sd"],["uvvt","application/vnd.dece.ttml+xml"],["uvvu","video/vnd.uvvu.mp4"],["uvvv","video/vnd.dece.video"],["uvvx","application/vnd.dece.unspecified"],["uvvz","application/vnd.dece.zip"],["uvx","application/vnd.dece.unspecified"],["uvz","application/vnd.dece.zip"],["vbox","application/x-virtualbox-vbox"],["vbox-extpack","application/x-virtualbox-vbox-extpack"],["vcard","text/vcard"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vdi","application/x-virtualbox-vdi"],["vds","model/vnd.sap.vds"],["vhd","application/x-virtualbox-vhd"],["vis","application/vnd.visionary"],["viv","video/vnd.vivo"],["vlc","application/videolan"],["vmdk","application/x-virtualbox-vmdk"],["vob","video/x-ms-vob"],["vor","application/vnd.stardivision.writer"],["vox","application/x-authorware-bin"],["vrml","model/vrml"],["vsd","application/vnd.visio"],["vsf","application/vnd.vsf"],["vss","application/vnd.visio"],["vst","application/vnd.visio"],["vsw","application/vnd.visio"],["vtf","image/vnd.valve.source.texture"],["vtt","text/vtt"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w3d","application/x-director"],["wad","application/x-doom"],["wadl","application/vnd.sun.wadl+xml"],["war","application/java-archive"],["wasm","application/wasm"],["wav","audio/x-wav"],["wax","audio/x-ms-wax"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["wdp","image/vnd.ms-photo"],["weba","audio/webm"],["webapp","application/x-web-app-manifest+json"],["webm","video/webm"],["webmanifest","application/manifest+json"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf","image/wmf"],["wml","text/vnd.wap.wml"],["wmlc","application/wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-msmetafile"],["woff","font/woff"],["woff2","font/woff2"],["word","application/msword"],["wpd","application/vnd.wordperfect"],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wqd","application/vnd.wqd"],["wri","application/x-mswrite"],["wrl","model/vrml"],["wsc","message/vnd.wfa.wsc"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wtb","application/vnd.webturbo"],["wvx","video/x-ms-wvx"],["x3d","model/x3d+xml"],["x3db","model/x3d+fastinfoset"],["x3dbz","model/x3d+binary"],["x3dv","model/x3d-vrml"],["x3dvz","model/x3d+vrml"],["x3dz","model/x3d+xml"],["x32","application/x-authorware-bin"],["x_b","model/vnd.parasolid.transmit.binary"],["x_t","model/vnd.parasolid.transmit.text"],["xaml","application/xaml+xml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xav","application/xcap-att+xml"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm","image/x-xbitmap"],["xca","application/xcap-caps+xml"],["xcs","application/calendar+xml"],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xel","application/xcap-el+xml"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xht","application/xhtml+xml"],["xhtml","application/xhtml+xml"],["xhvml","application/xv+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla","application/vnd.ms-excel"],["xlam","application/vnd.ms-excel.addin.macroEnabled.12"],["xlc","application/vnd.ms-excel"],["xlf","application/xliff+xml"],["xlm","application/vnd.ms-excel"],["xls","application/vnd.ms-excel"],["xlsb","application/vnd.ms-excel.sheet.binary.macroEnabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroEnabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt","application/vnd.ms-excel"],["xltm","application/vnd.ms-excel.template.macroEnabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlw","application/vnd.ms-excel"],["xm","audio/xm"],["xml","application/xml"],["xns","application/xcap-ns+xml"],["xo","application/vnd.olpc-sugar"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpl","application/xproc+xml"],["xpm","image/x-xpixmap"],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xpx","application/vnd.intercon.formnet"],["xsd","application/xml"],["xsl","application/xml"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xul","application/vnd.mozilla.xul+xml"],["xvm","application/xv+xml"],["xvml","application/xv+xml"],["xwd","image/x-xwindowdump"],["xyz","chemical/x-xyz"],["xz","application/x-xz"],["yaml","text/yaml"],["yang","application/yang"],["yin","application/yin+xml"],["yml","text/yaml"],["ymp","text/x-suse-ymp"],["z","application/x-compress"],["z1","application/x-zmachine"],["z2","application/x-zmachine"],["z3","application/x-zmachine"],["z4","application/x-zmachine"],["z5","application/x-zmachine"],["z6","application/x-zmachine"],["z7","application/x-zmachine"],["z8","application/x-zmachine"],["zaz","application/vnd.zzazz.deck+xml"],["zip","application/zip"],["zir","application/vnd.zul"],["zirz","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zsh","text/x-scriptzsh"]]);function Oc(i,o,d){const y=yT(i),{webkitRelativePath:x}=i,S=typeof o=="string"?o:typeof x=="string"&&x.length>0?x:`./${i.name}`;return typeof y.path!="string"&&Tx(y,"path",S),d!==void 0&&Object.defineProperty(y,"handle",{value:d,writable:!1,configurable:!1,enumerable:!0}),Tx(y,"relativePath",S),y}function yT(i){const{name:o}=i;if(o&&o.lastIndexOf(".")!==-1&&!i.type){const y=o.split(".").pop().toLowerCase(),x=gT.get(y);x&&Object.defineProperty(i,"type",{value:x,writable:!1,configurable:!1,enumerable:!0})}return i}function Tx(i,o,d){Object.defineProperty(i,o,{value:d,writable:!1,configurable:!1,enumerable:!0})}const _T=[".DS_Store","Thumbs.db"];function vT(i){return ll(this,void 0,void 0,function*(){return fm(i)&&xT(i.dataTransfer)?IT(i.dataTransfer,i.type):bT(i)?wT(i):Array.isArray(i)&&i.every(o=>"getFile"in o&&typeof o.getFile=="function")?CT(i):[]})}function xT(i){return fm(i)}function bT(i){return fm(i)&&fm(i.target)}function fm(i){return typeof i=="object"&&i!==null}function wT(i){return b0(i.target.files).map(o=>Oc(o))}function CT(i){return ll(this,void 0,void 0,function*(){return(yield Promise.all(i.map(d=>d.getFile()))).map(d=>Oc(d))})}function IT(i,o){return ll(this,void 0,void 0,function*(){if(i.items){const d=b0(i.items).filter(x=>x.kind==="file");if(o!=="drop")return d;const y=yield Promise.all(d.map(AT));return Px(uw(y))}return Px(b0(i.files).map(d=>Oc(d)))})}function Px(i){return i.filter(o=>_T.indexOf(o.name)===-1)}function b0(i){if(i===null)return[];const o=[];for(let d=0;d<i.length;d++){const y=i[d];o.push(y)}return o}function AT(i){if(typeof i.webkitGetAsEntry!="function")return kx(i);const o=i.webkitGetAsEntry();return o&&o.isDirectory?hw(o):kx(i,o)}function uw(i){return i.reduce((o,d)=>[...o,...Array.isArray(d)?uw(d):[d]],[])}function kx(i,o){return ll(this,void 0,void 0,function*(){var d;if(globalThis.isSecureContext&&typeof i.getAsFileSystemHandle=="function"){const S=yield i.getAsFileSystemHandle();if(S===null)throw new Error(`${i} is not a File`);if(S!==void 0){const b=yield S.getFile();return b.handle=S,Oc(b)}}const y=i.getAsFile();if(!y)throw new Error(`${i} is not a File`);return Oc(y,(d=o==null?void 0:o.fullPath)!==null&&d!==void 0?d:void 0)})}function ST(i){return ll(this,void 0,void 0,function*(){return i.isDirectory?hw(i):TT(i)})}function hw(i){const o=i.createReader();return new Promise((d,y)=>{const x=[];function S(){o.readEntries(b=>ll(this,void 0,void 0,function*(){if(b.length){const c=Promise.all(b.map(ST));x.push(c),S()}else try{const c=yield Promise.all(x);d(c)}catch(c){y(c)}}),b=>{y(b)})}S()})}function TT(i){return ll(this,void 0,void 0,function*(){return new Promise((o,d)=>{i.file(y=>{const x=Oc(y,i.fullPath);o(x)},y=>{d(y)})})})}var Cg=function(i,o){if(i&&o){var d=Array.isArray(o)?o:o.split(",");if(d.length===0)return!0;var y=i.name||"",x=(i.type||"").toLowerCase(),S=x.replace(/\/.*$/,"");return d.some(function(b){var c=b.trim().toLowerCase();return c.charAt(0)==="."?y.toLowerCase().endsWith(c):c.endsWith("/*")?S===c.replace(/\/.*$/,""):x===c})}return!0};function Mx(i){return MT(i)||kT(i)||pw(i)||PT()}function PT(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kT(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function MT(i){if(Array.isArray(i))return w0(i)}function Ex(i,o){var d=Object.keys(i);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(i);o&&(y=y.filter(function(x){return Object.getOwnPropertyDescriptor(i,x).enumerable})),d.push.apply(d,y)}return d}function zx(i){for(var o=1;o<arguments.length;o++){var d=arguments[o]!=null?arguments[o]:{};o%2?Ex(Object(d),!0).forEach(function(y){dw(i,y,d[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(d)):Ex(Object(d)).forEach(function(y){Object.defineProperty(i,y,Object.getOwnPropertyDescriptor(d,y))})}return i}function dw(i,o,d){return o in i?Object.defineProperty(i,o,{value:d,enumerable:!0,configurable:!0,writable:!0}):i[o]=d,i}function Gh(i,o){return NT(i)||zT(i,o)||pw(i,o)||ET()}function ET(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pw(i,o){if(i){if(typeof i=="string")return w0(i,o);var d=Object.prototype.toString.call(i).slice(8,-1);if(d==="Object"&&i.constructor&&(d=i.constructor.name),d==="Map"||d==="Set")return Array.from(i);if(d==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(d))return w0(i,o)}}function w0(i,o){(o==null||o>i.length)&&(o=i.length);for(var d=0,y=new Array(o);d<o;d++)y[d]=i[d];return y}function zT(i,o){var d=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(d!=null){var y=[],x=!0,S=!1,b,c;try{for(d=d.call(i);!(x=(b=d.next()).done)&&(y.push(b.value),!(o&&y.length===o));x=!0);}catch(F){S=!0,c=F}finally{try{!x&&d.return!=null&&d.return()}finally{if(S)throw c}}return y}}function NT(i){if(Array.isArray(i))return i}var DT=typeof Cg=="function"?Cg:Cg.default,LT="file-invalid-type",RT="file-too-large",FT="file-too-small",BT="too-many-files",jT=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",d=o.split(","),y=d.length>1?"one of ".concat(d.join(", ")):d[0];return{code:LT,message:"File type must be ".concat(y)}},Nx=function(o){return{code:RT,message:"File is larger than ".concat(o," ").concat(o===1?"byte":"bytes")}},Dx=function(o){return{code:FT,message:"File is smaller than ".concat(o," ").concat(o===1?"byte":"bytes")}},OT={code:BT,message:"Too many files"};function mw(i,o){var d=i.type==="application/x-moz-file"||DT(i,o);return[d,d?null:jT(o)]}function fw(i,o,d){if(Hs(i.size))if(Hs(o)&&Hs(d)){if(i.size>d)return[!1,Nx(d)];if(i.size<o)return[!1,Dx(o)]}else{if(Hs(o)&&i.size<o)return[!1,Dx(o)];if(Hs(d)&&i.size>d)return[!1,Nx(d)]}return[!0,null]}function Hs(i){return i!=null}function VT(i){var o=i.files,d=i.accept,y=i.minSize,x=i.maxSize,S=i.multiple,b=i.maxFiles,c=i.validator;return!S&&o.length>1||S&&b>=1&&o.length>b?!1:o.every(function(F){var W=mw(F,d),se=Gh(W,1),re=se[0],ce=fw(F,y,x),K=Gh(ce,1),Ie=K[0],Te=c?c(F):null;return re&&Ie&&!Te})}function gm(i){return typeof i.isPropagationStopped=="function"?i.isPropagationStopped():typeof i.cancelBubble<"u"?i.cancelBubble:!1}function kp(i){return i.dataTransfer?Array.prototype.some.call(i.dataTransfer.types,function(o){return o==="Files"||o==="application/x-moz-file"}):!!i.target&&!!i.target.files}function Lx(i){i.preventDefault()}function UT(i){return i.indexOf("MSIE")!==-1||i.indexOf("Trident/")!==-1}function $T(i){return i.indexOf("Edge/")!==-1}function ZT(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return UT(i)||$T(i)}function Pa(){for(var i=arguments.length,o=new Array(i),d=0;d<i;d++)o[d]=arguments[d];return function(y){for(var x=arguments.length,S=new Array(x>1?x-1:0),b=1;b<x;b++)S[b-1]=arguments[b];return o.some(function(c){return!gm(y)&&c&&c.apply(void 0,[y].concat(S)),gm(y)})}}function GT(){return"showOpenFilePicker"in window}function WT(i){if(Hs(i)){var o=Object.entries(i).filter(function(d){var y=Gh(d,2),x=y[0],S=y[1],b=!0;return gw(x)||(console.warn('Skipped "'.concat(x,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),b=!1),(!Array.isArray(S)||!S.every(yw))&&(console.warn('Skipped "'.concat(x,'" because an invalid file extension was provided.')),b=!1),b}).reduce(function(d,y){var x=Gh(y,2),S=x[0],b=x[1];return zx(zx({},d),{},dw({},S,b))},{});return[{description:"Files",accept:o}]}return i}function qT(i){if(Hs(i))return Object.entries(i).reduce(function(o,d){var y=Gh(d,2),x=y[0],S=y[1];return[].concat(Mx(o),[x],Mx(S))},[]).filter(function(o){return gw(o)||yw(o)}).join(",")}function HT(i){return i instanceof DOMException&&(i.name==="AbortError"||i.code===i.ABORT_ERR)}function XT(i){return i instanceof DOMException&&(i.name==="SecurityError"||i.code===i.SECURITY_ERR)}function gw(i){return i==="audio/*"||i==="video/*"||i==="image/*"||i==="text/*"||i==="application/*"||/\w+\/[-+.\w]+/g.test(i)}function yw(i){return/^.*\.[\w]+$/.test(i)}var KT=["children"],YT=["open"],JT=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],QT=["refKey","onChange","onClick"];function eP(i){return nP(i)||iP(i)||_w(i)||tP()}function tP(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iP(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function nP(i){if(Array.isArray(i))return C0(i)}function Ig(i,o){return oP(i)||aP(i,o)||_w(i,o)||rP()}function rP(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _w(i,o){if(i){if(typeof i=="string")return C0(i,o);var d=Object.prototype.toString.call(i).slice(8,-1);if(d==="Object"&&i.constructor&&(d=i.constructor.name),d==="Map"||d==="Set")return Array.from(i);if(d==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(d))return C0(i,o)}}function C0(i,o){(o==null||o>i.length)&&(o=i.length);for(var d=0,y=new Array(o);d<o;d++)y[d]=i[d];return y}function aP(i,o){var d=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(d!=null){var y=[],x=!0,S=!1,b,c;try{for(d=d.call(i);!(x=(b=d.next()).done)&&(y.push(b.value),!(o&&y.length===o));x=!0);}catch(F){S=!0,c=F}finally{try{!x&&d.return!=null&&d.return()}finally{if(S)throw c}}return y}}function oP(i){if(Array.isArray(i))return i}function Rx(i,o){var d=Object.keys(i);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(i);o&&(y=y.filter(function(x){return Object.getOwnPropertyDescriptor(i,x).enumerable})),d.push.apply(d,y)}return d}function Si(i){for(var o=1;o<arguments.length;o++){var d=arguments[o]!=null?arguments[o]:{};o%2?Rx(Object(d),!0).forEach(function(y){I0(i,y,d[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(d)):Rx(Object(d)).forEach(function(y){Object.defineProperty(i,y,Object.getOwnPropertyDescriptor(d,y))})}return i}function I0(i,o,d){return o in i?Object.defineProperty(i,o,{value:d,enumerable:!0,configurable:!0,writable:!0}):i[o]=d,i}function ym(i,o){if(i==null)return{};var d=sP(i,o),y,x;if(Object.getOwnPropertySymbols){var S=Object.getOwnPropertySymbols(i);for(x=0;x<S.length;x++)y=S[x],!(o.indexOf(y)>=0)&&Object.prototype.propertyIsEnumerable.call(i,y)&&(d[y]=i[y])}return d}function sP(i,o){if(i==null)return{};var d={},y=Object.keys(i),x,S;for(S=0;S<y.length;S++)x=y[S],!(o.indexOf(x)>=0)&&(d[x]=i[x]);return d}var Sy=Me.forwardRef(function(i,o){var d=i.children,y=ym(i,KT),x=xw(y),S=x.open,b=ym(x,YT);return Me.useImperativeHandle(o,function(){return{open:S}},[S]),vm.createElement(Me.Fragment,null,d(Si(Si({},b),{},{open:S})))});Sy.displayName="Dropzone";var vw={disabled:!1,getFilesFromEvent:vT,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1,autoFocus:!1};Sy.defaultProps=vw;Sy.propTypes={children:oi.func,accept:oi.objectOf(oi.arrayOf(oi.string)),multiple:oi.bool,preventDropOnDocument:oi.bool,noClick:oi.bool,noKeyboard:oi.bool,noDrag:oi.bool,noDragEventsBubbling:oi.bool,minSize:oi.number,maxSize:oi.number,maxFiles:oi.number,disabled:oi.bool,getFilesFromEvent:oi.func,onFileDialogCancel:oi.func,onFileDialogOpen:oi.func,useFsAccessApi:oi.bool,autoFocus:oi.bool,onDragEnter:oi.func,onDragLeave:oi.func,onDragOver:oi.func,onDrop:oi.func,onDropAccepted:oi.func,onDropRejected:oi.func,onError:oi.func,validator:oi.func};var A0={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function xw(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=Si(Si({},vw),i),d=o.accept,y=o.disabled,x=o.getFilesFromEvent,S=o.maxSize,b=o.minSize,c=o.multiple,F=o.maxFiles,W=o.onDragEnter,se=o.onDragLeave,re=o.onDragOver,ce=o.onDrop,K=o.onDropAccepted,Ie=o.onDropRejected,Te=o.onFileDialogCancel,We=o.onFileDialogOpen,he=o.useFsAccessApi,oe=o.autoFocus,fe=o.preventDropOnDocument,De=o.noClick,Xe=o.noKeyboard,tt=o.noDrag,et=o.noDragEventsBubbling,lt=o.onError,Lt=o.validator,mt=Me.useMemo(function(){return qT(d)},[d]),di=Me.useMemo(function(){return WT(d)},[d]),Mi=Me.useMemo(function(){return typeof We=="function"?We:Fx},[We]),Bi=Me.useMemo(function(){return typeof Te=="function"?Te:Fx},[Te]),si=Me.useRef(null),_i=Me.useRef(null),Gn=Me.useReducer(lP,A0),Mn=Ig(Gn,2),Qe=Mn[0],He=Mn[1],yt=Qe.isFocused,At=Qe.isFileDialogActive,Rt=Me.useRef(typeof window<"u"&&window.isSecureContext&&he&&GT()),qi=function(){!Rt.current&&At&&setTimeout(function(){if(_i.current){var ht=_i.current.files;ht.length||(He({type:"closeDialog"}),Bi())}},300)};Me.useEffect(function(){return window.addEventListener("focus",qi,!1),function(){window.removeEventListener("focus",qi,!1)}},[_i,At,Bi,Rt]);var pi=Me.useRef([]),En=function(ht){si.current&&si.current.contains(ht.target)||(ht.preventDefault(),pi.current=[])};Me.useEffect(function(){return fe&&(document.addEventListener("dragover",Lx,!1),document.addEventListener("drop",En,!1)),function(){fe&&(document.removeEventListener("dragover",Lx),document.removeEventListener("drop",En))}},[si,fe]),Me.useEffect(function(){return!y&&oe&&si.current&&si.current.focus(),function(){}},[si,oe,y]);var jt=Me.useCallback(function(Ye){lt?lt(Ye):console.error(Ye)},[lt]),zn=Me.useCallback(function(Ye){Ye.preventDefault(),Ye.persist(),yr(Ye),pi.current=[].concat(eP(pi.current),[Ye.target]),kp(Ye)&&Promise.resolve(x(Ye)).then(function(ht){if(!(gm(Ye)&&!et)){var Vt=ht.length,Gt=Vt>0&&VT({files:ht,accept:mt,minSize:b,maxSize:S,multiple:c,maxFiles:F,validator:Lt}),zi=Vt>0&&!Gt;He({isDragAccept:Gt,isDragReject:zi,isDragActive:!0,type:"setDraggedFiles"}),W&&W(Ye)}}).catch(function(ht){return jt(ht)})},[x,W,jt,et,mt,b,S,c,F,Lt]),vn=Me.useCallback(function(Ye){Ye.preventDefault(),Ye.persist(),yr(Ye);var ht=kp(Ye);if(ht&&Ye.dataTransfer)try{Ye.dataTransfer.dropEffect="copy"}catch{}return ht&&re&&re(Ye),!1},[re,et]),Nn=Me.useCallback(function(Ye){Ye.preventDefault(),Ye.persist(),yr(Ye);var ht=pi.current.filter(function(Gt){return si.current&&si.current.contains(Gt)}),Vt=ht.indexOf(Ye.target);Vt!==-1&&ht.splice(Vt,1),pi.current=ht,!(ht.length>0)&&(He({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),kp(Ye)&&se&&se(Ye))},[si,se,et]),fr=Me.useCallback(function(Ye,ht){var Vt=[],Gt=[];Ye.forEach(function(zi){var me=mw(zi,mt),j=Ig(me,2),O=j[0],Z=j[1],ee=fw(zi,b,S),le=Ig(ee,2),ge=le[0],xe=le[1],ye=Lt?Lt(zi):null;if(O&&ge&&!ye)Vt.push(zi);else{var Pe=[Z,xe];ye&&(Pe=Pe.concat(ye)),Gt.push({file:zi,errors:Pe.filter(function(Fe){return Fe})})}}),(!c&&Vt.length>1||c&&F>=1&&Vt.length>F)&&(Vt.forEach(function(zi){Gt.push({file:zi,errors:[OT]})}),Vt.splice(0)),He({acceptedFiles:Vt,fileRejections:Gt,isDragReject:Gt.length>0,type:"setFiles"}),ce&&ce(Vt,Gt,ht),Gt.length>0&&Ie&&Ie(Gt,ht),Vt.length>0&&K&&K(Vt,ht)},[He,c,mt,b,S,F,ce,K,Ie,Lt]),gr=Me.useCallback(function(Ye){Ye.preventDefault(),Ye.persist(),yr(Ye),pi.current=[],kp(Ye)&&Promise.resolve(x(Ye)).then(function(ht){gm(Ye)&&!et||fr(ht,Ye)}).catch(function(ht){return jt(ht)}),He({type:"reset"})},[x,fr,jt,et]),Ei=Me.useCallback(function(){if(Rt.current){He({type:"openDialog"}),Mi();var Ye={multiple:c,types:di};window.showOpenFilePicker(Ye).then(function(ht){return x(ht)}).then(function(ht){fr(ht,null),He({type:"closeDialog"})}).catch(function(ht){HT(ht)?(Bi(ht),He({type:"closeDialog"})):XT(ht)?(Rt.current=!1,_i.current?(_i.current.value=null,_i.current.click()):jt(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):jt(ht)});return}_i.current&&(He({type:"openDialog"}),Mi(),_i.current.value=null,_i.current.click())},[He,Mi,Bi,he,fr,jt,di,c]),ni=Me.useCallback(function(Ye){!si.current||!si.current.isEqualNode(Ye.target)||(Ye.key===" "||Ye.key==="Enter"||Ye.keyCode===32||Ye.keyCode===13)&&(Ye.preventDefault(),Ei())},[si,Ei]),li=Me.useCallback(function(){He({type:"focus"})},[]),Dn=Me.useCallback(function(){He({type:"blur"})},[]),Wn=Me.useCallback(function(){De||(ZT()?setTimeout(Ei,0):Ei())},[De,Ei]),Ln=function(ht){return y?null:ht},Rn=function(ht){return Xe?null:Ln(ht)},xn=function(ht){return tt?null:Ln(ht)},yr=function(ht){et&&ht.stopPropagation()},Dr=Me.useMemo(function(){return function(){var Ye=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ht=Ye.refKey,Vt=ht===void 0?"ref":ht,Gt=Ye.role,zi=Ye.onKeyDown,me=Ye.onFocus,j=Ye.onBlur,O=Ye.onClick,Z=Ye.onDragEnter,ee=Ye.onDragOver,le=Ye.onDragLeave,ge=Ye.onDrop,xe=ym(Ye,JT);return Si(Si(I0({onKeyDown:Rn(Pa(zi,ni)),onFocus:Rn(Pa(me,li)),onBlur:Rn(Pa(j,Dn)),onClick:Ln(Pa(O,Wn)),onDragEnter:xn(Pa(Z,zn)),onDragOver:xn(Pa(ee,vn)),onDragLeave:xn(Pa(le,Nn)),onDrop:xn(Pa(ge,gr)),role:typeof Gt=="string"&&Gt!==""?Gt:"presentation"},Vt,si),!y&&!Xe?{tabIndex:0}:{}),xe)}},[si,ni,li,Dn,Wn,zn,vn,Nn,gr,Xe,tt,y]),Lr=Me.useCallback(function(Ye){Ye.stopPropagation()},[]),Rr=Me.useMemo(function(){return function(){var Ye=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ht=Ye.refKey,Vt=ht===void 0?"ref":ht,Gt=Ye.onChange,zi=Ye.onClick,me=ym(Ye,QT),j=I0({accept:mt,multiple:c,type:"file",style:{border:0,clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",height:"1px",margin:"0 -1px -1px 0",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"},onChange:Ln(Pa(Gt,gr)),onClick:Ln(Pa(zi,Lr)),tabIndex:-1},Vt,_i);return Si(Si({},j),me)}},[_i,d,c,gr,y]);return Si(Si({},Qe),{},{isFocused:yt&&!y,getRootProps:Dr,getInputProps:Rr,rootRef:si,inputRef:_i,open:Ln(Ei)})}function lP(i,o){switch(o.type){case"focus":return Si(Si({},i),{},{isFocused:!0});case"blur":return Si(Si({},i),{},{isFocused:!1});case"openDialog":return Si(Si({},A0),{},{isFileDialogActive:!0});case"closeDialog":return Si(Si({},i),{},{isFileDialogActive:!1});case"setDraggedFiles":return Si(Si({},i),{},{isDragActive:o.isDragActive,isDragAccept:o.isDragAccept,isDragReject:o.isDragReject});case"setFiles":return Si(Si({},i),{},{acceptedFiles:o.acceptedFiles,fileRejections:o.fileRejections,isDragReject:o.isDragReject});case"reset":return Si({},A0);default:return i}}function Fx(){}const cP=()=>{const[i,o]=Me.useState("upload"),[d,y]=Me.useState([]),[x,S]=Me.useState(""),[b,c]=Me.useState({village:"",pattaId:"",holderName:"",coordinates:""}),[F,W]=Me.useState(!1),{getRootProps:se,getInputProps:re,isDragActive:ce}=xw({onDrop:he=>{y(he)},accept:{"application/pdf":[".pdf"],"image/*":[".jpeg",".jpg",".png",".tiff"]},maxFiles:1}),K=()=>{W(!0),setTimeout(()=>{S(`Village: Kothapally
Patta ID: PT-2023-045
Holder Name: Ram Prasad
Coordinates: 78.456, 17.123
Area: 2.5 hectares
Date: 2023-05-10
Witness: Suresh Kumar`),W(!1),o("ocr")},2e3)},Ie=()=>{W(!0),setTimeout(()=>{c({village:"Kothapally",pattaId:"PT-2023-045",holderName:"Ram Prasad",coordinates:"78.456, 17.123"}),W(!1),o("ner")},1500)},Te=(he,oe)=>{c({...b,[he]:oe})},We=()=>{console.log("Saving claim with data:",{uploadedFiles:d,ocrText:x,nerFields:b}),o("review")};return $("div",{className:"min-h-screen bg-gray-50",children:[A("div",{className:"bg-white shadow",children:$("div",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:[A("h1",{className:"text-3xl font-bold text-gray-900",children:"Document Digitization"}),A("p",{className:"mt-1 text-sm text-gray-500",children:"Upload documents, extract data, and create claims"})]})}),A("div",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:$("div",{className:"px-4 py-6 sm:px-0",children:[A("div",{className:"mb-8",children:A("nav",{"aria-label":"Progress",children:A("ol",{className:"space-y-4 md:flex md:space-y-0 md:space-x-8",children:["upload","ocr","ner","geometry","review"].map((he,oe)=>A("li",{className:"md:flex-1",children:i===he?$("div",{className:"group pl-4 py-2 flex flex-col border-l-4 border-indigo-600 md:pl-0 md:pt-4 md:pb-0 md:border-l-0 md:border-t-4",children:[A("span",{className:"text-xs font-semibold tracking-wide uppercase text-indigo-600",children:he}),A("span",{className:"text-sm font-medium text-gray-900 capitalize",children:he})]}):$("div",{className:"group pl-4 py-2 flex flex-col border-l-4 border-gray-200 md:pl-0 md:pt-4 md:pb-0 md:border-l-0 md:border-t-4",children:[A("span",{className:"text-xs font-semibold tracking-wide uppercase text-gray-500 group-hover:text-gray-700",children:he}),A("span",{className:"text-sm font-medium text-gray-500 group-hover:text-gray-700 capitalize",children:he})]})},he))})})}),i==="upload"&&A("div",{className:"bg-white shadow sm:rounded-lg",children:$("div",{className:"px-4 py-5 sm:p-6",children:[A("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Upload Document"}),A("div",{className:"mt-2 max-w-xl text-sm text-gray-500",children:A("p",{children:"Upload a scanned PDF or image of a forest rights document to begin digitization."})}),$("div",{className:"mt-5",children:[$("div",{...se(),className:"border-2 border-dashed border-gray-300 rounded-lg p-12 text-center cursor-pointer hover:border-indigo-400",children:[A("input",{...re()}),ce?A("p",{className:"text-indigo-600",children:"Drop the files here ..."}):$(zp,{children:[A("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:A("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),$("p",{className:"mt-2 text-sm text-gray-600",children:[A("span",{className:"font-medium text-indigo-600",children:"Click to upload"})," or drag and drop"]}),A("p",{className:"mt-1 text-xs text-gray-500",children:"PDF, JPG, PNG, or TIFF up to 10MB"})]})]}),d.length>0&&$("div",{className:"mt-4",children:[A("h4",{className:"text-sm font-medium text-gray-900",children:"Selected file:"}),A("ul",{className:"mt-2 divide-y divide-gray-200 rounded-md border border-gray-200",children:d.map((he,oe)=>$("li",{className:"flex items-center justify-between py-3 pl-3 pr-4 text-sm",children:[$("div",{className:"flex w-0 flex-1 items-center",children:[A("svg",{className:"h-5 w-5 flex-shrink-0 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:A("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z",clipRule:"evenodd"})}),A("span",{className:"ml-2 w-0 flex-1 truncate",children:he.name})]}),A("div",{className:"ml-4 flex-shrink-0",children:$("span",{className:"font-medium text-indigo-600",children:[(he.size/1024/1024).toFixed(2)," MB"]})})]},oe))})]})]}),A("div",{className:"mt-6",children:A("button",{type:"button",disabled:d.length===0||F,onClick:K,className:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white ${d.length===0||F?"bg-gray-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"}`,children:F?$(zp,{children:[$("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[A("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),A("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):"Run OCR Extraction"})})]})}),i==="ocr"&&A("div",{className:"bg-white shadow sm:rounded-lg",children:$("div",{className:"px-4 py-5 sm:p-6",children:[A("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"OCR Results"}),A("div",{className:"mt-2 max-w-xl text-sm text-gray-500",children:A("p",{children:"Text extracted from the document:"})}),A("div",{className:"mt-4",children:A("div",{className:"bg-gray-50 p-4 rounded-md",children:A("pre",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:x})})}),A("div",{className:"mt-6",children:A("button",{type:"button",onClick:Ie,disabled:F,className:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white ${F?"bg-gray-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"}`,children:F?$(zp,{children:[$("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[A("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),A("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Extracting fields..."]}):"Extract Fields with NER"})})]})}),i==="ner"&&A("div",{className:"bg-white shadow sm:rounded-lg",children:$("div",{className:"px-4 py-5 sm:p-6",children:[A("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Extracted Fields"}),A("div",{className:"mt-2 max-w-xl text-sm text-gray-500",children:A("p",{children:"Review and correct the extracted information:"})}),$("div",{className:"mt-6 grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6",children:[$("div",{className:"sm:col-span-3",children:[A("label",{htmlFor:"village",className:"block text-sm font-medium text-gray-700",children:"Village"}),A("div",{className:"mt-1",children:A("input",{type:"text",name:"village",id:"village",value:b.village,onChange:he=>Te("village",he.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})})]}),$("div",{className:"sm:col-span-3",children:[A("label",{htmlFor:"pattaId",className:"block text-sm font-medium text-gray-700",children:"Patta ID"}),A("div",{className:"mt-1",children:A("input",{type:"text",name:"pattaId",id:"pattaId",value:b.pattaId,onChange:he=>Te("pattaId",he.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})})]}),$("div",{className:"sm:col-span-4",children:[A("label",{htmlFor:"holderName",className:"block text-sm font-medium text-gray-700",children:"Holder Name"}),A("div",{className:"mt-1",children:A("input",{type:"text",name:"holderName",id:"holderName",value:b.holderName,onChange:he=>Te("holderName",he.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})})]}),$("div",{className:"sm:col-span-6",children:[A("label",{htmlFor:"coordinates",className:"block text-sm font-medium text-gray-700",children:"Coordinates"}),A("div",{className:"mt-1",children:A("input",{type:"text",name:"coordinates",id:"coordinates",value:b.coordinates,onChange:he=>Te("coordinates",he.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})})]})]}),$("div",{className:"mt-6 flex items-center justify-end space-x-4",children:[A("button",{type:"button",onClick:()=>o("ocr"),className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Back"}),A("button",{type:"button",onClick:()=>o("geometry"),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Continue to Geometry"})]})]})}),i==="geometry"&&A("div",{className:"bg-white shadow sm:rounded-lg",children:$("div",{className:"px-4 py-5 sm:p-6",children:[A("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Claim Geometry"}),A("div",{className:"mt-2 max-w-xl text-sm text-gray-500",children:A("p",{children:"Define the boundary of the claim on the map:"})}),A("div",{className:"mt-6",children:A("div",{className:"h-96 bg-gray-100 rounded-lg flex items-center justify-center",children:$("div",{className:"text-center",children:[A("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),A("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Map Editor"}),A("p",{className:"mt-1 text-sm text-gray-500",children:"Interactive map for drawing claim boundaries would be displayed here."}),A("div",{className:"mt-6",children:A("button",{type:"button",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Draw Boundary"})})]})})}),$("div",{className:"mt-6 flex items-center justify-end space-x-4",children:[A("button",{type:"button",onClick:()=>o("ner"),className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Back"}),A("button",{type:"button",onClick:We,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Save Claim"})]})]})}),i==="review"&&A("div",{className:"bg-white shadow sm:rounded-lg",children:$("div",{className:"px-4 py-5 sm:p-6",children:[A("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Claim Created Successfully"}),A("div",{className:"mt-2 max-w-xl text-sm text-gray-500",children:A("p",{children:"Your claim has been created and is ready for review."})}),A("div",{className:"mt-6",children:A("div",{className:"rounded-md bg-green-50 p-4",children:$("div",{className:"flex",children:[A("div",{className:"flex-shrink-0",children:A("svg",{className:"h-5 w-5 text-green-400",fill:"currentColor",viewBox:"0 0 20 20",children:A("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),$("div",{className:"ml-3",children:[A("h3",{className:"text-sm font-medium text-green-800",children:"Claim ID: CR-2023-045"}),$("div",{className:"mt-2 text-sm text-green-700",children:[$("p",{children:["Village: ",b.village]}),$("p",{children:["Holder: ",b.holderName]}),$("p",{children:["Patta ID: ",b.pattaId]})]})]})]})})}),$("div",{className:"mt-6 flex items-center justify-end space-x-4",children:[A("button",{type:"button",onClick:()=>{o("upload"),y([]),S(""),c({village:"",pattaId:"",holderName:"",coordinates:""})},className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Process Another Document"}),A("button",{type:"button",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"View Claim Details"})]})]})})]})})]})},uP=()=>{const[i,o]=Me.useState("all"),[d,y]=Me.useState(70),[x,S]=Me.useState(""),b=[{id:"farm-1",type:"Agricultural Land",name:"Farm Plot A",village:"Village A",confidence:95,area:"2.3 ha",coordinates:"78.45, 17.12"},{id:"farm-2",type:"Agricultural Land",name:"Farm Plot B",village:"Village A",confidence:87,area:"1.8 ha",coordinates:"78.46, 17.13"},{id:"pond-1",type:"Pond",name:"Community Pond",village:"Village A",confidence:92,area:"0.5 ha",coordinates:"78.44, 17.11"},{id:"forest-1",type:"Forest Patch",name:"Deciduous Forest",village:"Village B",confidence:88,area:"5.2 ha",coordinates:"78.55, 17.22"},{id:"well-1",type:"Borewell",name:"Borewell #123",village:"Village B",confidence:96,depth:"45m",coordinates:"78.56, 17.23"},{id:"well-2",type:"Borewell",name:"Borewell #124",village:"Village B",confidence:78,depth:"38m",coordinates:"78.57, 17.24"},{id:"road-1",type:"Road",name:"Village Road",village:"Village C",confidence:91,length:"1.2 km",coordinates:"78.65, 17.32"},{id:"stream-1",type:"Stream",name:"Seasonal Stream",village:"Village C",confidence:85,length:"0.8 km",coordinates:"78.66, 17.33"}],c=b.filter(W=>{const se=i==="all"||W.type===i,re=W.confidence>=d,ce=W.name.toLowerCase().includes(x.toLowerCase())||W.village.toLowerCase().includes(x.toLowerCase());return se&&re&&ce});return $("div",{className:"min-h-screen bg-gray-50",children:[A("div",{className:"bg-white shadow",children:$("div",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:[A("h1",{className:"text-3xl font-bold text-gray-900",children:"Asset Mapping"}),A("p",{className:"mt-1 text-sm text-gray-500",children:"AI-detected assets and infrastructure"})]})}),A("div",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:A("div",{className:"px-4 py-6 sm:px-0",children:$("div",{className:"flex flex-col lg:flex-row gap-6",children:[$("div",{className:"lg:w-1/4",children:[$("div",{className:"bg-white shadow rounded-lg p-6",children:[A("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Filters"}),$("div",{className:"mb-6",children:[A("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search Assets"}),$("div",{className:"relative rounded-md shadow-sm",children:[A("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:A("svg",{className:"h-5 w-5 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:A("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})})}),A("input",{type:"text",id:"search",className:"focus:ring-indigo-500 focus:border-indigo-500 block w-full pl-10 pr-12 sm:text-sm border-gray-300 rounded-md",placeholder:"Search by name or village...",value:x,onChange:W=>S(W.target.value)})]})]}),$("div",{className:"mb-6",children:[A("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asset Type"}),A("div",{className:"space-y-2",children:["all","Agricultural Land","Forest Patch","Pond","Borewell","Road","Stream"].map(W=>$("div",{className:"flex items-center",children:[A("input",{id:`type-${W}`,name:"asset-type",type:"radio",checked:i===W,onChange:()=>o(W),className:"focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300"}),A("label",{htmlFor:`type-${W}`,className:"ml-3 block text-sm text-gray-700 capitalize",children:W==="all"?"All Assets":W})]},W))})]}),$("div",{children:[$("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Confidence Threshold: ",d,"%"]}),A("input",{type:"range",min:"0",max:"100",value:d,onChange:W=>y(parseInt(W.target.value)),className:"w-full"}),$("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[A("span",{children:"0%"}),A("span",{children:"100%"})]})]})]}),$("div",{className:"bg-white shadow rounded-lg p-6 mt-6",children:[A("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Summary"}),$("div",{className:"space-y-3",children:[$("div",{className:"flex justify-between",children:[A("span",{className:"text-sm text-gray-500",children:"Total Assets"}),A("span",{className:"text-sm font-medium text-gray-900",children:b.length})]}),$("div",{className:"flex justify-between",children:[A("span",{className:"text-sm text-gray-500",children:"Filtered Assets"}),A("span",{className:"text-sm font-medium text-gray-900",children:c.length})]}),$("div",{className:"flex justify-between",children:[A("span",{className:"text-sm text-gray-500",children:"Avg Confidence"}),A("span",{className:"text-sm font-medium text-gray-900",children:c.length>0?Math.round(c.reduce((W,se)=>W+se.confidence,0)/c.length)+"%":"0%"})]})]})]})]}),$("div",{className:"lg:w-3/4",children:[A("div",{className:"bg-white shadow rounded-lg mb-6",children:$("div",{className:"px-4 py-5 sm:p-6",children:[A("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Asset Map"}),A("div",{className:"h-96 bg-gray-100 rounded-lg flex items-center justify-center",children:$("div",{className:"text-center",children:[A("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),A("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Asset Map"}),A("p",{className:"mt-1 text-sm text-gray-500",children:"Interactive map showing AI-detected assets would be displayed here."})]})})]})}),$("div",{className:"bg-white shadow rounded-lg",children:[$("div",{className:"px-4 py-5 sm:px-6",children:[A("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Detected Assets"}),A("p",{className:"mt-1 max-w-2xl text-sm text-gray-500",children:"List of AI-detected assets in the current view"})]}),A("div",{className:"border-t border-gray-200",children:A("ul",{className:"divide-y divide-gray-200",children:c.map(W=>A("li",{children:A("div",{className:"px-4 py-4 sm:px-6",children:$("div",{className:"flex items-center justify-between",children:[$("div",{className:"flex items-center",children:[$("div",{className:`flex-shrink-0 h-10 w-10 rounded-full flex items-center justify-center ${W.type==="Agricultural Land"?"bg-green-100":W.type==="Forest Patch"?"bg-emerald-100":W.type==="Pond"?"bg-blue-100":W.type==="Borewell"?"bg-cyan-100":W.type==="Road"?"bg-yellow-100":"bg-purple-100"}`,children:[W.type==="Agricultural Land"&&A("svg",{className:"h-6 w-6 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4 4 0 003 15z"})}),W.type==="Forest Patch"&&A("svg",{className:"h-6 w-6 text-emerald-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})}),W.type==="Pond"&&A("svg",{className:"h-6 w-6 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),W.type==="Borewell"&&A("svg",{className:"h-6 w-6 text-cyan-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})}),W.type==="Road"&&A("svg",{className:"h-6 w-6 text-yellow-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),W.type==="Stream"&&A("svg",{className:"h-6 w-6 text-purple-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7l4-4m0 0l4 4m-4-4v18m0 0l-4-4m4 4l4-4"})})]}),$("div",{className:"ml-4",children:[A("div",{className:"text-sm font-medium text-gray-900",children:W.name}),A("div",{className:"text-sm text-gray-500",children:W.village})]})]}),$("div",{className:"flex items-center",children:[$("div",{className:"text-sm text-gray-900 mr-4",children:[A("div",{className:"font-medium",children:W.type}),$("div",{className:"text-gray-500",children:[W.area&&`Area: ${W.area}`,W.depth&&`Depth: ${W.depth}`,W.length&&`Length: ${W.length}`]})]}),A("div",{className:"flex flex-col items-end",children:$("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[W.confidence,"% confidence"]})})]})]})})},W.id))})})]})]})]})})})]})},hP=()=>{const[i,o]=Me.useState("rules"),[d,y]=Me.useState("Village A"),[x,S]=Me.useState("PT-2023-001"),[b,c]=Me.useState([{id:"rule-1",name:"PM-KISAN Eligibility",description:"If household has farmland > 0.5 ha and farmer_flag = true => mark PM-KISAN eligible",condition:"farmland > 0.5 ha AND farmer_flag = true",action:"Mark PM-KISAN eligible",active:!0},{id:"rule-2",name:"Jal Jeevan Priority",description:"If water_index < 0.3 and population > 50 => recommend Jal Jeevan / borewell priority",condition:"water_index < 0.3 AND population > 50",action:"Recommend Jal Jeevan / borewell priority",active:!0},{id:"rule-3",name:"DAJGUA Interventions",description:'If forest_dependent = true and CFR_status = "granted" => recommend specific DAJGUA interventions',condition:'forest_dependent = true AND CFR_status = "granted"',action:"Recommend DAJGUA interventions",active:!0}]),F=[{pattaId:"PT-2023-001",holder:"Ram Prasad",village:"Village A",recommendations:[{scheme:"PM-KISAN",reason:"Farmland > 0.5 ha and farmer flag is true",priority:"High"},{scheme:"Soil Health Card",reason:"Agricultural land detected",priority:"Medium"}],confidence:92},{pattaId:"PT-2023-002",holder:"Sita Devi",village:"Village A",recommendations:[{scheme:"Jal Jeevan Mission",reason:"Water index < 0.3 and population > 50",priority:"High"}],confidence:87},{pattaId:"PT-2023-003",holder:"Community Council",village:"Village B",recommendations:[{scheme:"DAJGUA Interventions",reason:"Forest dependent and CFR granted",priority:"High"},{scheme:"Van Dhan Yojana",reason:"Forest area detected",priority:"Medium"}],confidence:95}],W=re=>{c(b.map(ce=>ce.id===re?{...ce,active:!ce.active}:ce))};return $("div",{className:"min-h-screen bg-gray-50",children:[A("div",{className:"bg-white shadow",children:$("div",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:[A("h1",{className:"text-3xl font-bold text-gray-900",children:"Decision Support System"}),A("p",{className:"mt-1 text-sm text-gray-500",children:"AI-powered recommendations for forest rights implementation"})]})}),A("div",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:$("div",{className:"px-4 py-6 sm:px-0",children:[A("div",{className:"border-b border-gray-200 mb-6",children:$("nav",{className:"-mb-px flex space-x-8",children:[A("button",{onClick:()=>o("rules"),className:`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ${i==="rules"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Rule Editor"}),A("button",{onClick:()=>o("analysis"),className:`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ${i==="analysis"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Analysis Results"})]})}),i==="rules"&&$("div",{className:"space-y-6",children:[A("div",{className:"bg-white shadow rounded-lg",children:A("div",{className:"px-4 py-5 sm:p-6",children:$("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[$("div",{children:[A("h3",{className:"text-lg font-medium text-gray-900",children:"DSS Rules"}),A("p",{className:"mt-1 text-sm text-gray-500",children:"Configure rules for automated decision support"})]}),A("div",{className:"mt-4 md:mt-0",children:$("button",{type:"button",onClick:()=>{console.log("Running DSS with rules:",b),o("analysis")},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[A("svg",{className:"-ml-1 mr-2 h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"Run DSS Analysis"]})})]})})}),A("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:A("ul",{className:"divide-y divide-gray-200",children:b.map(re=>A("li",{children:$("div",{className:"px-4 py-4 sm:px-6",children:[$("div",{className:"flex items-center justify-between",children:[$("div",{className:"flex items-center",children:[A("input",{id:`rule-${re.id}`,name:`rule-${re.id}`,type:"checkbox",checked:re.active,onChange:()=>W(re.id),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),A("label",{htmlFor:`rule-${re.id}`,className:"ml-3 text-sm font-medium text-gray-700",children:re.name})]}),A("div",{className:"flex items-center",children:A("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Active"})})]}),A("div",{className:"mt-2 sm:flex sm:justify-between",children:A("div",{className:"sm:flex",children:$("p",{className:"flex items-center text-sm text-gray-500",children:[A("svg",{className:"flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),re.description]})})}),$("div",{className:"mt-2 flex flex-wrap gap-2",children:[$("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:["Condition: ",re.condition]}),$("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:["Action: ",re.action]})]})]})},re.id))})}),A("div",{className:"bg-white shadow sm:rounded-lg",children:$("div",{className:"px-4 py-5 sm:p-6",children:[A("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Add New Rule"}),$("div",{className:"mt-4 grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6",children:[$("div",{className:"sm:col-span-3",children:[A("label",{htmlFor:"rule-name",className:"block text-sm font-medium text-gray-700",children:"Rule Name"}),A("div",{className:"mt-1",children:A("input",{type:"text",name:"rule-name",id:"rule-name",className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Enter rule name"})})]}),$("div",{className:"sm:col-span-6",children:[A("label",{htmlFor:"rule-description",className:"block text-sm font-medium text-gray-700",children:"Description"}),A("div",{className:"mt-1",children:A("textarea",{id:"rule-description",name:"rule-description",rows:2,className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Describe the rule"})})]}),$("div",{className:"sm:col-span-6",children:[A("label",{htmlFor:"rule-condition",className:"block text-sm font-medium text-gray-700",children:"Condition"}),A("div",{className:"mt-1",children:A("input",{type:"text",name:"rule-condition",id:"rule-condition",className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Enter condition logic"})})]}),$("div",{className:"sm:col-span-6",children:[A("label",{htmlFor:"rule-action",className:"block text-sm font-medium text-gray-700",children:"Action"}),A("div",{className:"mt-1",children:A("input",{type:"text",name:"rule-action",id:"rule-action",className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Enter action to take"})})]})]}),A("div",{className:"mt-6",children:$("button",{type:"button",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[A("svg",{className:"-ml-1 mr-2 h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Rule"]})})]})})]}),i==="analysis"&&$("div",{className:"space-y-6",children:[A("div",{className:"bg-white shadow rounded-lg",children:A("div",{className:"px-4 py-5 sm:p-6",children:$("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[$("div",{children:[A("h3",{className:"text-lg font-medium text-gray-900",children:"DSS Analysis Results"}),A("p",{className:"mt-1 text-sm text-gray-500",children:"Recommendations based on active rules"})]}),$("div",{className:"mt-4 flex flex-col sm:flex-row md:mt-0 gap-2",children:[$("select",{className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",value:d,onChange:re=>y(re.target.value),children:[A("option",{value:"Village A",children:"Village A"}),A("option",{value:"Village B",children:"Village B"}),A("option",{value:"Village C",children:"Village C"})]}),$("select",{className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",value:x,onChange:re=>S(re.target.value),children:[A("option",{value:"PT-2023-001",children:"PT-2023-001"}),A("option",{value:"PT-2023-002",children:"PT-2023-002"}),A("option",{value:"PT-2023-003",children:"PT-2023-003"})]})]})]})})}),$("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-3",children:[A("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:A("div",{className:"px-4 py-5 sm:p-6",children:$("div",{className:"flex items-center",children:[A("div",{className:"flex-shrink-0 bg-indigo-500 rounded-md p-3",children:A("svg",{className:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),A("div",{className:"ml-5 w-0 flex-1",children:$("dl",{children:[A("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Recommendations"}),A("dd",{className:"flex items-baseline",children:A("div",{className:"text-2xl font-semibold text-gray-900",children:"5"})})]})})]})})}),A("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:A("div",{className:"px-4 py-5 sm:p-6",children:$("div",{className:"flex items-center",children:[A("div",{className:"flex-shrink-0 bg-green-500 rounded-md p-3",children:A("svg",{className:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),A("div",{className:"ml-5 w-0 flex-1",children:$("dl",{children:[A("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"High Priority"}),A("dd",{className:"flex items-baseline",children:A("div",{className:"text-2xl font-semibold text-gray-900",children:"3"})})]})})]})})}),A("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:A("div",{className:"px-4 py-5 sm:p-6",children:$("div",{className:"flex items-center",children:[A("div",{className:"flex-shrink-0 bg-blue-500 rounded-md p-3",children:A("svg",{className:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),A("div",{className:"ml-5 w-0 flex-1",children:$("dl",{children:[A("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Avg Confidence"}),A("dd",{className:"flex items-baseline",children:A("div",{className:"text-2xl font-semibold text-gray-900",children:"91%"})})]})})]})})})]}),A("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:A("ul",{className:"divide-y divide-gray-200",children:F.map(re=>A("li",{children:$("div",{className:"px-4 py-4 sm:px-6",children:[$("div",{className:"flex items-center justify-between",children:[$("p",{className:"text-sm font-medium text-indigo-600 truncate",children:[re.pattaId," - ",re.holder]}),A("div",{className:"ml-2 flex-shrink-0 flex",children:$("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[re.confidence,"% confidence"]})})]}),A("div",{className:"mt-2 sm:flex sm:justify-between",children:A("div",{className:"sm:flex",children:$("p",{className:"flex items-center text-sm text-gray-500",children:[$("svg",{className:"flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),re.village]})})}),$("div",{className:"mt-4",children:[A("h4",{className:"text-sm font-medium text-gray-900",children:"Recommendations:"}),A("ul",{className:"mt-2 space-y-2",children:re.recommendations.map((ce,K)=>$("li",{className:"flex items-start",children:[A("div",{className:`flex-shrink-0 h-5 w-5 rounded-full flex items-center justify-center ${ce.priority==="High"?"bg-red-100":"bg-yellow-100"}`,children:A("svg",{className:`h-3 w-3 ${ce.priority==="High"?"text-red-600":"text-yellow-600"}`,fill:"currentColor",viewBox:"0 0 8 8",children:A("circle",{cx:"4",cy:"4",r:"3"})})}),$("p",{className:"ml-2 text-sm text-gray-700",children:[A("span",{className:"font-medium",children:ce.scheme})," - ",ce.reason]})]},K))})]})]})},re.pattaId))})}),A("div",{className:"bg-white shadow sm:rounded-lg",children:$("div",{className:"px-4 py-5 sm:p-6",children:[A("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Export Results"}),$("div",{className:"mt-4 flex space-x-4",children:[$("button",{type:"button",className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[A("svg",{className:"-ml-1 mr-2 h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export to PDF"]}),$("button",{type:"button",className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[A("svg",{className:"-ml-1 mr-2 h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export to CSV"]})]})]})})]})]})})]})},dP=()=>{const[i,o]=Me.useState("claims"),[d,y]=Me.useState({start:"2023-01-01",end:"2023-12-31"}),[x,S]=Me.useState("all"),[b,c]=Me.useState("pdf"),F=[{id:"claims",name:"Claims Summary",description:"Summary of all forest rights claims"},{id:"assets",name:"Asset Inventory",description:"Inventory of detected assets"},{id:"dss",name:"DSS Recommendations",description:"Decision support system recommendations"},{id:"users",name:"User Activity",description:"User login and activity report"}],W=[{id:"all",name:"All Villages"},{id:"village-a",name:"Village A"},{id:"village-b",name:"Village B"},{id:"village-c",name:"Village C"}],se=()=>{console.log("Generating report:",{reportType:i,dateRange:d,selectedVillage:x,selectedFormat:b}),alert(`Report generated successfully in ${b.toUpperCase()} format!`)};return $("div",{className:"min-h-screen bg-gray-50",children:[A("div",{className:"bg-white shadow",children:$("div",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:[A("h1",{className:"text-3xl font-bold text-gray-900",children:"Reports & Exports"}),A("p",{className:"mt-1 text-sm text-gray-500",children:"Generate and export reports"})]})}),A("div",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:A("div",{className:"px-4 py-6 sm:px-0",children:$("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[A("div",{className:"lg:col-span-2",children:A("div",{className:"bg-white shadow sm:rounded-lg",children:$("div",{className:"px-4 py-5 sm:p-6",children:[A("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Generate Report"}),$("div",{className:"mt-6 grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6",children:[$("div",{className:"sm:col-span-6",children:[A("label",{className:"block text-sm font-medium text-gray-700",children:"Report Type"}),A("div",{className:"mt-2 grid grid-cols-1 gap-4 sm:grid-cols-2",children:F.map(re=>$("div",{onClick:()=>o(re.id),className:`relative rounded-lg border p-4 cursor-pointer focus:outline-none ${i===re.id?"border-indigo-500 bg-indigo-50":"border-gray-300"}`,children:[$("div",{className:"flex items-center",children:[A("input",{type:"radio",checked:i===re.id,onChange:()=>{},className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500"}),A("span",{className:"ml-3 block text-sm font-medium text-gray-700",children:re.name})]}),A("p",{className:"mt-1 ml-7 text-sm text-gray-500",children:re.description})]},re.id))})]}),$("div",{className:"sm:col-span-3",children:[A("label",{htmlFor:"start-date",className:"block text-sm font-medium text-gray-700",children:"Start Date"}),A("div",{className:"mt-1",children:A("input",{type:"date",id:"start-date",value:d.start,onChange:re=>y({...d,start:re.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})})]}),$("div",{className:"sm:col-span-3",children:[A("label",{htmlFor:"end-date",className:"block text-sm font-medium text-gray-700",children:"End Date"}),A("div",{className:"mt-1",children:A("input",{type:"date",id:"end-date",value:d.end,onChange:re=>y({...d,end:re.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})})]}),$("div",{className:"sm:col-span-6",children:[A("label",{htmlFor:"village",className:"block text-sm font-medium text-gray-700",children:"Village"}),A("div",{className:"mt-1",children:A("select",{id:"village",value:x,onChange:re=>S(re.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:W.map(re=>A("option",{value:re.id,children:re.name},re.id))})})]}),$("div",{className:"sm:col-span-6",children:[A("label",{className:"block text-sm font-medium text-gray-700",children:"Export Format"}),A("div",{className:"mt-2 grid grid-cols-1 gap-4 sm:grid-cols-4",children:["pdf","csv","geojson","kml"].map(re=>A("div",{onClick:()=>c(re),className:`relative rounded-lg border p-4 cursor-pointer focus:outline-none ${b===re?"border-indigo-500 bg-indigo-50":"border-gray-300"}`,children:$("div",{className:"flex items-center",children:[A("input",{type:"radio",checked:b===re,onChange:()=>{},className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500"}),A("span",{className:"ml-3 block text-sm font-medium text-gray-700 uppercase",children:re})]})},re))})]})]}),A("div",{className:"mt-6",children:$("button",{type:"button",onClick:se,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[A("svg",{className:"-ml-1 mr-2 h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Generate Report"]})})]})})}),$("div",{children:[A("div",{className:"bg-white shadow sm:rounded-lg",children:$("div",{className:"px-4 py-5 sm:p-6",children:[A("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Recent Reports"}),A("div",{className:"mt-4",children:$("ul",{className:"divide-y divide-gray-200",children:[A("li",{className:"py-3",children:$("div",{className:"flex items-center justify-between",children:[$("div",{children:[A("p",{className:"text-sm font-medium text-gray-900",children:"Claims Summary"}),A("p",{className:"text-sm text-gray-500",children:"May 15, 2023"})]}),A("div",{className:"flex space-x-2",children:A("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"PDF"})})]})}),A("li",{className:"py-3",children:$("div",{className:"flex items-center justify-between",children:[$("div",{children:[A("p",{className:"text-sm font-medium text-gray-900",children:"Asset Inventory"}),A("p",{className:"text-sm text-gray-500",children:"May 10, 2023"})]}),A("div",{className:"flex space-x-2",children:A("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"CSV"})})]})}),A("li",{className:"py-3",children:$("div",{className:"flex items-center justify-between",children:[$("div",{children:[A("p",{className:"text-sm font-medium text-gray-900",children:"DSS Recommendations"}),A("p",{className:"text-sm text-gray-500",children:"May 5, 2023"})]}),A("div",{className:"flex space-x-2",children:A("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:"PDF"})})]})}),A("li",{className:"py-3",children:$("div",{className:"flex items-center justify-between",children:[$("div",{children:[A("p",{className:"text-sm font-medium text-gray-900",children:"User Activity"}),A("p",{className:"text-sm text-gray-500",children:"April 28, 2023"})]}),A("div",{className:"flex space-x-2",children:A("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"CSV"})})]})})]})}),A("div",{className:"mt-4",children:$("button",{type:"button",className:"w-full inline-flex justify-center items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[A("svg",{className:"-ml-1 mr-2 h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"View All Reports"]})})]})}),A("div",{className:"mt-6 bg-white shadow sm:rounded-lg",children:$("div",{className:"px-4 py-5 sm:p-6",children:[A("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Quick Exports"}),$("div",{className:"mt-4 space-y-3",children:[$("button",{type:"button",className:"w-full inline-flex justify-center items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[A("svg",{className:"-ml-1 mr-2 h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export All Claims (GeoJSON)"]}),$("button",{type:"button",className:"w-full inline-flex justify-center items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[A("svg",{className:"-ml-1 mr-2 h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export Assets (KML)"]}),$("button",{type:"button",className:"w-full inline-flex justify-center items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[A("svg",{className:"-ml-1 mr-2 h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export DSS Results (CSV)"]})]})]})})]})]})})})]})},pP=()=>{const[i,o]=Me.useState(""),[d,y]=Me.useState(!1),[x,S]=Me.useState(null),[b,c]=Me.useState([{id:"1",name:"Admin User",email:"admin@example.com",role:"Administrator",status:"Active",lastLogin:"2023-05-15"},{id:"2",name:"Field Officer",email:"field@example.com",role:"Field Officer",status:"Active",lastLogin:"2023-05-14"},{id:"3",name:"Data Analyst",email:"analyst@example.com",role:"Analyst",status:"Active",lastLogin:"2023-05-10"},{id:"4",name:"Reviewer",email:"reviewer@example.com",role:"Reviewer",status:"Inactive",lastLogin:"2023-04-28"}]),F=["Administrator","Field Officer","Analyst","Reviewer"],W=b.filter(K=>K.name.toLowerCase().includes(i.toLowerCase())||K.email.toLowerCase().includes(i.toLowerCase())||K.role.toLowerCase().includes(i.toLowerCase())),se=K=>{const Ie={id:(b.length+1).toString(),...K,status:"Active",lastLogin:"Never"};c([...b,Ie]),y(!1)},re=K=>{c(b.map(Ie=>Ie.id===x.id?{...Ie,...K}:Ie)),S(null)},ce=K=>{c(b.filter(Ie=>Ie.id!==K))};return $("div",{className:"min-h-screen bg-gray-50",children:[A("div",{className:"bg-white shadow",children:$("div",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:[A("h1",{className:"text-3xl font-bold text-gray-900",children:"User Management"}),A("p",{className:"mt-1 text-sm text-gray-500",children:"Manage users and their roles"})]})}),A("div",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:$("div",{className:"px-4 py-6 sm:px-0",children:[$("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6",children:[A("div",{className:"flex-1",children:$("div",{className:"relative rounded-md shadow-sm",children:[A("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:A("svg",{className:"h-5 w-5 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:A("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})})}),A("input",{type:"text",className:"focus:ring-indigo-500 focus:border-indigo-500 block w-full pl-10 pr-12 sm:text-sm border-gray-300 rounded-md",placeholder:"Search users...",value:i,onChange:K=>o(K.target.value)})]})}),A("div",{className:"mt-4 md:mt-0 md:ml-4",children:$("button",{type:"button",onClick:()=>y(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[A("svg",{className:"-ml-1 mr-2 h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add User"]})})]}),A("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:A("ul",{className:"divide-y divide-gray-200",children:W.map(K=>A("li",{children:$("div",{className:"px-4 py-4 sm:px-6",children:[$("div",{className:"flex items-center justify-between",children:[$("div",{className:"flex items-center",children:[A("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center",children:A("span",{className:"text-indigo-800 font-medium",children:K.name.charAt(0)})}),$("div",{className:"ml-4",children:[A("div",{className:"text-sm font-medium text-gray-900",children:K.name}),A("div",{className:"text-sm text-gray-500",children:K.email})]})]}),$("div",{className:"flex items-center space-x-4",children:[A("div",{className:"text-sm text-gray-900",children:A("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:K.role})}),A("div",{className:"text-sm text-gray-500",children:K.status==="Active"?A("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Active"}):A("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"Inactive"})}),$("div",{className:"flex space-x-2",children:[A("button",{onClick:()=>S(K),className:"text-indigo-600 hover:text-indigo-900",children:A("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),A("button",{onClick:()=>ce(K.id),className:"text-red-600 hover:text-red-900",children:A("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})]}),A("div",{className:"mt-2 sm:flex sm:justify-between",children:A("div",{className:"sm:flex",children:$("p",{className:"flex items-center text-sm text-gray-500",children:["Last login: ",K.lastLogin]})})})]})},K.id))})})]})}),d&&A("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:$("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[A("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:A("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),A("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:""}),$("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[A("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:A("div",{className:"sm:flex sm:items-start",children:$("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full",children:[A("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Add New User"}),A("div",{className:"mt-4",children:$("form",{className:"space-y-4",children:[$("div",{children:[A("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Full Name"}),A("input",{type:"text",name:"name",id:"name",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),$("div",{children:[A("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email Address"}),A("input",{type:"email",name:"email",id:"email",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),$("div",{children:[A("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700",children:"Role"}),A("select",{id:"role",name:"role",className:"mt-1 block w-full bg-white border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:F.map(K=>A("option",{value:K,children:K},K))})]})]})})]})})}),$("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[A("button",{type:"button",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-indigo-600 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:ml-3 sm:w-auto sm:text-sm",onClick:()=>se({name:"New User",email:"new@example.com",role:"Field Officer"}),children:"Add User"}),A("button",{type:"button",className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",onClick:()=>y(!1),children:"Cancel"})]})]})]})}),x&&A("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:$("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[A("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:A("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),A("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:""}),$("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[A("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:A("div",{className:"sm:flex sm:items-start",children:$("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full",children:[A("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Edit User"}),A("div",{className:"mt-4",children:$("form",{className:"space-y-4",children:[$("div",{children:[A("label",{htmlFor:"edit-name",className:"block text-sm font-medium text-gray-700",children:"Full Name"}),A("input",{type:"text",name:"edit-name",id:"edit-name",defaultValue:x.name,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),$("div",{children:[A("label",{htmlFor:"edit-email",className:"block text-sm font-medium text-gray-700",children:"Email Address"}),A("input",{type:"email",name:"edit-email",id:"edit-email",defaultValue:x.email,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),$("div",{children:[A("label",{htmlFor:"edit-role",className:"block text-sm font-medium text-gray-700",children:"Role"}),A("select",{id:"edit-role",name:"edit-role",defaultValue:x.role,className:"mt-1 block w-full bg-white border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:F.map(K=>A("option",{value:K,children:K},K))})]})]})})]})})}),$("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[A("button",{type:"button",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-indigo-600 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:ml-3 sm:w-auto sm:text-sm",onClick:()=>re({name:"Updated User",email:"updated@example.com",role:"Field Officer"}),children:"Update User"}),A("button",{type:"button",className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",onClick:()=>S(null),children:"Cancel"})]})]})]})})]})},mP=()=>{const[i,o]=Me.useState(""),[d,y]=Me.useState(!1),[x,S]=Me.useState(null),[b,c]=Me.useState([{id:"1",name:"Patta Boundaries",type:"Vector",status:"Published",version:"1.2",lastUpdated:"2023-05-15"},{id:"2",name:"Forest Cover",type:"Raster",status:"Published",version:"2.1",lastUpdated:"2023-05-10"},{id:"3",name:"Water Bodies",type:"Vector",status:"Draft",version:"0.9",lastUpdated:"2023-05-05"},{id:"4",name:"Road Network",type:"Vector",status:"Published",version:"1.0",lastUpdated:"2023-04-28"},{id:"5",name:"Homesteads",type:"Vector",status:"Archived",version:"1.5",lastUpdated:"2023-04-20"}]),F=["Vector","Raster","Point","Line"],W=b.filter(Ie=>Ie.name.toLowerCase().includes(i.toLowerCase())||Ie.type.toLowerCase().includes(i.toLowerCase())||Ie.status.toLowerCase().includes(i.toLowerCase())),se=Ie=>{const Te={id:(b.length+1).toString(),...Ie,status:"Draft",version:"1.0",lastUpdated:new Date().toISOString().split("T")[0]};c([...b,Te]),y(!1)},re=Ie=>{c(b.map(Te=>Te.id===x.id?{...Te,...Ie}:Te)),S(null)},ce=Ie=>{c(b.filter(Te=>Te.id!==Ie))},K=Ie=>{c(b.map(Te=>{if(Te.id===Ie){const We=Te.status==="Published"?"Draft":"Published";return{...Te,status:We}}return Te}))};return $("div",{className:"min-h-screen bg-gray-50",children:[A("div",{className:"bg-white shadow",children:$("div",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:[A("h1",{className:"text-3xl font-bold text-gray-900",children:"Layer Management"}),A("p",{className:"mt-1 text-sm text-gray-500",children:"Manage map layers and their versions"})]})}),A("div",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:$("div",{className:"px-4 py-6 sm:px-0",children:[$("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6",children:[A("div",{className:"flex-1",children:$("div",{className:"relative rounded-md shadow-sm",children:[A("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:A("svg",{className:"h-5 w-5 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:A("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})})}),A("input",{type:"text",className:"focus:ring-indigo-500 focus:border-indigo-500 block w-full pl-10 pr-12 sm:text-sm border-gray-300 rounded-md",placeholder:"Search layers...",value:i,onChange:Ie=>o(Ie.target.value)})]})}),A("div",{className:"mt-4 md:mt-0 md:ml-4",children:$("button",{type:"button",onClick:()=>y(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[A("svg",{className:"-ml-1 mr-2 h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Layer"]})})]}),A("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:A("ul",{className:"divide-y divide-gray-200",children:W.map(Ie=>A("li",{children:A("div",{className:"px-4 py-4 sm:px-6",children:$("div",{className:"flex items-center justify-between",children:[$("div",{className:"flex items-center",children:[$("div",{className:"flex-shrink-0 h-10 w-10 rounded-md bg-indigo-100 flex items-center justify-center",children:[Ie.type==="Vector"&&A("svg",{className:"h-6 w-6 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})}),Ie.type==="Raster"&&A("svg",{className:"h-6 w-6 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),Ie.type==="Point"&&$("svg",{className:"h-6 w-6 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),Ie.type==="Line"&&A("svg",{className:"h-6 w-6 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5v-4m0 4h-4m4 0l-5-5"})})]}),$("div",{className:"ml-4",children:[A("div",{className:"text-sm font-medium text-gray-900",children:Ie.name}),$("div",{className:"text-sm text-gray-500",children:[Ie.type,"  v",Ie.version,"  Updated ",Ie.lastUpdated]})]})]}),$("div",{className:"flex items-center space-x-4",children:[A("div",{className:"text-sm text-gray-900",children:A("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Ie.status==="Published"?"bg-green-100 text-green-800":Ie.status==="Draft"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:Ie.status})}),$("div",{className:"flex space-x-2",children:[A("button",{onClick:()=>K(Ie.id),className:"text-indigo-600 hover:text-indigo-900",children:Ie.status==="Published"?"Unpublish":"Publish"}),A("button",{onClick:()=>S(Ie),className:"text-indigo-600 hover:text-indigo-900",children:A("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),A("button",{onClick:()=>ce(Ie.id),className:"text-red-600 hover:text-red-900",children:A("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})]})})},Ie.id))})})]})}),d&&A("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:$("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[A("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:A("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),A("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:""}),$("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[A("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:A("div",{className:"sm:flex sm:items-start",children:$("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full",children:[A("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Add New Layer"}),A("div",{className:"mt-4",children:$("form",{className:"space-y-4",children:[$("div",{children:[A("label",{htmlFor:"layer-name",className:"block text-sm font-medium text-gray-700",children:"Layer Name"}),A("input",{type:"text",name:"layer-name",id:"layer-name",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Enter layer name"})]}),$("div",{children:[A("label",{htmlFor:"layer-type",className:"block text-sm font-medium text-gray-700",children:"Layer Type"}),A("select",{id:"layer-type",name:"layer-type",className:"mt-1 block w-full bg-white border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:F.map(Ie=>A("option",{value:Ie,children:Ie},Ie))})]}),$("div",{children:[A("label",{htmlFor:"layer-description",className:"block text-sm font-medium text-gray-700",children:"Description"}),A("textarea",{id:"layer-description",name:"layer-description",rows:3,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Enter layer description"})]})]})})]})})}),$("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[A("button",{type:"button",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-indigo-600 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:ml-3 sm:w-auto sm:text-sm",onClick:()=>se({name:"New Layer",type:"Vector",description:"New layer description"}),children:"Add Layer"}),A("button",{type:"button",className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",onClick:()=>y(!1),children:"Cancel"})]})]})]})}),x&&A("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:$("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[A("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:A("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),A("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:""}),$("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[A("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:A("div",{className:"sm:flex sm:items-start",children:$("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full",children:[A("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Edit Layer"}),A("div",{className:"mt-4",children:$("form",{className:"space-y-4",children:[$("div",{children:[A("label",{htmlFor:"edit-layer-name",className:"block text-sm font-medium text-gray-700",children:"Layer Name"}),A("input",{type:"text",name:"edit-layer-name",id:"edit-layer-name",defaultValue:x.name,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),$("div",{children:[A("label",{htmlFor:"edit-layer-type",className:"block text-sm font-medium text-gray-700",children:"Layer Type"}),A("select",{id:"edit-layer-type",name:"edit-layer-type",defaultValue:x.type,className:"mt-1 block w-full bg-white border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:F.map(Ie=>A("option",{value:Ie,children:Ie},Ie))})]}),$("div",{children:[A("label",{htmlFor:"edit-layer-description",className:"block text-sm font-medium text-gray-700",children:"Description"}),A("textarea",{id:"edit-layer-description",name:"edit-layer-description",rows:3,defaultValue:x.description||"",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),$("div",{children:[A("label",{htmlFor:"edit-layer-version",className:"block text-sm font-medium text-gray-700",children:"Version"}),A("input",{type:"text",name:"edit-layer-version",id:"edit-layer-version",defaultValue:x.version,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]})]})})]})})}),$("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[A("button",{type:"button",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-indigo-600 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:ml-3 sm:w-auto sm:text-sm",onClick:()=>re({name:"Updated Layer",type:"Vector",description:"Updated description",version:"2.0"}),children:"Update Layer"}),A("button",{type:"button",className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",onClick:()=>S(null),children:"Cancel"})]})]})]})})]})};class fP extends vm.Component{constructor(o){super(o),this.state={hasError:!1,error:null}}static getDerivedStateFromError(o){return{hasError:!0,error:o}}componentDidCatch(o,d){console.error("App Error Boundary:",o,d)}render(){return this.state.hasError?$("div",{style:{padding:"20px",backgroundColor:"#fee",color:"#c33",minHeight:"100vh"},children:[A("h1",{children:"Application Error"}),A("p",{children:"Something went wrong. Please try refreshing the page."}),this.state.error&&$("details",{style:{marginTop:"20px",padding:"10px",backgroundColor:"white",borderRadius:"4px"},children:[A("summary",{children:"Error Details"}),A("pre",{children:this.state.error.message})]}),A("button",{onClick:()=>window.location.reload(),style:{marginTop:"10px",padding:"5px 10px"},children:"Reload Page"})]}):this.props.children}}const gP=()=>A(fP,{children:A(WS,{children:$(jS,{children:[A(Un,{path:"/",element:A(FS,{to:"/login"})}),A(Un,{path:"/login",element:A(KS,{})}),A(Un,{path:"/dashboard",element:A(YS,{})}),A(Un,{path:"/admin/dashboard",element:A(JS,{})}),A(Un,{path:"/field/dashboard",element:A(QS,{})}),A(Un,{path:"/user/dashboard",element:A(eT,{})}),A(Un,{path:"/map",element:A(lT,{})}),A(Un,{path:"/claims",element:A(cT,{})}),A(Un,{path:"/claim/:id",element:A(uT,{})}),A(Un,{path:"/digitize",element:A(cP,{})}),A(Un,{path:"/asset-mapping",element:A(uP,{})}),A(Un,{path:"/dss",element:A(hP,{})}),A(Un,{path:"/reports",element:A(dP,{})}),A(Un,{path:"/admin/users",element:A(pP,{})}),A(Un,{path:"/admin/layers",element:A(mP,{})})]})})});window.addEventListener("error",i=>{console.error("Global error:",i.error)});window.addEventListener("unhandledrejection",i=>{console.error("Unhandled promise rejection:",i.reason)});try{const i=document.getElementById("root");if(!i)throw new Error("Root element not found in HTML");Ag.createRoot(i).render(A(vm.StrictMode,{children:A(gP,{})}))}catch(i){console.error("Failed to render app:",i),document.body.innerHTML=`
    <div style="padding: 20px; background-color: #fee; color: #c33; min-height: 100vh; display: flex; flex-direction: column; justify-content: center; align-items: center; font-family: Arial, sans-serif;">
      <h1 style="color: #c33;">Critical Initialization Error</h1>
      <p>Failed to initialize the application.</p>
      <div style="margin-top: 20px; padding: 10px; background-color: white; border-radius: 4px; max-width: 80%;">
        <strong>Error:</strong>
        <pre style="font-size: 0.8em; white-space: pre-wrap;">${i instanceof Error?i.message:String(i)}</pre>
      </div>
      <button 
        onclick="window.location.reload()" 
        style="margin-top: 20px; padding: 10px 20px; background-color: #c33; color: white; border: none; border-radius: 4px; cursor: pointer;"
      >
        Reload Page
      </button>
    </div>
  `}
//# sourceMappingURL=index-9cf23185.js.map
